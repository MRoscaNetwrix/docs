"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[568347],{28453:(e,s,t)=>{t.d(s,{R:()=>r,x:()=>a});var n=t(296540);const i={},o=n.createContext(i);function r(e){const s=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(o.Provider,{value:s},e.children)}},432571:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"enterpriseauditor/solutions/windows/authentication/sg_lsasettings","title":"SG\\\\_LSASettings Job","description":"The SG\\\\_LASettings job lists settings on all targeted hosts. In particular, the RunAsPPL, RestrictAnonymous, and ValidateKdcPacSignature keys are examined. If these keys are not set to 1, a host is vulnerable to mimikatz and other exploitation tools. See the Microsoft Configuring Additional LSA Protection) article for additional information.","source":"@site/docs/accessanalyzer/enterpriseauditor/solutions/windows/authentication/sg_lsasettings.md","sourceDirName":"enterpriseauditor/solutions/windows/authentication","slug":"/enterpriseauditor/solutions/windows/authentication/sg_lsasettings","permalink":"/docs/accessanalyzer/enterpriseauditor/solutions/windows/authentication/sg_lsasettings","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/enterpriseauditor/solutions/windows/authentication/sg_lsasettings.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"Recommended Configurations for the Authentication Job Group","permalink":"/docs/accessanalyzer/enterpriseauditor/solutions/windows/authentication/recommended"},"next":{"title":"SG\\\\_SecuritySupportProviders Job","permalink":"/docs/accessanalyzer/enterpriseauditor/solutions/windows/authentication/sg_securitysupportproviders"}}');var i=t(474848),o=t(28453);const r={},a="SG_LSASettings Job",d={},l=[{value:"Queries for the SG_LSASettings Job",id:"queries-for-the-sg_lsasettings-job",level:2},{value:"Analysis Tasks for the SG_LSASettings Job",id:"analysis-tasks-for-the-sg_lsasettings-job",level:2}];function c(e){const s={a:"a",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"sg_lsasettings-job",children:"SG_LSASettings Job"})}),"\n",(0,i.jsxs)(s.p,{children:["The SG_LASettings job lists settings on all targeted hosts. In particular, the RunAsPPL, RestrictAnonymous, and ValidateKdcPacSignature keys are examined. If these keys are not set to 1, a host is vulnerable to mimikatz and other exploitation tools. See the Microsoft ",(0,i.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn408187(v=ws.11)",children:"Configuring Additional LSA Protection"})," article for additional information."]}),"\n",(0,i.jsx)(s.h2,{id:"queries-for-the-sg_lsasettings-job",children:"Queries for the SG_LSASettings Job"}),"\n",(0,i.jsx)(s.p,{children:"The SG_LSASettings job uses the Registry Data Collector for the following queries:"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"CAUTION:"})," The queries are preconfigured for this job. Never modify the queries."]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Queries for the SG_LSASettings Job",src:t(925803).A+"",width:"788",height:"256"})}),"\n",(0,i.jsx)(s.p,{children:"The queries for the SG_LSASettings Job are:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Check LSA registry keys \u2013 Checks LSA registry keys"}),"\n",(0,i.jsx)(s.li,{children:"PAC Validation \u2013 Provides PAC Validation"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"analysis-tasks-for-the-sg_lsasettings-job",children:"Analysis Tasks for the SG_LSASettings Job"}),"\n",(0,i.jsxs)(s.p,{children:["Navigate to the ",(0,i.jsx)(s.strong,{children:"Windows"})," > ",(0,i.jsx)(s.strong,{children:"Authentication"})," > ",(0,i.jsx)(s.strong,{children:"SG_LSASettings"})," > ",(0,i.jsx)(s.strong,{children:"Configure"})," node and select ",(0,i.jsx)(s.strong,{children:"Analysis"})," to view the analysis tasks."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"CAUTION:"})," Do not modify or deselect the selected analysis tasks. The analysis tasks are preconfigured for this job."]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Analysis Tasks for the SG_LSASettings Job",src:t(464971).A+"",width:"637",height:"294"})}),"\n",(0,i.jsx)(s.p,{children:"The default analysis tasks are:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"TrackRunAsPPL changes \u2013 Creates the SG_LSASettings_RunAsPPLChangeTracking table accessible under the job\u2019s Results node"}),"\n",(0,i.jsx)(s.li,{children:"List RunAsPPL setting details \u2013 Creates the SG_LSASettings_RunAsPPLDetails table accessible under the job\u2019s Results node"}),"\n",(0,i.jsx)(s.li,{children:"Summarize RunAsPPL settings \u2013 Creates an interim processing table in the database for use by downstream analysis and report generation"}),"\n",(0,i.jsx)(s.li,{children:"Track RestrictAnonymous changes \u2013 Creates the SG_LSASettings_RestrictAnonymousChangeTracking table accessible under the job\u2019s Results node"}),"\n",(0,i.jsx)(s.li,{children:"List RestrictAnonymous setting details \u2013 Creates the SG_LSASettings_RestrictAnonymousDetails table accessible under the job\u2019s Results node"}),"\n",(0,i.jsx)(s.li,{children:"Summarize RestrictAnonymous settings \u2013 Creates an interim processing table in the database for use by downstream analysis and report generation"}),"\n",(0,i.jsx)(s.li,{children:"PAC \u2013 Creates the SG_LSASettings_PACStatus table accessible under the job\u2019s Results node"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"In addition to the tables created by the data collector, the SG_LSASettings job produces the following pre-configured reports."}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Report"}),(0,i.jsx)(s.th,{children:"Description"}),(0,i.jsx)(s.th,{children:"Default Tags"}),(0,i.jsx)(s.th,{children:"Report Elements"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Additional LSA Protection"}),(0,i.jsxs)(s.td,{children:["This report summarizes RunAsPPL registry settings on targeted hosts. This key governs whether or not additional LSA protection is enabled. See the Microsoft ",(0,i.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn408187(v=ws.11)",children:"Configuring Additional LSA Protection"})," article for additional information."]}),(0,i.jsx)(s.td,{children:"None"}),(0,i.jsx)(s.td,{children:"This report is comprised of two elements:   - Pie Chart \u2013 Displays additional LSA protection by host - Table \u2013 Provides additional LSA Protection Details"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"PAC Validation"}),(0,i.jsxs)(s.td,{children:["This report indicates whether or not PAC Validation is enabled on all targeted hosts. This is governed by the ValidateKdcPacSignature key. Default behavior in the event of this key's absence depends on the Windows version installed. See the Microsoft ",(0,i.jsx)(s.a,{href:"https://learn.microsoft.com/en-gb/archive/blogs/openspecification/understanding-microsoft-kerberos-pac-validation",children:"Understanding Microsoft Kerberos PAC Validation"})," article for additional information."]}),(0,i.jsx)(s.td,{children:"None"}),(0,i.jsx)(s.td,{children:"This report is comprised of two elements:   - Pie Chart \u2013 Displays PAC validation status - Table \u2013 Provides PAC validation details"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Restrict Anonymous Access"}),(0,i.jsxs)(s.td,{children:["This report summarizes RestrictAnonymous registry settings on targeted hosts. This key governs whether or not access over anonymous connections is enabled. See the Microsoft ",(0,i.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/previous-versions/tn-archive/bb418944(v=technet.10)",children:"Restrict Anonymous check"})," article for additional information."]}),(0,i.jsx)(s.td,{children:"None"}),(0,i.jsx)(s.td,{children:"This report is comprised of two elements:   - Pie Chart \u2013 Displays anonymous access by host - Table \u2013 Provides anonymous access details"})]})]})]})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},464971:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/lsasettingsanalysis-a5166426ef4fb92b6c4f00f41705f6ff.webp"},925803:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/lsasettingsqueries-42d9bbda5e8ea5c416338d55b03d08c5.webp"}}]);