"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[576775],{28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>t});var i=s(296540);const l={},o=i.createContext(l);function c(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),i.createElement(o.Provider,{value:n},e.children)}},154046:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/policypak_and_powershell_4_950x333-7255c2be46eacc2595442141c9b3d0f5.webp"},208696:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/policypak_and_powershell_6_950x148-dc08eab50030443638eab7a22e639134.webp"},278716:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>t,default:()=>p,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"policypak/install/powershell","title":"Endpoint Policy Manager and PowerShell","description":"Netwrix Endpoint Policy Manager (formerly PolicyPak) has a PowerShell module that can perform some key tasks. As of the writing of this manual, the PowerShell cmdlets can perform licensing steps and discover Endpoint Policy Manager items within a Group Policy Object (GPO). The Endpoint Policy Manager PowerShell module is located in the Endpoint Policy Manager Extras folder you downloaded.","source":"@site/docs/policypak/policypak/install/powershell.md","sourceDirName":"policypak/install","slug":"/policypak/install/powershell","permalink":"/docs/policypak/policypak/install/powershell","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/install/powershell.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Video Learning Center","permalink":"/docs/policypak/policypak/install/overview/videolearningcenter"},"next":{"title":"Using Rings to Test and Update the Endpoint Policy Manager Client-Side Extension and/or Cloud Client (And How to Stay Supported)","permalink":"/docs/policypak/policypak/install/rings"}}');var l=s(474848),o=s(28453);const c={},t="Endpoint Policy Manager and PowerShell",r={},a=[{value:"Endpoint Policy Manager PowerShell and Licensing Endpoint Policy Manager",id:"endpoint-policy-manager-powershell-and-licensing-endpoint-policy-manager",level:2},{value:"Endpoint Policy Manager PowerShell and Discovery",id:"endpoint-policy-manager-powershell-and-discovery",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"endpoint-policy-manager-and-powershell",children:"Endpoint Policy Manager and PowerShell"})}),"\n",(0,l.jsx)(n.p,{children:"Netwrix Endpoint Policy Manager (formerly PolicyPak) has a PowerShell module that can perform some key tasks. As of the writing of this manual, the PowerShell cmdlets can perform licensing steps and discover Endpoint Policy Manager items within a Group Policy Object (GPO). The Endpoint Policy Manager PowerShell module is located in the Endpoint Policy Manager Extras folder you downloaded."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"policypak_and_powershell_1200x787",src:s(442827).A+"",width:"1200",height:"787"})}),"\n",(0,l.jsxs)(n.p,{children:["Run the Endpoint Policy Manager PowerShell Tools installer. The Endpoint Policy Manager PowerShell modules will be installed to ",(0,l.jsx)(n.code,{children:">c:\\Program Files\\PolicyPak1\\Tools\\Modules\\PolicyPak"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:["At a Powershell prompt run the command ",(0,l.jsx)(n.code,{children:">Import-Module PolicyPak.psd1."})," If you add the ",(0,l.jsx)(n.code,{children:">-verbose "}),"command you will see all of the available cmdlets."]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"policypak_and_powershell_1_1200x974",src:s(888575).A+"",width:"1200",height:"974"})}),"\n",(0,l.jsx)(n.h2,{id:"endpoint-policy-manager-powershell-and-licensing-endpoint-policy-manager",children:"Endpoint Policy Manager PowerShell and Licensing Endpoint Policy Manager"}),"\n",(0,l.jsxs)(n.p,{children:["To import a module, you need to call ",(0,l.jsx)(n.code,{children:">Import-Module Endpoint Policy Manager "}),"in PowerShell. At the time of the publication of this manual, all Endpoint Policy Manager cmdlets are for a licensing component that requires the following commands:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Importing cmdlet '",(0,l.jsx)(n.code,{children:"Get-PPCses"}),"'"]}),"\n",(0,l.jsxs)(n.li,{children:["Importing cmdlet '",(0,l.jsx)(n.code,{children:"Get-PPGPOs"}),"'"]}),"\n",(0,l.jsxs)(n.li,{children:["Importing cmdlet '",(0,l.jsx)(n.code,{children:"Get-RegisteredCses"}),"'"]}),"\n",(0,l.jsxs)(n.li,{children:["Importing cmdlet '",(0,l.jsx)(n.code,{children:"Register-PPLicenses"}),"'"]}),"\n",(0,l.jsxs)(n.li,{children:["Importing cmdlet '",(0,l.jsx)(n.code,{children:"Test-PPLicense"}),"'"]}),"\n",(0,l.jsxs)(n.li,{children:["Importing cmdlet '",(0,l.jsx)(n.code,{children:"Disable-InactiveComputers"}),"'"]}),"\n",(0,l.jsxs)(n.li,{children:["Importing cmdlet '",(0,l.jsx)(n.code,{children:"Get-InactiveComputers"}),"'"]}),"\n",(0,l.jsxs)(n.li,{children:["Importing cmdlet '",(0,l.jsx)(n.code,{children:"Get-PPLicenses"}),"'"]}),"\n",(0,l.jsxs)(n.li,{children:["Importing cmdlet '",(0,l.jsx)(n.code,{children:"Register-PPLicense"}),"'"]}),"\n",(0,l.jsxs)(n.li,{children:["Importing cmdlet '",(0,l.jsx)(n.code,{children:"New-PPLicenseRequestFile"}),"'"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"To generate a new Endpoint Policy Manager license request, there are two methods. Method 1 requires using the existing Microsoft cmdlet Get-ADOrganizationalUnit as shown below."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"># New-PPLicenseRequest"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:">Import-Module ActiveDirectory"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:">Import-Module PolicyPak"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:'>$scope = Get-ADOrganizationalUnit -Filter {(name -eq "OU2") -or (name -like "Domain*") -or (name -like "Real*")} -Property * | FT DistinguishedName -A -HideTableHeaders | Out-String'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:'>$som = Get-ADOrganizationalUnit -Filter {(name -like "Real*") -or (name -like "Domain*")} -Property * | FT DistinguishedName -A -HideTableHeaders | Out-String'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:'>New-PPLicenseRequestfile "C:\\Temp\\request1.xml" -Scope $scope -Som $som -Verbose '})}),"\n",(0,l.jsx)(n.p,{children:"The request output is shownbelow."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"policypak_and_powershell_2",src:s(801794).A+"",width:"861",height:"285"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"NOTE:"})," To understand scope versus SOM, see ",(0,l.jsx)(n.a,{href:"/docs/policypak/policypak/license/activedirectory/scope",children:"Why does License Tool ask Who am I and Where do I want to use Endpoint Policy Manager?"}),"."]}),"\n",(0,l.jsx)(n.p,{children:"Method 2 requires indicating specific organizational units (OUs), as shown below. In this example, the scope is the whole domain, but the SOM is the Sales OU within the Fabrikam.com domain. Below is an example script which requests a new license file from a specific SOM and scope."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"># New-PPLicenseRequest"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:">Import-Module ActiveDirectory"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:">Import-Module PolicyPak"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:'>$scope = "DC=Fabrikam, DC=com" '})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:'>$som = "OU=Sales, DC=Fabrikam, DC=com"'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:'>New-PPLicenseRequestFile "E:\\Downloads\\adcomputer.text.new.xml" -scope $scope -som $som -Verbose'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:">#---"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"policypak_and_powershell_3_1200x833",src:s(742967).A+"",width:"1200",height:"833"})}),"\n",(0,l.jsx)(n.p,{children:"The next cmdlet enables you to determine how many computers are not active."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"># Get-InactiveComputers"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:">Import-Module PolicyPak"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:">Get-InactiveComputers -LastLoginTime 90 -inu -Verbose"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:">#---"})}),"\n",(0,l.jsx)(n.p,{children:"The result from this cmdlet is shown below."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"policypak_and_powershell_4_950x333",src:s(154046).A+"",width:"950",height:"333"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:">The next cmdlet disables inactive computers.># Disable-InactiveComputers  \n>Import-Module PolicyPak  \n>Disable-InactiveComputers -LastLoginTime 900 -Verbose  \n>#---\n"})}),"\n",(0,l.jsx)(n.p,{children:"You can then see the machines are disabled:"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"policypak_and_powershell_5_1200x561",src:s(917305).A+"",width:"1200",height:"561"})}),"\n",(0,l.jsx)(n.p,{children:"When the next cmdlet is run, you can see if the license file you got from Endpoint Policy Manager was valid. Note that you might have to run the cmdlet on each Endpoint Policy Manager license file you get."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'># Test-PPlicense>Import-Module PolicyPak  \n>Test-PPlicense\xa0  \n>"C:\\Users\\server\\Desktop\\_licenses\\license_1.xml" -verbose  \n>Test-PPlicense\xa0  \n>"C:\\Users\\server\\Desktop\\_licenses\\license1.xml" -verbose  \n>Test-PPlicense\xa0  \n>"C:\\Users\\server\\Desktop\\_licenses\\license2.xml" -verbose  \n>Test-PPlicense\xa0  \n>"C:\\Users\\server\\Desktop\\_licenses\\FIRSTLicense-Request-Key.xml" -verbose  \n>#---\n'})}),"\n",(0,l.jsx)(n.p,{children:"You can then see that the license is valid:"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"policypak_and_powershell_6_950x148",src:s(208696).A+"",width:"950",height:"148"})}),"\n",(0,l.jsx)(n.p,{children:"When the next cmdlet is run, you can create a new GPO and link it to the scope."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'># Register-PPlicense>Import-Module PolicyPak  \n>Register-PPlicense\xa0  \n>"C:\\Users\\server\\Desktop\\_licenses\\license1.xml" -e $True -verbose\xa0\n'})}),"\n",(0,l.jsx)(n.p,{children:"You can then see the successful installation:"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"policypak_and_powershell_7_1200x328",src:s(664074).A+"",width:"1200",height:"328"})}),"\n",(0,l.jsx)(n.p,{children:"The next cmdlet will specify a GPO by GUID."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'>#Register-PPlicense >"C:\\Users\\server\\Desktop\\_licenses\\license1.xml" -e $True -mgpo "96A61654-8363-444B-97AC-47D466FE12EE" -verbose\xa0  \n>#---  \n># Get-PPlicenses  \n>Import-Module PolicyPak  \n>Get-PPlicenses -Verbose  \n>#---\n'})}),"\n",(0,l.jsx)(n.p,{children:"The result is shown below. You can see the GPO name, scope, expiration date of the license, Endpoint Policy Manager license version type, and validation status of the license."}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"policypak_and_powershell_8_1200x803",src:s(824191).A+"",width:"1200",height:"803"})}),"\n",(0,l.jsx)(n.h2,{id:"endpoint-policy-manager-powershell-and-discovery",children:"Endpoint Policy Manager PowerShell and Discovery"}),"\n",(0,l.jsx)(n.p,{children:"Endpoint Policy Manager can help you discover which GPOs contain Endpoint Policy Manager directives. After you have performed the import of the Endpoint Policy Manager module with Import-Module PolicyPak, you can use cmdlets like the following examples:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:">Get-PPCses"}),": shows Endpoint Policy Manager client-side extension (CSE) names and guids"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:'>Get-PPGPOs -cse "Security"'}),': same as above, but searches for CSEs with "security" in the name (case insensitive)']}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:">Get-RegisteredCses"}),": shows CSEs registered in the system"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:">Get-PPGPOs | Format-Table -wrap"}),": shows all GPOs with any Endpoint Policy Manager product as a table (You can see this in Figure 26 below.)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:'>Get-PPGPOs | Select -ExpandProperty "GPO"'}),":\xa0 shows all GPOs with Endpoint Policy Manager products as names only"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:'>Get-PPGPOs -cse "Security" | Select -ExpandProperty "GPO"'}),': shows all GPOs with any Endpoint Policy Manager products with "security" in the title']}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:'>Get-PPGPOs -cse "E0088A46-AB54-4FBD-A733-303C58244C5E"'}),": shows all GPOs based on CSE GUID"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"![Text"}),"\n",(0,l.jsx)(n.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/install/policypak_and_powershell_9_850x594.webp)"})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},442827:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/policypak_and_powershell_1200x787-a09ada7701c80c3beb431adfc05982fd.webp"},664074:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/policypak_and_powershell_7_1200x328-05de299b2de5b141f4df59448f1498a7.webp"},742967:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/policypak_and_powershell_3_1200x833-b0cbe8888b12629c5a9846a9e496da07.webp"},801794:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/policypak_and_powershell_2-4e78ae5c013d5e90d470431c6faa61b0.webp"},824191:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/policypak_and_powershell_8_1200x803-e72a11898efdca719b189ea27ee02cb7.webp"},888575:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/policypak_and_powershell_1_1200x974-90b44f0e762229581e59511d694ea705.webp"},917305:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/policypak_and_powershell_5_1200x561-12186bbf9b7659914a345aecec62de4e.webp"}}]);