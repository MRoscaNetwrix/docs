"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[484336],{28453:(e,t,o)=>{o.d(t,{R:()=>s,x:()=>l});var i=o(296540);const a={},n=i.createContext(a);function s(e){const t=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(n.Provider,{value:t},e.children)}},887029:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>h,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>r});const i=JSON.parse('{"id":"policypak/video/fileassociations/mailto","title":"Endpoint Policy Manager: How to get mailto: to open in Office 365","description":"Use Endpoint Policy Manager File Associations Manager to use OWA URL links to compose message directly in Office 365. When done OWA will be the default handler for the mailto protocol in Windows, so that clicking an email address will open the OWA \\"Compose message\\" window. Hope this helps you out.","source":"@site/docs/policypak/policypak/video/fileassociations/mailto.md","sourceDirName":"policypak/video/fileassociations","slug":"/policypak/video/fileassociations/mailto","permalink":"/docs/policypak/policypak/video/fileassociations/mailto","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/video/fileassociations/mailto.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"File Associations Manager Helper Tool","permalink":"/docs/policypak/policypak/video/fileassociations/helpertool"},"next":{"title":"Managing File Associations with an MDM service","permalink":"/docs/policypak/policypak/video/fileassociations/mdm"}}');var a=o(474848),n=o(28453);const s={},l="Endpoint Policy Manager: How to get mailto: to open in Office 365",h={},r=[{value:"How to get mailto: to open in\xa0Office 365",id:"how-to-get-mailto-to-open-inoffice-365",level:3}];function c(e){const t={a:"a",code:"code",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"endpoint-policy-manager-how-to-get-mailto-to-open-in-office-365",children:"Endpoint Policy Manager: How to get mailto: to open in Office 365"})}),"\n",(0,a.jsx)(t.p,{children:'Use Endpoint Policy Manager File Associations Manager to use OWA URL links to compose message directly in Office 365. When done OWA will be the default handler for the mailto protocol in Windows, so that clicking an email address will open the OWA "Compose message" window. Hope this helps you out.'}),"\n",(0,a.jsx)(t.p,{children:"Code:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:'`@echo off  \nset address=%1  \nset address=%address:~7%  \nrundll32 URL.DLL,FileProtocolHandler "https://outlook.office.com/?path=/mail/action/compose&to=%address%"`\n'})}),"\n",(0,a.jsx)(t.h3,{id:"how-to-get-mailto-to-open-inoffice-365",children:"How to get mailto: to open in\xa0Office 365"}),"\n",(0,a.jsx)(t.p,{children:"Hi. This is Jeremy Moskowitz. In this video, I'm going to show you how you can make your mailto handler actually open up a web browser such that it will launch Outlook web access."}),"\n",(0,a.jsx)(t.p,{children:"Let me show used to the result of what I put together. When you go ahead and click on a mailto like, it says \"Do you want to open this link?\" What's it going to do? It's going to open up your default browser and, provided you've already logged on to Office 365, it's then going to automatically send that mail to that person. It's just that simple."}),"\n",(0,a.jsxs)(t.p,{children:['How did I perform this magic here? The first thing is that I have a little batch file. I put it in "temp," and I just called it "',(0,a.jsx)(t.code,{children:"a1.bat"}),'." Let me show you what it does here. The first thing it does is that it silences it as much as it can ("@echo off").']}),"\n",(0,a.jsxs)(t.p,{children:['Then it says "set address=%1" which means it\'s going to take in the item that you\'re passing. So that would be the address: "mailto',":jeremym",'@policypak.com." Then what it does is removes the first seven characters which would be "mailto:" and then what we do is that we run the default browser against the special link in "',(0,a.jsx)(t.a,{href:"https://outlook.office.com",children:"https://outlook.office.com"}),'" and then we put in "',(0,a.jsx)(t.code,{children:"%address%"}),'" which is the address without the "mailto:".']}),"\n",(0,a.jsx)(t.p,{children:'The net result, as you can see, is that when you click it and click "Yes" you do get that very brief flash of the DOS prompt, but the net result is that you get exactly what you\'re after here.'}),"\n",(0,a.jsx)(t.p,{children:'Now let me show you how I set this up in File Associations Manager in Endpoint Policy Manager land. You have to do this on the computer side in "File Associations Manager." Then here is how to do it. You give it any "Policy Name" you want. You use the "Network Protocol." You have to use "MAILTO."'}),"\n",(0,a.jsxs)(t.p,{children:['Then we use a "Custom application." I\'m going to say that my custom application is where that batch file is: "',(0,a.jsx)(t.code,{children:"c:\\temp\\a1.bat"}),'." Then you\'re going to pass it "%1." The "Application Name" itself doesn\'t really matter, and you can select any "Application Icon." That part is not of real concern. So this is the "Associated Program" and that is the "Command Line." That\'s all there is to it.']}),"\n",(0,a.jsxs)(t.p,{children:["Once you've done that, you're off to the races. It will automatically associate correctly. All you have to do is run GP Update (\"",(0,a.jsx)(t.code,{children:"gpupdate"}),"\"), log off and log back on once, and you're good to go."]}),"\n",(0,a.jsx)(t.p,{children:"Now the next thing about this is that you may want to change the default browser, and that is totally supported as well. That's going to be in Browser Router. I already have a Browser Router policy, so I'm just going to modify that guy."}),"\n",(0,a.jsx)(t.p,{children:'I think my default browser right now is Internet Explorer, but let\'s go ahead and check it out. If I were to go to Browser Router, "Endpoint Policy Manager" and go to my "Browser Router" settings here and if I were to check my "Default browser," it\'s "Internet Explorer." Let\'s go ahead and change that to "Google Chrome" or "Edge" or whatever you want. I\'ll go ahead and click on "Google Chrome" here. I\'ll set that.'}),"\n",(0,a.jsxs)(t.p,{children:["Then I'm going to run GP Update (\"",(0,a.jsx)(t.code,{children:"gpupdate"}),"\") to get my latest directives here. After I do this, my goal is that I want to launch the mailto again and this time it will automatically go to Chrome. Now if I haven't logged on to Office 365 in Chrome yet, then it may not automatically open up the Office page, but you get the gist. It will have opened Office through Chrome, just not having not logged on yet."]}),"\n",(0,a.jsx)(t.p,{children:"All right, let's go check it out. Let me go ahead and click on the email link and click \"Yes.\" What do we get? We got Chrome automatically. We can see the log on page here. I just haven't quite logged on yet, but when I do it will then pass that all the way through, pass the correct items directly to Office 365."}),"\n",(0,a.jsx)(t.p,{children:"Therefore, any time you click on a mailto link, you're automatically going to the default browser and passing in the special characteristics to open up that page in Office 365 and Outlook instead of a mail program that's local."}),"\n",(0,a.jsx)(t.p,{children:"If you like what you see here and want to get started with PolicyPak , then go ahead and we'll see you in the webinar. Then after that, we'll hand over the bits, and you can try it out yourself."}),"\n",(0,a.jsx)(t.p,{children:"Thanks so very much, and we'll talk to you soon."})]})}function d(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);