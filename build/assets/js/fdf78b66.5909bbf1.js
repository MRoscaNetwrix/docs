"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[421234],{28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>a});var n=s(296540);const i={},o=n.createContext(i);function r(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(o.Provider,{value:t},e.children)}},322101:(e,t,s)=>{s.d(t,{A:()=>n});const n="data:image/webp;base64,UklGRlwCAABXRUJQVlA4IFACAAAQDQCdASp6ACkAPm0yl0gkIqIhJXQKAIANiUAapm7RgHi5esV6AN4Y9ADyzvZF/cItAUznx6jo5XepQ3x+AC+9EqxLzvIVe1GbvmrREs6MPiemgovw4yYDePqGrBC+aSIEGaFjPQDeU/IUninnGsq9UAD+/EaU0qipI8c/mqb25sczXuLAq6HdFrDAw7IlZEYe/alXzKOMbtn0jhD2x9Oqv0dlqk3sHfz0WE5GFkFZSue4r6nud2iwL13E2RHiG5P/m2vng/s5WvnqeUQtRJ2ai78/9VDv79e1/wdNMMv6WH/jt//TSxiQCRsrIkfWcwY0qGFW3qFyZBmvzBZ16tLJKZ4uSFRQfDhOOhKvZfxxDc8S42OpZ5btvvQq5RV0o9ahvkvGrJ4myRXl9g9uy/iy/8Nnj9nYBpTv3IiOY89LjKTmv8Tj+Zq2+xfBUc4+gwmbMT3MALm3pTLeTsiQmRf3Wi9Gv/7eI7BhdWXQEVOE0iKPpddtrRnDMphFsbm6gCETDgHnVQjoI/zP0qV+f0okv8RaWlXs59Kw4UgA2ONLT/Hits2NGzCUdPbNR1DpTyY12ISCp4yRft1Lht+rr5X8sTBT0U6l0d+Jt8n0f6yKTbfjEl5a3UFInZZBO981kM3XVzARi/9h9rx93IEuCDDDzDElNPVYDUkWY3IIMCDGnfzJd5f/9wf/ogwyynWKq7FzXfET3GyqMJdkLiVRxpBuby0hxv9HqGY3Mnwh+ah5XjQp9iDXZ/qOcFvzGBJ5eXr/1FtNfP/PxuEJUAAAAAAA"},467422:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"policypak/scriptstriggers/teamsminimized","title":"How to run Microsoft Teams minimized to systray using PPScripts and PPAM","description":"Prerequisites:","source":"@site/docs/policypak/policypak/scriptstriggers/teamsminimized.md","sourceDirName":"policypak/scriptstriggers","slug":"/policypak/scriptstriggers/teamsminimized","permalink":"/docs/policypak/policypak/scriptstriggers/teamsminimized","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/scriptstriggers/teamsminimized.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"How to silently install Firefox ESR, Chrome and WinZip 14.5 using Endpoint Policy Scripts Manager","permalink":"/docs/policypak/policypak/scriptstriggers/silentbrowserinstall"},"next":{"title":"How-to change Temperature Unit from Fahrenheit to Celsius in Microsoft Outlook Calendar via Group Policy?","permalink":"/docs/policypak/policypak/scriptstriggers/temperatureunit"}}');var i=s(474848),o=s(28453);const r={},a="How to run Microsoft Teams minimized to systray using PPScripts and PPAM",c={},l=[];function h(e){const t={br:"br",code:"code",h1:"h1",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"how-to-run-microsoft-teams-minimized-to-systray-using-ppscripts-and-ppam",children:"How to run Microsoft Teams minimized to systray using PPScripts and PPAM"})}),"\n",(0,i.jsx)(t.p,{children:"Prerequisites:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["MS Teams needs to have been installed using the Teams Machine-Wide Installer option:",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:'msiexec /i Teams_windows_x64.msi OPTIONS="ALLUSERS=1"'})]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"User needs to have logged in completely at least once to MS Teams, (the status icon will be visible)."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"364_1_image-20210414013029-6",src:s(322101).A+"",width:"122",height:"41"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 1 \u2013"})," Create a new Application Settings Manager policy for MS Teams on either the Computer or User side, depending on whether the GPO applies to computer or user objects. If the GPO applies to the OU containing only computer objects, then create the policy on the computer side, if the GPO applies to the OU containing only User objects, then create the policy on the user side, etc."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 2 \u2013"})," Enable the three settings (see image below) in the Microsoft Teams policy, then click Ok to save the settings."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"NOTE:"})," Only the underlined settings are being reapplied when the policy processes, the other options are not being changed."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"364_2_image-20210414013029-7",src:s(535085).A+"",width:"694",height:"554"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 3 \u2013"})," Next, create a new Scripts & Triggers policy within the same GPO, under the same configuration side, user or computer that you used in Step 1."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"NOTE:"}),"  If applying the policy on the computer side choose switched mode like in the screenshot below."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"364_3_image-20210414013029-8",src:s(539369).A+"",width:"727",height:"509"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 4 \u2013"}),' At the "On apply action" screen select "PowerShell script" from the dropdown, then in the main text window, paste in the script below, check the two options "Run script as user" and "Run interactively", then click "Next".']}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'# Hides the blue PowerShell window UI when running PS scripts interactively  \nAdd-Type -Name Window -Namespace Console -MemberDefinition \'  \n[DllImport("Kernel32.dll")]  \npublic static extern IntPtr GetConsoleWindow();  \n[DllImport("user32.dll")]  \npublic static extern bool ShowWindow(IntPtr hWnd, Int32 nCmdShow);  \n\'  \n[Console.Window]::ShowWindow([Console.Window]::GetConsoleWindow(), 0)  \n# Segment of Script below is from https://www.alkanesolutions.co.uk/2021/01/16/launch-microsoft-teams-minimised-in-the-system-tray/  \nTry  \n\xa0{  \n\xa0#Terminate Teams if it is running  \n\xa0$teamsProcess = Get-Process Teams -ErrorAction SilentlyContinue  \nIf ($teamsProcess)  \n\xa0\xa0\xa0\xa0\xa0{  \n\xa0\xa0\xa0\xa0\xa0#Close Teams Window  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0$teamsProcess.CloseMainWindow() | Out-Null  \n\xa0\xa0\xa0\xa0\xa0Start-Sleep -s 5  \n\xa0\xa0\xa0\xa0\xa0#Close Teams\xa0  \n\xa0\xa0\xa0\xa0\xa0Stop-Process -Name "Teams" -Force -ErrorAction SilentlyContinue  \n\xa0\xa0\xa0\xa0\xa0}  \n#Define Teams Update.exe paths\xa0\xa0\xa0\xa0\xa0\xa0  \n$userTeams = [System.IO.Path]::Combine("$env:LOCALAPPDATA", "Microsoft", "Teams", "current", "Teams.exe")  \n$machineTeamsX86 = [System.IO.Path]::Combine("$env:PROGRAMFILES (X86)", "Microsoft", "Teams", "current", "Teams.exe")  \n$machineTeamsX64 = [System.IO.Path]::Combine("$env:PROGRAMFILES", "Microsoft", "Teams", "current", "Teams.exe")\xa0\xa0\xa0\xa0\xa0  \n#Define arguments  \n$args = @("-process-start-args","""--system-initiated""")  \n#Launch Teams  \nif (Test-Path -Path $userTeams)  \n\xa0{Start-Process -FilePath $userTeams -ArgumentList $args}  \nElseif (Test-Path -Path $machineTeamsX86)  \n\xa0{Start-Process -FilePath $machineTeamsX86 -ArgumentList $args}  \nElseif (Test-Path -Path $machineTeamsX64)  \n\xa0{Start-Process -FilePath $machineTeamsX64 -ArgumentList $args}  \n} catch {  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0#do something  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0#$_.Exception  \n}  \n\n'})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"364_4_image-20210414013029-9",src:s(816653).A+"",width:"727",height:"585"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 5 \u2013"}),' Click "Next" at the "On revert action" screen to skip that screen, then at the "specify process mode" screen choose the "On trigger" option, then choose "Logon" from the drop down before clicking "Next" to continue.']}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"364_5_image-20210414013029-10_724x538",src:s(911276).A+"",width:"724",height:"538"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 6 \u2013"}),' At the "Policy settings" screen give the policy a descriptive name then click "Finish."']}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 7 \u2013"})," Lastly, test the policy by logging into a computer as a user that should receive the policy.\xa0 If everything works Teams should open minimized and you should see the MS Teams icon in the systray."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"NOTE:"})," Users may initially see two MS Teams icons for a few seconds in the Systray at the same time, however, one of the icons will disappear shortly. Also, if this is the first time logging in since the policy was applied it may take a 2nd login for the policy to kick in."]})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},535085:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/364_2_image-20210414013029-7-a6f276ebc4cb02c59ac1d1f54e270d05.webp"},539369:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/579_1_image-20190918135807-1-49f455314db4f1d864b9ac212012d272.webp"},816653:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/364_4_image-20210414013029-9-2e1f3f090af208dcf3b7c63230acb174.webp"},911276:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/364_5_image-20210414013029-10_724x538-905c2933c4f40447ec4660ac03354acb.webp"}}]);