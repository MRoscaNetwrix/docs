"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[63890],{28453:(e,o,n)=>{n.d(o,{R:()=>s,x:()=>a});var r=n(296540);const t={},i=r.createContext(t);function s(e){const o=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function a(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(i.Provider,{value:o},e.children)}},52890:(e,o,n)=>{n.d(o,{A:()=>r});const r=n.p+"assets/images/669_1_image-20200327172830-2-baf6e555bce2771af71ca4bfbdedcf85.jpeg"},607595:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"policypak/troubleshooting/error/gpocompilancereporter/systeminvalidoperationexception","title":"GPCR Snapshot fails with error \\"System.InvalidOperationException\\" when using a remote SQL server and one is a clone of the other","description":"When using a remote SQL server as the database for Netwrix Endpoint Policy Manager (formerly PolicyPak) Group Policy Compliance Reporter, the snapshot operation may fail with the following error.","source":"@site/docs/policypak/policypak/troubleshooting/error/gpocompilancereporter/systeminvalidoperationexception.md","sourceDirName":"policypak/troubleshooting/error/gpocompilancereporter","slug":"/policypak/troubleshooting/error/gpocompilancereporter/systeminvalidoperationexception","permalink":"/docs/policypak/policypak/troubleshooting/error/gpocompilancereporter/systeminvalidoperationexception","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/troubleshooting/error/gpocompilancereporter/systeminvalidoperationexception.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Endpoint Policy Feature Manager for Windows doesn\'t appear to be working and we\'re getting error code 0x800f0954. What can I try?","permalink":"/docs/policypak/policypak/troubleshooting/error/feature/code0x800f0954"},"next":{"title":"When using a remote SQL Server, GPCR Snapshot fails with error \\"System.InvalidOperationException\\" and \\"MSDTC has been disabled\\" in Debug log","permalink":"/docs/policypak/policypak/troubleshooting/error/gpocompilancereporter/systeminvalidoperationexceptionmsdtc"}}');var t=n(474848),i=n(28453);const s={},a='GPCR Snapshot fails with error "System.InvalidOperationException" when using a remote SQL server and one is a clone of the other',c={},l=[{value:"Resolution",id:"resolution",level:2},{value:"Re-install DTC",id:"re-install-dtc",level:2}];function p(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.header,{children:(0,t.jsx)(o.h1,{id:"gpcr-snapshot-fails-with-error-systeminvalidoperationexception-when-using-a-remote-sql-server-and-one-is-a-clone-of-the-other",children:'GPCR Snapshot fails with error "System.InvalidOperationException" when using a remote SQL server and one is a clone of the other'})}),"\n",(0,t.jsx)(o.p,{children:"When using a remote SQL server as the database for Netwrix Endpoint Policy Manager (formerly PolicyPak) Group Policy Compliance Reporter, the snapshot operation may fail with the following error."}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"794_1_image-20200327171540-1",src:n(52890).A+"",width:"716",height:"164"})}),"\n",(0,t.jsx)(o.p,{children:"The Server debug log will contain the following error as well:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"System.Runtime.InteropServices.COMException:\xa0  \nThe MSDTC transaction manager was unable to pull the transaction from the source transaction manager due to communication problems. Possible causes are: a firewall is present and it doesn't have an exception for the MSDTC process, the two machines cannot find each other by their NetBIOS names, or the support for network transactions is not enabled for one of the two transaction managers.\xa0  \n(Exception from HRESULT: 0x8004D02B)\n"})}),"\n",(0,t.jsxs)(o.p,{children:["To enable diagnostic logging, follow the directions in the article ",(0,t.jsx)(o.a,{href:"/docs/policypak/policypak/troubleshooting/grouppolicycompliancereporter/logenhanced",children:"How do I turn on enhanced logging for Endpoint Policy Manager Group Policy Compliance Reporter if asked to do so?"}),"g-for-ppgpcr-server-if-asked/"]}),"\n",(0,t.jsxs)(o.p,{children:["The resulting GPCR Server log can be found in: ",(0,t.jsx)(o.code,{children:"C:\\ProgramData\\PolicyPak\\PolicyPak Group Policy Compliance Reporter Server\\Diagnostics"})]}),"\n",(0,t.jsx)(o.p,{children:'When a server VM is cloned, the DTC ID remains the unchanged on the new server copy. In this case, although you have communication with the SQL server, the ability to connect to port 1433, and GPCR is able to successfully accept workstation audits, attempting a snapshot results in the error above. When enabling the server debugging log, it shows "communication problems" as the cause.'}),"\n",(0,t.jsx)(o.h2,{id:"resolution",children:"Resolution"}),"\n",(0,t.jsx)(o.p,{children:"To resolve the error and allow snapshots to complete successfully, you must re-install MS DTC on one of the computers"}),"\n",(0,t.jsx)(o.h2,{id:"re-install-dtc",children:"Re-install DTC"}),"\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.strong,{children:"Step 1 \u2013"})," Open a command prompt",(0,t.jsx)(o.code,{children:' "\u2026 as administrator"'})]}),"\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.strong,{children:"Step 2 \u2013"})," Uninstall ",(0,t.jsx)(o.code,{children:"MSDTC: msdtc -uninstall"})," and hit enter"]}),"\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.strong,{children:"Step 3 \u2013"})," Install ",(0,t.jsx)(o.code,{children:"MSDTC: msdtc -install"})," and hit enter"]}),"\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.strong,{children:"Step 4 \u2013"})," Verify service is installed and running: sc query msdtc and hit enter"]}),"\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.strong,{children:"NOTE:"})," this can also be performed after the uninstall to verify it was removed"]})]})}function h(e={}){const{wrapper:o}={...(0,i.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}}}]);