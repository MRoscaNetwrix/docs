"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[900923],{28453:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>r});var i=n(296540);const o={},s=i.createContext(o);function c(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),i.createElement(s.Provider,{value:t},e.children)}},245635:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/editcollectionmachineaccounts-3a3e15d30c5b177638e74ddb9feb2908.webp"},440386:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/editcollectionaccounts-2f562ff37db946b685cf50aab993fd1d.webp"},640931:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"threatprevention/admin/configuration/eventfilteringconfiguration","title":"Event Filtering Configuration Window","description":"The Event Filtering Configuration window enables you to exclude specific Active Directory and Authentication events from being monitored. A latency threshold can be set to generate alerts for AD events.","source":"@site/docs/threatprevention/threatprevention/admin/configuration/eventfilteringconfiguration.md","sourceDirName":"threatprevention/admin/configuration","slug":"/threatprevention/admin/configuration/eventfilteringconfiguration","permalink":"/docs/threatprevention/threatprevention/admin/configuration/eventfilteringconfiguration","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/threatprevention/threatprevention/admin/configuration/eventfilteringconfiguration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"threatPreventionSidebar","previous":{"title":"EPE Settings Window","permalink":"/docs/threatprevention/threatprevention/admin/configuration/epesettings"},"next":{"title":"Events Database Configuration Window","permalink":"/docs/threatprevention/threatprevention/admin/configuration/eventsdatabaseconfiguration"}}');var o=n(474848),s=n(28453);const c={},r="Event Filtering Configuration Window",a={},l=[{value:"Exclude \u2018Noise\u2019 Events Option",id:"exclude-noise-events-option",level:2},{value:"Exclude AD DNS Events Option",id:"exclude-ad-dns-events-option",level:2},{value:"Exclude Logins from Machine Accounts Option",id:"exclude-logins-from-machine-accounts-option",level:2},{value:"Exclude Authentication Events from Selected Hosts Option",id:"exclude-authentication-events-from-selected-hosts-option",level:2},{value:"Exclude Authentication Events from Selected Accounts Option",id:"exclude-authentication-events-from-selected-accounts-option",level:2},{value:"AD Events Latency Threshold Option",id:"ad-events-latency-threshold-option",level:2}];function d(e){const t={a:"a",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"event-filtering-configuration-window",children:"Event Filtering Configuration Window"})}),"\n",(0,o.jsx)(t.p,{children:"The Event Filtering Configuration window enables you to exclude specific Active Directory and Authentication events from being monitored. A latency threshold can be set to generate alerts for AD events."}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"NOTE:"})," This window is only available to Threat Prevention administrators."]}),"\n",(0,o.jsx)(t.p,{children:"Follow the steps to enable event filtering."}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 1 \u2013"})," Click ",(0,o.jsx)(t.strong,{children:"Configuration"})," > ",(0,o.jsx)(t.strong,{children:"Event Filtering"})," on the menu to open the Event Filtering Configuration window."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Event Filtering Configuration Window",src:n(938800).A+"",width:"426",height:"498"})}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 2 \u2013"})," The filter options are grouped by AD Global Pre Filters, Authentication Global Pre Filters, and Alerts. Check the checkboxes to activate the filters and click ",(0,o.jsx)(t.strong,{children:"Save"}),"."]}),"\n",(0,o.jsxs)(t.p,{children:["To disable a filter for diagnostic purposes, simply uncheck its checkbox and click ",(0,o.jsx)(t.strong,{children:"Save"}),"."]}),"\n",(0,o.jsx)(t.p,{children:"Click the Help icon (?) for an option in the AD Global Pre Filters area to view the type of \u201cnoise\u201d events being filtered."}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"NOTE:"})," All Authentication Global Pre Filters options require configuration before they can be enabled."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.em,{children:(0,o.jsx)(t.strong,{children:"RECOMMENDED:"})})," Enable all the AD Global Pre Filters options as well as the Exclude Logins from Machine Accounts option in the Authentication Global Pre Filters section."]}),"\n",(0,o.jsx)(t.p,{children:"When activated, the Agent filters out the event data according to configurations defined in the filters.json file located in the installation directory of the Enterprise Manager."}),"\n",(0,o.jsx)(t.h2,{id:"exclude-noise-events-option",children:"Exclude \u2018Noise\u2019 Events Option"}),"\n",(0,o.jsx)(t.p,{children:"The Exclude \u2018Noise\u2019 Events option is enabled by default to filter out login and internal low level attributes that can be considered \u2018noise\u2019 events, resulting in a bloating of the database. This option can be scoped to include any combination of the following \u2018noise\u2019 events:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["Successful AD User Logins \u2013 Excludes events with the following attributes where \u2018objectClass\u2019 does not equal computer:","\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"logonCount"}),"\n",(0,o.jsx)(t.li,{children:"lastLogon"}),"\n",(0,o.jsx)(t.li,{children:"badPwdCount"}),"\n",(0,o.jsx)(t.li,{children:"lastLogonTimestamp"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["AD User Logins with Bad Password \u2013 Excludes events with the following set of attributes where \u2018objectClass\u2019 does not equal computer:","\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"badPwdCount"}),"\n",(0,o.jsx)(t.li,{children:"badPasswordTime"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["AD Computer Logins \u2013 Excludes events with the following set of attributes where \u2018objectClass\u2019 equals computer:","\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"logonCount"}),"\n",(0,o.jsx)(t.li,{children:"lastLogon"}),"\n",(0,o.jsx)(t.li,{children:"badPwdCount"}),"\n",(0,o.jsx)(t.li,{children:"lastLogonTimestamp"}),"\n",(0,o.jsx)(t.li,{children:"badPasswordTime"}),"\n",(0,o.jsx)(t.li,{children:"badPwdCount"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["Low Level Attributes \u2013 Excludes the following attributes from event:","\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"ImPwdHistory"}),"\n",(0,o.jsx)(t.li,{children:"dBCSPwd"}),"\n",(0,o.jsx)(t.li,{children:"ntPwdHistory"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"exclude-ad-dns-events-option",children:"Exclude AD DNS Events Option"}),"\n",(0,o.jsx)(t.p,{children:"The Exclude AD DNS Events option is enabled by default to filter out DNS events. These events can result in a bloating of the database. They must meet both of the following conditions to be excluded:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"objectClass = \u2018dnsNode\u2019 or \u2018dnsZone\u2019"}),"\n",(0,o.jsx)(t.li,{children:"Contains the \u2018dnsRecord\u2019 or \u2018dNSTombstoned\u2019 attribute"}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"When the Exclude AD DNS Events checkbox is unchecked, DNS record events are displayed in a human-readable format on the Recent Events tab of the Active Directory policy. In order to search these results, the Affected Object: Class can be set to equals dnsNode for the dnsRecord attribute to display."}),"\n",(0,o.jsx)(t.h2,{id:"exclude-logins-from-machine-accounts-option",children:"Exclude Logins from Machine Accounts Option"}),"\n",(0,o.jsxs)(t.p,{children:["The Exclude Logins from Machine Accounts option is enabled by default to filter out machine logins. These events can result in a bloating of the database. Click the ",(0,o.jsx)(t.strong,{children:"configure"})," link to open the Edit Collection window."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Edit Collection window - For Machine Accounts",src:n(245635).A+"",width:"888",height:"488"})}),"\n",(0,o.jsxs)(t.p,{children:["The Exclude Logins from Machine Accounts collection is only accessible through the Event Filtering Configuration window. Either use the ",(0,o.jsx)(t.strong,{children:"Add"})," (+) button to open the ",(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/policies/eventtype/window/selectactivedirectory/perpetrators",children:"Select Active Directory Perpetrators Window"})," to browse for machine accounts or type the account name in the textbox."]}),"\n",(0,o.jsx)(t.p,{children:"Only perpetrators with accounts ending in \u201c$\u201d are considered for this filter. Wild cards (*) can be used for partial matches to account names."}),"\n",(0,o.jsx)(t.p,{children:"All machine accounts in the textbox are either included or excluded from event data monitoring by the Agent. Machine accounts not in the list have the unselected property applied."}),"\n",(0,o.jsx)(t.p,{children:"Select one of the following radio buttons to apply to the list of account names:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Pass to agent on match \u2013 Included and passed to the Agent for event data monitoring. Machine accounts not in the list are excluded and ignored by the Agent."}),"\n",(0,o.jsx)(t.li,{children:"Remove on match \u2013 Excluded and ignored by the Agent. Machine accounts not in the list are included and sent to the Agent for event data monitoring."}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["Repeat the process until all machine accounts to be included or excluded from Authentication event data have been entered in the list. Then click ",(0,o.jsx)(t.strong,{children:"OK"}),"."]}),"\n",(0,o.jsx)(t.p,{children:"Usage Tip"}),"\n",(0,o.jsx)(t.p,{children:"Windows Server 2012 introduced gMSA (Group Managed Service Accounts). gMSA accounts include \u201c$\u201d in their names, so by default Threat Prevention filters out authentication traffic generated by these accounts because they \u2018look\u2019 like machine accounts which prior to Server 2012 were the only account names ending in \u201c$\u201d. The ability in Threat Prevention to add a list of filter strings to the \u201cExclude Logins from Machine Accounts\u201d global filter enables you to capture activity by gMSA type accounts as this activity is typically of interest whereas true \u2018machine accounts\u2019 is not. By supplying either an explicit list of gMSA account names, or if a naming convention has been adopted, a set of wild card strings such as \u201cgMSA*\u201d or \u201csvc*\u201d, allows capturing authentication activity from such accounts while ignoring the noisy \u2018machine accounts\u2019."}),"\n",(0,o.jsx)(t.h2,{id:"exclude-authentication-events-from-selected-hosts-option",children:"Exclude Authentication Events from Selected Hosts Option"}),"\n",(0,o.jsxs)(t.p,{children:["The Exclude Authentication Events from Selected Hosts option is disabled by default as it requires configuration before it can be enabled. Click the ",(0,o.jsx)(t.strong,{children:"selected hosts"})," link to open the Edit Collection window."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Edit Collection window - For Hosts",src:n(982781).A+"",width:"882",height:"486"})}),"\n",(0,o.jsxs)(t.p,{children:["The Exclude Authentication Events from Hosts collection is only accessible through the Event Filtering Configuration window. All three methods of identification for a host (IP address, NETBIOS host name, or DNS host name) must be known in order to effectively exclude authentication from the host. Identify the host to be excluded in the textbox under the IP Address column and hit ",(0,o.jsx)(t.strong,{children:"Enter"})," or select the next row in the grid. Threat Prevention attempts to discover the NETBIOS host name and the DNS host name associated with the supplied IP address. If the host identification is not resolved or is inaccurate, manually type the information."]}),"\n",(0,o.jsxs)(t.p,{children:["Repeat the process until all hosts for which authentication event data will not be collected have been entered in the list. Then click ",(0,o.jsx)(t.strong,{children:"OK"}),". The Edit Collection window closes, and the Exclude Authentication Events from selected hosts option can be enabled."]}),"\n",(0,o.jsx)(t.h2,{id:"exclude-authentication-events-from-selected-accounts-option",children:"Exclude Authentication Events from Selected Accounts Option"}),"\n",(0,o.jsx)(t.p,{children:"The Exclude Authentication Events from Selected Accounts option is disabled by default as it requires configuration before it can be enabled. Click the selected accounts link to open the Edit Collection window."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Edit Collection window - For Selected Accounts",src:n(440386).A+"",width:"888",height:"485"})}),"\n",(0,o.jsxs)(t.p,{children:["The Exclude Authentication Events from Selected Accounts collection is only accessible through the Event Filtering Configuration window. Use the ",(0,o.jsx)(t.strong,{children:"Add"})," (+) button to open the ",(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/policies/eventtype/window/selectactivedirectory/perpetrators",children:"Select Active Directory Perpetrators Window"})," to browse for the desired accounts. Account names [domain name\\account] can also be typed in the textbox. Wild cards (*) can be used as part of either the domain name or account. An asterisk (*) appearing anywhere other than as the first character or the last character are treated as a literal character instead of as a wild card. For example: *\\Service1 would exclude all Service1 accounts whether it is a domain or local account, and Example\\Service* would exclude all accounts that start with \u201cService\u201d for the Example domain."]}),"\n",(0,o.jsx)(t.p,{children:"Repeat the process until all accounts to be excluded from Authentication event data have been entered in the list. Then click OK. The Edit Collection window closes, and the Exclude Authentication Events from selected accounts option can be enabled."}),"\n",(0,o.jsx)(t.h2,{id:"ad-events-latency-threshold-option",children:"AD Events Latency Threshold Option"}),"\n",(0,o.jsx)(t.p,{children:"The Send Latency Alerts option is disabled by default. It is used to generate alerts if the time delay between when the Agent detects an AD event and the time the Enterprise Manager receives it exceeds the specified latency threshold. This option is helpful for troubleshooting when experiencing slow connection in the environment. These events can result in a bloating of the database especially if the latency threshold is set too low."}),"\n",(0,o.jsxs)(t.p,{children:["Select the Send Latency Alerts checkbox to enable this option. Use the arrows, or type into the textbox, to set the latency threshold in minutes for the time when the Agent detects the event and the Enterprise Manager receives it. When events exceed the timeframe, alerts are displayed in the ",(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/alerts/overview",children:"Alerts Interface"}),". Email or SIEM alerts can be generated by selecting the Agent Latency checkbox in the Operations tab of the ",(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/systemalerting/overview",children:"System Alerting Window"}),"."]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},938800:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/eventfiltering-5e60b586f9cdd03c3498ae65323c1de5.webp"},982781:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/editcollectionhosts-83b934e522079c29739c691b993c6098.webp"}}]);