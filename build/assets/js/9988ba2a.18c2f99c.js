"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[612729],{28453:(e,n,a)=>{a.d(n,{R:()=>i,x:()=>c});var r=a(296540);const o={},s=r.createContext(o);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(s.Provider,{value:n},e.children)}},140359:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"enterpriseauditor/admin/datacollector/exchangeps/overview","title":"ExchangePS Data Collector","description":"The ExchangePS Data Collector utilizes the Exchange CMDlets to return information about the Exchange environment utilizing PowerShell. This data collector has been designed to work with Exchange 2010 and newer. The ExchangePS Data Collector has been preconfigured within the Exchange Solution. Both this data collector and the solution are available with a special Access Analyzer license. See the Exchange Solution topic for additional information.","source":"@site/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/overview.md","sourceDirName":"enterpriseauditor/admin/datacollector/exchangeps","slug":"/enterpriseauditor/admin/datacollector/exchangeps/overview","permalink":"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"ExchangePS:\xa0Options","permalink":"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/options"},"next":{"title":"ExchangePS:\xa0Results","permalink":"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/results"}}');var o=a(474848),s=a(28453);const i={},c="ExchangePS Data Collector",l={},t=[{value:"Remote PowerShell",id:"remote-powershell",level:2},{value:"The Exchange Applet",id:"the-exchange-applet",level:2},{value:"ExchangePS Query Configuration",id:"exchangeps-query-configuration",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"exchangeps-data-collector",children:"ExchangePS Data Collector"})}),"\n",(0,o.jsxs)(n.p,{children:["The ExchangePS Data Collector utilizes the Exchange CMDlets to return information about the Exchange environment utilizing PowerShell. This data collector has been designed to work with Exchange 2010 and newer. The ExchangePS Data Collector has been preconfigured within the Exchange Solution. Both this data collector and the solution are available with a special Access Analyzer license. See the ",(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/solutions/exchange/overview",children:"Exchange Solution"})," topic for additional information."]}),"\n",(0,o.jsx)(n.p,{children:"Protocols"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"PowerShell"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Ports"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"TCP 135"}),"\n",(0,o.jsx)(n.li,{children:"Randomly allocated high TCP ports"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Permissions"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Remote PowerShell enabled on a single Exchange server"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Windows Authentication enabled for the PowerShell Virtual Directory on the same Exchange server where Remote PowerShell has been enabled"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"View-Only Organization Management Role Group"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Discovery Search Management Role Group"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Public Folder Management Role Group"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Mailbox Search Role"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Discovery Management Role"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Organization Management Role"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["See the ",(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/powershell",children:"Exchange PowerShell Permissions"})," topic for additional information."]}),"\n",(0,o.jsx)(n.h2,{id:"remote-powershell",children:"Remote PowerShell"}),"\n",(0,o.jsx)(n.p,{children:"The ExchangePS Data Collector will utilize Remote PowerShell when connecting to Exchange 2010 or newer. This behavior simulates what the Exchange Management Shell does when loading. The below PowerShell syntax is an example of how the connection is loaded through PowerShell."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"$JobUserName = '{insert domain\\username}'  \n$JobPassword = '{insert password}'  \n$secpasswd = ConvertTo-SecureString $JobPassword -AsPlainText -Force  \n$JobCredential = New-Object System.Management.Automation.PSCredential ($JobUserName, $secpasswd)  \n$relaxed=New-PSSessionOption -SkipCACheck -SkipCNCheck -SkipRevocationCheck  \n$sess=New-PSSession -ConnectionUri 'https://{exchangeserver}/powershell?serializationLevel=Full' -ConfigurationName 'Microsoft.Exchange' -AllowRedirection -Authentication Negotiate -Credential $JobCredential -SessionOption $relaxed\xa0  \nImport-PSSession $sess\n"})}),"\n",(0,o.jsxs)(n.p,{children:["See the ",(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/powershell",children:"Exchange PowerShell Permissions"})," topic for instructions on enabling Remote PowerShell."]}),"\n",(0,o.jsx)(n.h2,{id:"the-exchange-applet",children:"The Exchange Applet"}),"\n",(0,o.jsx)(n.p,{children:"The Exchange Applet will run on the Exchange server by the ExchangePS Data Collector in the following circumstances:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["An actual Client Access Server (CAS) server is not specified either in the global configuration (",(0,o.jsx)(n.strong,{children:"Settings"})," > ",(0,o.jsx)(n.strong,{children:"Exchange"})," node) or on the Category page of the ExchangePS Data Collector Wizard"]}),"\n",(0,o.jsx)(n.li,{children:"Remote PowerShell has not been enabled for targeting Exchange 2010"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"The following Exchange Snap-in is used when the applet is utilized:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Add-pssnapin Microsoft.Exchange.Management.Powershell.E2010"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"exchangeps-query-configuration",children:"ExchangePS Query Configuration"}),"\n",(0,o.jsx)(n.p,{children:"The ExchangePS Data Collector is configured through the ExchangePS Data Collector Wizard, which contains the following wizard pages:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/category",children:"ExchangePS:\xa0Category"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/scope",children:"ExchangePS:\xa0Scope"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/scopedatabases",children:"ExchangePS:\xa0Scope by DB"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/scopemailboxes",children:"ExchangePS:\xa0Scope by Mailboxes"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/scopepublicfolders",children:"ExchangePS:\xa0Scope by Public Folders"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/filtermessage",children:"ExchangePS:\xa0Filter by Message"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/mailboxlogons",children:"ExchangePS:\xa0Mailbox Logons"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/results",children:"ExchangePS:\xa0Results"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/options",children:"ExchangePS:\xa0Options"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/errorlogging",children:"ExchangePS:\xa0Error Logging"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/summary",children:"ExchangePS:\xa0Summary"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Available pages vary according to selections made throughout the wizard."})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}}}]);