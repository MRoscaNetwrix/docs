"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[970580],{28453:(e,i,n)=>{n.d(i,{R:()=>o,x:()=>a});var r=n(296540);const t={},s=r.createContext(t);function o(e){const i=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(s.Provider,{value:i},e.children)}},48756:(e,i,n)=>{n.d(i,{A:()=>r});const r=n.p+"assets/images/mp_adfs_listing_thumb_0_0-68ba174c699d0afa48c9003284ad2e87.webp"},413136:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"auditor/configuration/activedirectoryfederatedservices/overview","title":"AD FS","description":"Netwrix Auditor relies on native logs for collecting audit data. Therefore, successful change and access auditing requires a certain configuration of native audit settings in the audited environment and on the Auditor console computer. Configuring your IT infrastructure may also include enabling certain built-in Windows services, etc. Proper audit configuration is required to ensure audit data integrity, otherwise your change reports may contain warnings, errors or incomplete audit data.","source":"@site/docs/auditor/auditor/configuration/activedirectoryfederatedservices/overview.md","sourceDirName":"auditor/configuration/activedirectoryfederatedservices","slug":"/auditor/configuration/activedirectoryfederatedservices/overview","permalink":"/docs/auditor/auditor/configuration/activedirectoryfederatedservices/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/activedirectoryfederatedservices/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Adjust Active Directory Tombstone Lifetime (optional)","permalink":"/docs/auditor/auditor/configuration/activedirectory/tombstone"},"next":{"title":"Permissions for AD FS Auditing","permalink":"/docs/auditor/auditor/configuration/activedirectoryfederatedservices/permissions"}}');var t=n(474848),s=n(28453);const o={},a="AD FS",d={},l=[{value:"<strong>Configure AD FS farm audit settings automatically</strong>",id:"configure-ad-fs-farm-audit-settings-automatically",level:2},{value:"Configure AD FS farm manually",id:"configure-ad-fs-farm-manually",level:2},{value:"AD FS Servers Data Collection",id:"ad-fs-servers-data-collection",level:2}];function c(e){const i={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"ad-fs",children:"AD FS"})}),"\n",(0,t.jsx)(i.p,{children:"Netwrix Auditor relies on native logs for collecting audit data. Therefore, successful change and access auditing requires a certain configuration of native audit settings in the audited environment and on the Auditor console computer. Configuring your IT infrastructure may also include enabling certain built-in Windows services, etc. Proper audit configuration is required to ensure audit data integrity, otherwise your change reports may contain warnings, errors or incomplete audit data."}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"CAUTION:"})," Folder associated with Netwrix Auditor must be excluded from antivirus scanning. See the ",(0,t.jsx)(i.a,{href:"https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000HirCAE.html",children:"Antivirus Exclusions for Netwrix Auditor"})," knowledge base article for additional information."]}),"\n",(0,t.jsx)(i.p,{children:"Active Directory Federation Services (AD FS) server role can be assigned:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"to a domain controller"}),"\n",(0,t.jsx)(i.li,{children:"to a Windows server joined in the domain"}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["Multiple AD FS federation servers can be included in a ",(0,t.jsx)(i.strong,{children:"farm"}),", a group of connected servers with configuration replicated between them. The first AD FS federation server you set up in the farm becomes the ",(0,t.jsx)(i.strong,{children:"primary"})," server. Other federation servers you add to the farm will become ",(0,t.jsx)(i.strong,{children:"secondary"})," servers."]}),"\n",(0,t.jsxs)(i.p,{children:["Make sure you have Windows Remote Management properly configured on your Auditor\xa0console computer. See the ",(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/requirements/software",children:"Software Requirements"})," topic for additional information."]}),"\n",(0,t.jsx)(i.p,{children:"You can configure your\xa0IT Infrastructure for monitoring in one of the following ways:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["Automatically through a monitoring plan \u2013 This is a recommended method. If you select to automatically configure audit in the target environment, your current audit settings will be checked on each data collection and adjusted if necessary. See the ",(0,t.jsx)(i.a,{href:"#Configure-AD-FS-farm-audit-settings-automatically",children:"Configure AD FS farm audit settings automatically"})," topic\xa0for additional information."]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Manually \u2013 Native audit settings must be adjusted manually to ensure collecting comprehensive and reliable audit data. You can enable Auditor to continually enforce the relevant audit policies or configure them manually:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"AD FS audit settings must be configured on the primary AD FS server, i.e. on the first server you have set up in the farm:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"To configure audit of AD FS 4.0 on Windows Server 2016 or AD FS 5.0 on Windows Server 2019, use the following PowerShell cmdlets:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"Set-AdfsProperties -LogLevel Errors,FailureAudits,Verbose,SuccessAudits,Warnings  \nSet-AdfsProperties \u2013AuditLevel Verbose\n"})}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"To configure audit of AD FS 3.0 on Windows Server 2012 R2, use the following PowerShell cmdlet"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"Set-AdfsProperties -LogLevel Errors,FailureAudits,Verbose,SuccessAudits,Warnings\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["Windows Audit policy must be configured on each server in the farm. For all Windows server versions Run the ",(0,t.jsx)(i.em,{children:"auditpol"})," utility with the following parameters:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:'auditpol.exe /set /subcategory:"Application Generated" /failure:enable /success:enable'})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["Adjust log size and retention settings for ",(0,t.jsx)(i.strong,{children:"Security"})," log and for ",(0,t.jsx)(i.strong,{children:"AD FS Admin"})," log (under ",(0,t.jsx)(i.strong,{children:"Applications and Service logs"}),"). See ",(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/windowsserver/eventlog",children:"Adjusting Event Log Size and Retention Settings"})," for details."]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"If AD FS Admin logging is disabled, you should enable it."}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["See the ",(0,t.jsx)(i.a,{href:"#Configure-AD-FS-farm-manually",children:"Configure AD FS farm manually"}),"\xa0topic for additional information."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"configure-ad-fs-farm-audit-settings-automatically",children:(0,t.jsx)(i.strong,{children:"Configure AD FS farm audit settings automatically"})}),"\n",(0,t.jsx)(i.p,{children:"Audit settings can be applied automatically if your monitoring plan has the primary AD FS federation server included as an item. If it has only secondary AD FS federation servers included, you will need to configure audit settings manually, as described later in this section."}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 1 \u2013"})," Select the AD FS data source in this monitoring plan (top row under the header), click ",(0,t.jsx)(i.strong,{children:"Edit data source"})," to open its settings."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"mp_adfs_listing_thumb_0_0",src:n(48756).A+"",width:"1136",height:"731"})}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 2 \u2013"})," In the ",(0,t.jsx)(i.strong,{children:"Configure audit settings"})," section, select ",(0,t.jsx)(i.strong,{children:"Adjust audit settings automatically"})," check box."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"mp_data_source_ad_fs_thumb_0_0",src:n(823863).A+"",width:"1136",height:"731"})}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 3 \u2013"})," Save the settings."]}),"\n",(0,t.jsx)(i.p,{children:"Auditor\xa0 will automatically configure audit settings on all servers in the AD FS farm and adjust the necessary log settings on these servers."}),"\n",(0,t.jsx)(i.h2,{id:"configure-ad-fs-farm-manually",children:"Configure AD FS farm manually"}),"\n",(0,t.jsx)(i.p,{children:"Follow the steps to enable AD FS audit settings and set up Windows audit policy."}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 1 \u2013"})," AD FS audit settings must be configured on the primary AD FS server, i.e. on the first server you have set up in the farm:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"To configure audit of AD FS 3.0 on Windows Server 2012 R2, use the following PowerShell cmdlet:"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Set-AdfsProperties -LogLevel Errors,FailureAudits,Verbose,SuccessAudits,Warnings"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"To configure audit of AD FS 4.0 on Windows Server 2016 or AD FS 5.0 on Windows Server 2019, use the following PowerShell cmdlets:"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Set-AdfsProperties -LogLevel Errors,FailureAudits,Verbose,SuccessAudits,Warnings"}),"\n",(0,t.jsx)(i.p,{children:"Set-AdfsProperties \u2013AuditLevel Verbose"}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 2 \u2013"})," Windows Audit policy must be configured on each server in the farm. For all Windows server versions"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Run the ",(0,t.jsx)(i.em,{children:"auditpol"})," utility with the following parameters:"]}),"\n"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-auditpol.exe",metastring:'/set /subcategory:"Application Generated" /failure:enable /success:enable'})}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 3 \u2013"}),"  Adjust log size and retention settings for ",(0,t.jsx)(i.strong,{children:"Security"})," log and for ",(0,t.jsx)(i.strong,{children:"AD FS Admin"})," log (under ",(0,t.jsx)(i.strong,{children:"Applications and Service logs"}),"). See the ",(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/windowsserver/eventlog",children:"Adjusting Event Log Size and Retention Settings"})," topic for additional information."]}),"\n",(0,t.jsx)(i.p,{children:"If AD FS Admin logging is disabled, you should enable it."}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.em,{children:"Remember,"})," do the following:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Configure Data Collecting Account as described in the ",(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/activedirectoryfederatedservices/permissions",children:"Permissions for AD FS Auditing"})," topic."]}),"\n",(0,t.jsxs)(i.li,{children:["Configure ports as described in the ",(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/activedirectoryfederatedservices/ports",children:"AD FS Ports"})," topic."]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"ad-fs-servers-data-collection",children:"AD FS Servers Data Collection"}),"\n",(0,t.jsx)(i.p,{children:"For Active Directory Federation Services (AD FS) servers, Netwrix Auditor can collect audit data on the events and configuration objects listed below."}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Event type"}),(0,t.jsx)(i.th,{children:"Action"}),(0,t.jsx)(i.th,{children:"Details"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"AD FS logon (intranet)"}),(0,t.jsx)(i.td,{children:"Failed Logon"}),(0,t.jsx)(i.td,{children:"Cause (for failed attempts)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"AD FS logon (extranet)"}),(0,t.jsx)(i.td,{children:"Successful Logon"}),(0,t.jsx)(i.td,{children:"Authentication methods (for Successful attempts)"})]})]})]}),"\n",(0,t.jsx)(i.p,{children:"Configuration information can be collected for the following objects:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"AD FS servers included in the farm"}),"\n",(0,t.jsx)(i.li,{children:"Application Groups settings"}),"\n",(0,t.jsx)(i.li,{children:"Authentication Method names"}),"\n",(0,t.jsx)(i.li,{children:"Relying Party Trusts settings"}),"\n",(0,t.jsx)(i.li,{children:"Scope Descriptions"}),"\n"]})]})}function u(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},823863:(e,i,n)=>{n.d(i,{A:()=>r});const r=n.p+"assets/images/mp_data_source_ad_fs_thumb_0_0-1bb16cef15e439b5c80e42d981e9d9d7.webp"}}]);