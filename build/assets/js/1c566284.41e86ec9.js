"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[983514],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var t=s(296540);const i={},r=t.createContext(i);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}},47614:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"usercube/user-guide/deploy/production-agent-installation/settings-files/index","title":"Configure the Agent\'s Settings","description":"This guide shows how to configure the agent\'s application settings via the `web.config`, `appsettings.json` and `appsettings.agent.json` files.","source":"@site/docs/usercube/usercube/user-guide/deploy/production-agent-installation/settings-files/index.md","sourceDirName":"usercube/user-guide/deploy/production-agent-installation/settings-files","slug":"/usercube/user-guide/deploy/production-agent-installation/settings-files/","permalink":"/docs/usercube/usercube/user-guide/deploy/production-agent-installation/settings-files/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/usercube/usercube/user-guide/deploy/production-agent-installation/settings-files/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"userCubeSidebar","previous":{"title":"Install IIS via Server Manager","permalink":"/docs/usercube/usercube/user-guide/deploy/production-agent-installation/iis-installation/"},"next":{"title":"Global Process","permalink":"/docs/usercube/usercube/user-guide/global-process/"}}');var i=s(474848),r=s(28453);const o={},c="Configure the Agent's Settings",d={},l=[{value:"Overview",id:"overview",level:2},{value:"Configure the Agent&#39;s Settings",id:"configure-the-agents-settings-1",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"configure-the-agents-settings",children:"Configure the Agent's Settings"})}),"\n",(0,i.jsxs)(n.p,{children:["This guide shows how to configure the agent's application settings via the ",(0,i.jsx)(n.code,{children:"web.config"}),", ",(0,i.jsx)(n.code,{children:"appsettings.json"})," and ",(0,i.jsx)(n.code,{children:"appsettings.agent.json"})," files."]}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.p,{children:["Identity Manager\xa0provides JSON files to configure varied application settings, named appsettings json and appsettings.agent.json. See the ",(0,i.jsx)(n.a,{href:"/docs/usercube/usercube/integration-guide/network-configuration/agent-configuration/appsettings/",children:"Application Settings"})," and ",(0,i.jsx)(n.a,{href:"/docs/usercube/usercube/integration-guide/network-configuration/agent-configuration/appsettings-agent/",children:"appsettings.agent"})," topics for additional information."]}),"\n",(0,i.jsx)(n.p,{children:"This page describes the optimal configuration of the production agent's application settings."}),"\n",(0,i.jsx)(n.h2,{id:"configure-the-agents-settings-1",children:"Configure the Agent's Settings"}),"\n",(0,i.jsx)(n.p,{children:"Configure the agent's settings by proceeding as follows:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["From the ",(0,i.jsx)(n.code,{children:"Runtime/Agent"})," folder, copy the files ",(0,i.jsx)(n.code,{children:"appsettings.json"}),", ",(0,i.jsx)(n.code,{children:"appsettings.agent.json"})," and ",(0,i.jsx)(n.code,{children:"web.config"})," and paste them in the ",(0,i.jsx)(n.code,{children:"Runtime"})," folder, thus replacing the pre-existing ones."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Open ",(0,i.jsx)(n.code,{children:"web.config"})," and make sure that, in the ",(0,i.jsx)(n.code,{children:"aspNetCore"})," tag, the value of ",(0,i.jsx)(n.code,{children:"arguments"})," is set to ",(0,i.jsx)(n.code,{children:"./Usercube-Agent.dll"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["When needing to get the agent's logs, set also ",(0,i.jsx)(n.code,{children:"stdoutLogEnabled"})," to ",(0,i.jsx)(n.code,{children:"true"}),". See more details in ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/fr-fr/aspnet/core/host-and-deploy/iis/logging-and-diagnostics?view=aspnetcore-7.0",children:"Microsoft's documentation"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\n web.config\n\n ...\n <aspNetCore processPath="dotnet" arguments="./Usercube-Agent.dll" stdoutLogEnabled="true" stdoutLogFile="../Temp/stdout-server.log" hostingModel="inprocess">     ...\n </aspNetCore> ...\n \n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Open ",(0,i.jsx)(n.code,{children:"appsettings.json"})," and make sure that:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"License"})," contains a valid license;"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"IdentityServer"})," contains the encryption certificate's path and password provided by Netwrix Identity Manager (formerly Usercube) team, in order to secure agent/server identification;"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\nappsettings.json\n\n"IdentityServer": {\n  "X509KeyFilePath": "./Usercube.pfx",\n  "X509KeyFilePassword": "secret"\n}\n\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["you get an encryption certificate which will be used to encrypt specific files such as logs or temporary files, and that ",(0,i.jsx)(n.strong,{children:"EncryptionCertificate"})," contains its path and password;"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\nappsettings.json\n\n"EncryptionCertificate": {\n  "File": "./Usercube-Files.pfx",\n  "Password": "secret",\n  "EncryptFile": true\n}\n\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"EncryptFile"})," can stay set to ",(0,i.jsx)(n.code,{children:"false"})," while verifying the agent installation, but for security reasons it must be set to ",(0,i.jsx)(n.code,{children:"true"})," afterwards."]}),"\n",(0,i.jsxs)(n.p,{children:["If the certificates' passwords contain ",(0,i.jsx)(n.code,{children:"@"}),", then they must be escaped via the ",(0,i.jsx)(n.code,{children:"@"})," as first character of the strings."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"ApplicationUri"})," contains the server's address, provided by Netwrix Identity Manager (formerly Usercube) team when working in a SaaS environment;"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\nappsettings.json\n\n"ApplicationUri": "http://localhost:5000"\n\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Do not write a ",(0,i.jsx)(n.code,{children:"/"})," character at the end of the string."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cors"})," > ",(0,i.jsx)(n.strong,{children:"AllowAnyHeader"}),", ",(0,i.jsx)(n.strong,{children:"AllowAnyMethod"})," and ",(0,i.jsx)(n.strong,{children:"AllowCredentials"})," are set to ",(0,i.jsx)(n.code,{children:"true"}),";"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\n  appsettings.json\n\n  "Cors": {\n      "AllowAnyHeader": "true",\n      "AllowAnyMethod": "true",\n      "AllowCredentials": "true"\n  }\n  \n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Open ",(0,i.jsx)(n.code,{children:"appsettings.agent.json"})," and make sure that:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"OpenId"})," > ",(0,i.jsx)(n.strong,{children:"AgentIdentifier"})," specifies the agent's name which must match the XML configuration. See the ",(0,i.jsx)(n.a,{href:"/docs/usercube/usercube/integration-guide/network-configuration/agent-configuration/appsettings-agent/",children:"appsettings.agent"})," topic for additional information.."]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\n        appsettings.agent.json\n        \n        "OpenId": {\n          "AgentIdentifier": "MyAgent"\n          }\n        \n'})}),"\n",(0,i.jsx)(n.p,{children:"With the following configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\n        <Agent Identifier="MyAgent" DisplayName_L1="My Agent" URI="https://contoso.com" />\n        \n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"OpenId"})," > ",(0,i.jsx)(n.strong,{children:"OpenIdClients"})," > ",(0,i.jsx)(n.strong,{children:"Job"}),' contains the non-hashed value of the password of "Job-Remote" provided by NETWRIX\' team']}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\nappsettings.agent.json\n\n"OpenId": {\n  "AgentIdentifier": "MyAgent",\n  "OpenIdClients": {\n      "Job": "secret"\n  }\n}\n\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["and add the hashed value of this password to the ",(0,i.jsx)(n.code,{children:"OpenIdClient"})," named ",(0,i.jsx)(n.code,{children:"Job"})," from the XML configuration;"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\n<OpenIdClient Identifier="Job" HashedSecret="K7gNU3sdo+OL0wNhqoVWhr3g6s1xYv72ol/pe/Unols=" ConsolidationMode="Merge" />\n\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"OpenId"})," > ",(0,i.jsx)(n.strong,{children:"DefaultOpenIdClient"})," is set to ",(0,i.jsx)(n.code,{children:"Job"}),";"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\nappsettings.agent.json\n\n"OpenId": {\n  "AgentIdentifier": "MyAgent",\n  "OpenIdClients": {\n      "Job": "secret"\n  },\n  "DefaultOpenIdClient": "Job"\n}\n\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"PasswordResetSettings"})," > ",(0,i.jsx)(n.strong,{children:"TwoFactorSettings"})," > ",(0,i.jsx)(n.strong,{children:"ApplicationUri"})," contains the server's address, provided by NETWRIX' team when working in a SaaS environment;"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\nappsettings.agent.json\n\n"PasswordResetSettings": {\n  "TwoFactorSettings": {\n      "ApplicationUri": "http://localhost:5000"\n  }\n}\n\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"PasswordResetSettings"})," > ",(0,i.jsx)(n.strong,{children:"EncryptionCertificate"})," contains contains the path and password of the certificate used to secure password tokens;"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\nappsettings.agent.json\n\n"PasswordResetSettings": {\n  "TwoFactorSettings": {\n      "ApplicationUri": "http://localhost:5000"\n  },\n  "EncryptionCertificate": {\n      "File": "../Usercube.pfx",\n      "Password": "secret"\n  }\n}\n\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"PasswordResetSettings"})," > ",(0,i.jsx)(n.strong,{children:"MailSettings"})," > ",(0,i.jsx)(n.strong,{children:"PickupDirectory"})," is set to the ",(0,i.jsx)(n.code,{children:"Mails"})," folder and ",(0,i.jsx)(n.strong,{children:"FromAddress"})," to ",(0,i.jsx)(n.code,{children:"no-reply@<organization>.com"}),";"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\nappsettings.agent.json\n\n"PasswordResetSettings": {\n  "TwoFactorSettings": {\n      "ApplicationUri": "http://localhost:5000"\n  },\n  "EncryptionCertificate": {\n      "File": "../Usercube.pfx",\n      "Password": "secret"\n  },\n  "MailSettings": {\n      "PickupDirectory": "../Mails",\n      "FromAddress": "no-reply@contoso.com"\n  }\n}\n\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"SourcesRootPaths"})," contains the path to the ",(0,i.jsx)(n.code,{children:"Sources"})," folder."]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\nappsettings.agent.json\n\n"SourcesRootPaths": [\n  "C:/Usercube/Sources"\n]\n\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.p,{children:["To continue,see the local server to ",(0,i.jsx)(n.a,{href:"/docs/usercube/usercube/user-guide/deploy/production-agent-installation/iis-installation/",children:"\nInstall IIS via Server Manager\n"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);