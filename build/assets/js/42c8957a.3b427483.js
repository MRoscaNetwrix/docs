"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[820398],{24715:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"policypak/leastprivilege/policyeditor/scope","title":"How do I use the Filter section in Endpoint Privilege Manager ?","description":"The Scope filter section can be found in various rule types in Netwrix Endpoint Policy Manager (formerly PolicyPak) Least Privilege Manager. For instance, it exists in every explicit rule, like this:","source":"@site/docs/policypak/policypak/leastprivilege/policyeditor/scope.md","sourceDirName":"policypak/leastprivilege/policyeditor","slug":"/policypak/leastprivilege/policyeditor/scope","permalink":"/docs/policypak/policypak/leastprivilege/policyeditor/scope","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/leastprivilege/policyeditor/scope.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"How does the \\"Show Pop-Up\\" message checkbox work along side \\"Force user re-authenticate\\" and \\"Justification text required\\" checkboxes?","permalink":"/docs/policypak/policypak/leastprivilege/policyeditor/optionsshowpopupmessage"},"next":{"title":"Least Privilege Manager - How to create a Self-Elevation policy for local groups of Standalone computers","permalink":"/docs/policypak/policypak/leastprivilege/policyeditor/selfelevation"}}');var n=i(474848),o=i(28453);const r={},a="How do I use the Filter section in Endpoint Privilege Manager ?",c={},l=[{value:"Scenario 1: Enhanced SecureRun / Prevent untrusted executables and scripts from running even by LOCAL SYSTEM.",id:"scenario-1-enhanced-securerun--prevent-untrusted-executables-and-scripts-from-running-even-by-local-system",level:2},{value:"Scenario 2: Specific rule to block an app from being run, even as local System.",id:"scenario-2-specific-rule-to-block-an-app-from-being-run-even-as-local-system",level:2},{value:"Scenario 2B: Block Powershell.exe completely, but allow Local System to run a specific .PS1 script",id:"scenario-2b-block-powershellexe-completely-but-allow-local-system-to-run-a-specific-ps1-script",level:3},{value:"Scenario 3: Running or Elevating applications or installers, but blocking other admins from running them.",id:"scenario-3-running-or-elevating-applications-or-installers-but-blocking-other-admins-from-running-them",level:2},{value:"Scenario 4:\xa0 Elevating a Service account",id:"scenario-4-elevating-a-service-account",level:2}];function d(e){const s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"how-do-i-use-the-filter-section-in-endpoint-privilege-manager-",children:"How do I use the Filter section in Endpoint Privilege Manager ?"})}),"\n",(0,n.jsx)(s.p,{children:"The Scope filter section can be found in various rule types in Netwrix Endpoint Policy Manager (formerly PolicyPak) Least Privilege Manager. For instance, it exists in every explicit rule, like this:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_1_faq-img-01_950x578",src:i(665711).A+"",width:"950",height:"578"})}),"\n",(0,n.jsx)(s.p,{children:"And also in SecureRun\u2122 rules like this:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_2_faq-img-02_950x537",src:i(543464).A+"",width:"950",height:"537"})}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"NOTE:"})," At this time, Policy Scope rules are not yet available for:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Global Settings Policy (to perform Discovery audits.)"}),"\n",(0,n.jsx)(s.li,{children:"Admin Approval Policy"}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"These are coming soon."}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"NOTE:"})," The Policy Scope option is only available when used on the Computer side; on the User side it is greyed out because this setting is only meant to express to the COMPUTER (system) how to work with User, and User and System Processes. On the User side, the processes are always in the context of the User."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_3_faq-img-03_950x571",src:i(767056).A+"",width:"950",height:"571"})}),"\n",(0,n.jsx)(s.p,{children:"In this topic, we are going over various use cases when you might use the Policy Scope option (which again, will only be un-gray / valid on the Computer side.)"}),"\n",(0,n.jsx)(s.h2,{id:"scenario-1-enhanced-securerun--prevent-untrusted-executables-and-scripts-from-running-even-by-local-system",children:"Scenario 1: Enhanced SecureRun / Prevent untrusted executables and scripts from running even by LOCAL SYSTEM."}),"\n",(0,n.jsx)(s.p,{children:'When you apply SecureRun on the user or computer side, you\'re saying "Block all untrusted executables started by users." But this does not, by default, block the attack vector of the System performing the attack. You can see the example below where the Standard User is blocked from an executable attempt, but System is still allowed.'}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_4_faq-img-04_950x647",src:i(932042).A+"",width:"950",height:"647"})}),"\n",(0,n.jsx)(s.p,{children:'However, you can switch SecureRun on the computer side to now say "Block all untrusted executables started by users or LOCAL SYSTEM." You would do this on the Computer side, and specify User and System Processes, as shown below.'}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_5_faq-img-05_950x547",src:i(951437).A+"",width:"950",height:"547"})}),"\n",(0,n.jsx)(s.p,{children:"The result is that both User and System attempts to run un-trusted executables will be prevented."}),"\n",(0,n.jsx)(s.p,{children:"When could this occur?"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"If a normal (user-level) process exploits a security vulnerability to escalate his own privileges and run some arbitrary code with higherprivileges (like LOCAL SYSTEM in this case)."}),"\n",(0,n.jsxs)(s.li,{children:["If malware launched software on a machine that runs as Local System and existed at ",(0,n.jsx)(s.code,{children:"c:\\anything\\Program.exe"})," (like PSEXEC, other ransomware, etc.). In this case, it would be owned by the user (who is not on the SecureRun list.) However, if the malware executed the",(0,n.jsx)(s.code,{children:" c:\\anything\\Program.exe"})," as SYSTEM, this attack would be prevented, because the owner of the ",(0,n.jsx)(s.code,{children:"c:\\anything\\Program.exe"})," is the User (as the attacker) but would not on the SecureRun list (even though the process is being run AS SYSTEM.)"]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["This would strengthen security if a malware ended up using an elevated process to attempt to perform its work as LOCAL SYSTEM and tries to run an un-trusted file. Therefore, when the application (",(0,n.jsx)(s.code,{children:".EXE"}),") or script, etc., was attempted to fire off, because the user isn't on the SecureRun trusted list, the attack attempt will fail."]}),"\n",(0,n.jsxs)(s.p,{children:["For a video demo of this scenario, see\xa0",(0,n.jsx)(s.a,{href:"/docs/policypak/policypak/video/leastprivilege/bestpractices/securerun/usersystemexecutables",children:"SecureRun to block User AND System executables"})]}),"\n",(0,n.jsx)(s.h2,{id:"scenario-2-specific-rule-to-block-an-app-from-being-run-even-as-local-system",children:"Scenario 2: Specific rule to block an app from being run, even as local System."}),"\n",(0,n.jsx)(s.p,{children:"You might want to explicitly block attack vectors such as PSEXEC (which was used in WannaCry), or entirely block PowerShell.\xa0 If you specify to do this only on the User side (or set Computer side scope to User processed only), then only user processes will be affected:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_6_faq-img-06_950x195",src:i(667900).A+"",width:"950",height:"195"})}),"\n",(0,n.jsx)(s.p,{children:"You can shore up this attack vector by making the explicit deny rule on the Computer side:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_7_faq-img-07_950x381",src:i(174253).A+"",width:"950",height:"381"})}),"\n",(0,n.jsx)(s.p,{children:"When you do, \xa0this happens:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_8_faq-img-08_950x183",src:i(532511).A+"",width:"950",height:"183"})}),"\n",(0,n.jsx)(s.h3,{id:"scenario-2b-block-powershellexe-completely-but-allow-local-system-to-run-a-specific-ps1-script",children:"Scenario 2B: Block Powershell.exe completely, but allow Local System to run a specific .PS1 script"}),"\n",(0,n.jsx)(s.p,{children:"In the previous example, we blocked Powershell (or PSEXEC, etc.) from all user and system processes."}),"\n",(0,n.jsx)(s.p,{children:"However, you might need to run some Powershell scripts as SYSTEM to perform some maintenance tasks.\xa0 Since PowerShell is now being blocked for all Computer side processes, you cannot run a specific script with PowerShel:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_9_faq-img-09_950x271",src:i(463849).A+"",width:"950",height:"271"})}),"\n",(0,n.jsxs)(s.p,{children:["To enable this, simply add another rule to ALLOW AND LOG, for example, ",(0,n.jsx)(s.code,{children:"C:\\SCRIPTS\\ITSCRIPT1.ps1"}),", and set the scope to User and System processes, but use the scope Filter to SYSTEM."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_10_faq-img-10_950x453",src:i(214851).A+"",width:"950",height:"453"})}),"\n",(0,n.jsx)(s.p,{children:"Result:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_11_faq-img-11_950x375",src:i(398800).A+"",width:"950",height:"375"})}),"\n",(0,n.jsxs)(s.p,{children:["For more information on this issue, see \xa0",(0,n.jsx)(s.a,{href:"/docs/policypak/policypak/video/leastprivilege/bestpractices/powershellblock",children:"Block PowerShell in General, Open up for specific items"})]}),"\n",(0,n.jsx)(s.h2,{id:"scenario-3-running-or-elevating-applications-or-installers-but-blocking-other-admins-from-running-them",children:"Scenario 3: Running or Elevating applications or installers, but blocking other admins from running them."}),"\n",(0,n.jsx)(s.p,{children:"In this scenario you want to do work with Endpoint Policy Manager Least Privilege Manager (Elevate, Allow, or Block) but prevent other admins (local admins or domain admins) from overcoming your rule."}),"\n",(0,n.jsx)(s.p,{children:"To perform this, you'll need to apply these two rules:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["First one BLOCKS ",(0,n.jsx)(s.code,{children:"ABC.EXE"})," or ",(0,n.jsx)(s.code,{children:"ABC.CMD"})," or ",(0,n.jsx)(s.code,{children:"ABC.MSI"}),". This must be done on the COMPUTER side with SCOPE = USER AND SYSTEM. Then, filter the scope by group (more on this in a second.)"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["Second rule ALLOWS or ELEVATES ",(0,n.jsx)(s.code,{children:"ABC.EXE"})," or ",(0,n.jsx)(s.code,{children:"ABC.CMD"})," or ",(0,n.jsx)(s.code,{children:"ABC.MSI"}),". The scope doesn't matter. You can do this on the COMPUTER or USER side. (leaving the default filters in place.)"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"If you want toblock only LOCAL admins (but not domain admins) then Rule #1 needs to look like this. (Note that this group is not available when editing a GPO from a DC, and only available when creating the GPO from a Windows 10 computer):"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_12_faq-img-12_950x482",src:i(112189).A+"",width:"950",height:"482"})}),"\n",(0,n.jsx)(s.p,{children:"If you want toblock both local admins and domain administrators, then Rule #1 needs to look like this."}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_13_faq-img-13_950x534",src:i(176605).A+"",width:"950",height:"534"})}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.em,{children:"Remember,"})," rule 2, the rule that does the ELEVATE or ALLOW, is just a standard rule, and can be done on the user or computer side, like this:"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_14_faq-img-14_950x458",src:i(969834).A+"",width:"950",height:"458"})}),"\n",(0,n.jsxs)(s.p,{children:["video 3:\xa0",(0,n.jsx)(s.a,{href:"/docs/policypak/policypak/video/leastprivilege/bestpractices/appblock",children:"Elevate apps as standard user, BLOCK other Admins"})]}),"\n",(0,n.jsx)(s.h2,{id:"scenario-4-elevating-a-service-account",children:"Scenario 4:\xa0 Elevating a Service account"}),"\n",(0,n.jsx)(s.p,{children:"You might have a service which requires specific privileges. Maybe your service, by default, uses Local System, and you want to give it less rights."}),"\n",(0,n.jsx)(s.p,{children:"With Endpoint Policy Manager Least Privilege Manager, you can remove the powerful privileges of the service account and strip out LOCAL SYSTEM and grant a specific user the permissions required."}),"\n",(0,n.jsx)(s.p,{children:"If you want a process to be run via special user account, follow these steps you would need to do the following:"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Step 1 \u2013"})," Make a rule for an ",(0,n.jsx)(s.code,{children:".exe"})," from which the service runs."]}),"\n",(0,n.jsx)(s.p,{children:"We recommend to make a File Info + Signature rule, but PATH rules would work as well."}),"\n",(0,n.jsxs)(s.p,{children:["e.g. ",(0,n.jsx)(s.code,{children:"C:\\Program Files\\AppABC \\AppService.exe"})]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Step 2 \u2013"}),' On the Actions page select "Run with custom token" and configure the TOKEN and/or exact PRIVILEGES the process needs like Load Driver Privilege (SeLoadDriverPrivilege), Bypass Traverse Checking (SeChangeNotify).']}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Step 3 \u2013"})," On the final page select Scope = User and System Processes"]}),"\n",(0,n.jsx)(s.p,{children:"AND"}),"\n",(0,n.jsx)(s.p,{children:"Scope Filter should be trimmed to the specific account you specified to run the service runs as."}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"NOTE:"})," It's also possible to use Scope Filter = SERVICES to make the rule apply to all services that run from the specified ",(0,n.jsx)(s.code,{children:".exe "}),"regardless of the user."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"319_15_faq-img-15_950x467",src:i(689134).A+"",width:"950",height:"467"})}),"\n",(0,n.jsxs)(s.p,{children:["video: ",(0,n.jsx)(s.a,{href:"/docs/policypak/policypak/video/leastprivilege/bestpractices/serviceaccountrights",children:"Reduce or specify Service Account Rights"})]})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},28453:(e,s,i)=>{i.d(s,{R:()=>r,x:()=>a});var t=i(296540);const n={},o=t.createContext(n);function r(e){const s=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),t.createElement(o.Provider,{value:s},e.children)}},112189:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_12_faq-img-12_950x482-c4e7de93ff2b9e12f27b5aac1a84a37a.webp"},174253:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_7_faq-img-07_950x381-c5a86fdc7fb1c707d6bcfdb0fff8d173.webp"},176605:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_13_faq-img-13_950x534-a5691baf3d471cc43188144c13d53d61.webp"},214851:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_10_faq-img-10_950x453-a8eca66f56add6dfb7b5bde76e699429.webp"},398800:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_11_faq-img-11_950x375-eaa6b2fcb5fee40b9673225e4407c460.webp"},463849:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_9_faq-img-09_950x271-c92a6381f653e56645e2c3d100929624.webp"},532511:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_8_faq-img-08_950x183-380623c1aa6abe0cf0814d74b61f22c7.webp"},543464:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_2_faq-img-02_950x537-e3752f22cef8118443305313e0a770ff.webp"},665711:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_1_faq-img-01_950x578-101005114c414e07809a349d7ec1a5f4.webp"},667900:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_6_faq-img-06_950x195-148e87c03704aa83ff2e386a65bf9396.webp"},689134:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_15_faq-img-15_950x467-aec8ffad77b660fa824bf20b59928bcd.webp"},767056:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_3_faq-img-03_950x571-95be8c2cda497bc1f9f40c5de8ba27d7.webp"},932042:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_4_faq-img-04_950x647-30e1fb2e933a7d1d4098a26a6a09a4a2.webp"},951437:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_5_faq-img-05_950x547-62130c2f7c9a01904222846a47c6d044.webp"},969834:(e,s,i)=>{i.d(s,{A:()=>t});const t=i.p+"assets/images/319_14_faq-img-14_950x458-a094c75382881b578140db19aaef9c73.webp"}}]);