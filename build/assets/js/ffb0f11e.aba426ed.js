"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[170768],{28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>a});var n=i(296540);const o={},s=n.createContext(o);function r(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),n.createElement(s.Provider,{value:t},e.children)}},211462:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/403_2_hfkb-1131-img-02_950x173-3a349d733bcec3b934e1683a2ccc4dad.webp"},319907:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/403_3_hfkb-1131-img-03_950x147-dc6a3134c981c665711be9170c9d6f63.webp"},397576:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/403_5_hfkb-1131-img-05_950x612-a87752f3016961c4435e9258eed0f7db.webp"},448262:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/403_1_hfkb-1131-img-01_950x470-51742872e36d11fdc361cd7464ae8fa8.webp"},912194:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>r,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"policypak/gpoexport/usercontext","title":"Why must some GPPreferences items be run in User Context?","description":"You might have some existing GPPreferences items, like Printer ,which won\'t work as expected when using them with Netwrix Endpoint Policy Manager (formerly PolicyPak) Cloud or Endpoint Policy Manager with an MDM service, like Intune, when the computer is non-domain joined.","source":"@site/docs/policypak/policypak/gpoexport/usercontext.md","sourceDirName":"policypak/gpoexport","slug":"/policypak/gpoexport/usercontext","permalink":"/docs/policypak/policypak/gpoexport/usercontext","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/gpoexport/usercontext.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Which security settings can be exported by GPO Export Manager?","permalink":"/docs/policypak/policypak/gpoexport/securitysettings"},"next":{"title":"How to insert User information in any Application via Group Policies?","permalink":"/docs/policypak/policypak/grouppolicy/insertuserinfo"}}');var o=i(474848),s=i(28453);const r={},a="Why must some GPPreferences items be run in User Context?",c={},h=[{value:"Modify the option in the GPPreferences Editor and specify Run in logged-on user&#39;s security context",id:"modify-the-option-in-the-gppreferences-editor-and-specify-run-in-logged-on-users-security-context",level:2},{value:"Hand edit the setting within the XML after export",id:"hand-edit-the-setting-within-the-xml-after-export",level:2},{value:"Use the GPO Export Manager to automatically detect and change the setting (works for Printers items only)",id:"use-the-gpo-export-manager-to-automatically-detect-and-change-the-setting-works-for-printers-items-only",level:2},{value:"More details:",id:"more-details",level:2}];function d(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"why-must-some-gppreferences-items-be-run-in-user-context",children:"Why must some GPPreferences items be run in User Context?"})}),"\n",(0,o.jsx)(t.p,{children:"You might have some existing GPPreferences items, like Printer ,which won't work as expected when using them with Netwrix Endpoint Policy Manager (formerly PolicyPak) Cloud or Endpoint Policy Manager with an MDM service, like Intune, when the computer is non-domain joined."}),"\n",(0,o.jsx)(t.p,{children:"This is because the item might be required to be run in the User context and not the System context."}),"\n",(0,o.jsx)(t.p,{children:"This is especially true when you have machines which are NOT domain joined, but you wish to use on-prem / Active Directory joined resources."}),"\n",(0,o.jsx)(t.p,{children:"There are three available recommended fixes for this, all with the same end result. The result of all three recommendations is exactly the same."}),"\n",(0,o.jsx)(t.h2,{id:"modify-the-option-in-the-gppreferences-editor-and-specify-run-in-logged-on-users-security-context",children:"Modify the option in the GPPreferences Editor and specify Run in logged-on user's security context"}),"\n",(0,o.jsx)(t.p,{children:"This must be done by hand on each Group Policy Preference item that requires it. The downside is that this might change the expected behavior in production for existing Group Policy preferences items. But you can at least perform this action on one or two items to verify if this is actually the problem."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"403_1_hfkb-1131-img-01_950x470",src:i(448262).A+"",width:"950",height:"470"})}),"\n",(0,o.jsx)(t.h2,{id:"hand-edit-the-setting-within-the-xml-after-export",children:"Hand edit the setting within the XML after export"}),"\n",(0,o.jsxs)(t.p,{children:["Group Policy Preferences items can be viewed as XML and then hand-edited. Items in the SYSTEM context will appear as ",(0,o.jsx)(t.code,{children:'userContext = "0"'}),"."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"403_2_hfkb-1131-img-02_950x173",src:i(211462).A+"",width:"950",height:"173"})}),"\n",(0,o.jsxs)(t.p,{children:["You may hand-edit them to ",(0,o.jsx)(t.code,{children:'userContext = "1"'})," like what's seen here, to use them with non-domain joined machines."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"403_3_hfkb-1131-img-03_950x147",src:i(319907).A+"",width:"950",height:"147"})}),"\n",(0,o.jsx)(t.h2,{id:"use-the-gpo-export-manager-to-automatically-detect-and-change-the-setting-works-for-printers-items-only",children:"Use the GPO Export Manager to automatically detect and change the setting (works for Printers items only)"}),"\n",(0,o.jsx)(t.p,{children:"The Endpoint Policy Manager GPO Export Manager will detect your use of Printer items on the USER or COMPUTER side of the GPO where you are using the System context, and then make a recommendation for you which would flip any / all of them to the User context. The GPO Export Manager will ONLY check for Printer items at this time and will make this recommendation if you have items on the USER or COMPUTER side, and when the context is SYSTEM and should be USER."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"403_4_hfkb-1131-img-04_950x466",src:i(964299).A+"",width:"950",height:"466"})}),"\n",(0,o.jsx)(t.h2,{id:"more-details",children:"More details:"}),"\n",(0,o.jsxs)(t.p,{children:["When the Preferences Item is attempting to run in System, the access rights are simply blocked because the item attempting to be run with the System context is not authorized to do an action with a domain object. For instance, a Printer with a queue called ",(0,o.jsx)(t.code,{children:"\\\\dc2016\\Printer2"})," will not allow the System to map to the queue, because the System is not recognized in Active Directory. However, the user might be, and can use his pass-thru credentials to make that shared printer mapping."]}),"\n",(0,o.jsx)(t.p,{children:"If you fail to change the context from System to User and attempt to map a printer, you will get the following in the Group Policy Preferences Trace logs, which show the Access Denied details."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"403_5_hfkb-1131-img-05_950x612",src:i(397576).A+"",width:"950",height:"612"})})]})}function l(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},964299:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/403_4_hfkb-1131-img-04_950x466-59803b54f5adb3bd25c556f4e04cdf14.webp"}}]);