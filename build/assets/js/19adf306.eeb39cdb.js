"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[131665],{28453:(e,s,r)=>{r.d(s,{R:()=>o,x:()=>c});var n=r(296540);const t={},i=n.createContext(t);function o(e){const s=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),n.createElement(i.Provider,{value:s},e.children)}},549484:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"passwordsecure/configuration/advanced_view/clientmodule/passwordreset/user-defined_scripts/user-defined_scripts","title":"User-defined scripts","description":"Individual solutions using your own scripts","source":"@site/docs/passwordsecure/passwordsecure/configuration/advanced_view/clientmodule/passwordreset/user-defined_scripts/user-defined_scripts.md","sourceDirName":"passwordsecure/configuration/advanced_view/clientmodule/passwordreset/user-defined_scripts","slug":"/passwordsecure/configuration/advanced_view/clientmodule/passwordreset/user-defined_scripts/","permalink":"/docs/passwordsecure/passwordsecure/configuration/advanced_view/clientmodule/passwordreset/user-defined_scripts/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/passwordsecure/passwordsecure/configuration/advanced_view/clientmodule/passwordreset/user-defined_scripts/user-defined_scripts.md","tags":[],"version":"current","frontMatter":{},"sidebar":"passwordSecureSidebar","previous":{"title":"Scripts","permalink":"/docs/passwordsecure/passwordsecure/configuration/advanced_view/clientmodule/passwordreset/scripts/"},"next":{"title":"Passwords","permalink":"/docs/passwordsecure/passwordsecure/configuration/advanced_view/clientmodule/passwords/"}}');var t=r(474848),i=r(28453);const o={},c="User-defined scripts",a={},d=[{value:"Individual solutions using your own scripts",id:"individual-solutions-using-your-own-scripts",level:2},{value:"Storage location, name and call",id:"storage-location-name-and-call",level:2},{value:"Structure of the scripts",id:"structure-of-the-scripts",level:2},{value:"RunScript function",id:"runscript-function",level:3},{value:"Scriptblock",id:"scriptblock",level:3},{value:"Invoke",id:"invoke",level:3}];function l(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"user-defined-scripts",children:"User-defined scripts"})}),"\n",(0,t.jsx)(s.h2,{id:"individual-solutions-using-your-own-scripts",children:"Individual solutions using your own scripts"}),"\n",(0,t.jsxs)(s.p,{children:["If your requirements cannot be met using the ",(0,t.jsx)(s.a,{href:"/docs/passwordsecure/passwordsecure/configuration/advanced_view/clientmodule/passwordreset/scripts/",children:"Scripts"}),", it is also possible to create your own Powershell scripts. These scripts need to meet certain requirements to be used in Netwrix Password Secure."]}),"\n",(0,t.jsx)(s.h2,{id:"storage-location-name-and-call",children:"Storage location, name and call"}),"\n",(0,t.jsxs)(s.p,{children:["The scripts must be saved in the following directory:\n",(0,t.jsx)(s.code,{children:"C:\\ProgramData\\MATESO\\Password Safe and Repository Service\\System\\PowerShell"})]}),"\n",(0,t.jsxs)(s.p,{children:["The scripts are saved in the ",(0,t.jsx)(s.strong,{children:"format.ps1"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"structure-of-the-scripts",children:"Structure of the scripts"}),"\n",(0,t.jsx)(s.p,{children:"The PowerShell scripts must have the following structure:"}),"\n",(0,t.jsx)(s.h3,{id:"runscript-function",children:"RunScript function"}),"\n",(0,t.jsx)(s.p,{children:"Netwrix Password Secure always calls the RunScript function."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.a,{href:"javascript:void(0);",children:"Copy"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"function RunScript  \nparam (  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[String]$HostName,  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[String]$UserName,  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[String]$NewPassword,  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[String]$CredentialsUserName,  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[Security.SecureString]$CredentialsPassword  \n\xa0\xa0\xa0\xa0)  \n\n"})}),"\n",(0,t.jsx)(s.p,{children:"The following standard parameters can be used here:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"UserName: The user name for which the password should be changed"}),"\n",(0,t.jsx)(s.li,{children:"Password: The password that should be reset"}),"\n",(0,t.jsx)(s.li,{children:"CredentialsUserName: The user name of the user authorized to carry our the reset (e.g. administrator)"}),"\n",(0,t.jsx)(s.li,{children:"CredentialsPassword: The password of the authorized user"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"scriptblock",children:"Scriptblock"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.strong,{children:"scriptblock"})," can be used when the script should run in the context of another user. The actual change is then carried out in the ",(0,t.jsx)(s.strong,{children:"scriptblock"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["It is important in this case that you provide Netwrix Password Secure with feedback about what has been changed via a ",(0,t.jsx)(s.strong,{children:"Write-Output"}),". The following example simply uses the outputs ",(0,t.jsx)(s.strong,{children:"true"})," or ",(0,t.jsx)(s.strong,{children:"false"}),". However, it is also conceivable that an error message or similar is output."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.a,{href:"javascript:void(0);",children:"Copy"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'\xa0\xa0\xa0\xa0$scriptBlock = {param ($UserName, $Password)  \n\xa0\xa0\xa0\xa0// Make changes to SAP  \n\xa0\xa0\xa0\xa0if($OK) {  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Write-Output "true"  \n\xa0\xa0\xa0\xa0} else {  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Write-Output "false"  \n\xa0\xa0\xa0\xa0}  \n\n'})}),"\n",(0,t.jsxs)(s.p,{children:["Naturally, CredentialsUserName and CredentialsPassword can also be directly used in the script (i.e. without the ",(0,t.jsx)(s.strong,{children:"scriptblock"}),"). You can view the supplied MSSQL script as an example."]}),"\n",(0,t.jsx)(s.h3,{id:"invoke",children:"Invoke"}),"\n",(0,t.jsxs)(s.p,{children:["A credential then still needs to be created. This is then transferred to the ",(0,t.jsx)(s.strong,{children:"scriptblock"})," using the ",(0,t.jsx)(s.strong,{children:"invoke"})," command. It is also important in this case to provide Netwrix Password Secure with feedback about all errors via ",(0,t.jsx)(s.strong,{children:"Write-Output"})," or ",(0,t.jsx)(s.strong,{children:"throw [System.Exception]"}),"."]})]})}function u(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}}}]);