"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[779556],{28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>c});var o=i(296540);const t={},r=o.createContext(t);function s(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),o.createElement(r.Provider,{value:n},e.children)}},190950:(e,n,i)=>{i.d(n,{A:()=>o});const o=i.p+"assets/images/npsdatacollectingaccountresourced-e08bef61f6f46401d1622c23fdf3f74e.webp"},413966:(e,n,i)=>{i.d(n,{A:()=>o});const o=i.p+"assets/images/npsdatacollectingaccount-5a4fda6e3025e3096e005d480f82a7b2.webp"},487784:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"auditor/configuration/grouppolicy/permissions","title":"Permissions for Group Policy Auditing","description":"Before you start creating a monitoring plan to audit the group policy in the domain, plan for the account that will be used for data collection \u2013 it should meet the requirements listed below. Then you will provide this account in the monitoring plan wizard (or in the monitored item settings).","source":"@site/docs/auditor/auditor/configuration/grouppolicy/permissions.md","sourceDirName":"auditor/configuration/grouppolicy","slug":"/auditor/configuration/grouppolicy/permissions","permalink":"/docs/auditor/auditor/configuration/grouppolicy/permissions","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/grouppolicy/permissions.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Group Policy","permalink":"/docs/auditor/auditor/configuration/grouppolicy/overview"},"next":{"title":"Group Policy Ports","permalink":"/docs/auditor/auditor/configuration/grouppolicy/ports"}}');var t=i(474848),r=i(28453);const s={},c="Permissions for Group Policy Auditing",a={},d=[{value:"Account Requirements",id:"account-requirements",level:2},{value:"Additional Configuration for Domain Controller&#39;s Event Logs Auto-backup",id:"additional-configuration-for-domain-controllers-event-logs-auto-backup",level:2},{value:"Assign Permission to Read the Registry Key",id:"assign-permission-to-read-the-registry-key",level:2},{value:"Considerations for Netwrix Privilege Secure Integration",id:"considerations-for-netwrix-privilege-secure-integration",level:2}];function l(e){const n={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"permissions-for-group-policy-auditing",children:"Permissions for Group Policy Auditing"})}),"\n",(0,t.jsx)(n.p,{children:"Before you start creating a monitoring plan to audit the group policy in the domain, plan for the account that will be used for data collection \u2013 it should meet the requirements listed below. Then you will provide this account in the monitoring plan wizard (or in the monitored item settings)."}),"\n",(0,t.jsx)(n.p,{children:"You can use group Managed Service Accounts (gMSA) as data collecting accounts."}),"\n",(0,t.jsxs)(n.p,{children:["See the ",(0,t.jsx)(n.a,{href:"/docs/auditor/auditor/requirements/gmsa",children:"Use Group Managed Service Account (gMSA)"})," topic and the following Microsoft article: ",(0,t.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows-server/security/group-managed-service-accounts/group-managed-service-accounts-overview",children:"Group Managed Service Accounts Overview"})," for additional information about gMSA."]}),"\n",(0,t.jsx)(n.h2,{id:"account-requirements",children:"Account Requirements"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"NOTE:"})," These group Managed Service Accounts should also meet the related requirements. See the ",(0,t.jsx)(n.a,{href:"/docs/auditor/auditor/requirements/gmsa",children:"Use Group Managed Service Account (gMSA)"})," topic and the following Microsoft article: ",(0,t.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows-server/security/group-managed-service-accounts/group-managed-service-accounts-overview",children:"Group Managed Service Accounts Overview"})," for additional information about gMSA."]}),"\n",(0,t.jsx)(n.p,{children:"The account used for data collection must meet the following requirements:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Member of the local Administrators group on the target server."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Member of the Domain Admins group on the target server."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"NOTE:"})," This covers all the required permissions below and is a mandatory setting if you want to use network traffic compression for data collection."]}),"\n",(0,t.jsx)(n.p,{children:"OR"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["The combination of the following rights and permissions if you plan to disable network traffic compression for your monitoring plan or, for some reasons, do not want to add this account to the ",(0,t.jsx)(n.strong,{children:"Domain Admins"})," group:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Manage auditing and security log"})," policy must be defined for this account.",(0,t.jsx)(n.br,{}),"\n","See the ",(0,t.jsx)(n.a,{href:"/docs/auditor/auditor/configuration/activedirectory/permissions",children:"Permissions for Active Directory Auditing"})," topic for additional information."]}),"\n",(0,t.jsxs)(n.li,{children:["If you plan to process Active Directory ",(0,t.jsx)(n.strong,{children:"Deleted Objects"})," container, ",(0,t.jsx)(n.strong,{children:"Read"})," permission on\nthis container is required. See the ",(0,t.jsx)(n.a,{href:"/docs/auditor/auditor/configuration/activedirectory/permissions",children:"Permissions for Active Directory Auditing"})," topic for additional information."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"additional-configuration-for-domain-controllers-event-logs-auto-backup",children:"Additional Configuration for Domain Controller's Event Logs Auto-backup"}),"\n",(0,t.jsxs)(n.p,{children:["The following is required if auto-backup is ",(0,t.jsx)(n.em,{children:"enabled"})," for the domain controller event logs:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Permissions to access the ",(0,t.jsx)(n.em,{children:"HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\EventLog\\Security"})," registry key on the domain controllers in the target domain. See the ",(0,t.jsx)(n.a,{href:"#Assign-Permission-to-Read-the-Registry-Key",children:"Assign Permission to Read the Registry Key"})," topic for additional information."]}),"\n",(0,t.jsxs)(n.li,{children:["Membership in one of the following groups: ",(0,t.jsx)(n.strong,{children:"Administrators"}),", ",(0,t.jsx)(n.strong,{children:"Print Operators"}),", ",(0,t.jsx)(n.strong,{children:"Server Operators"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"Read/Write share permission and Full control security permission on the logs backup folder."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"assign-permission-to-read-the-registry-key",children:"Assign Permission to Read the Registry Key"}),"\n",(0,t.jsx)(n.p,{children:"This permission is required only if the account selected for data collection is not a member of the Domain Admins group."}),"\n",(0,t.jsxs)(n.p,{children:["This permission should be assigned on each domain controller in the audited domain, so if your domain contains multiple domain controllers, it is recommended to assign permissions through Group Policy, or automatically using ",(0,t.jsx)(n.a,{href:"/docs/auditor/auditor/tools/auditconfigurationassistant",children:"Audit Configuration Assistant"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"To assign permissions manually, use the Registry Editor snap-in or the Group Policy Management console."}),"\n",(0,t.jsx)(n.p,{children:"Assign Permission Via the Registry Editor Snap-in"}),"\n",(0,t.jsx)(n.p,{children:"Follow the steps to assign permission via the Registry Editor snap-in:"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 1 \u2013"})," On your target server, open Registry Editor: navigate to ",(0,t.jsx)(n.strong,{children:"Start > Run"})," and type ",(0,t.jsx)(n.em,{children:'"regedit"'}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 2 \u2013"})," In the left pane, navigate to ",(0,t.jsx)(n.em,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControl Set\\Services\\EventLog\\Security"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 3 \u2013"})," Right-click the ",(0,t.jsx)(n.strong,{children:"Security"})," node and select ",(0,t.jsx)(n.strong,{children:"Permissions"})," from the pop-up menu."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 4 \u2013"})," Click ",(0,t.jsx)(n.strong,{children:"Add"})," and enter the name of the user that you want to grant permissions to."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 5 \u2013"})," Check ",(0,t.jsx)(n.strong,{children:"Allow"})," next to the ",(0,t.jsx)(n.strong,{children:"Read"})," permission."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 6 \u2013"})," For auditing Logon Activity, you also need to assign the Read permission to the ",(0,t.jsx)(n.em,{children:"HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\PolAdtEv"})," registry key."]}),"\n",(0,t.jsx)(n.p,{children:"To assign permission using the Group Policy Management console"}),"\n",(0,t.jsx)(n.p,{children:"Assign Permission Using the Group Policy Management Console"}),"\n",(0,t.jsx)(n.p,{children:"Follow the steps to assign permission using the Group Policy Management console:"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 1 \u2013"})," Open the Group Policy Management console on any domain controller in the target domain: navigate to Start > Windows Administrative Tools (Windows Server 2016/2019) or Administrative Tools (Windows 2012 R2 and below) > Group Policy Management."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 2 \u2013"})," In the left pane, navigate to Forest: ",(0,t.jsx)(n.code,{children:"<forest name>"})," > Domains > ",(0,t.jsx)(n.code,{children:"<domain name>"})," > Domain Controllers. Right-click the effective domain controllers policy (by default, it is the ",(0,t.jsx)(n.em,{children:"Default Domain Controllers Policy"}),"), and select Edit ."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 3 \u2013"})," In the Group Policy Management Editor dialog, expand the Computer Configuration node on the left and navigate to Policies > Windows Settings > Security Settings > Registry."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 4 \u2013"})," Right-click in the pane and select Add Key."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 5 \u2013"})," Navigate to ",(0,t.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\PolAdtEv"})," and click OK."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 6 \u2013"})," Click Add and enter the name of the user that you want to grant permissions to and press Enter."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 7 \u2013"})," Check Allow next to the ",(0,t.jsx)(n.em,{children:'"Read"'})," permission and click OK"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 8 \u2013"})," In the pop-up window, select Propagate inheritable permissions to all subkeys and click OK."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 9 \u2013"})," Repeat the steps 4-8 for keys below:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurePipeServers\\winreg"}),";"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\EventLog\\Security"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 10 \u2013"})," Close Group Policy Management console."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 11 \u2013"}),' Navigate to Start > Run and type "',(0,t.jsx)(n.em,{children:"cmd"}),'". Input the ',(0,t.jsx)(n.code,{children:"gpupdate /force"})," command and press Enter. The group policy will be updated."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 12 \u2013"})," Type ",(0,t.jsx)(n.code,{children:"repadmin /syncall"})," command and press Enter for replicate GPO changes to other domain controllers."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 13 \u2013"})," Ensure that new GPO settings were applied to the domain controllers."]}),"\n",(0,t.jsx)(n.h2,{id:"considerations-for-netwrix-privilege-secure-integration",children:"Considerations for Netwrix Privilege Secure Integration"}),"\n",(0,t.jsxs)(n.p,{children:["Starting with version 10.7, you can use Netwrix Privilege Secure to manage the account for collecting data, after configuring the integration. See the ",(0,t.jsx)(n.a,{href:"/docs/auditor/auditor/admin/settings/privilegesecure",children:"Netwrix Privilege Secure"})," topic for additional information about integration and supported data sources. In this case, the credentials will not be stored by Netwrix Auditor. Instead, they will be managed by Netwrix Privilege Secure and\xa0provided on demand, ensuring password rotation or using temporary accounts for data collection."]}),"\n",(0,t.jsx)(n.p,{children:"Follow the steps to use Netwrix Privilege Secure as\xa0an account for data collection."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 1 \u2013"})," Select the desired item."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 2 \u2013"})," In the item configuration menu, select Netwrix Privilege Secure as an option for data collection."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"npsdatacollectingaccount",src:i(413966).A+"",width:"577",height:"325"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 3 \u2013"})," Select the type of the Access Policy you want to use in Netwrix Privilege Secure. Credential-based is the default option. Refer to the ",(0,t.jsx)(n.a,{href:"https://helpcenter.netwrix.com/category/privilegesecure_accessmanagement",children:"Netwrix Privilege Secure"})," documentation to learn more about Access Policies."]}),"\n",(0,t.jsx)(n.p,{children:"In this case, you need to provide the username of the account managed by Netwrix Privilege Secure, and to which Netwrix Auditor has the access through a Credential-based access policy."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"NOTE:"})," Netwrix recommends using different credentials for different monitoring plans and data sources."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"npsdatacollectingaccountresourced",src:i(190950).A+"",width:"596",height:"436"})}),"\n",(0,t.jsx)(n.p,{children:"The second option is Resource-based. To use this option, you need to provide the Activity and Resource names, assigned to Netwrix Auditor in the corresponding Resource-based policy. Make sure that you specified the same names as in Netwrix Privilege Secure."}),"\n",(0,t.jsx)(n.p,{children:"The Resource name in this case is where the activity will be performed. For example, if you grant the data collecting account the access to a local Administrators group - the resource is the server where the permission will be granted."}),"\n",(0,t.jsx)(n.p,{children:"Netwrix Privilege Secure is ready to use as\xa0an account for data collection."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}}}]);