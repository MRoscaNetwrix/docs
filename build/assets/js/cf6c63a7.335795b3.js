"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[528132],{28453:(e,s,t)=>{t.d(s,{R:()=>c,x:()=>i});var o=t(296540);const r={},n=o.createContext(r);function c(e){const s=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),o.createElement(n.Provider,{value:s},e.children)}},327449:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>i,default:()=>d,frontMatter:()=>c,metadata:()=>o,toc:()=>p});const o=JSON.parse('{"id":"policypak/troubleshooting/scriptstriggers/systemprocesses","title":"Why don\'t Batch and PowerShell scripts get blocked when SYSTEM processes are blocked","description":"When implementing SecureRun to block both User and System processes (as demonstrated in SecureRun to block User AND System executables video) we find that EXEs, MSIs and VB scripts get smacked down as expected when running as the USER, ADMIN or SYSTEM account. However, Batch and PowerShell scripts that are started from within a previously opened cmd.exe or powershell.exe window do not get blocked when running as a system process. Why don\'t they?","source":"@site/docs/policypak/policypak/troubleshooting/scriptstriggers/systemprocesses.md","sourceDirName":"policypak/troubleshooting/scriptstriggers","slug":"/policypak/troubleshooting/scriptstriggers/systemprocesses","permalink":"/docs/policypak/policypak/troubleshooting/scriptstriggers/systemprocesses","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/troubleshooting/scriptstriggers/systemprocesses.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Troubleshooting","permalink":"/docs/policypak/policypak/troubleshooting/scriptstriggers/overview"},"next":{"title":"How do I ensure that settings will revert when the policy no longer applies (by Group Policy, File, or Endpoint Policy Manager Cloud)?","permalink":"/docs/policypak/policypak/troubleshooting/settingsrevert"}}');var r=t(474848),n=t(28453);const c={},i="Why don't Batch and PowerShell scripts get blocked when SYSTEM processes are blocked",a={},p=[];function l(e){const s={a:"a",h1:"h1",header:"header",p:"p",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"why-dont-batch-and-powershell-scripts-get-blocked-when-system-processes-are-blocked",children:"Why don't Batch and PowerShell scripts get blocked when SYSTEM processes are blocked"})}),"\n",(0,r.jsxs)(s.p,{children:["When implementing SecureRun to block both User and System processes (as demonstrated in ",(0,r.jsx)(s.a,{href:"/docs/policypak/policypak/video/leastprivilege/bestpractices/securerun/usersystemexecutables",children:"SecureRun to block User AND System executables"})," video) we find that EXEs, MSIs and VB scripts get smacked down as expected when running as the USER, ADMIN or SYSTEM account. However, Batch and PowerShell scripts that are started from within a previously opened cmd.exe or powershell.exe window do not get blocked when running as a system process. Why don't they?"]}),"\n",(0,r.jsx)(s.p,{children:"This is expected behavior. When you run an EXE, MSI and VB script a new process is created. PolicyPak Least Privilege Manager then intercepts that process and applies the appropriate rule to it. Batch and PowerShell scripts when run from within an open cmd.exe or powershell.exe window, however, do not open a new process; they run within that existing process. As no new process is started, there's nothing for Least Privilege Manager to intercept and the command is thereby allowed to run."})]})}function d(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}}}]);