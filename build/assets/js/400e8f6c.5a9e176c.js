"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[860358],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>d});var r=s(296540);const i={},t=r.createContext(i);function o(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}},823846:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/manualconfig_ws_auditenrty_2016-3a0d79984446915bd30dd76c7a5327ef.webp"},956700:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/manualconfig_ws_auditenrty2008-9cdee43b7cb1222d44a8a0bc46a471f3.webp"},976163:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>g,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"auditor/configuration/windowsserver/windowsregistry","title":"Configure Windows Registry Audit Settings","description":"Windows Registry audit permissions must be configured on each Windows server you want to audit so that the \u201cWho\u201d and \u201cWhen\u201d values are reported correctly for each change. For test environment, PoC or evaluation you can use automatic audit configuration. If you want to configure Windows Registry manually, follow the instructions below.","source":"@site/docs/auditor/auditor/configuration/windowsserver/windowsregistry.md","sourceDirName":"auditor/configuration/windowsserver","slug":"/auditor/configuration/windowsserver/windowsregistry","permalink":"/docs/auditor/auditor/configuration/windowsserver/windowsregistry","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/windowsserver/windowsregistry.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Configure Removable Storage Media for Monitoring","permalink":"/docs/auditor/auditor/configuration/windowsserver/removablestorage"},"next":{"title":"Getting Started","permalink":"/docs/auditor/auditor/gettingstarted"}}');var i=s(474848),t=s(28453);const o={},d="Configure Windows Registry Audit Settings",c={},l=[{value:"Configuring Windows registry audit settings on pre-Windows Server 2012 versions",id:"configuring-windows-registry-audit-settings-on-pre-windows-server-2012-versions",level:2},{value:"Configuring Windows registry audit settings on Windows Server 2012 and above",id:"configuring-windows-registry-audit-settings-on-windows-server-2012-and-above",level:2}];function a(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"configure-windows-registry-audit-settings",children:"Configure Windows Registry Audit Settings"})}),"\n",(0,i.jsx)(n.p,{children:"Windows Registry audit permissions must be configured on each Windows server you want to audit so that the \u201cWho\u201d and \u201cWhen\u201d values are reported correctly for each change. For test environment, PoC or evaluation you can use automatic audit configuration. If you want to configure Windows Registry manually, follow the instructions below."}),"\n",(0,i.jsxs)(n.p,{children:["The following audit permissions must be set to ",(0,i.jsx)(n.em,{children:'"Successful"'})," for the ",(0,i.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SOFTWARE and HKEY_LOCAL_MACHINE\\SYSTEM"})," keys:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Set Value"}),"\n",(0,i.jsx)(n.li,{children:"Create Subkey"}),"\n",(0,i.jsx)(n.li,{children:"Delete"}),"\n",(0,i.jsx)(n.li,{children:"Write DAC"}),"\n",(0,i.jsx)(n.li,{children:"Write Owner"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Perform one of the following procedures depending on the OS\xa0version:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#Configuring-Windows-registry-audit-settings-on-pre-Windows-Server-2012-versions",children:"Configuring Windows registry audit settings on pre-Windows Server 2012 versions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#Configuring-Windows-registry-audit-settings-on-Windows-Server-2012-and-above",children:"Configuring Windows registry audit settings on Windows Server 2012 and above"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"configuring-windows-registry-audit-settings-on-pre-windows-server-2012-versions",children:"Configuring Windows registry audit settings on pre-Windows Server 2012 versions"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 1 \u2013"})," On your target server, open ",(0,i.jsx)(n.strong,{children:"Registry Editor"}),": navigate to ",(0,i.jsx)(n.strong,{children:"Start \u2192 Run"})," and type ",(0,i.jsx)(n.em,{children:'"regedit"'}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 2 \u2013"})," In the registry tree, expand the ",(0,i.jsx)(n.strong,{children:"HKEY_LOCAL_MACHINE"})," key, right-click ",(0,i.jsx)(n.strong,{children:"SOFTWARE"})," and select ",(0,i.jsx)(n.strong,{children:"Permissions"})," from the pop-up menu."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 3 \u2013"})," In the ",(0,i.jsx)(n.strong,{children:"Permissions for SOFTWARE"})," dialog, click ",(0,i.jsx)(n.strong,{children:"Advanced"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 4 \u2013"})," In the ",(0,i.jsx)(n.strong,{children:"Advanced Security Settings for SOFTWARE"})," dialog, select the ",(0,i.jsx)(n.strong,{children:"Auditing"})," tab and click ",(0,i.jsx)(n.strong,{children:"Add"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 5 \u2013"})," Select the ",(0,i.jsx)(n.strong,{children:"Everyone"})," group."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 6 \u2013"})," In the ",(0,i.jsx)(n.strong,{children:"Auditing Entry for SOFTWARE"})," dialog, select ",(0,i.jsx)(n.em,{children:'"Successful"'})," for the following access types:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Set Value"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Create Subkey"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Delete"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Write DAC"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Write Owner"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"ManualConfig_WS_AuditingEntry2008",src:s(956700).A+"",width:"372",height:"473"})}),"\n",(0,i.jsxs)(n.p,{children:["Repeat the same steps for the ",(0,i.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SYSTEM"})," key."]}),"\n",(0,i.jsx)(n.h2,{id:"configuring-windows-registry-audit-settings-on-windows-server-2012-and-above",children:"Configuring Windows registry audit settings on Windows Server 2012 and above"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 1 \u2013"})," On your target server, open ",(0,i.jsx)(n.strong,{children:"Registry Editor"}),": navigate to ",(0,i.jsx)(n.strong,{children:"Start \u2192 Run"})," and type ",(0,i.jsx)(n.em,{children:'"regedit"'}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 2 \u2013"})," In the registry tree, expand the ",(0,i.jsx)(n.strong,{children:"HKEY_LOCAL_MACHINE"})," key, right-click ",(0,i.jsx)(n.strong,{children:"SOFTWARE"})," and select ",(0,i.jsx)(n.strong,{children:"Permissions"})," from the pop-up menu."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 3 \u2013"})," In the ",(0,i.jsx)(n.strong,{children:"Permissions for SOFTWARE"})," dialog, click ",(0,i.jsx)(n.strong,{children:"Advanced"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 4 \u2013"})," In the ",(0,i.jsx)(n.strong,{children:"Advanced Security Settings for SOFTWARE"})," dialog, select the ",(0,i.jsx)(n.strong,{children:"Auditing"})," tab and click ",(0,i.jsx)(n.strong,{children:"Add"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 5 \u2013"})," Click ",(0,i.jsx)(n.strong,{children:"Select a principal link"})," and specify the ",(0,i.jsx)(n.strong,{children:"Everyone"})," group in the ",(0,i.jsx)(n.strong,{children:"Enter the object name to select"})," field."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 6 \u2013"})," Set ",(0,i.jsx)(n.strong,{children:"Type"})," to ",(0,i.jsx)(n.em,{children:'"Success"'})," and ",(0,i.jsx)(n.strong,{children:"Applies to"})," to ",(0,i.jsx)(n.em,{children:'"This key and subkeys'}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 7 \u2013"})," Click ",(0,i.jsx)(n.strong,{children:"Show advanced permissions"})," and select the following access types:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Set Value"}),"\n",(0,i.jsx)(n.li,{children:"Create Subkey"}),"\n",(0,i.jsx)(n.li,{children:"Delete"}),"\n",(0,i.jsx)(n.li,{children:"Write DAC"}),"\n",(0,i.jsx)(n.li,{children:"Write Owner"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Config_WS_AuditingEntry_2016",src:s(823846).A+"",width:"913",height:"590"})}),"\n",(0,i.jsxs)(n.p,{children:["Repeat the same steps for the ",(0,i.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SYSTEM"})," key."]}),"\n",(0,i.jsx)(n.p,{children:"Using Group Policy for configuring registry audit is not recommended, as registry DACL settings may be lost."})]})}function g(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);