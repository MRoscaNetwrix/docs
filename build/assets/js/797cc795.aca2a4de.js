"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[239605],{28453:(e,i,n)=>{n.d(i,{R:()=>o,x:()=>d});var s=n(296540);const t={},r=s.createContext(t);function o(e){const i=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:i},e.children)}},515924:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"auditor/configuration/fileservers/windows/overview","title":"Windows File Servers","description":"Netwrix Auditor relies on native logs for collecting audit data. Therefore, successful change and access auditing requires a certain configuration of native audit settings in the audited environment and on the Auditor console computer. Configuring your IT infrastructure may also include enabling certain built-in Windows services, etc. Proper audit configuration is required to ensure audit data integrity, otherwise your change reports may contain warnings, errors or incomplete audit data.","source":"@site/docs/auditor/auditor/configuration/fileservers/windows/overview.md","sourceDirName":"auditor/configuration/fileservers/windows","slug":"/auditor/configuration/fileservers/windows/overview","permalink":"/docs/auditor/auditor/configuration/fileservers/windows/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/fileservers/windows/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Configure Object-Level Access Auditing","permalink":"/docs/auditor/auditor/configuration/fileservers/windows/objectlevel"},"next":{"title":"Permissions for Windows File Server Auditing","permalink":"/docs/auditor/auditor/configuration/fileservers/windows/permissions"}}');var t=n(474848),r=n(28453);const o={},d="Windows File Servers",l={},a=[{value:"Configuration Overview",id:"configuration-overview",level:2},{value:"Configuration Steps",id:"configuration-steps",level:2},{value:"DFS-Related Constraints",id:"dfs-related-constraints",level:2},{value:"File Servers and Antivirus",id:"file-servers-and-antivirus",level:2},{value:"Monitored Objects",id:"monitored-objects",level:2}];function c(e){const i={a:"a",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"windows-file-servers",children:"Windows File Servers"})}),"\n",(0,t.jsx)(i.p,{children:"Netwrix Auditor relies on native logs for collecting audit data. Therefore, successful change and access auditing requires a certain configuration of native audit settings in the audited environment and on the Auditor console computer. Configuring your IT infrastructure may also include enabling certain built-in Windows services, etc. Proper audit configuration is required to ensure audit data integrity, otherwise your change reports may contain warnings, errors or incomplete audit data."}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"CAUTION:"})," Folder associated with Netwrix Auditor must be excluded from antivirus scanning. See the ",(0,t.jsx)(i.a,{href:"https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000HirCAE.html",children:"Antivirus Exclusions for Netwrix Auditor"})," knowledge base article for additional information."]}),"\n",(0,t.jsx)(i.h2,{id:"configuration-overview",children:"Configuration Overview"}),"\n",(0,t.jsx)(i.p,{children:"You can configure your\xa0IT Infrastructure for monitoring in one of the following ways:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Automatically through a monitoring plan \u2013 This is a recommended method. If you select to automatically configure audit in the target environment, your current audit settings will be checked on each data collection and adjusted if necessary."}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Manually \u2013 Native audit settings must be adjusted manually to ensure collecting comprehensive and reliable audit data. You can enable Auditor to continually enforce the relevant audit policies or configure them manually:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"On the Windows file server:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"For a security principal (e.g., Everyone), the following options must be configured in the Advanced Security > Auditing settings for the audited shared folders:"}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Advanced Security Option"}),(0,t.jsx)(i.th,{children:"Setting"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"List Folder / Read Data (Files only)"}),(0,t.jsx)(i.td,{children:'"Success" and "Fail"'})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"List Folder / Read Data (This folder, subfolders and files)"}),(0,t.jsx)(i.td,{children:'"Fail"'})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Create Files / Write Data*"}),(0,t.jsx)(i.td,{children:'"Success" and "Fail"'})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Create Folders / Append Data*"}),(0,t.jsx)(i.td,{children:'"Success" and "Fail"'})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Write Extended Attributes*"}),(0,t.jsx)(i.td,{children:'"Success" and "Fail"'})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Delete Subfolders and Files*"}),(0,t.jsx)(i.td,{children:'"Success" and "Fail"'})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Delete*"}),(0,t.jsx)(i.td,{children:'"Success" and "Fail"'})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Change Permissions*"}),(0,t.jsx)(i.td,{children:'"Success" and "Fail"'})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Take Ownership*"}),(0,t.jsx)(i.td,{children:'"Success" and "Fail"'})]})]})]}),"\n",(0,t.jsx)(i.p,{children:'* Select "Fail" only if you want to track failure events, it is not required for success events monitoring.'}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"NOTE:"}),' If you want to get only state-in-time snapshots of your system configuration, limit your settings to the permissions marked with * and set it to "Success" (Apply onto: This folder, subfolders and files).']}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"The following Advanced audit policy settings must be configured:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"The Audit: Force audit policy subcategory settings (Windows 7 or later) security option must be enabled."}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"NOTE:"})," If you want to get only state-in-time snapshots of your system configuration, limit your audit settings to the following policies:"]}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Advanced Audit Policy"}),(0,t.jsx)(i.th,{children:"Setting"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Object Access > Audit File Share"}),(0,t.jsx)(i.td,{children:'"Success"'})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Object Access > Audit Handle Manipulation"}),(0,t.jsx)(i.td,{children:'"Success"'})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Policy Change > Audit Audit Policy Change"}),(0,t.jsx)(i.td,{children:'"Success"'})]})]})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"The following legacy policies can be configured instead of advanced:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:'Audit object access policy must set to "Success" and "Failure."'}),"\n",(0,t.jsx)(i.li,{children:'Audit logon events policy must be set to "Success."'}),"\n",(0,t.jsx)(i.li,{children:'Audit system events policy must be set to "Success."'}),"\n",(0,t.jsx)(i.li,{children:'Audit policy change must be set to "Success."'}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["The  Security event log maximum size must be set to 4GB. The retention method of the Security event log must be set to ",(0,t.jsx)(i.em,{children:"\u201cOverwrite events as needed\u201d"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"The Remote Registry service must be started."}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"The following inbound Firewall rules must be enabled:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Remote Event Log Management (NP-In)*"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Remote Event Log Management (RPC)*"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Remote Event Log Management (RPC-EPMAP)*"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Windows Management Instrumentation (ASync-In)"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Windows Management Instrumentation (DCOM-In)"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Windows Management Instrumentation (WMI-In)"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Network Discovery (NB-Name-In)"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"File and Printer Sharing (NB-Name-In)"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"File and Printer Sharing (Echo Request - ICMPv4-In)"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"File and Printer Sharing (Echo Request - ICMPv6-In)"}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"NOTE:"})," The rules marked with * are required only if you do not want to use network traffic compression for auditing."]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"If you plan to audit Windows Server 2019 or Windows 10 Update 1803 without network compression service, make sure the following inbound connection rules are enabled:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Remote Scheduled Tasks Management (RPC)"}),"\n",(0,t.jsx)(i.li,{children:"Remote Scheduled Tasks Management (RPC-EMAP)"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"On the Auditor console computer:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"If your file shares contain symbolic links and you want to collect state-in-time data for these shares, the local-to-local, local-to-remote, remote-to-local, and remote-to-remote symbolic link evaluations must be enabled on the computer that hosts Auditor Server."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Consider the following:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"To collect data from 32-bit operating systems, network traffic compression must be disabled."}),"\n",(0,t.jsx)(i.li,{children:"To collect data from Windows Failover Cluster, network traffic compression must be enabled."}),"\n",(0,t.jsx)(i.li,{children:"Scale-Out File Server (SOFS) cluster is not supported."}),"\n",(0,t.jsxs)(i.li,{children:["Auditing of files and folders placed directly into the DFS namespace root is not supported, as such configuration is not recommended by Microsoft. (See the Microsoft ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/en-us/archive/blogs/askds/common-dfsn-configuration-mistakes-and-oversights#placing-files-directly-in-the-namespace-share",children:"Placing files directly in the namespace share"})," article for additional information.) Make sure the UNC path of a shared folder is placed within a share targeted by a DFS folder."]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"configuration-steps",children:"Configuration Steps"}),"\n",(0,t.jsx)(i.p,{children:"Follow the steps to configure Windows File Servers for auditing:"}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 1 \u2013"})," Check requirements. Make sure the Windows File Servers you want to monitor meet the requirements."]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 2 \u2013"})," Decide on audit data to collect."]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Review the list of objects and attributes that can be monitored by Auditor: See the ",(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/fileservers/overview",children:"File Servers"}),"topic for additional information."]}),"\n",(0,t.jsx)(i.li,{children:"Plan for the file servers and shares you want to audit:"}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"If you have multiple file shares frequently accessed by a significant number of users, it is reasonable to audit object changes only. Tracking all events may result in too much data written to the audit logs, whereas only some part of it may be of any interest."}),"\n",(0,t.jsx)(i.li,{children:"Audit flags must be set on every file share you want to audit."}),"\n",(0,t.jsx)(i.li,{children:"If your file shares are stored within one folder (or disk drive), you can configure audit settings for this folder only. As a result, you will receive reports on all required access types applied to all file shares within this folder. It is not recommended to configure audit settings for system disks."}),"\n",(0,t.jsx)(i.li,{children:"By default, Auditor will monitor all shares stored in the specified location, except for hidden shares (both default and user-defined). If you want to monitor user-defined hidden shares, select the related option in the monitored item settings."}),"\n",(0,t.jsxs)(i.li,{children:["Administrative hidden shares like default system root or Windows directory (",(0,t.jsx)(i.em,{children:"ADMIN$"}),"), default drive shares (",(0,t.jsx)(i.em,{children:"D$, E$"}),"), etc. will not be monitored."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 3 \u2013"})," Review considerations and limitations:"]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"The following considerations and limitations refer to data collection:"})}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"To collect data from 32-bit operating systems, network traffic compression must be disabled."}),"\n",(0,t.jsx)(i.li,{children:"To collect data from Windows Failover Cluster, network traffic compression must be enabled."}),"\n",(0,t.jsx)(i.li,{children:"Scale-Out File Server (SOFS) cluster is not supported."}),"\n",(0,t.jsxs)(i.li,{children:["Several constraints apply to DFS auditing. See the ",(0,t.jsx)(i.a,{href:"#DFS-Related-Constraints",children:"DFS-Related Constraints"})," topic for additional information."]}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"The following considerations and limitations refer to reporting:"})}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"In the reports and search results, in some cases, Auditor displays not the actual time when the event occurred but data collection time."}),"\n",(0,t.jsxs)(i.li,{children:["Auditor may report on several unexpected changes with ",(0,t.jsx)(i.em,{children:"who"})," (initiator's account) reported as ",(0,t.jsx)(i.em,{children:"system"})," due to the native Windows File Servers audit peculiarities. If you do not want to see these changes, exclude them from the audit. See the ",(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/fileservers/overview",children:"File Servers"})," topic for additional information. For example - mass file removals, when target Windows server generates too many events at a time and the product is unable to parse their sequences correctly."]}),"\n",(0,t.jsxs)(i.li,{children:["Due to Windows limitations, the ",(0,t.jsx)(i.em,{children:"copy/rename/move"})," actions on remote file shares may be reported as two sequential actions: copying \u2013 as adding a new file and reading the initial file; renaming/moving \u2013 as removing the initial file and adding a new file with the same name."]}),"\n",(0,t.jsxs)(i.li,{children:["To report on ",(0,t.jsx)(i.em,{children:"copy"})," actions on remote file shares, make sure that audit of successful read operations is enabled. See the ",(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/fileservers/windows/objectlevel",children:"Configure Object-Level Access Auditing"})," topic for additional information."]}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 4 \u2013"})," Apply required audit settings."]}),"\n",(0,t.jsx)(i.p,{children:"Depending on your auditing requirements, you may need to audit your file server objects for:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Successful read attempts"}),"\n",(0,t.jsx)(i.li,{children:"Successful modifications"}),"\n",(0,t.jsx)(i.li,{children:"Failed read and modification attempts"}),"\n",(0,t.jsx)(i.li,{children:"Failed modification attempts"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"For that, object-level audit settings and appropriate audit policies should be set up. Besides, the following should be configured for your Windows file servers:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Windows Event log size and retention settings"}),"\n",(0,t.jsx)(i.li,{children:"Remote registry service"}),"\n",(0,t.jsx)(i.li,{children:"Inbound connection rules for Windows firewall"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"You can apply required audit settings to your Windows file servers in one of the following ways:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Automatically"})," when creating a monitoring plan."]}),"\n",(0,t.jsxs)(i.p,{children:["In this case, the audit settings will be applied automatically, then they will be periodically checked and adjusted if necessary. See the ",(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/admin/monitoringplans/create",children:"Create a New Monitoring Plan"})," topic for additional information."]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Manually."})," To configure your Windows File Servers for monitoring manually, perform the following procedures:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/fileservers/windows/objectlevel",children:"Configure Object-Level Access Auditing"})}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/fileservers/windows/localpolicy",children:"Configure Local Audit Policies"})," or ",(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/fileservers/windows/advancedpolicy",children:"Configure Advanced Audit Policies"})]}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/fileservers/windows/eventlog",children:"Configure Event Log Size and Retention Settings"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/fileservers/windows/remoteregistryservice",children:"Enable Remote Registry Service"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/fileservers/windows/ports",children:"Windows File Server Ports"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"With automatically applied settings, initial SACL configuration for DFS replication links may take longer than with manual configuration \u2014 however, automatic configuration will help to minimize the impact on the DFS backlog and replication process in general."}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 5 \u2013"})," Configure Data Collecting Account. See the ",(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/admin/monitoringplans/dataaccounts",children:"Data Collecting Account"})," topic for additional information."]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 6 \u2013"})," Configure required protocols and ports. Set up protocols and ports. See the ",(0,t.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/fileservers/delldatastorage/ports",children:"Dell Data Storage Ports"})," topic for additional information."]}),"\n",(0,t.jsx)(i.h2,{id:"dfs-related-constraints",children:"DFS-Related Constraints"}),"\n",(0,t.jsx)(i.p,{children:"Perform the following steps if planning to audit DFS files and folders:"}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 1 \u2013"})," Auditor supports auditing of DFS and clustered file servers if Object Access Auditing is enabled on DFS file shares or on every cluster node."]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 2 \u2013"})," When adding a cluster file server for auditing, it is recommended to specify a server name of the ",(0,t.jsx)(i.strong,{children:"Role"})," server or a UNC path of the shared folder located on the ",(0,t.jsx)(i.strong,{children:"Role"})," server."]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Step 3 \u2013"}),"  When adding a DFS file share for auditing, specify a Windows file share item and provide the UNC path of the whole namespace or UNC path of the DFS link (folder). For example:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.em,{children:'"\\domain\\dfsnamespace"'})," (domain-based namespace)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.em,{children:'"\\server\\dfsnamespace"'})," (in case of stand-alone namespace);"]}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["Auditing of files and folders placed directly into the DFS namespace root is not supported, as such configuration is not recommended by Microsoft. See the ",(0,t.jsx)(i.a,{href:"https://docs.microsoft.com/en-us/archive/blogs/askds/common-dfsn-configuration-mistakes-and-oversights#placing-files-directly-in-the-namespace-share",children:"Placing files directly in the namespace share"})," section of the Microsoft article for additional information. Make sure the UNC path of a shared folder is placed within a share targeted by a DFS folder."]}),"\n",(0,t.jsxs)(i.p,{children:["For recommendations on configuring DFS replication, refer to the following Netwrix knowledge base article: ",(0,t.jsx)(i.a,{href:"https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA00g000000H9SyCAK.html",children:"Why did loss of performance occur when configuring audit settings for Windows File Servers?"}),". Remember that replication of namespace roots is not supported."]}),"\n",(0,t.jsx)(i.h2,{id:"file-servers-and-antivirus",children:"File Servers and Antivirus"}),"\n",(0,t.jsx)(i.p,{children:"It is strongly recommended that you add the following executables to the list of exclusions for your antivirus:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"C:\\Windows\\SysWOW64\\NwxExeSvc\\NwxExeSvc.exe"}),"\n",(0,t.jsx)(i.li,{children:"C:\\Windows\\SysWOW64\\NwxExeSvc\\NwxEventCollectorAgent.exe"}),"\n",(0,t.jsx)(i.li,{children:"C:\\Windows\\SysWOW64\\NwxExeSvc\\NwxFsAgent.exe"}),"\n",(0,t.jsx)(i.li,{children:"C:\\Windows\\SysWOW64\\NwxExeSvc\\NwxSaclTunerAgent.exe"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Otherwise, significant delays and performance issues may occur while collecting data."}),"\n",(0,t.jsx)(i.p,{children:"This happens because these executables access a large number of file server objects (files, folders), fetching audit data \u2014 and your antivirus may treat this as a suspicious behavior."}),"\n",(0,t.jsx)(i.p,{children:"For some antiviruses (for example, Trend Micro) you may need to specify the folders to exclude, that is, __C:\\Windows\\SysWOW64\\NwxExeSvc__. Refer to your antivirus documentation for details."}),"\n",(0,t.jsx)(i.h2,{id:"monitored-objects",children:"Monitored Objects"}),"\n",(0,t.jsx)(i.p,{children:"The following table lists the actions that can be performed with Windows-Based File Shares:"}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{}),(0,t.jsx)(i.th,{children:"File"}),(0,t.jsx)(i.th,{children:"Folder"}),(0,t.jsx)(i.th,{children:"Share"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Added"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Add (failed attempt)"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"\u2013"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Modified"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Modify (failed attempt)"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Moved"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"\u2013"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Move (failed attempt)"}),(0,t.jsx)(i.td,{children:"\u2013"}),(0,t.jsx)(i.td,{children:"\u2013"}),(0,t.jsx)(i.td,{children:"\u2013"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Read"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"\u2013"}),(0,t.jsx)(i.td,{children:"\u2013"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Read (failed attempt)"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Renamed"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"\u2013"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Renamed (failed attempt)"}),(0,t.jsx)(i.td,{children:"\u2013"}),(0,t.jsx)(i.td,{children:"\u2013"}),(0,t.jsx)(i.td,{children:"\u2013"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Removed"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Remove (failed attempt)"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"\u2013"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Copied"}),(0,t.jsx)(i.td,{children:"+"}),(0,t.jsx)(i.td,{children:"\u2013"}),(0,t.jsx)(i.td,{children:"\u2013"})]})]})]})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);