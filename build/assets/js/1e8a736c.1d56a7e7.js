"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3119],{28453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>c});var s=i(296540);const n={},r=s.createContext(n);function o(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(r.Provider,{value:t},e.children)}},199551:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"activitymonitor/restapi/security","title":"Security and Access Control","description":"Security","source":"@site/docs/activitymonitor/activitymonitor/restapi/security.md","sourceDirName":"activitymonitor/restapi","slug":"/activitymonitor/restapi/security","permalink":"/docs/activitymonitor/activitymonitor/restapi/security","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/activitymonitor/activitymonitor/restapi/security.md","tags":[],"version":"current","frontMatter":{},"sidebar":"activityMonitorSidebar","previous":{"title":"Schema and Resources","permalink":"/docs/activitymonitor/activitymonitor/restapi/resources"},"next":{"title":"SIEM Integrations","permalink":"/docs/activitymonitor/activitymonitor/siem/overview"}}');var n=i(474848),r=i(28453);const o={},c="Security and Access Control",d={},a=[{value:"Security",id:"security",level:2},{value:"Authentication",id:"authentication",level:3},{value:"Authorization",id:"authorization",level:3}];function l(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"security-and-access-control",children:"Security and Access Control"})}),"\n",(0,n.jsx)(t.h2,{id:"security",children:"Security"}),"\n",(0,n.jsx)(t.p,{children:"The REST-style API is exposed via TLS v1.2, with a self-signed certificate by default. The port is customizable, 4494 by default. The IP whitelist can be used to restrict access to the port."}),"\n",(0,n.jsx)(t.p,{children:"You can use the Activity Monitor Console to allow applications to access the API, change permissions, or revoke access. The console generates unique Client ID and Secret for each application."}),"\n",(0,n.jsx)(t.h3,{id:"authentication",children:"Authentication"}),"\n",(0,n.jsxs)(t.p,{children:["OAuth 2.0 client-credentials grant is used for authentication. A pair of Client ID and Secret are used to obtain an access token from the access token URL: ",(0,n.jsx)(t.code,{children:"https://localhost:4494/api/v1/token"}),".\nToken expiration intervals are not configurable."]}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Type"}),(0,n.jsx)(t.th,{children:"Expires in"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Client Secret"}),(0,n.jsx)(t.td,{children:"72 hours"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Access Token"}),(0,n.jsx)(t.td,{children:"7 days"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Refresh Token"}),(0,n.jsx)(t.td,{children:"never"})]})]})]}),"\n",(0,n.jsx)(t.p,{children:"It is considered a best practice to use short expiration periods for OAuth 2.0 tokens, like 1 hour for the access token. A shorter period allows you to revoke the access quicker if needed.\nIn case of Activity Monitor, the Agent is both the authentication server and the resource server. Therefore, it can validate the token on each and every access to a resource. So, for Activity Monitor long expiration periods do not make the protocol less secure."}),"\n",(0,n.jsxs)(t.p,{children:["A client is expected to pass the access token in the ",(0,n.jsx)(t.code,{children:"Authorization"})," request header."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"NOTE:"})," ",(0,n.jsx)(t.strong,{children:"Use a client library that is secure and fully implements the OAuth 2.0 protocol."})," The sample below shows just a piece of OAuth 2 interaction."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:'curl -X POST -d "client_id=<CLIENT_ID>&client_secret=<CLIENT_SECRET>&grant_type=client_credentials" https://<AGENT_SERVER>:4494/api/v1/token --insecure  \n{"access_token":"AQAAANCMnd8BFdERjHoAwE_Cl-sBAAAAZpRDOzeUzUikVK9ydmsV1QAAAAACAAAAAAAQZgAAAAEAACAAAAAFzYG4Tasvowq939pou5ADE883Ns2DV-X6_S20RMDcwAAAAAAOgAAAAAIAACAAAAB1IcZrZavgp2Ab63P  \n8kbCr7NwopOsfz0SeSaXjKVhVC-AAAACix_0klwXoiwiqTZTlaUXCqn9MkquZC84ew9E0-E_vu6FNJ6NDLj7MGCPR-mCi4MRmwr6TYtZ_XfAXRtSh66gbABv-gTnmimruLRWxN2is5twUl563kGpHqnbKydqPNgOy4gXxgR_V08kFut2qPxZ  \nLsN14yK8Prp1paaQy4-mhONaFIrVx7bOmVIdfVnjEYjwIRdd9QjQEY3wJtnDIEBWi2s-6uYo8tcCEztPiraBpLJC3Tib8NQYu_YxwbzeRun_h2KZOMewLzkfZGS2h9SvvnlxECQ0G5PEfslnAEwC7VEAAAAAxZTm06tyRQNMbw_bLr4FiZi0  \ny-QipaafBBRtm83q-l6bG9bQ-C1Hr19-0H6KgzDb3_JJWxxNmGdD-wG95wjlD","token_type":"bearer","expires_in":604799,"refresh_token":"AQAAANCMnd8BFdERjHoAwE_Cl-sBAAAAZpRDOzeUzUikVK9ydmsV1QAAAA  \nACAAAAAAAQZgAAAAEAACAAAAAocNSP3GFuJ0RK_1dsX5uSR4dmiqzhV7-LYhc9sYbF2gAAAAAOgAAAAAIAACAAAABQuudDm06II62U6vM2u9CczyRa1siP-H3WfP6iDYOmh-AAAADjzqzTweG14Gngd68rC3BX4GA4kBR5FA8JVVly3KHUS2  \nQ-SD9q4S9C3yLZxv2k_zGr2YA_bVdfZ78vRCUYC3QgbpJTjzYPWnPNW5RsqLLtd47h6THU5Wc0RkoBG4c8gB569Jvl0WkAG3xJFHitbUQISYbSosd-cIW4JZkHzcT3zkPgAtLkNyhqQd1g1jgCzP63MCAFq1AN2NB2wLCk_jNRi8aypxR1Ty  \nF5HpSlZ6QzVNycMNeckayAEOCAUAXwx_tBVhqvUwn7YEF_bT2WYoW9boU_IUzWKtO8R5MXsVR6aEAAAAATVk3stUcghjkgv6abuLddE9Hf2S0o9Gpmp4UPallX6dIbAvm10f-De1aTU-jG7LJMdAv2PKVyuGiyUzI-DE0K"}  \n\n'})}),"\n",(0,n.jsx)(t.h3,{id:"authorization",children:"Authorization"}),"\n",(0,n.jsx)(t.p,{children:"A user assigns permissions to a client application. Permissions can be combined."}),"\n",(0,n.jsx)(t.p,{children:"Activity Monitor8.0 permissions:"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Permission"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Access activity data"}),(0,n.jsx)(t.td,{children:"Provides minimal access rights to list and download the log files."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Read"}),(0,n.jsx)(t.td,{children:"Read-only access to all the information about all agents, domains, and hosts. Does not allow one to download the log files."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Policy change"}),(0,n.jsx)(t.td,{children:"Add, modify, and delete the AD monitoring policies."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Modify host"}),(0,n.jsx)(t.td,{children:"Add, modify, enable, disable, and delete Hosts and their Outputs."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Modify agent"}),(0,n.jsx)(t.td,{children:"Add, modify, and delete agents."})]})]})]}),"\n",(0,n.jsxs)(t.p,{children:["An unauthorized request fails with ",(0,n.jsx)(t.code,{children:"404 Not Found"})," (instead of ",(0,n.jsx)(t.code,{children:"403 Forbidden"}),") when the resource is specified explicitly, by ID. For collections, the API Server removes unauthorized resources from results."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"Access activity data"}),' is special. It provides limited information only about the agent which hosts the API server, limited monitored domain information, limited monitored hosts information, and outputs - just enough to get information about the log files. See "Detailed Only" column in the next section for the list of attributes not included into the limited information.']}),"\n",(0,n.jsx)(t.p,{children:"Here is how the permissions affect the returned resources:"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Permission\\Resource"}),(0,n.jsx)(t.th,{children:"Agent"}),(0,n.jsx)(t.th,{children:"Host"}),(0,n.jsx)(t.th,{children:"Domain"}),(0,n.jsx)(t.th,{children:"Output"}),(0,n.jsx)(t.th,{children:"Policy"}),(0,n.jsx)(t.th,{children:"Log File"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Read"}),(0,n.jsx)(t.td,{children:"All agents, all info"}),(0,n.jsx)(t.td,{children:"All hosts, all info"}),(0,n.jsx)(t.td,{children:"All domains, all info"}),(0,n.jsx)(t.td,{children:"All"}),(0,n.jsx)(t.td,{children:"All"}),(0,n.jsx)(t.td,{children:"None"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Access activity data"}),(0,n.jsx)(t.td,{children:"Only this agent. Limited info."}),(0,n.jsx)(t.td,{children:"This agent's hosts only. Limited info."}),(0,n.jsx)(t.td,{children:"This agent's domain only. Limited info."}),(0,n.jsx)(t.td,{children:"Outputs of this agent's hosts and domain"}),(0,n.jsx)(t.td,{children:"None"}),(0,n.jsx)(t.td,{children:"All files of this agent"})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}}}]);