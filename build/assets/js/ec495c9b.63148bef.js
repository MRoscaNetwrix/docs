"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[712979],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var r=s(296540);const t={},i=r.createContext(t);function a(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(i.Provider,{value:n},e.children)}},237663:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/registryinclusion-401a58c96e4ebcbf48fccb1b52bbf184.webp"},307664:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"changetracker/admin/matchrules/registryrules","title":"Registry Inclusion/Exclusion Match Rules","description":"Similar to Folder/File Match Rules, Registry Key/Value Match Rules can be defined and used to precisely track only keys and values of interest.","source":"@site/docs/changetracker/changetracker/admin/matchrules/registryrules.md","sourceDirName":"changetracker/admin/matchrules","slug":"/changetracker/admin/matchrules/registryrules","permalink":"/docs/changetracker/changetracker/admin/matchrules/registryrules","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/changetracker/changetracker/admin/matchrules/registryrules.md","tags":[],"version":"current","frontMatter":{},"sidebar":"changeTrackerSidebar","previous":{"title":"Match Rules Overview","permalink":"/docs/changetracker/changetracker/admin/matchrules/matchrulesoverview"},"next":{"title":"Administration","permalink":"/docs/changetracker/changetracker/admin/overview"}}');var t=s(474848),i=s(28453);const a={},l="Registry Inclusion/Exclusion Match Rules",c={},o=[];function d(e){const n={code:"code",h1:"h1",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"registry-inclusionexclusion-match-rules",children:"Registry Inclusion/Exclusion Match Rules"})}),"\n",(0,t.jsxs)(n.p,{children:["Similar to ",(0,t.jsx)(n.strong,{children:"Folder/File Match Rules"}),", ",(0,t.jsx)(n.strong,{children:"Registry Key/Value Match Rules"})," can be defined and used to precisely track only keys and values of interest."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"For example"}),", tracking the '",(0,t.jsx)(n.strong,{children:"WinLogon"}),"' registry key and values is important because there are a number of session management security controls defined in this key. However, in certain environments, the 'DCacheUpdate' values may change causing spurious alerts that are not significant from a security perspective (DCacheUpdate stores domain names in binary form for internal Winlogon programming code to use). Therefore the ability to easily track all keys and values below the Winlogon key, but exclude DCacheUpdate changes may be desirable."]}),"\n",(0,t.jsxs)(n.p,{children:["The '",(0,t.jsx)(n.strong,{children:"All Registry Values"}),"' Match Rule is available by default but to define the 'Isolate DCacheUpdate Value Changes' exclusion, the following Custom PathMatch Definition would be added:"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"RegistryInclusion",src:s(237663).A+"",width:"992",height:"246"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 1 \u2013"})," ",(0,t.jsx)(n.strong,{children:"KeyMatchType"})," - Available options are:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"All;"}),"\n",(0,t.jsx)(n.li,{children:"Exact;"}),"\n",(0,t.jsx)(n.li,{children:"Wildcards;"}),"\n",(0,t.jsx)(n.li,{children:"Regex."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 2 \u2013"})," ",(0,t.jsx)(n.strong,{children:"KeyMatchExpression"}),". Available options are:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["If using '",(0,t.jsx)(n.strong,{children:"All"}),'\', then use "";']}),"\n",(0,t.jsxs)(n.li,{children:["If using '",(0,t.jsx)(n.strong,{children:"Exact"}),'\', then specify an exact "keyname";']}),"\n",(0,t.jsxs)(n.li,{children:["If using '",(0,t.jsx)(n.strong,{children:"Wildcards"}),'\', then specify a separated wildcards list eg "key_abc*|key_def*";']}),"\n",(0,t.jsxs)(n.li,{children:["If using '",(0,t.jsx)(n.strong,{children:"Regex"}),"', then specify a regular expression eg ",(0,t.jsx)(n.code,{children:'"^S-1-5-21-[0-9]+-[0-9]+-[0-9]+-[0-9]{4,}\\\\Software\\\\Policies\\\\Microsoft\\\\Windows\\\\Control Panel\\\\Desktop"'}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 3 \u2013"})," ValueMatchType. oAvailable options are",":ptions"," the same as for the 'foldermatchtype' (All|Exact|Wildcards|Regex)."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 4 \u2013"})," ",(0,t.jsx)(n.strong,{children:"ValueMatchExpression"})," \u2013 Available options are:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["If using '",(0,t.jsx)(n.strong,{children:"All"}),'\', then use "";']}),"\n",(0,t.jsxs)(n.li,{children:["If using '",(0,t.jsx)(n.strong,{children:"Exact"}),'\', then specify an exact "filename";']}),"\n",(0,t.jsxs)(n.li,{children:["If using '",(0,t.jsx)(n.strong,{children:"Wildcards"}),'\', then specify a separated wildcards list eg "*.exe|*.dll";']}),"\n",(0,t.jsxs)(n.li,{children:["If using '",(0,t.jsx)(n.strong,{children:"Regex"}),'\', then specify a regular expression eg "^audit[0-9]*.(log|txt)$".']}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 5 \u2013"})," ",(0,t.jsx)(n.strong,{children:"SkipRootKey"})," \u2013 Available options are: ",(0,t.jsx)(n.strong,{children:"true"})," or ",(0,t.jsx)(n.strong,{children:"false"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 6 \u2013"})," ",(0,t.jsx)(n.strong,{children:"Subkey Recursion"}),". Available options are:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Unlimited;"}),"\n",(0,t.jsx)(n.li,{children:"None (operate on specified folder only);"}),"\n",(0,t.jsx)(n.li,{children:'"n" = recurse through 1, 2 or 3 subfolders.'}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);