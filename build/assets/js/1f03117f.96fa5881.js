"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[998136],{28453:(e,r,s)=>{s.d(r,{R:()=>n,x:()=>a});var o=s(296540);const t={},i=o.createContext(t);function n(e){const r=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:n(e.components),o.createElement(i.Provider,{value:r},e.children)}},548749:(e,r,s)=>{s.d(r,{A:()=>o});const o=s.p+"assets/images/cpasswordquery-19ae032c7ee683e02899cad8b8123e32.webp"},844643:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>n,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"enterpriseauditor/solutions/activedirectory/grouppolicy/ad_cpassword","title":"AD\\\\_CPassword Job","description":"The AD\\\\CPassword Job identifies passwords that are stored in Group Policy Preferences which present a security risk allowing attackers access to these passwords. Microsoft published the AES private key, which can be used to decrypt passwords stored in Group Policy Preferences. See the Microsoft 2.2.1.1.4 Password Encryption article for additional information. Since Authenticated Users have read access to SYSVOL, any malicious insider or attacker can search for the cPassword file inside XML files shared through SYSVOL to decrypt them. GPOs can be stored in the `%ProgramData%\\\\Microsoft\\\\Group Policy\\\\History` folder on each machine, meaning any results found by this job should be deleted off every computer once this policy has been removed.","source":"@site/docs/accessanalyzer/enterpriseauditor/solutions/activedirectory/grouppolicy/ad_cpassword.md","sourceDirName":"enterpriseauditor/solutions/activedirectory/grouppolicy","slug":"/enterpriseauditor/solutions/activedirectory/grouppolicy/ad_cpassword","permalink":"/docs/accessanalyzer/enterpriseauditor/solutions/activedirectory/grouppolicy/ad_cpassword","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/enterpriseauditor/solutions/activedirectory/grouppolicy/ad_cpassword.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"Recommended Configurations for the 5.Domains Job Group","permalink":"/docs/accessanalyzer/enterpriseauditor/solutions/activedirectory/domains/recommended"},"next":{"title":"AD\\\\_GroupPolicy Job","permalink":"/docs/accessanalyzer/enterpriseauditor/solutions/activedirectory/grouppolicy/ad_grouppolicy"}}');var t=s(474848),i=s(28453);const n={},a="AD_CPassword Job",c={},d=[{value:"Query for the AD_CPassword Job",id:"query-for-the-ad_cpassword-job",level:2}];function l(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"ad_cpassword-job",children:"AD_CPassword Job"})}),"\n",(0,t.jsxs)(r.p,{children:["The AD_CPassword Job identifies passwords that are stored in Group Policy Preferences which present a security risk allowing attackers access to these passwords. Microsoft published the AES private key, which can be used to decrypt passwords stored in Group Policy Preferences. See the Microsoft ",(0,t.jsx)(r.a,{href:"https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be",children:"2.2.1.1.4 Password Encryption"})," article for additional information. Since Authenticated Users have read access to SYSVOL, any malicious insider or attacker can search for the cPassword file inside XML files shared through SYSVOL to decrypt them. GPOs can be stored in the ",(0,t.jsx)(r.code,{children:"%ProgramData%\\Microsoft\\Group Policy\\History"})," folder on each machine, meaning any results found by this job should be deleted off every computer once this policy has been removed."]}),"\n",(0,t.jsx)(r.h2,{id:"query-for-the-ad_cpassword-job",children:"Query for the AD_CPassword Job"}),"\n",(0,t.jsx)(r.p,{children:"The AD_CPassword Job uses the PowerShell Data Collector for the following query:"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"CAUTION:"})," Do not modify the query. The query is preconfigured for this job"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"Query for the AD_CPassword Job",src:s(548749).A+"",width:"720",height:"237"})}),"\n",(0,t.jsx)(r.p,{children:"The queries for this job are:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:"Sysvol \u2013 Targets one domain controller per domain known to Access Analyzer to determine CPassword security"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["See the ",(0,t.jsx)(r.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/powershell/overview",children:"PowerShell Data Collector"})," topic for additional information."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:"In addition to the tables created by the data collector, the AD_CPassword Job produces the following pre-configured report:"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Report"}),(0,t.jsx)(r.th,{children:"Description"}),(0,t.jsx)(r.th,{children:"Default Tags"}),(0,t.jsx)(r.th,{children:"Report Elements"})]})}),(0,t.jsx)(r.tbody,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Potential Plaintext Passwords"}),(0,t.jsx)(r.td,{children:"This report highlights domain contollers where this vulnerability exists, and provides the path of the XML file in question."}),(0,t.jsx)(r.td,{children:"None"}),(0,t.jsx)(r.td,{children:"This report is comprised of one elements:   - Table \u2013 Provides details on potential plaintext passwords"})]})})]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}}}]);