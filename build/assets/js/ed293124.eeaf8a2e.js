"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[615521],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var r=s(296540);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}},758421:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"enterpriseauditor/requirements/solutions/exchange/remoteconnections","title":"Exchange Remote Connections Permissions","description":"The SMARTLog Data Collector processes the IIS Logs on the server running the Client Access Service (CAS) to return information about the remote connections being made to Exchange. This data collector uses an applet to process and collect the IIS Logs.","source":"@site/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/remoteconnections.md","sourceDirName":"enterpriseauditor/requirements/solutions/exchange","slug":"/enterpriseauditor/requirements/solutions/exchange/remoteconnections","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/remoteconnections","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/remoteconnections.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"Exchange PowerShell Permissions","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/powershell"},"next":{"title":"Exchange Support and Permissions Explained","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/support"}}');var t=s(474848),i=s(28453);const o={},c="Exchange Remote Connections Permissions",l={},a=[];function h(e){const n={a:"a",code:"code",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"exchange-remote-connections-permissions",children:"Exchange Remote Connections Permissions"})}),"\n",(0,t.jsx)(n.p,{children:"The SMARTLog Data Collector processes the IIS Logs on the server running the Client Access Service (CAS) to return information about the remote connections being made to Exchange. This data collector uses an applet to process and collect the IIS Logs."}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsx)(n.li,{children:"CAS Metrics Job Group Requirement"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"In addition to the permissions required by the SMARTLog Data Collector, the Connection Profile assigned to the 2. CAS Metrics Job Group requires the following permissions and User Rights (based on default settings):"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Member of the local Administrator group on the targeted Exchange server(s) where the Client Access Service is running"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Log on as a Service Group Policy:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Go to ",(0,t.jsx)(n.code,{children:"GPedit.msc"})]}),"\n",(0,t.jsx)(n.li,{children:"Go to Computer Configuration > Windows Settings > Security Settings > Local Policies > User Rights"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Permissions required by the ExchangePS Data Collector. See the ",(0,t.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/powershell",children:"Exchange PowerShell Permissions"})," topic for additional information."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Applet Permissions"}),"\n",(0,t.jsx)(n.p,{children:"This is required because the SMARTLog Data Collector is an applet-based data collector. It requires the following permission on the target host which contain the IIS Logs:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Member of the local Administrators group"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This grants the ability to process logs folder which will contain the applet files and logs. For example:"}),"\n",(0,t.jsx)(n.p,{children:"\\ExchangeServerName\\c$\\Program Files (x86)\\STEALTHbits\\StealthAUDIT\\LogProcessor"}),"\n",(0,t.jsx)(n.p,{children:"If there have been additional security or permission modifications on the server(s), the following rights and policies may need to be enabled on the targeted host:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Ensure the Administrator group has been granted Full Control over IIS Log Directories"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["WMI Control (",(0,t.jsx)(n.code,{children:"wmimgmt.msc"}),") > Right Click Properties > Security"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Security Tab > Root > CIMV2 > Click Security"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Ensure the Administrators group has been assigned:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Execute Methods"}),"\n",(0,t.jsx)(n.li,{children:"Remote Enable"}),"\n",(0,t.jsx)(n.li,{children:"Enable Account"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Local Security Policy (",(0,t.jsx)(n.code,{children:"secpol.msc"}),"):"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Local Policies > User Rights Assignment:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Ensure the \u2018Replace a Process Level Token\u2019 right grants access to Local Service, Network Service, and Administrators"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Ensure the \u2018Adjust Memory Quotas for a Process\u2019 right grants access to Local Service, Network Service, and Administrators"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Ensure the \u2018Impersonate a client after authentication\u2019 right grants access to Local Service and Administrators"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Ensure the Administrators group has been granted the following rights:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Access this computer from a network"}),"\n",(0,t.jsx)(n.li,{children:"Allow Log on Locally"}),"\n",(0,t.jsx)(n.li,{children:"Log on as a batch job"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);