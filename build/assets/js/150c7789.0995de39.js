"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[37293],{28453:(e,t,i)=>{i.d(t,{R:()=>l,x:()=>o});var n=i(296540);const s={},a=n.createContext(s);function l(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),n.createElement(a.Provider,{value:t},e.children)}},28660:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/451_3_image-20200210223130-2_950x592-7e4f5fe4ceaaf48deafce0b436c8aa6f.webp"},119912:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/451_19_image-20200210223130-10_950x266-a57dbdf84ac5ad5bcdd3fd60d1eab63f.webp"},275774:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/451_15_image-20200210223130-8-c632f0d6a35cade86374d0a46ea5fb7d.webp"},383163:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/451_7_image-20200210223130-4-40c46d56e21ea9d8fe3d339df0d17dfb.webp"},616695:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/451_17_image-20200210223130-9-a039f24bedfe3d732dd5730a1b021794.webp"},785184:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>r,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"policypak/leastprivilege/elevate/applicationextension","title":"How to Elevate applications with a .application extension using Least Privilege Manager","description":"Method 1 (Recommended): Elevating the underlying .EXE","source":"@site/docs/policypak/policypak/leastprivilege/elevate/applicationextension.md","sourceDirName":"policypak/leastprivilege/elevate","slug":"/policypak/leastprivilege/elevate/applicationextension","permalink":"/docs/policypak/policypak/leastprivilege/elevate/applicationextension","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/leastprivilege/elevate/applicationextension.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"How can I make all files in a folder, or all files in all recursive folders Elevated, Blocked, or Allow & Log?","permalink":"/docs/policypak/policypak/leastprivilege/elevate/allfiles"},"next":{"title":"Elevating COM / CSLID Class Items","permalink":"/docs/policypak/policypak/leastprivilege/elevate/com_cslidclass"}}');var s=i(474848),a=i(28453);const l={},o="How to Elevate applications with a .application extension using Least Privilege Manager",r={},c=[];function d(e){const t={a:"a",code:"code",h1:"h1",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"how-to-elevate-applications-with-a-application-extension-using-least-privilege-manager",children:"How to Elevate applications with a .application extension using Least Privilege Manager"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Method 1 (Recommended): Elevating the underlying .EXE"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 1 \u2013"})," Look in the Netwrix Endpoint Policy Manager (formerly PolicyPak) Event log for the blocked event to findthe name of the EXE being blocked."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"451_1_image-20200210223130-1_950x326",src:i(914294).A+"",width:"950",height:"326"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 2 \u2013"})," Create an EXE elevation combo rule in Least Privilege Manager for the EXE being blocked."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"451_3_image-20200210223130-2_950x592",src:i(28660).A+"",width:"950",height:"592"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"NOTE:"}),"  The more conditions evaluated, the more secure the rule will be. See this video for more details: ",(0,s.jsx)(t.a,{href:"/docs/policypak/policypak/video/leastprivilege/bestpractices/elevatinguserbasedinstalls",children:"Best Practices for Elevating User-Based Installs"})]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 3 \u2013"})," Apply the policy and then verify using the Endpoint Policy Manager event log of the application being Elevated."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"451_5_image-20200210223130-3_950x270",src:i(860260).A+"",width:"950",height:"270"})}),"\n",(0,s.jsx)(t.p,{children:"Method 2: Elevating RUNDLL32.exe and the .APPLICATION exactly"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 1 \u2013"})," Immediately after receiving the BLOCKED message (launch the application again if needed), look in the Least Privilege Manager Log ",(0,s.jsx)(t.code,{children:"PPService.log"}),", which can be found here by default:"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"%programdata%\\PolicyPak\\PolicyPak Least Privilege Manager\\ppService.log"})," (i.e. ",(0,s.jsx)(t.code,{children:"C:\\ProgramData\\PolicyPak\\PolicyPak Least Privilege Manager\\ppService.log"}),")"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"451_7_image-20200210223130-4",src:i(383163).A+"",width:"514",height:"263"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"NOTE:"}),"  The reason to look immediately in the log is so that we know which ppservice().log file to look in, ppservice.log is the latest log, and ppservice(n).log files are the rolled over logs."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 2 \u2013"}),' Open the ppservice.log in notepad (or any text editor) and scroll all the way to the bottom. Start searching from the bottom upwards for the text ".application".']}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"451_9_image-20200210223130-5",src:i(898450).A+"",width:"614",height:"422"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 3 \u2013"})," What we are looking for is the entire command-line used to launch the .application. See below for example:"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"451_11_image-20200210223130-6",src:i(839308).A+"",width:"890",height:"288"})}),"\n",(0,s.jsx)(t.p,{children:"Using the example above\xa0our entire command-line would be:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'"C:\\Windows\\System32\\rundll32.exe" "C:\\Windows\\System32\\dfshim.dll",ShOpenVerbApplication C:\\Users\\EastSalesUser1\\Desktop\\test.application\n'})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 4 \u2013"})," Now we are going to create an EXE combo elevation rule using ",(0,s.jsx)(t.strong,{children:"Path"}),", and also check the two settings for ",(0,s.jsx)(t.strong,{children:"Command-line arguments"})," and ",(0,s.jsx)(t.strong,{children:"Apply to child processes"})," before clicking ",(0,s.jsx)(t.strong,{children:"Next"}),"."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"451_13_image-20200210223130-7",src:i(889377).A+"",width:"743",height:"548"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 5 \u2013"}),' Enter "*\\EXE" for the PATH, replace EXE with the name of the executable mentioned in the command-line from the ppservice.log relevant to your environment, then click ',(0,s.jsx)(t.strong,{children:"Next"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["In this example, the EXE name is ",(0,s.jsx)(t.strong,{children:"Rundll32.exe"}),"."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"451_15_image-20200210223130-8",src:i(275774).A+"",width:"753",height:"562"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 6 \u2013"})," At the next screen, copy and paste the entire command-line from the ppservice.log file into the ",(0,s.jsx)(t.strong,{children:"Command-line Arguments"})," section. Ensure that ",(0,s.jsx)(t.strong,{children:"Strict Equality"})," and ",(0,s.jsx)(t.strong,{children:"Ignore Arguments case"})," are both selected."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"NOTE:"})," The command-line arguments cannot be empty."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 7 \u2013"})," Click ",(0,s.jsx)(t.strong,{children:"Next"})," then ",(0,s.jsx)(t.strong,{children:"Finish"})," to save the rule."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"451_17_image-20200210223130-9",src:i(616695).A+"",width:"760",height:"568"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 8 \u2013"})," Apply the policy and then verify using the Endpoint Policy Manager event log for the application being Elevated."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"451_19_image-20200210223130-10_950x266",src:i(119912).A+"",width:"950",height:"266"})})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},839308:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/451_11_image-20200210223130-6-4cb53ffd5caa6cdea744bd42ab8ec56b.webp"},860260:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/451_5_image-20200210223130-3_950x270-e8c647abd6ddacdb9c6892847a6debf7.webp"},889377:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/451_13_image-20200210223130-7-5fb343bc6db7214232044f360591c7da.webp"},898450:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/451_9_image-20200210223130-5-773fc16f8e98136b354490af1f9b4908.webp"},914294:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/451_1_image-20200210223130-1_950x326-033c1c7dba267d955c2a92bee9c1e3af.webp"}}]);