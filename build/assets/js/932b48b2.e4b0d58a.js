"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[741315],{28453:(e,t,n)=>{n.d(t,{R:()=>d,x:()=>l});var s=n(296540);const r={},i=s.createContext(r);function d(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(i.Provider,{value:t},e.children)}},67746:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"auditor/admin/alertsettings/createmailboxaccess","title":"Create Alerts for Non-Owner Mailbox Access Events","description":"If you have a monitoring plan configured to audit Exchange, you can configure alerts to be triggered by non-owner mailbox access events (e.g., opening a message folder, opening/modifying/deleting a message) using the event log alerts. To enable monitoring of non-owner mailbox access events, you need to create a monitoring plan for auditing event logs.","source":"@site/docs/auditor/auditor/admin/alertsettings/createmailboxaccess.md","sourceDirName":"auditor/admin/alertsettings","slug":"/auditor/admin/alertsettings/createmailboxaccess","permalink":"/docs/auditor/auditor/admin/alertsettings/createmailboxaccess","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/admin/alertsettings/createmailboxaccess.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Create Alerts on Health Status","permalink":"/docs/auditor/auditor/admin/alertsettings/createhealthstatus"},"next":{"title":"Alerts Overview Dashboard","permalink":"/docs/auditor/auditor/admin/alertsettings/dashboard"}}');var r=n(474848),i=n(28453);const d={},l="Create Alerts for Non-Owner Mailbox Access Events",c={},a=[{value:"Create Alerts for Non-Owner Mailbox Access Events",id:"create-alerts-for-non-owner-mailbox-access-events-1",level:2},{value:"Review Event Description",id:"review-event-description",level:2}];function o(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"create-alerts-for-non-owner-mailbox-access-events",children:"Create Alerts for Non-Owner Mailbox Access Events"})}),"\n",(0,r.jsx)(t.p,{children:"If you have a monitoring plan configured to audit Exchange, you can configure alerts to be triggered by non-owner mailbox access events (e.g., opening a message folder, opening/modifying/deleting a message) using the event log alerts. To enable monitoring of non-owner mailbox access events, you need to create a monitoring plan for auditing event logs."}),"\n",(0,r.jsx)(t.h2,{id:"create-alerts-for-non-owner-mailbox-access-events-1",children:"Create Alerts for Non-Owner Mailbox Access Events"}),"\n",(0,r.jsxs)(t.p,{children:["The procedure below describes the basic steps, required for creation of a monitoring plan that will be used to collect data on non-owner mailbox access events. See ",(0,r.jsx)(t.a,{href:"/docs/auditor/auditor/tools/eventlogmanager",children:"Event Log Manager"})," topic for additional information."]}),"\n",(0,r.jsx)(t.p,{children:"Follow the steps to create alert for non-owner mailbox access events."}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 1 \u2013"})," Create a monitoring plan in Netwrix Auditor Event Log Manager."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 2 \u2013"}),' Make sure that the Enable event log collection checkbox is selected. Specify the name for the new plan, for example, "',(0,r.jsx)(t.em,{children:"Non-owner mailbox access auditing"}),'".']}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 3 \u2013"})," Navigate to the Monitored computers list and add a server where your Exchange organization resides."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 4 \u2013"})," On the General tab, click Configure next to Alerts. Make sure the predefined alerts are disabled. Click Add to create an alert for non-owner mailbox access event."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 5 \u2013"})," In the Alert Properties wizard, specify the alert name and enter alert description (optional). Specify the number alerts per email. Grouped alerts for different computers will be delivered in separate email messages. This value is set to 1 by default, which means that each alert will be delivered as a separate email message."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 6 \u2013"})," Specify alert recipient if you want the alert to be delivered to a non-default email."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 7 \u2013"})," Navigate to Event Filters and click Add to specify an event that will trigger the alert."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 8 \u2013"})," Complete the Event Filter dialog."]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["In the Event tab, specify the filter name and description. In the Event Log field enter ",(0,r.jsx)(t.em,{children:'"Netwrix Non-Owner Mailbox Access Agent"'}),"."]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"In the Event Fields tab, complete the following fields:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["Event ID\u2014Enter the identifier of a specific event that you want to be alerted on. You can add several IDs separated by comma. Review the event IDs available in the Netwrix ",(0,r.jsx)(t.strong,{children:"Non-Owner Mailbox Access Agent"})," event log:"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"ID"}),(0,r.jsx)(t.th,{children:"Description"}),(0,r.jsx)(t.th,{children:"Access Type (as displayed in XML view of event details)"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"1"}),(0,r.jsx)(t.td,{children:"A folder was opened"}),(0,r.jsx)(t.td,{children:"actFolderOpen"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"2"}),(0,r.jsx)(t.td,{children:"A message was opened"}),(0,r.jsx)(t.td,{children:"actMessageOpened"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"3"}),(0,r.jsx)(t.td,{children:"A message was sent"}),(0,r.jsx)(t.td,{children:"actMessageSubmit"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4"}),(0,r.jsx)(t.td,{children:"A message was changed and saved"}),(0,r.jsx)(t.td,{children:"actChangedMessageSaved"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"5"}),(0,r.jsx)(t.td,{children:"A message was deleted"}),(0,r.jsx)(t.td,{children:"actMessageDeleted"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"6"}),(0,r.jsx)(t.td,{children:"A folder was deleted"}),(0,r.jsx)(t.td,{children:"actFolderDeleted"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"7"}),(0,r.jsx)(t.td,{children:"The entire contents of a folder was deleted"}),(0,r.jsx)(t.td,{children:"actAllFolderContentsDeleted"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"8"}),(0,r.jsx)(t.td,{children:"A message was created and saved"}),(0,r.jsx)(t.td,{children:"actMessageCreatedAndSaved"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"9"}),(0,r.jsx)(t.td,{children:"A message was moved or/and copied"}),(0,r.jsx)(t.td,{children:"actMessageMoveCopy"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"10"}),(0,r.jsx)(t.td,{children:"A folder was moved or/and copied"}),(0,r.jsx)(t.td,{children:"actFolderMoveCopy"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"14"}),(0,r.jsx)(t.td,{children:"A folder was created"}),(0,r.jsx)(t.td,{children:"actFolderCreated"})]})]})]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["Source\u2014Enter ",(0,r.jsx)(t.em,{children:'"Netwrix Non-Owner Mailbox Access Agent"'}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"In the Insertion Strings tab, select Consider the following event Insertion Strings to receive alerts on events containing a specific string in the EventData. Click Add and specify the Insertion String."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 9 \u2013"})," Click OK to save the changes and close the Event Filters dialog."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 10 \u2013"})," In the Netwrix Auditor Event Log Manager wizard, navigate to Notifications and specify the email address where notifications will be delivered."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.em,{children:(0,r.jsx)(t.strong,{children:"RECOMMENDED:"})}),"  click ",(0,r.jsx)(t.strong,{children:"Send Test Email"}),". The system will send a test message to the specified email address and inform you if any problems are detected."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 11 \u2013"})," Click Edit next to Audit Archiving Filters step, in the Inclusive Filters section clear the filters you do not need, click Add and specify the following information:"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"The filter name and description (e.g., Non-owner mailbox access event)"}),"\n",(0,r.jsxs)(t.li,{children:["In Event Log, enter ",(0,r.jsx)(t.em,{children:'"Netwrix Non-Owner Mailbox Access Agent"'}),"."]}),"\n",(0,r.jsx)(t.li,{children:"In Write to, select Long-Term Archive. The events will be saved into the local repository."}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 12 \u2013"})," Click Save. If an event occurs that triggers an alert, an email notification will be sent immediately to the specified recipients."]}),"\n",(0,r.jsx)(t.h2,{id:"review-event-description",children:"Review Event Description"}),"\n",(0,r.jsx)(t.p,{children:"Review the example of the MessageOpened event in the XML view:"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"eventmessageopen",src:n(631304).A+"",width:"635",height:"455"})}),"\n",(0,r.jsx)(t.p,{children:"Depending on the event, the strings in the description may vary. The first eight strings are common for all events:"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"String"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String1"}),(0,r.jsx)(t.td,{children:"The event type: info or warning"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String2"}),(0,r.jsx)(t.td,{children:"The event date and time in the following format: YYYY_MM_DD_hh_mm_ss_000"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String3"}),(0,r.jsx)(t.td,{children:"The name of the user accessing mailbox"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String4"}),(0,r.jsx)(t.td,{children:"The SID of the user accessing mailbox"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String5"}),(0,r.jsx)(t.td,{children:"The GUID of the mailbox being accessed"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String6"}),(0,r.jsxs)(t.td,{children:["Shows whether the user accessing mailbox is the owner: it is always ",(0,r.jsx)(t.em,{children:"false"})]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String7"}),(0,r.jsx)(t.td,{children:"The IP of the computer accessing the mailbox"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String8"}),(0,r.jsx)(t.td,{children:"The access type"})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"The following strings depend on the non-owner access type, represented by different Event IDs:"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Event ID"}),(0,r.jsx)(t.th,{children:"Access type (String 8)"}),(0,r.jsx)(t.th,{children:"Strings"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"1"}),(0,r.jsx)(t.td,{children:"actFolderOpen"}),(0,r.jsx)(t.td,{children:"String9"}),(0,r.jsx)(t.td,{children:"The internal folder URL"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"2"}),(0,r.jsx)(t.td,{children:"actMessageOpened"}),(0,r.jsx)(t.td,{children:"String9"}),(0,r.jsx)(t.td,{children:"The internal message URL"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String10"}),(0,r.jsx)(t.td,{children:"The message subject"}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String11"}),(0,r.jsx)(t.td,{children:"The message type: IPM.Note\u2014Email, IPM.Contact \u2013 contact, etc."}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"3"}),(0,r.jsx)(t.td,{children:"actMessageSubmit"}),(0,r.jsx)(t.td,{children:"String9"}),(0,r.jsx)(t.td,{children:"The internal message URL"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String10"}),(0,r.jsx)(t.td,{children:"The message subject"}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String11"}),(0,r.jsx)(t.td,{children:"Email addresses of the message recipients, separated by a semicolon"}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String12"}),(0,r.jsx)(t.td,{children:"The message type: IPM.Note\u2014Email, IPM.Contact \u2013 contact, etc."}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4"}),(0,r.jsx)(t.td,{children:"actChangedMessageSaved"}),(0,r.jsx)(t.td,{children:"String9"}),(0,r.jsx)(t.td,{children:"The internal message URL"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String10"}),(0,r.jsx)(t.td,{children:"The message subject"}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String11"}),(0,r.jsx)(t.td,{children:"The message type: IPM.Note \u2013 Email, IPM.Contact \u2013 contact, etc."}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"5"}),(0,r.jsx)(t.td,{children:"actMessageDeleted"}),(0,r.jsx)(t.td,{children:"String9"}),(0,r.jsx)(t.td,{children:"The internal message URL"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String10"}),(0,r.jsx)(t.td,{children:"The message subject"}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String11"}),(0,r.jsx)(t.td,{children:"The message type: IPM.Note\u2014Email, IPM.Contact \u2013 contact, etc."}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"6"}),(0,r.jsx)(t.td,{children:"actFolderDeleted"}),(0,r.jsx)(t.td,{children:"String9"}),(0,r.jsx)(t.td,{children:"The internal folder URL"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"7"}),(0,r.jsx)(t.td,{children:"actAllFolderContentsDeleted"}),(0,r.jsx)(t.td,{children:"String9"}),(0,r.jsx)(t.td,{children:"The internal folder URL"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"8"}),(0,r.jsx)(t.td,{children:"actMessageCreatedAndSaved"}),(0,r.jsx)(t.td,{children:"String9"}),(0,r.jsx)(t.td,{children:"The internal message URL"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"9"}),(0,r.jsx)(t.td,{children:"actMessageMoveCopy"}),(0,r.jsx)(t.td,{children:"String9"}),(0,r.jsx)(t.td,{children:"The message being moved/copied\u2014the final part of the message URL, e.g., /Inbox/testMessage.EML"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String10"}),(0,r.jsx)(t.td,{children:"The action \u2013 copy or move"}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String11"}),(0,r.jsx)(t.td,{children:"The folder URL the message is copied/moved from"}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String12"}),(0,r.jsx)(t.td,{children:"The destination folder URL"}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"String13"}),(0,r.jsx)(t.td,{children:"The message type: IPM.Note\u2014Email, IPM.Contact \u2013 contact, etc."}),(0,r.jsx)(t.td,{}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"10"}),(0,r.jsx)(t.td,{children:"actFolderMoveCopy"}),(0,r.jsx)(t.td,{children:"Strings 9 -13"}),(0,r.jsx)(t.td,{children:"The string descriptions for the folder are similar to those for messages."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"14"}),(0,r.jsx)(t.td,{children:"actFolderCreated"}),(0,r.jsx)(t.td,{children:"String9"}),(0,r.jsx)(t.td,{children:"The new folder URL"})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"With different Exchange versions and/or different email clients, the same non-owner action (e.g., copying a message) may generate different events: e.g., actMessageMoveCopy with one server/client or actMessageCreatedAndSaved with another."}),"\n",(0,r.jsxs)(t.p,{children:["You can add the required strings contained in % symbols for your own custom alert separated by a",(0,r.jsx)(t.code,{children:" <br>"})," tag in ",(0,r.jsx)(t.code,{children:"<b>Event Parameters:</b>"}),". Event parameter descriptions can also be added."]}),"\n",(0,r.jsx)(t.p,{children:"In the example below, the following information has been added:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"The description for String 3\u2014User accessing mailbox"}),"\n",(0,r.jsx)(t.li,{children:"String 8 with the description"}),"\n",(0,r.jsx)(t.li,{children:"String 9 with the description"}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"editnotificationtemplate",src:n(940102).A+"",width:"487",height:"362"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},631304:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/eventmessageopen-370a0551629ad281cee8d59f610f7766.webp"},940102:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/editnotificationtemplate-9aa4f830f684a1c97ed5602357f57e4d.webp"}}]);