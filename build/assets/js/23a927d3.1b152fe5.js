"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[103414],{28453:(e,o,i)=>{i.d(o,{R:()=>l,x:()=>s});var n=i(296540);const t={},c=n.createContext(t);function l(e){const o=n.useContext(c);return n.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function s(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),n.createElement(c.Provider,{value:o},e.children)}},303870:(e,o,i)=>{i.r(o),i.d(o,{assets:()=>r,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"config/netapp7mode/configurefpolicy","title":"Configure FPolicy","description":"Select a method to configure the FPolicy for NetApp Data ONTAP 7-Mode devices:","source":"@site/docs/accessanalyzer/config/netapp7mode/configurefpolicy.md","sourceDirName":"config/netapp7mode","slug":"/config/netapp7mode/configurefpolicy","permalink":"/docs/accessanalyzer/config/netapp7mode/configurefpolicy","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/config/netapp7mode/configurefpolicy.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"NetApp Data ONTAP 7-Mode Activity Auditing Configuration","permalink":"/docs/accessanalyzer/config/netapp7mode/activity"},"next":{"title":"Customize FPolicy Policy Name","permalink":"/docs/accessanalyzer/config/netapp7mode/customizefpolicy"}}');var t=i(474848),c=i(28453);const l={},s="Configure FPolicy",r={},a=[{value:"Manually Configure FPolicy (Recommended Option)",id:"manually-configure-fpolicy-recommended-option",level:2},{value:"Part 1: Create FPolicy",id:"part-1-create-fpolicy",level:3},{value:"Part 2: Set FPolicy Required to Off",id:"part-2-set-fpolicy-required-to-off",level:3},{value:"Part 3: Set FPolicy to Collect Permission Changes",id:"part-3-set-fpolicy-to-collect-permission-changes",level:3},{value:"Part 4: Set FPolicy to Monitor Alternate Data Streams",id:"part-4-set-fpolicy-to-monitor-alternate-data-streams",level:3},{value:"Part 5: Set FPolicy to Monitor Disconnected Sessions",id:"part-5-set-fpolicy-to-monitor-disconnected-sessions",level:3},{value:"Part 6: Scope FPolicy for Specific Volumes",id:"part-6-scope-fpolicy-for-specific-volumes",level:3},{value:"Part 7: Enable FPolicy",id:"part-7-enable-fpolicy",level:3},{value:"Automatic Configuration of FPolicy",id:"automatic-configuration-of-fpolicy",level:2}];function d(e){const o={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.header,{children:(0,t.jsx)(o.h1,{id:"configure-fpolicy",children:"Configure FPolicy"})}),"\n",(0,t.jsx)(o.p,{children:"Select a method to configure the FPolicy for NetApp Data ONTAP 7-Mode devices:"}),"\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.em,{children:(0,t.jsx)(o.strong,{children:"RECOMMENDED:"})}),"  ",(0,t.jsx)(o.a,{href:"#manually-configure-fpolicy-recommended-option",children:"Manually Configure FPolicy (Recommended Option)"})," \u2013 A tailored FPolicy"]}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["\n",(0,t.jsx)(o.p,{children:"If using vFilers the FPolicy must be created on the vFiler, and the Activity Monitor must target the vFiler. This is because FPolicy operates on the affected vFiler. Therefore, when executing these commands on a vFiler, the commands must be run from a vFiler context (e.g. via the vFiler run command)."}),"\n"]}),"\n",(0,t.jsxs)(o.li,{children:["\n",(0,t.jsxs)(o.p,{children:["Allow the Activity Monitor to create an FPolicy automatically. See the ",(0,t.jsx)(o.a,{href:"#automatic-configuration-of-fpolicy",children:"Automatic Configuration of FPolicy"})," topic for additional information."]}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsx)(o.li,{children:"This option is enabled when the Activity Monitor Activity Agent is configured to monitor the NetApp device on the NetApp FPolicy Configuration page of the Add New Hosts window."}),"\n",(0,t.jsx)(o.li,{children:"It monitors all file system activity."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(o.h2,{id:"manually-configure-fpolicy-recommended-option",children:"Manually Configure FPolicy (Recommended Option)"}),"\n",(0,t.jsx)(o.p,{children:"This section describes how to manually configure FPolicy. Manual configuration of the FPolicy is recommended so that the policy can be scoped. It is necessary to create six FPolicy components and then enable the FPolicy. See the sections corresponding to each part of this list:"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.a,{href:"#part-1-create-fpolicy",children:"Part 1: Create FPolicy"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.a,{href:"#part-2-set-fpolicy-required-to-off",children:"Part 2: Set FPolicy Required to Off"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.a,{href:"#part-3-set-fpolicy-to-collect-permission-changes",children:"Part 3: Set FPolicy to Collect Permission Changes"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.a,{href:"#part-4-set-fpolicy-to-monitor-alternate-data-streams",children:"Part 4: Set FPolicy to Monitor Alternate Data Streams"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.a,{href:"#part-5-set-fpolicy-to-monitor-disconnected-sessions",children:"Part 5: Set FPolicy to Monitor Disconnected Sessions"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.a,{href:"#part-6-scope-fpolicy-for-specific-volumes",children:"Part 6: Scope FPolicy for Specific Volumes"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.a,{href:"#part-7-enable-fpolicy",children:"Part 7: Enable FPolicy"})}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:"If using vFilers the FPolicy must be created on the vFiler, and the Activity Monitor must target the vFiler. This is because FPolicy operates on the affected vFiler. Therefore, when executing these commands on a vFiler, the commands must be run from a vFiler context (e.g. via the vFiler run command)."}),"\n",(0,t.jsxs)(o.p,{children:["Relevant NetApp Documentation: To learn more about configuring file policies, please visit the NetApp website and read ",(0,t.jsx)(o.a,{href:"https://library.netapp.com/ecmdocs/ECMP1196890/html/man1/na_fpolicy.1.html",children:"na_fpolicy \u2013 configure file policies"})," article."]}),"\n",(0,t.jsx)(o.h3,{id:"part-1-create-fpolicy",children:"Part 1: Create FPolicy"}),"\n",(0,t.jsx)(o.p,{children:"Create the FPolicy on the vFiler."}),"\n",(0,t.jsx)(o.p,{children:"IMPORTANT:"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsx)(o.li,{children:'The policy should be named "StealthAUDIT"'}),"\n",(0,t.jsx)(o.li,{children:'The only supported policy type is "screen" for file screening.'}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:"Use the following command to create the FPolicy:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"fpolicy create StealthAUDIT screen\n"})}),"\n",(0,t.jsx)(o.h3,{id:"part-2-set-fpolicy-required-to-off",children:"Part 2: Set FPolicy Required to Off"}),"\n",(0,t.jsxs)(o.p,{children:["If the ",(0,t.jsx)(o.code,{children:"FPolicy Required"})," value is set to on, user requests are denied if an FPolicy server is not available to implement the policy. If it is set to off, user requests are allowed when it is not possible to apply the policy to the file because no FPolicy server is available."]}),"\n",(0,t.jsx)(o.p,{children:"IMPORTANT:"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["The ",(0,t.jsx)(o.code,{children:"FPolicy Required"})," value should be set to ",(0,t.jsx)(o.strong,{children:"off"})]}),"\n"]}),"\n",(0,t.jsxs)(o.p,{children:["Use the following command to set the ",(0,t.jsx)(o.code,{children:"FPolicy Required"})," value to off:"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"fpolicy options StealthAUDIT required off\n"})}),"\n",(0,t.jsx)(o.h3,{id:"part-3-set-fpolicy-to-collect-permission-changes",children:"Part 3: Set FPolicy to Collect Permission Changes"}),"\n",(0,t.jsx)(o.p,{children:"The cifs_setattr value must be set to on in order for CIFS requests to change file security descriptors to be screened by the policy."}),"\n",(0,t.jsx)(o.p,{children:"IMPORTANT:"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["The ",(0,t.jsx)(o.code,{children:"cifs_setattr"})," value must be set to ",(0,t.jsx)(o.strong,{children:"on"})]}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:"Use the following command to enable the FPolicy to collect permission changes:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"fpolicy options StealthAUDIT cifs_setattr on\n"})}),"\n",(0,t.jsx)(o.h3,{id:"part-4-set-fpolicy-to-monitor-alternate-data-streams",children:"Part 4: Set FPolicy to Monitor Alternate Data Streams"}),"\n",(0,t.jsx)(o.p,{children:"The monitor_ads value must be set to on in order for CIFS requests for alternate data streams (ADS) to be monitored by the policy."}),"\n",(0,t.jsx)(o.p,{children:"IMPORTANT:"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["The ",(0,t.jsx)(o.code,{children:"monitor_ads"})," value must be set to ",(0,t.jsx)(o.strong,{children:"on"})]}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:"Use the following command to enable the FPolicy to monitor ADS:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"fpolicy options StealthAUDIT monitor_ads on\n"})}),"\n",(0,t.jsx)(o.h3,{id:"part-5-set-fpolicy-to-monitor-disconnected-sessions",children:"Part 5: Set FPolicy to Monitor Disconnected Sessions"}),"\n",(0,t.jsx)(o.p,{children:"The cifs_disconnect_check value must be set to on in order for CIFS requests associated with disconnected sessions to be monitored by the policy."}),"\n",(0,t.jsx)(o.p,{children:"IMPORTANT:"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["The ",(0,t.jsx)(o.code,{children:"cifs_disconnect_check"})," value must be set to ",(0,t.jsx)(o.strong,{children:"on"})]}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:"Use the following command to enable the FPolicy to monitor disconnected sessions:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"fpolicy options StealthAUDIT cifs_disconnect_check on\n"})}),"\n",(0,t.jsx)(o.h3,{id:"part-6-scope-fpolicy-for-specific-volumes",children:"Part 6: Scope FPolicy for Specific Volumes"}),"\n",(0,t.jsx)(o.p,{children:"The FPolicy can be scoped either to monitor only specified volumes (inclusion) or to not monitor specific volumes (exclusion)."}),"\n",(0,t.jsx)(o.p,{children:"IMPORTANT:"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsx)(o.li,{children:"Choose to scope by including or excluding volumes"}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:"Use the following command to scope the FPolicy by volume:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"fpolicy \u2011volume [INCLUDE OR EXCLUSION] \u2011add StealthAUDIT [VOLUME_NAME],[VOLUME_NAME]\n"})}),"\n",(0,t.jsx)(o.p,{children:"Inclusion Example:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"fpolicy \u2011volume include \u2011add StealthAUDIT samplevolume1,samplevolume2\n"})}),"\n",(0,t.jsx)(o.p,{children:"Exclusion Example:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"fpolicy \u2011volume exclusion \u2011add StealthAUDIT samplevolume1,samplevolume2\n"})}),"\n",(0,t.jsx)(o.h3,{id:"part-7-enable-fpolicy",children:"Part 7: Enable FPolicy"}),"\n",(0,t.jsx)(o.p,{children:"The FPolicy must be enabled before the Activity Monitor Activity Agent can be configured to monitor the NetApp device."}),"\n",(0,t.jsx)(o.p,{children:"IMPORTANT:"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["The Activity Monitor must register with the NetApp device as an FPolicy server. By default, it looks for a policy named ",(0,t.jsx)(o.code,{children:"StealthAUDIT"}),". See the ",(0,t.jsx)(o.a,{href:"/docs/accessanalyzer/config/netapp7mode/customizefpolicy",children:"Customize FPolicy Policy Name"})," section for information on using a different policy name."]}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:"Use the following command to enable the FPolicy to monitor disconnected sessions:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"fpolicy enable StealthAUDIT\n"})}),"\n",(0,t.jsx)(o.h2,{id:"automatic-configuration-of-fpolicy",children:"Automatic Configuration of FPolicy"}),"\n",(0,t.jsx)(o.p,{children:"The Activity Monitor can automatically configure FPolicy on the targeted NetApp Data ONTAP 7-Mode device. The FPolicy created monitors all file system activity. This is done when the NetApp device is assigned to the agent for monitoring. This option is enabled on the NetApp FPolicy Configuration page of the Add New Host window."})]})}function h(e={}){const{wrapper:o}={...(0,c.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);