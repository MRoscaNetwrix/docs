"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[396341],{28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>d});var s=i(296540);const t={},o=s.createContext(t);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(o.Provider,{value:n},e.children)}},779670:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"auditor/configuration/windowsserver/permissions","title":"Permissions for Windows Server Auditing","description":"Before you start creating a monitoring plan to audit your Windows servers (including DNS and DHCP servers), plan for the account that will be used for data collection \u2013 it should meet the requirements listed below. Then you will provide this account in the monitoring plan wizard (or in the monitored item settings).","source":"@site/docs/auditor/auditor/configuration/windowsserver/permissions.md","sourceDirName":"auditor/configuration/windowsserver","slug":"/auditor/configuration/windowsserver/permissions","permalink":"/docs/auditor/auditor/configuration/windowsserver/permissions","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/windowsserver/permissions.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Windows Server","permalink":"/docs/auditor/auditor/configuration/windowsserver/overview"},"next":{"title":"Configure Enable Persistent Time Stamp Policy","permalink":"/docs/auditor/auditor/configuration/windowsserver/persistenttimestamp"}}');var t=i(474848),o=i(28453);const r={},d="Permissions for Windows Server Auditing",a={},l=[{value:"Assign Permission To Read the Registry Key",id:"assign-permission-to-read-the-registry-key",level:2},{value:"Assign Permission via the Registry Editor Snap-in",id:"assign-permission-via-the-registry-editor-snap-in",level:3},{value:"Assign Permission using the Group Policy Management Console",id:"assign-permission-using-the-group-policy-management-console",level:3}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"permissions-for-windows-server-auditing",children:"Permissions for Windows Server Auditing"})}),"\n",(0,t.jsx)(n.p,{children:"Before you start creating a monitoring plan to audit your Windows servers (including DNS and DHCP servers), plan for the account that will be used for data collection \u2013 it should meet the requirements listed below. Then you will provide this account in the monitoring plan wizard (or in the monitored item settings)."}),"\n",(0,t.jsx)(n.p,{children:"The account used for data collection must meet the following requirements on the target servers:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:['The "Manage auditing and security log" policy must be defined for this account. See the ',(0,t.jsx)(n.a,{href:"/docs/auditor/auditor/configuration/activedirectory/permissions",children:"Permissions for Active Directory Auditing"})," topic for additional information."]}),"\n",(0,t.jsx)(n.li,{children:"This account must be a member of the local Administrators group."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"assign-permission-to-read-the-registry-key",children:"Assign Permission To Read the Registry Key"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"NOTE:"})," This permission is required only if the account selected for data collection is not a member of the Domain Admins group."]}),"\n",(0,t.jsx)(n.p,{children:"This permission should be assigned on each domain controller in the audited domain, so if your domain contains multiple domain controllers, it is recommended to assign permissions through Group Policy."}),"\n",(0,t.jsx)(n.p,{children:"To assign permissions manually, use the Registry Editor snap-in or the Group Policy Management console."}),"\n",(0,t.jsx)(n.h3,{id:"assign-permission-via-the-registry-editor-snap-in",children:"Assign Permission via the Registry Editor Snap-in"}),"\n",(0,t.jsx)(n.p,{children:"Follow the steps to assign permission via the Registry Editor snap-in:"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 1 \u2013"})," On your target server, open Registry Editor: navigate to ",(0,t.jsx)(n.strong,{children:"Start > Run"})," and type ",(0,t.jsx)(n.em,{children:'"regedit"'}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 2 \u2013"})," In the left pane, navigate to ",(0,t.jsx)(n.em,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControl Set\\Services\\EventLog\\Security"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 3 \u2013"})," Right-click the ",(0,t.jsx)(n.strong,{children:"Security"})," node and select ",(0,t.jsx)(n.strong,{children:"Permissions"})," from the pop-up menu."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 4 \u2013"})," Click ",(0,t.jsx)(n.strong,{children:"Add"})," and enter the name of the user that you want to grant permissions to."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 5 \u2013"})," Check ",(0,t.jsx)(n.strong,{children:"Allow"})," next to the ",(0,t.jsx)(n.strong,{children:"Read"})," permission."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"NOTE:"})," For auditing Logon Activity, you also need to assign the Read permission to the ",(0,t.jsx)(n.em,{children:"HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\PolAdtEv"})," registry key."]}),"\n",(0,t.jsx)(n.h3,{id:"assign-permission-using-the-group-policy-management-console",children:"Assign Permission using the Group Policy Management Console"}),"\n",(0,t.jsx)(n.p,{children:"Follow the steps to assign permission using the Group Policy Management console;"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 1 \u2013"})," Open the Group Policy Management console on any domain controller in the target domain: navigate to Start > Windows Administrative Tools (Windows Server 2016/2019) or Administrative Tools (Windows 2012 R2 and below) > Group Policy Management."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 2 \u2013"})," In the left pane, navigate to Forest: ",(0,t.jsx)(n.code,{children:"<forest name>"})," > Domains > ",(0,t.jsx)(n.code,{children:"<domain name>"})," > Domain Controllers. Right-click the effective domain controllers policy (by default, it is the ",(0,t.jsx)(n.em,{children:"Default Domain Controllers Policy"}),"), and select Edit."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 3 \u2013"})," In the Group Policy Management Editor dialog, expand the Computer Configuration node on the left and navigate to Policies > Windows Settings > Security Settings > Registry."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 4 \u2013"})," Right-click in the pane and select Add Key."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 5 \u2013"})," Navigate to ",(0,t.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\PolAdtEv"})," and click OK."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 6 \u2013"})," Click Add and enter the name of the user that you want to grant permissions to and press Enter."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 7 \u2013"})," Check Allow next to the ",(0,t.jsx)(n.em,{children:'"Read"'})," permission and click OK."]}),"\n",(0,t.jsx)(n.p,{children:"In the pop-up window, select Propagate inheritable permissions to all subkeys and click OK."}),"\n",(0,t.jsx)(n.p,{children:"Repeat the steps 4-7 for keys below:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurePipeServers\\winreg"}),";"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\EventLog\\Security"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 8 \u2013"})," Close Group Policy Management console."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 9 \u2013"})," Open command prompt and input the ",(0,t.jsx)(n.code,{children:"gpupdate /force"})," command and press Enter. The group policy will be updated."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 10 \u2013"})," Type ",(0,t.jsx)(n.code,{children:"repadmin /syncall"})," command and press Enter for replicate GPO changes to other domain controllers."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 11 \u2013"})," Ensure that new GPO settings were applied to the domain controllers."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);