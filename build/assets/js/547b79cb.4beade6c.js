"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[536300],{28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var r=t(296540);const i={},s=r.createContext(i);function o(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:n},e.children)}},510617:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"usercube/integration-guide/toolkit/xml-configuration/jobs/tasks/agent/preparesynchronizationtask/index","title":"Prepare Synchronization Task","description":"View Behavior Details","source":"@site/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/jobs/tasks/agent/preparesynchronizationtask/index.md","sourceDirName":"usercube/integration-guide/toolkit/xml-configuration/jobs/tasks/agent/preparesynchronizationtask","slug":"/usercube/integration-guide/toolkit/xml-configuration/jobs/tasks/agent/preparesynchronizationtask/","permalink":"/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/jobs/tasks/agent/preparesynchronizationtask/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/jobs/tasks/agent/preparesynchronizationtask/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"userCubeSaasSidebar","previous":{"title":"Invoke Sql Command Task","permalink":"/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/jobs/tasks/agent/invokesqlcommandtask/"},"next":{"title":"Server Tasks","permalink":"/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/jobs/tasks/server/"}}');var i=t(474848),s=t(28453);const o={},a="Prepare Synchronization Task",c={},d=[{value:"View Behavior Details",id:"view-behavior-details",level:2},{value:"Cleanse data",id:"cleanse-data",level:3},{value:"Compute changes",id:"compute-changes",level:3},{value:"Prepare the server",id:"prepare-the-server",level:3},{value:"Send clean exports",id:"send-clean-exports",level:3},{value:"Examples",id:"examples",level:2},{value:"Properties",id:"properties",level:2}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"prepare-synchronization-task",children:"Prepare Synchronization Task"})}),"\n",(0,i.jsx)(n.h2,{id:"view-behavior-details",children:"View Behavior Details"}),"\n",(0,i.jsxs)(n.p,{children:["The task reads files from the source directory, usually the temp folder >Export Output folder. See the ",(0,i.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/network-configuration/agent-configuration/appsettings/",children:"Application Settings"}),"topic for additional information."]}),"\n",(0,i.jsx)(n.h3,{id:"cleanse-data",children:"Cleanse data"}),"\n",(0,i.jsxs)(n.p,{children:["The following actions are performed on the ",(0,i.jsx)(n.em,{children:"CSV source files"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Remove columns that are not used in ",(0,i.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/connectors/entitytypemapping/",children:"\nEntity Type Mapping\n"})," or ",(0,i.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/connectors/entityassociationmapping/",children:"\nEntity Association Mapping\n"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Remove entries that have a null primary key."}),"\n",(0,i.jsx)(n.li,{children:"Remove duplicates."}),"\n",(0,i.jsx)(n.li,{children:"Sort entries according to the primary key."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The result of the ",(0,i.jsx)(n.em,{children:"Prepare-Synchronization"})," is stored in the ",(0,i.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/network-configuration/server-configuration/general-purpose/",children:"Application Settings"}),"directory as three files:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["For every entity type of the relevant ",(0,i.jsx)(n.em,{children:"Connector"})," involved in an ",(0,i.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/connectors/entitytypemapping/",children:"\nEntity Type Mapping\n"}),"> or an ",(0,i.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/connectors/entityassociationmapping/",children:"\nEntity Association Mapping\n"}),", a ",(0,i.jsx)(n.code,{children:".sorted.csv"})," file is generated, containing the final, cleansed and sorted result."]}),"\n",(0,i.jsxs)(n.li,{children:["Duplicates are kept in a separate ",(0,i.jsx)(n.code,{children:".duplicates.csv"})," file."]}),"\n",(0,i.jsxs)(n.li,{children:["Null primary key entries are kept in a separate ",(0,i.jsx)(n.code,{children:".nullpk.csv"})," file."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"All files produced by the task are in the work folder > Collect directory."}),"\n",(0,i.jsx)(n.h3,{id:"compute-changes",children:"Compute changes"}),"\n",(0,i.jsxs)(n.p,{children:["In ",(0,i.jsx)(n.em,{children:"incremental"})," mode, changes might need to be computed by the ",(0,i.jsx)(n.em,{children:"Agent"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If the Export step has provided computed changes, no further process is required. The changes will be sent as-is to the server."}),"\n",(0,i.jsxs)(n.li,{children:["If the Export step has provided a full extract of the managed systems, the ",(0,i.jsx)(n.em,{children:"Prepare-Synchronization"})," step computes changes. This computation is based on the result of the last data cleansing, generated by the previous ",(0,i.jsx)(n.em,{children:"Prepare-Synchronization"}),", and stored in the ",(0,i.jsx)(n.code,{children:"previous"})," folder in the ",(0,i.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/network-configuration/server-configuration/general-purpose/",children:"Application Settings"}),"directory."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["For ",(0,i.jsx)(n.em,{children:"incremental"})," mode, it is recommended, whenever possible, to use managed systems to compute changes. Dedicated workstations and knowledge of the inner data organization allow managed systems to compute changes with performance that Identity Manager can't match. Using managed systems for these operations avoids generating heavy files and alleviates Identity Manager's processing load."]}),"\n",(0,i.jsxs)(n.p,{children:["The result is a set of clean lists of changes stored as a ",(0,i.jsx)(n.code,{children:".sorted.delta"})," file containing a ",(0,i.jsx)(n.em,{children:"command"})," column. The ",(0,i.jsx)(n.em,{children:"command"})," column can take the following values:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.em,{children:"insert"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.em,{children:"update"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.em,{children:"delete"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.em,{children:"merge"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["These values are instructions for the ",(0,i.jsx)(n.em,{children:"Synchronization"})," step to apply the changes to the database."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:".sorted"})," file (that is, the ",(0,i.jsx)(n.strong,{children:"original"})," clean export file, ",(0,i.jsx)(n.strong,{children:"not"})," the changes) is stored in the ",(0,i.jsx)(n.code,{children:"previous"})," folder inside the ",(0,i.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/network-configuration/server-configuration/general-purpose/",children:"Application Settings"}),"directory. It will be used as a reference for the next ",(0,i.jsx)(n.em,{children:"incremental"})," Prepare-Synchronization to compute the changes, if needed."]}),"\n",(0,i.jsxs)(n.p,{children:["Tampering with the ",(0,i.jsx)(n.code,{children:"previous"})," folder content would result in false changes leading to false computation. It would result in data corruption in the Identity Manager database. To restore the Identity Manager database and reflect the managed system data updates, a ",(0,i.jsx)(n.em,{children:"complete__Sync Up"})," would be required."]}),"\n",(0,i.jsx)(n.h3,{id:"prepare-the-server",children:"Prepare the server"}),"\n",(0,i.jsxs)(n.p,{children:["At the beginning of every ",(0,i.jsx)(n.em,{children:"Prepare-Synchronization"})," process, the ",(0,i.jsx)(n.em,{children:"Server"})," is notified via HTTP."]}),"\n",(0,i.jsxs)(n.p,{children:["Upon receiving the notification, the server creates a directory on its host environment, identified by a unique GUID, to contain ",(0,i.jsx)(n.code,{children:".sorted"})," or ",(0,i.jsx)(n.code,{children:".sorted.delta"})," files that will be sent by the agent."]}),"\n",(0,i.jsxs)(n.p,{children:["This is designed to prevent network errors that would cause an ",(0,i.jsx)(n.em,{children:"incremental"})," database update to happen more than once."]}),"\n",(0,i.jsxs)(n.p,{children:["This means that several ",(0,i.jsx)(n.em,{children:"Export"})," and ",(0,i.jsx)(n.em,{children:"Prepare-Synchronization"})," tasks can be executed simultaneously. These tasks will be processed by the server one at a time, in the right order."]}),"\n",(0,i.jsxs)(n.p,{children:["Any notification of a ",(0,i.jsx)(n.em,{children:"complete"})," Prepare-Synchronization would cancel the previous non-processed ",(0,i.jsx)(n.em,{children:"incremental"})," Prepare-Synchronizations. As a ",(0,i.jsx)(n.em,{children:"complete"})," Prepare-Synchronization reloads the whole database, it renders ",(0,i.jsx)(n.em,{children:"incremental"})," changes computation moot."]}),"\n",(0,i.jsx)(n.h3,{id:"send-clean-exports",children:"Send clean exports"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:".sorted"})," or ",(0,i.jsx)(n.code,{children:".sorted.delta"})," files are sent over HTTP to the ",(0,i.jsx)(n.em,{children:"Server"})," for the last step."]}),"\n",(0,i.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\n<PrepareSynchronizationTask\n    Identifier="HR_PrepareSynchronization"\n    DisplayName_L1="HR PrepareSynchronization"\n    OpenIdClient="Job"\n    Connector="HR"\n    Agent="Local"\n    SynchronizationMode="Initial"\n/>\n\n'})}),"\n",(0,i.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Property"}),(0,i.jsx)(n.th,{children:"Details"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Agent   required"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"Type"}),"    String   ",(0,i.jsx)(n.strong,{children:"Description"}),"   Identifier of the agent on which the job will be launched.   ",(0,i.jsx)(n.strong,{children:"Warning:"})," all jobs containing the task must be launched on the same agent or on the server."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Connector   required"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"Type"}),"    String   ",(0,i.jsx)(n.strong,{children:"Description"}),"   Identifier of the connector involved in the task."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"DisplayName_L1   required"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"Type"}),"    String   ",(0,i.jsx)(n.strong,{children:"Description"}),"   Display name of the task in language 1 (up to 16)."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"OpenIdClient   required"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"Type"}),"    String   ",(0,i.jsx)(n.strong,{children:"Description"}),"   Connection client for the task."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"SynchronizationMode   required"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"Type"}),"    DataCollectType   ",(0,i.jsx)(n.strong,{children:"Description"}),"   Synchronization mode for collect and synchronization Task.   List of Modes:   - Initial = 0,   - Complete = 1,   - Incremental = 2"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"ColumnName   optional"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"Type"}),"    String   ",(0,i.jsx)(n.strong,{children:"Description"}),"   If there is a delta in the synchronization, specifies the column name which stores the command"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Identifier   optional"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"Type"}),"    String   ",(0,i.jsx)(n.strong,{children:"Description"}),"   Unique identifier of the task."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Type   default value: None"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"Type"}),"    PrepareSynchronizationType   ",(0,i.jsx)(n.strong,{children:"Description"}),"   Define the type of PrepareSynchronization to launch the correct executable in job."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"WorkingDirectory   optional"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"Type"}),"    String   ",(0,i.jsx)(n.strong,{children:"Description"}),"   Path of the working directory"]})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);