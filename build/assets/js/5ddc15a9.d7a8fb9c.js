"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[204635],{28453:(e,r,s)=>{s.d(r,{R:()=>o,x:()=>a});var n=s(296540);const t={},i=n.createContext(t);function o(e){const r=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),n.createElement(i.Provider,{value:r},e.children)}},600217:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"passwordreset/administration/persuading_users_to_enroll","title":"Persuading Users to Enroll","description":"The Web Interface includes a REST API which your web sites and applications can query to determine if a user is enrolled. Your web site or application can take appropriate action to encourage the user to enroll. This could be anything from displaying a discreet message to denying access until the user enrolls.","source":"@site/docs/passwordpolicyenforcer/passwordreset/administration/persuading_users_to_enroll.md","sourceDirName":"passwordreset/administration","slug":"/passwordreset/administration/persuading_users_to_enroll","permalink":"/docs/passwordpolicyenforcer/passwordreset/administration/persuading_users_to_enroll","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/passwordpolicyenforcer/passwordreset/administration/persuading_users_to_enroll.md","tags":[],"version":"current","frontMatter":{},"sidebar":"passwordPolicyEnforcerSidebar","previous":{"title":"Permissions Tab","permalink":"/docs/passwordpolicyenforcer/passwordreset/administration/permissions_tab"},"next":{"title":"Securing Password Reset","permalink":"/docs/passwordpolicyenforcer/passwordreset/administration/securing_password_reset"}}');var t=s(474848),i=s(28453);const o={},a="Persuading Users to Enroll",d={},l=[{value:"Enabling the API",id:"enabling-the-api",level:2},{value:"Querying the API",id:"querying-the-api",level:2},{value:"Interpreting the Response",id:"interpreting-the-response",level:2},{value:"Performance and Caching",id:"performance-and-caching",level:2}];function c(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"persuading-users-to-enroll",children:"Persuading Users to Enroll"})}),"\n",(0,t.jsx)(r.p,{children:"The Web Interface includes a REST API which your web sites and applications can query to determine if a user is enrolled. Your web site or application can take appropriate action to encourage the user to enroll. This could be anything from displaying a discreet message to denying access until the user enrolls."}),"\n",(0,t.jsx)(r.h2,{id:"enabling-the-api",children:"Enabling the API"}),"\n",(0,t.jsx)(r.p,{children:"The API is disabled by default. If an attacker sends many queries to the API, they could try to guess the domain and user names of enrolled users. They could get the same information by sending many requests to the Web Interface.API is the more attractive target because API\xa0responds faster and API queries are not logged to the Audit Log."}),"\n",(0,t.jsxs)(r.p,{children:["If you do not want to enable the API because your Web Interface is accessible from the Internet, then you could leave the API disabled on your Internet-facing Web Interface and set up an internal Web Interface for API queries. Use the ServerIP registry value to point both Web Interfaces to the same NPR Server, and enable the API only on the internal server. See the ",(0,t.jsx)(r.a,{href:"/docs/passwordpolicyenforcer/passwordreset/administration/installation#multiple-server-installation",children:"Multiple Server Installation"})," topic for more information."]}),"\n",(0,t.jsx)(r.p,{children:"Follow the steps below to enable the API."}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Step 1 \u2013"})," Start the Registry Editor (regedit.exe)."]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Step 2 \u2013"})," Expand the ",(0,t.jsx)(r.strong,{children:"HKEY_LOCAL_MACHINE"}),", ",(0,t.jsx)(r.strong,{children:"SOFTWARE"}),", ",(0,t.jsx)(r.strong,{children:"ANIXIS"}),", ",(0,t.jsx)(r.strong,{children:"ANIXIS Password Reset"}),", and ",(0,t.jsx)(r.strong,{children:"3.0"})," registry keys."]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Step 3 \u2013"})," Create a new ",(0,t.jsx)(r.strong,{children:"DWORD"})," value called ",(0,t.jsx)(r.strong,{children:"WebAPIState"}),", and set it to 1."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"persuading_users_to_enroll",src:s(919238).A+"",width:"667",height:"321"})}),"\n",(0,t.jsx)(r.h2,{id:"querying-the-api",children:"Querying the API"}),"\n",(0,t.jsx)(r.p,{children:"Send a GET request with the user's Active Directory domain and user name like:"}),"\n",(0,t.jsxs)(r.p,{children:["GET https://[server]/pwreset/apr.dll/api/enrollments/",(0,t.jsx)(r.strong,{children:"[domain]"}),"/",(0,t.jsx)(r.strong,{children:"[user]"})]}),"\n",(0,t.jsx)(r.p,{children:"You can also use the User Principal Name (UPN):"}),"\n",(0,t.jsxs)(r.p,{children:["GET https://[server]/pwreset/apr.dll/api/enrollments/upn/",(0,t.jsx)(r.strong,{children:"[user@domain]"})]}),"\n",(0,t.jsx)(r.h2,{id:"interpreting-the-response",children:"Interpreting the Response"}),"\n",(0,t.jsx)(r.p,{children:"There are three possible responses:"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Response"}),(0,t.jsx)(r.th,{children:"Meaning"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:'{"isEnrolled": true}'})}),(0,t.jsx)(r.td,{children:"User is enrolled"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:'{"isEnrolled": false}'})}),(0,t.jsx)(r.td,{children:"User is not enrolled or does not exist"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"{}"})}),(0,t.jsx)(r.td,{children:"System maintenance is running"})]})]})]}),"\n",(0,t.jsx)(r.p,{children:"The API may also return one of these HTTP errors:"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Error"}),(0,t.jsx)(r.th,{children:"Reason"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"400 Bad Request"}),(0,t.jsx)(r.td,{children:"Invalid request path"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"403 Forbidden"}),(0,t.jsx)(r.td,{children:"API\xa0disabled, or cannot read configuration"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"500 Internal Server Error"}),(0,t.jsx)(r.td,{children:"Other error"})]})]})]}),"\n",(0,t.jsx)(r.h2,{id:"performance-and-caching",children:"Performance and Caching"}),"\n",(0,t.jsx)(r.p,{children:"API performance is dependent on many factors. Synchronous queries will suffice in most cases, but asynchronous queries are recommended to avoid delays."}),"\n",(0,t.jsx)(r.p,{children:"Avoid unnecessary calls to the API as they can overload the server. Try to call the API only once after users logon."}),"\n",(0,t.jsxs)(r.p,{children:["Caching improves performance and increases capacity. When the API sends a ",(0,t.jsx)(r.strong,{children:"user is enrolled"})," response, it requests caching for up to two weeks. The web browser should cache the response and use it for the next two weeks before querying the server again. No caching is requested for other responses."]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"NOTE:"})," You may get a ",(0,t.jsx)(r.strong,{children:"user is enrolled"})," response after deleting an enrolled user when testing the API. Clearing the browser cache may fix this, but not if other HTTP caches have cached the response."]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},919238:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/persuading_users_to_enroll-27109eb2247f55f17fe26a60cb970984.jpg"}}]);