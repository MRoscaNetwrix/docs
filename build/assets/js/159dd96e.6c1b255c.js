"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[969380],{28453:(e,s,t)=>{t.d(s,{R:()=>i,x:()=>a});var r=t(296540);const o={},n=r.createContext(o);function i(e){const s=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(n.Provider,{value:s},e.children)}},460429:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"passwordreset/administration/securing_password_reset","title":"Securing Password Reset","description":"Password Reset has many inbuilt security features, but there are some things you should do to secure Password Reset. The most important of these is to install an SSL certificate for the Web Interface. You can also set up a standard user account with delegated permissions for the Password Reset Server.","source":"@site/docs/passwordpolicyenforcer/passwordreset/administration/securing_password_reset.md","sourceDirName":"passwordreset/administration","slug":"/passwordreset/administration/securing_password_reset","permalink":"/docs/passwordpolicyenforcer/passwordreset/administration/securing_password_reset","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/passwordpolicyenforcer/passwordreset/administration/securing_password_reset.md","tags":[],"version":"current","frontMatter":{},"sidebar":"passwordPolicyEnforcerSidebar","previous":{"title":"Persuading Users to Enroll","permalink":"/docs/passwordpolicyenforcer/passwordreset/administration/persuading_users_to_enroll"},"next":{"title":"Security Tab","permalink":"/docs/passwordpolicyenforcer/passwordreset/administration/security_tab"}}');var o=t(474848),n=t(28453);const i={},a="Securing Password Reset",c={},d=[{value:"Installing and Using an SSL Certificate",id:"installing-and-using-an-ssl-certificate",level:2},{value:"Delegating Permissions to the Netwrix Password Reset Server Service",id:"delegating-permissions-to-the-netwrix-password-reset-server-service",level:2},{value:"Using Delegated Permissions with Protected Groups",id:"using-delegated-permissions-with-protected-groups",level:3}];function h(e){const s={a:"a",br:"br",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsx)(s.h1,{id:"securing-password-reset",children:"Securing Password Reset"})}),"\n",(0,o.jsx)(s.p,{children:"Password Reset has many inbuilt security features, but there are some things you should do to secure Password Reset. The most important of these is to install an SSL certificate for the Web Interface. You can also set up a standard user account with delegated permissions for the Password Reset Server."}),"\n",(0,o.jsx)(s.h2,{id:"installing-and-using-an-ssl-certificate",children:"Installing and Using an SSL Certificate"}),"\n",(0,o.jsxs)(s.p,{children:["The Web Interface and Password Reset Server always communicate over a secure channel. You do not have to configure the encryption for this connection, but you do need to set up SSL (Secure Sockets Layer) encryption for the connection between the web browser (or Password Reset Client) and the web server. See the ",(0,o.jsx)(s.a,{href:"/docs/passwordpolicyenforcer/passwordreset/administration/password_reset_client",children:"Password Reset Client"})," topic for more information."]}),"\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"CAUTION:"})," Do not use Password Reset on a production network without SSL encryption."]}),"\n",(0,o.jsx)(s.p,{children:"You can use a self-signed certificate with Password Reset, but most organizations purchase certificates from a certificate authority. You can install the Web Interface on a server that already has an SSL certificate if you would rather not purchase another one."}),"\n",(0,o.jsx)(s.p,{children:"Your certificate authority will have instructions to guide you through the certificate request and installation process. You can also learn more about using SSL certificates with IIS on the pages below."}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:(0,o.jsx)(s.a,{href:"http://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis",children:"http://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis"})}),"\n",(0,o.jsx)(s.li,{children:(0,o.jsx)(s.a,{href:"http://technet.microsoft.com/en-us/library/cc732230(WS.10).aspx",children:"http://technet.microsoft.com/en-us/library/cc732230(WS.10).aspx"})}),"\n"]}),"\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"NOTE:"})," Ensure that users only access Password Reset over an encrypted connection after the SSL certificate is installed. The Start address and Restricted path in the Password Reset Client configuration should start with https://. Web browsers can be redirected to the secure URL. See the ",(0,o.jsx)(s.a,{href:"/docs/passwordpolicyenforcer/passwordreset/administration/password_reset_client#configuring-the-prc",children:"Configuring the PRC"})," topic for more information."]}),"\n",(0,o.jsx)(s.h2,{id:"delegating-permissions-to-the-netwrix-password-reset-server-service",children:"Delegating Permissions to the Netwrix Password Reset Server Service"}),"\n",(0,o.jsx)(s.p,{children:"When the Setup wizard creates a service account for the Password Reset Server, it adds the account to the Domain Admins group. This allows Password Reset to start working without additional configuration, but it also gives the service excessive permissions. You can improve security by removing the service account from the Domain Admins group and granting only the required permissions."}),"\n",(0,o.jsx)(s.p,{children:"You can grant Active Directory permissions from the command-line with dsacls.exe, or with the graphical user interface. The examples below use the command-line, but you can use either method. The commands you need to execute are:"}),"\n",(0,o.jsxs)(s.p,{children:['dsacls "[object]" /I',":S",' /G "[account]',":CA",';Reset Password;user"']}),"\n",(0,o.jsxs)(s.p,{children:['dsacls "[object]" /I',":S",' /G "[account]',":RPWP",';lockoutTime;user"']}),"\n",(0,o.jsxs)(s.p,{children:['dsacls "[object]" /I',":S",' /G "[account]',":RPWP",';pwdLastSet;user"']}),"\n",(0,o.jsx)(s.p,{children:"Where [object] is the distinguished name of the domain or OU containing the user accounts, and [account] is the name of the service account in user@domain or domain\\user format."}),"\n",(0,o.jsxs)(s.p,{children:["The first two commands allow NPR to reset passwords and unlock accounts. Both commands are required even if the Unlock item is hidden from the menu because Password Reset automatically unlocks an account when its password is reset. The third command allows Password Reset to set ",(0,o.jsx)(s.strong,{children:"User must change password at next logon"})," in Active Directory if the ",(0,o.jsx)(s.strong,{children:"Require users to change their password after a reset"})," option is enabled in the Configuration Console's ",(0,o.jsx)(s.strong,{children:"Security"})," tab."]}),"\n",(0,o.jsx)(s.p,{children:"For example, the following command grants the axs\\apr account permission to reset passwords for users in the axs.net domain:"}),"\n",(0,o.jsxs)(s.p,{children:['dsacls "dc=axs,dc=net" /I',":S",' /G "axs\\apr',":CA",';Reset Password;user"']}),"\n",(0,o.jsxs)(s.p,{children:["If Password Reset is configured to use an SQL Server Compact database, then give the service account read and write permissions to the database files. See the ",(0,o.jsx)(s.a,{href:"/docs/passwordpolicyenforcer/passwordreset/administration/moving_to_sql_server",children:"Moving to SQL Server"})," topic for more information."]}),"\n",(0,o.jsx)(s.p,{children:"Remove the service account from the Domain Admins group and restart the Password Reset service after executing these commands. Check the Windows Application event log if the service does not start."}),"\n",(0,o.jsx)(s.h3,{id:"using-delegated-permissions-with-protected-groups",children:"Using Delegated Permissions with Protected Groups"}),"\n",(0,o.jsx)(s.p,{children:"When you delegate permissions for the Password Reset service account, the delegated permissions are initially applied to all users in the domain or OU. After some time, Windows restores the original permissions for some important user accounts. The restored permissions do not allow Password Reset to reset passwords or unlock accounts for these users."}),"\n",(0,o.jsx)(s.p,{children:"The accounts protected by this feature vary by Windows version, and include members of the Domain Admins, Enterprise Admins, and Schema Admins groups. The list of protected groups is configurable, so it may differ from the defaults in the Windows documentation."}),"\n",(0,o.jsx)(s.p,{children:"If you are using an Password Reset service account with delegated permissions and do not want these privileged accounts to reset their password or unlock their account with Password Reset, then there is no need to make any configuration changes. Windows automatically restores the original permissions for these accounts. This is done every hour by default."}),"\n",(0,o.jsx)(s.p,{children:"If you want to allow these users to reset their password and unlock their account with Password Reset, then you need to change the permissions for the AdminSDHolder container. The commands you need to execute are:"}),"\n",(0,o.jsxs)(s.p,{children:['dsacls "[AdminSDHolder]" /G "[account]',":CA",';Reset Password"']}),"\n",(0,o.jsxs)(s.p,{children:['dsacls "[AdminSDHolder]" /G "[account]',":RPWP",';lockoutTime"']}),"\n",(0,o.jsxs)(s.p,{children:['dsacls "[AdminSDHolder]" /G "[account]',":RPWP",';pwdLastSet"']}),"\n",(0,o.jsxs)(s.p,{children:["Where [AdminSDHolder] is the distinguished name of the AdminSDHolder container, and [account] is the name of the service account in user@domain or domain\\user format.",(0,o.jsx)(s.br,{}),"\n","The DN of the AdminSDHolder container for the netwrix.com domain is CN=AdminSDHolder,CN=System,DC=netwrix,DC=com"]}),"\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"NOTE:"})," Changes to the AdminSDHolder container are not applied to accounts immediately. You may need to wait up to an hour for Windows to update the DACL for these accounts. You can also start the process manually. Search for runProtectAdminGroupsTask or FixUpInheritance in Microsoft's documentation or more information."]})]})}function u(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}}}]);