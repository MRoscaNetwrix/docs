"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[245585],{28453:(e,t,s)=>{s.d(t,{R:()=>c,x:()=>a});var r=s(296540);const n={},o=r.createContext(n);function c(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:c(e.components),r.createElement(o.Provider,{value:t},e.children)}},164325:(e,t,s)=>{s.d(t,{A:()=>r});const r="data:image/webp;base64,UklGRiwNAABXRUJQVlA4ICANAABwQwCdASqrAVoAPm0wk0akIyGhJJN+eIANiU3cLYwHYvL0/dWqa9+n2XilP3/671Cf3n00Ogt5gP5D/gP2W93P/lepv+09Md6jfoAec//7vZM/w/pi+gBvqHib+SduP9Q/F/sIfS/tduu2o78Y+zH3b+p/jF7X/3jxT+D/7p6gX45/I/7b+ZPnA7jutfoBetHzf/M/1L9xv7T6KX9l/QPU/8I/qf+q9wD+Ifyn+/+onhK+F/SB9gH8q/nf+i/vn7r/5D6Vv13/of4L8sPaV+R/13/nf3j8kfsD/kv88/3X9x9qr15fr5///cn/XT/9nVc/P0A4A8E6Oyg87+Ha3PlI7W58pHa3PlI7W58pHansPkh4ug+vSBDs/HBqs5buZvFblPhRLKWt0qc0dpETf8D7cJyrVeci9FaPr46iNpuld7BN7s3uf52zVwkqBiAgQIIn4hLpuLbzXcNvRAULTETf3TzD2tuIXo52bHgvxZDyLth9QrlGCMhS5hj+GUXGYCPz19Kv4pc5el2rOj0aCUXNW7v9Iw8xfBD/jckCY9DVLtwPxVjb+mcKFU0ORNoY1jJ2QMR7Fs+IPX3lEYE+cYK2lwh/PzzUnuT5H5z88yZALxanlGXmKxlllllllllllhgrxi0p9O2WpmkXzTVZiyddnebqirQYZmqvXu0RFLke7cMao3JGHupcIf9c7W58pHa3B9PAm3q3mST7hi/WneUtT2KQAAD+5XZsOxZB8+pjt6m0zCx8Ql+DkTUVSrd0pCStztAqaO8YLqiWnmHKkAZEdBRljYmtEngV75qoQjDlz+gZ8WdUgRR5cF97ssrgAh5yN1Q2mKzzf6+al4beafRI9cFz9RN8hB5tbFuXmsaib5CDz4AGzIUhu8X37omNpdU39eojyEY4ilIhX322QJt+N0W2jTbv7tXvmyWZtQ08xz1Ka3wmLj19ZlQubjJoVoyodyB4kDDEfMnSmKhVTTek98j5b9/IJWefrKlxUb/GHHEOhEeU3U8kuCU0uEXkSqKfsYJO876TTX85Ac0ZNtFlDxBUeTP3EiJyRwXczKHbaj9jdQVmjl7k7Ug2dyUiKXNxynfZp+yTXXg9q4SbXHD9rCS352zwx86sg7aXsuyt71ChMDN/WlDKxM/PZd0ChLwbJpXvoWAFce8p6tVG74tFSginjTwz3V5LR2n2A2w9ALFr1Mz5VhD+NeoU+54WYwKbliG9yMevT9jFhvOSPwoGowanrSIcoX9vhJuxSLqbfheReZlGhFR25jYuEGj4X8H38sGThnIo/1Ijxfp4es4G45hYdnUII0FTg8VM418QAttZqBP6/Z3zwM/XP/Bki7fqZgeu6DBYm/8Cr5TnJaCuNg7NqYr456ZuYdR+cQ5OBv+O4RljM1h3/ZYYqtdn11bSQWpKtljzHaWWtrqcGX8+hVn7q1LgsXCJwWHtb/DMPzTGSax5xGAmMjxeSY58PxkOGwhG97nhBvpzJN3jRT9RHFJvaUgLM0+hv3itpyQRwPlrLW+kYqGM5EhZeP8bGeiw9AR26IFvEv/pt0atFjDjyIUn36cCma8R9PSys5BPTJ8Mn7JKiR2k8LnEW3DJZQxbEebHQGPD3QEr6DnJ5DbCyRs1Rfgv6NJmoN6S1PRaRkrOHZxzFPaM8OckGdXtmhlIrSV27qNxe0hFj9wJGpURtCgwt80SlKn8uW5E3dPGXVtoyXaiGA83rUFkBUKiVGWhWPlAuEvXCU6VWXItzxKOltGQtmSbOGuYkKSoouZyUOIkrsn1+jVauW1+4rACGSPdJEAY08ioW/qQQKHlV7xw2CSkLT8PKeZadHkUpfGpST+A5NPWDu+Zi5yCcGd3DN5W9mfpAdyjiHWMGrxB5e+nwPNOt9Tyn/AJvan88ezDq+3tbVgxAZ8dq4DNzUvbqj5t1aQWA47xj3FIXNII3ZsgFI0Q2CCf0041wt7f5WMoJN5994z0wD+IYvtG0hxCL2H4JR3KnRWgJ3YvIJ/MMZxJ6leDhYd3ZLANqJvjwnG0CqFo0MgtCsaRx06tQwYgeQ4VuOqXcon3cT2ZfmKlrhs1NIyo91HDgc8RCZdsU6NzuHUpqES4E6ZuOJCWMJEKxfF3J4fX3ADgeJ3j95mocMerfzq//w1SO1f4spol49O3d/CW7O6YQufB3ofLZN4GEjnh/HzipLppEAlbHyNbXb2ZLj885O496q9QsRYbIubY9OkErUYG9IHSitMKkOjp8Ir233npyovzJuXuwIJucXyRzmzftnjuWNMUgIsy6N3xqkD2URZ2m3Ot4bCLCgrqUDOANbLN9eFo7yz7d6WjhlsQlYJIV6TyB486BXK6ysX7HaykrKoj7yzsHh8GwexUSTnP1uTx4jmdIkvtb9Azf39hv2CF8V6XActuU5HBqumegE5huieA0HWIAKGaiwGkR/vEbIchn6Hli93tZYYTsa2VGcx5k3eq8J7fnnaX2cNJK9dnx3kWW2AUlMLB5Grt9e04j6AeuGRYjU/JRH+sZ2dciWoMs8sCc2yyeC4pmZ8LRkWoggWR+GAjmwlXeWNT4NOKgiEhJ/wxHjEq2hhF4WVzbcqQUH4OckIq7qdwI8nqaOIfftvHwp+wfCT7XWihhzY85Kws7Z2ItMFSf0z5+hYMDz6J0itpXqXtKw8vu2BcfQwV6D+yYT4Umoea5vWfUYJXB06EinJIAiYxWXQRlobCaQdJTftINt0TJTxXCv9gn/w8Q3U7eSRKijJQNrHUs2EfBbe2WVnKHOtcq3iUMI2nfwJ6Z/+XZ1f2abfsOvViCJPTt3ewcjm3HFlp1Zqw3z12gnKLjI9mLfdmMOMSx5I3R2sEl5he1HSz61xtxdhKBFyK882+zsf9afsMfgBgdDPEWTTL23Ud8vR1i2qkoaJWqgxIDG8aMqWADgDc8DeMuBBv4UbYQDW7EZnS+GTpdXPrx/6Kjkz5371vMD/8kLM2Rujix3gu3H6Nk1Nd3viu+XpXx7XVEcTHayo83PcjT8qjYVklUTt95RCbL2i/+X2Vc3lWcWvzEsFSSSNf0R4k3HhAlyaIk8sNYbzdJMTLrq8LdO6SGBcehDgZXuOjl09qlH1/AEZEO36FrbpwhQiH9hgM9pIoBZQkAMl4wI6H7p8QLIUSX/qMuWiGDILeZtgnHG9x+ZEe2I3Aka4HJPswJcEXsIb+ysOAbVdFfCO3j1O2Xp4+EL1rPnde2fnwOHl02dDZTCq9IxDPmmfZB+pOtp2PMYackxUQ8Jj/3kX5g7w+87l+lSyDQfkMEP6h5PM3JiGkz4g+LaBG3gVnPnxiPZlQRrFUF4dSn5A4cN4TOjPp8nTS6ow/Eyui7O862VyHty0Af4BBGXXFYSFHOCPirH/0OISflV3nbX69uqdB6M9q6dgXyjCuLFIN+XdKZcGS3oM9I3UHTsAY+/N0PLDz3zcZg8c8qHpeix33FMxYTinVNfXNoX433ma5E5xVeKRxCEngeMYNcolL3yYjqGBNJJKmSdYTpk5Lt4TGONoElBjVtIALKlGbcoBzZOrJFi1O1onnWLk09PWuC5HeMvMP0EtfsS1I2CO8DDl17qGLwcL6bKkCtWD60fmkXouMGmzqfsM0m8NbIjlT0+jTF1x/ubIW6eYMxn2awDeZjuXjaNy70IGFI0Tu+++7uvv5sgawvgoiwassB++zPHTVWW/Z/19DwyF87wYyP0AVOKd+00eC/cCDUWheGpuulXcehPRVdSC6HgJ4YvpcPZke8AAAAAAAAzGqlrzxAfjoGuaUXRpofdwTj3G/24ifvutqNqY09oKbhUkOA4LtNxh7BwjNyhbIDppWozrMSMH9wRASR3APV/wSGTOyeCUV9g05wau5Txnu06Gji6JL+UyqLai21c7Qh3FUFwqINsqqS549SQGNPnNbIPp6g1U51AobhgzXOhxegA5yxJG+Y0L3DnBf4nM+MdbXCjf7V2AenwW38bpyzRB4AdaKLo4cxYxNOAy8eARfP/p5jUVdHvoN6gbToibwqpd/v/m/vDYcljyog9OFcHeH7onMDdv1tqtFn/mKxuBaVml1NzS0fCfFZ8rem6S8GjAytASd/IcVkVzbESFURE/7hzKEist0gZjwPKCNd3ec3YGd7UBhmzxAEZxH1S1gPGHiiUv/K70bq/6aJ78+zCRTfb2HHRp6poK9DRgimATddsast+dvUrWtBIFo253wSSGCenVNHxhL9+1Ds99/jF0nC+V90FG1mfMX/cCcOuz9ti6eZ7G4AdVDuID4UCbW3xmTAnarEoCmu2//Aa0oxBssJyv+OQF40Gr6vYUzduinWIMHQCHfUhVlFfwRi47yNXGns1yLH+G1Hx56XUA+BWtM1Rh8r3eDDB9ak0WI0MkpZKcu6z5IXlVlZV1pBNa/qtxyZltAj0lOzZLnlpxChJ1WoSezM52oR24bQL4taGO7CJNURBsj6tBr+82da97Rl/gNAtLqwFaYaBKAAAA="},400803:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/923_4_image-20221221103111-4-cf9e45deb25317b0d31bc8cb76aaef4a.webp"},568405:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/923_5_image-20221221103111-5-b40a375ba5f8f51bbb41ce81e94f30a5.webp"},602141:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/923_3_image-20221221103111-3-cc1c8850c76bc2bd6a03a51a8c32cb29.webp"},723191:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/923_2_image-20221221103111-2-50c617d3a120eb451c8fda12c45fb4b5.webp"},973355:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>i,contentTitle:()=>a,default:()=>d,frontMatter:()=>c,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"policypak/scriptstriggers/localaccountpassword","title":"How to Set the Password for a Local Account using Scripts Manager","description":"As of https://support.microsoft.com/en-us/topic/ms14-025-vulnerability-in-group-policy-preferences-could-allow-elevation-of-privilege-may-13-2014-60734e15-af79-26ca-ea53-8cd617073c30 Microsoft has blocked the ability to configure local","source":"@site/docs/policypak/policypak/scriptstriggers/localaccountpassword.md","sourceDirName":"policypak/scriptstriggers","slug":"/policypak/scriptstriggers/localaccountpassword","permalink":"/docs/policypak/policypak/scriptstriggers/localaccountpassword","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/scriptstriggers/localaccountpassword.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Understanding Processing Order and Precedence","permalink":"/docs/policypak/policypak/scriptstriggers/itemleveltargeting/processorderprecedence"},"next":{"title":"How to Create a Local Scheduled Task to Reboot a PC every day at 9 AM","permalink":"/docs/policypak/policypak/scriptstriggers/localscheduledtask"}}');var n=s(474848),o=s(28453);const c={},a="How to Set the Password for a Local Account using Scripts Manager",i={},l=[];function p(e){const t={a:"a",code:"code",h1:"h1",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"how-to-set-the-password-for-a-local-account-using-scripts-manager",children:"How to Set the Password for a Local Account using Scripts Manager"})}),"\n",(0,n.jsxs)(t.p,{children:["As of ",(0,n.jsx)(t.a,{href:"https://support.microsoft.com/en-us/topic/ms14-025-vulnerability-in-group-policy-preferences-could-allow-elevation-of-privilege-may-13-2014-60734e15-af79-26ca-ea53-8cd617073c30",children:"https://support.microsoft.com/en-us/topic/ms14-025-vulnerability-in-group-policy-preferences-could-allow-elevation-of-privilege-may-13-2014-60734e15-af79-26ca-ea53-8cd617073c30"})," Microsoft has blocked the ability to configure local\npasswords using Group Policy Preferences.\xa0 However, you can still workaround this by using a PowerShell script\nwithin Netwrix Endpoint Policy Manager (formerly PolicyPak) Scripts and Triggers Manager (PPScripts)."]}),"\n",(0,n.jsx)(t.p,{children:"How this works is that you first define your own Security Key to use for\nencrypting the clear text password, (see $key below for example)."}),"\n",(0,n.jsx)(t.p,{children:"Create the password file:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"$key = (1,2,3,4,5,1,2,3,4,5,11,12,13,14,15,20,30,40,50,5,4,3,2,1)  \nread-host -assecurestring | convertfrom-securestring -key $key | out-file \\\\server\\share\\file.txt\n"})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"NOTE:"})," The PowerShell Script above was borrowed from: ",(0,n.jsx)(t.a,{href:"https://community.spiceworks.com/topic/584947-local-users-and-groups-group-policy-update",children:"https://community.spiceworks.com/topic/584947-local-users-and-groups-group-policy-update"}),")"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"CAUTION:"}),"  The targeted endpoint must have rights to read the share and file used above (i.e.,\n",(0,n.jsx)(t.code,{children:"\\\\server\\share\\file.txt"}),"\n)."]}),"\n",(0,n.jsx)(t.p,{children:'Then use that Security Key to encrypt the clear text password that you enter on the screen, i.e.,\n"Password!"'}),"\n",(0,n.jsx)(t.p,{children:"If using PowerShell ISE:"}),"\n",(0,n.jsx)(t.p,{children:"Enter the password in the window that appears when the script above is run."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"923_1_image-20221221103111-1",src:s(164325).A+"",width:"427",height:"90"})}),"\n",(0,n.jsx)(t.p,{children:"If running PowerShell from CMD:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"923_2_image-20221221103111-2",src:s(723191).A+"",width:"983",height:"303"})}),"\n",(0,n.jsxs)(t.p,{children:["The resulting encrypted password is then stored at a secure location that is accessible from the endpoints (in this\ncase a file on a secure network share ",(0,n.jsx)(t.code,{children:"(\\\\server\\share\\file.txt)"}),"."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"923_3_image-20221221103111-3",src:s(602141).A+"",width:"925",height:"167"})}),"\n",(0,n.jsx)(t.p,{children:"The next step is to create a computer side PowerShell policy in Endpoint Policy Manager Scripts & Triggers."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"923_4_image-20221221103111-4",src:s(400803).A+"",width:"731",height:"516"})}),"\n",(0,n.jsx)(t.p,{children:'Then at the "On Apply action" screen choose PowerShell script for the type of script from the dropdown,\nand then paste in the script below after editing it to reflect your Security Key, and the corresponding local username\non the endpoints in your environment that you wish to update.'}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:'$key = (1,2,3,4,5,1,2,3,4,5,11,12,13,14,15,20,30,40,50,5,4,3,2,1)  \n$pwd = get-content \\\\server\\share\\file.txt | convertto-securestring -key $key  \n$user = "EastSalesUser1"  \n$cred = new-object -typename System.Management.Automation.PSCredential -argumentlist $user,$pwd  \n$pw = $cred.GetNetworkCredential().Password  \n$cmd = "net user $user $pw"  \nInvoke-Expression $cmd\n'})}),"\n",(0,n.jsxs)(t.p,{children:["This script will read the",(0,n.jsx)(t.code,{children:" file.txt"})," from the secure network share and then use that information to update any local\nuser account you have defined in your script."]}),"\n",(0,n.jsx)(t.p,{children:'In the example below we are setting the password for a local user called "EastSalesUser1", see $user\nbelow).'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"923_5_image-20221221103111-5",src:s(568405).A+"",width:"737",height:"512"})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"CAUTION:"}),"  The targeted endpoint must have rights to read the share and file used above (i.e.,\n",(0,n.jsx)(t.code,{children:"\\\\server\\share\\file.txt"}),")."]}),"\n",(0,n.jsx)(t.p,{children:"Lastly, apply the policy to any endpoints as needed and you are good to go."})]})}function d(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}}}]);