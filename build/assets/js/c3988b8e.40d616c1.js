"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[564153],{28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>c});var n=s(296540);const i={},r=n.createContext(i);function o(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(r.Provider,{value:t},e.children)}},157067:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>n,toc:()=>p});const n=JSON.parse('{"id":"policypak/scriptstriggers/edgefirstlogon","title":"How to Run Microsoft Edge Once at a User\'s 1st Logon using Scripts and Triggers Manager","description":"Step 1 \u2013 Create a new Scripts and Triggers Policy on the Computer side that runs in Switched Mode or on the User side.","source":"@site/docs/policypak/policypak/scriptstriggers/edgefirstlogon.md","sourceDirName":"policypak/scriptstriggers","slug":"/policypak/scriptstriggers/edgefirstlogon","permalink":"/docs/policypak/policypak/scriptstriggers/edgefirstlogon","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/scriptstriggers/edgefirstlogon.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"What must I do in Cylance such that it will run Powershell scripts via Endpoint Policy Scripts Manager?","permalink":"/docs/policypak/policypak/scriptstriggers/cylance"},"next":{"title":"Using Endpoint Policy Manager Scripts on the Computer Side","permalink":"/docs/policypak/policypak/scriptstriggers/gettoknow/computerside"}}');var i=s(474848),r=s(28453);const o={},c="How to Run Microsoft Edge Once at a User's 1st Logon using Scripts and Triggers Manager",a={},p=[];function l(e){const t={code:"code",h1:"h1",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"how-to-run-microsoft-edge-once-at-a-users-1st-logon-using-scripts-and-triggers-manager",children:"How to Run Microsoft Edge Once at a User's 1st Logon using Scripts and Triggers Manager"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 1 \u2013"})," Create a new Scripts and Triggers Policy on the Computer side that runs in Switched Mode or on the User side."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 2 \u2013"})," Use the script below and be sure to check the option to run the script interactively and as the user."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"868_1_image-20220225024809-1_950x457",src:s(988733).A+"",width:"950",height:"457"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'$path = "$env:LOCALAPPDATA\\temp\\1stlogon.flg"  \n$logfile = "$env:LOCALAPPDATA\\temp\\1stlogon.log"  \n# TIMESTAMP FUNCTION: Usage: Write-Output "$(Get-TimeStamp) Text goes here" | Out-file C:\\log.txt -append  \nfunction Get-TimeStamp {  \n\xa0\xa0return "[{0:MM/dd/yyyy} {0:HH:mm:ss}]" -f (Get-Date)  \n}  \nif(!(Test-Path -Path $path))  \n{  \n\xa0\xa0\xa0\xa0New-Item -Path "$env:LOCALAPPDATA\\temp\\1stlogon.flg"  \n\xa0\xa0\xa0\xa0Write-Output "$(Get-TimeStamp) Going to run Edge since this is the 1st logon."| Out-file $logfile -append  \n\xa0\xa0\xa0\xa0start msedge  \n}  \nelse  \n{  \n\xa0Write-Output "$(Get-TimeStamp) Script has been already applied. Skipping." | Out-file $logfile -append  \n}\n'})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 3 \u2013"}),' At the "Specify process mode" screen select "On trigger" and choose "Logon" from the drop-down, then click "Next".']}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"868_2_image-20220225024809-2",src:s(533682).A+"",width:"726",height:"596"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 4 \u2013"}),' At the Trigger settings" screen set a delay if desired otherwise click "Next" the skip this option.']}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 5 \u2013"}),' At the "Policy settings" screen give the policy a descriptive name then click "Finish".']}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Step 6 \u2013"})," Lastly, apply the policy, and test with a new user logon, if all goes well you will see the screen below after a successful 1st logon."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"868_3_image-20220225024809-3_900x490",src:s(801785).A+"",width:"900",height:"490"})})]})}function d(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},533682:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/868_2_image-20220225024809-2-0d7f4e0be612d97728108d4eff1730f8.webp"},801785:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/868_3_image-20220225024809-3_900x490-93feafc0af1db0a7ccc65b5e03f2eaf4.webp"},988733:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/868_1_image-20220225024809-1_950x457-9dd90682f593dcc5a7c90183bd670202.webp"}}]);