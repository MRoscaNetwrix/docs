"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[446214],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var i=t(296540);const r={},o=i.createContext(r);function a(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(o.Provider,{value:n},e.children)}},243953:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/policytab-d2dc1145d52b1fd28414d9a2c3672dd5.webp"},343660:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"threatprevention/admin/analytics/kerberosweakencryption","title":"Kerberos Weak Encryption Analytic Type","description":"The Kerberos Weak Encryption analytic type identifies Kerberos tickets with RC4\\\\HMAC\\\\MD5 encryption by detecting the use of weak encryption. Various attack methods utilize weak Kerberos encryption cyphers, including Overpass-the-Hash.","source":"@site/docs/threatprevention/threatprevention/admin/analytics/kerberosweakencryption.md","sourceDirName":"threatprevention/admin/analytics","slug":"/threatprevention/admin/analytics/kerberosweakencryption","permalink":"/docs/threatprevention/threatprevention/admin/analytics/kerberosweakencryption","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/threatprevention/threatprevention/admin/analytics/kerberosweakencryption.md","tags":[],"version":"current","frontMatter":{},"sidebar":"threatPreventionSidebar","previous":{"title":"Impersonation Logins Analytic Type","permalink":"/docs/threatprevention/threatprevention/admin/analytics/impersonationlogins"},"next":{"title":"Analytics Interface","permalink":"/docs/threatprevention/threatprevention/admin/analytics/overview"}}');var r=t(474848),o=t(28453);const a={},s="Kerberos Weak Encryption Analytic Type",c={},d=[{value:"Configure Kerberos Weak Encryption Analytic Policy",id:"configure-kerberos-weak-encryption-analytic-policy",level:2},{value:"Kerberos Weak Encryption Analytic Data Grid",id:"kerberos-weak-encryption-analytic-data-grid",level:2}];function l(e){const n={a:"a",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"kerberos-weak-encryption-analytic-type",children:"Kerberos Weak Encryption Analytic Type"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"Kerberos Weak Encryption"})," analytic type identifies Kerberos tickets with RC4_HMAC_MD5 encryption by detecting the use of weak encryption. Various attack methods utilize weak Kerberos encryption cyphers, including Overpass-the-Hash."]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Kerberos Weak Encryption"}),(0,r.jsx)(n.th,{})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Definition"}),(0,r.jsx)(n.td,{children:"Kerberos tickets with RC4_HMAC_MD5 encryption."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Example"}),(0,r.jsx)(n.td,{children:"Kerberos tickets are used as a sort of \u201cpass card\u201d to obtain access to resources. Once a domain controller authenticates a user, a TGT (ticket granting ticket) is granted with a limited lifespan. This is then used to obtain TGS (ticket granting service) and the TGS is what identifies a user to a resource on the network.  If RC4_HMAC_MD5 encryption is used then it makes possible to obtain password value using Kerberoasting attack. If a user on the network were to attempt to use such a ticket, this analytic would detect this ticket and generate an alert."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Trigger"}),(0,r.jsx)(n.td,{children:"Ticket uses RC4_HMAC_MD5 encryption."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Recommended Settings"}),(0,r.jsx)(n.td,{children:"No additional configuration is needed"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Analytic Workflow"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Configure the analytic policy"}),"\n",(0,r.jsx)(n.li,{children:"Enable the analytic policy"}),"\n",(0,r.jsxs)(n.li,{children:["Enable alerting on incidents through the ",(0,r.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/systemalerting/overview",children:"System Alerting Window"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"#Kerberos-Weak-Encryption-Analytic-Data-Grid",children:"Kerberos Weak Encryption Analytic Data Grid"})," topic for information on event data collected per incident."]}),"\n",(0,r.jsx)(n.h2,{id:"configure-kerberos-weak-encryption-analytic-policy",children:"Configure Kerberos Weak Encryption Analytic Policy"}),"\n",(0,r.jsx)(n.p,{children:"Open the Kerberos Weak Encryption Policy in any of the following ways:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Click Analytics in the left pane to launch the Analytics interface. Then click the gear icon for the analytic."}),"\n",(0,r.jsx)(n.li,{children:"Expand the Analytics node and click the desired analytic. On the analytic window, click the gear icon available in the top right corner."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The Configure Analytics window has one tab:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Policy \u2013 Where filters can be added, additional actions configured, a custom schedule set, and the policy enabled"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Policy Tab"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Kerberos Weak Encryption Analytic Type - Policy tab",src:t(243953).A+"",width:"851",height:"832"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"Policy"})," tab for configuring analytics consists of three sub-tabs:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["General tab \u2013 Configured the same way a regular policy\u2019s ",(0,r.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/policies/general",children:"General Tab"})," is configured. The only exception is that the Name and Description are hard coded, and cannot be modified. The Tags field is disabled for analytics."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Event Type tab \u2013 Configured the same way a regular policy\u2019s ",(0,r.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/policies/eventtype/overview",children:"Event Type Tab"})," is configured. The only exception is that the ",(0,r.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/policies/eventtype/authenticationmonitoring",children:"Authentication Monitoring Event Type"})," is hard coded, and the Success filter cannot be modified."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Scope the servers to be included in or excluded from monitoring on the IP Addresses (from) filter, the IP Addresses (to) filter, the Hosts (from) filter, or the Hosts (to) filter."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"NOTE:"})," Some authentication events may return only a host name (NetBIOS or FQDN), others may return only an IP address. It is recommended to take this into account when entering filter values."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:"Alternatively:"}),"\xa0Scope the domains to be included in or excluded from monitoring on the Domains/Servers filter."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"_Optional:_Scope the protocol to be monitored on the Authentication Protocol filter. If enabling the analytic on a domain controller, also scope the login type. The Authentication Protocol filter is hard coded to ensure the Kerberos protocol is monitored."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"NOTE:"})," The Exclude failed authentications with \u2018N-2\u2019 passwords option requires a GPO within the organization be configured to \u2018Enforce password history\u2019 with a setting of a minimum of \u20183 passwords remembered\u2019 or it will not have an effect."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:"Optional"})," \u2013 Scope the accounts to include in or exclude from being monitored on the AD Perpetrator filter."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Actions tab \u2013 Configured the same way a regular policy\u2019s ",(0,r.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/policies/actions/overview",children:"Actions Tab"})," is configured. The only exceptions are that the \u201cSend to Event DB\u201d and \u201cEmail Notifications\u201d options are disabled. The event data collected by analytic policies are stored in memory until an incident is triggered. For the \u201cSend Raw Data to SIEM\u201d option, use ",(0,r.jsx)(n.em,{children:"caution"}),", as this will send all event data not the triggered incident, which could be a large volume of data. To send notifications on incidents, use the ",(0,r.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/systemalerting/overview",children:"System Alerting Window"})," to configure Email and SIEM alerts."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"kerberos-weak-encryption-analytic-data-grid",children:"Kerberos Weak Encryption Analytic Data Grid"}),"\n",(0,r.jsxs)(n.p,{children:["The data grid on the ",(0,r.jsx)(n.strong,{children:"Kerberos Weak Encryption"})," node lists one row per incident identified."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"kerberosweakencryption",src:t(667216).A+"",width:"1088",height:"426"})}),"\n",(0,r.jsxs)(n.p,{children:["The data grid can be filtered according to the Event Tracker status: All, New, or Reviewed. See the ",(0,r.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/policies/recentevents/eventtracker",children:"Event Tracker Window"})," topic for additional information."]}),"\n",(0,r.jsx)(n.p,{children:"The top data grid includes the following information for each incident:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"From Host \u2013 Name of the originating host"}),"\n",(0,r.jsx)(n.li,{children:"From Host IP Address \u2013 IP address of the originating host"}),"\n",(0,r.jsx)(n.li,{children:"To Host \u2013 Name of the target host"}),"\n",(0,r.jsx)(n.li,{children:"To Host IP Address \u2013 IP address of the target host"}),"\n",(0,r.jsx)(n.li,{children:"Account Name \u2013 Security principal of the account that triggered the incident"}),"\n",(0,r.jsx)(n.li,{children:"Account SID \u2013 Security Identifier of the account used in the event"}),"\n",(0,r.jsx)(n.li,{children:"Access Type \u2013 Type of authentication with encryption, e.g. TGS: cifs/ enc:23/18, TGS: krbtgt/ enc: 23/18, etc."}),"\n",(0,r.jsx)(n.li,{children:"SPN \u2013 The service principal name (SPN) included in the Kerberos ticket data"}),"\n",(0,r.jsx)(n.li,{children:"Status \u2013 Indication of whether the authentication was successful"}),"\n",(0,r.jsx)(n.li,{children:"Date/Time \u2013 Date timestamp of the monitored event. Hover over the data in this column to view the local time (of the Enterprise Manager) and UTC time simultaneously."}),"\n",(0,r.jsx)(n.li,{children:"Detected on DC \u2013 Fully-qualified name of the domain controller that detected the event"}),"\n",(0,r.jsx)(n.li,{children:"Encryption Type \u2013 Type of encryption identified as weak that triggered the incident"}),"\n",(0,r.jsx)(n.li,{children:"Agent Time Logged \u2013 Timestamp for when the Agent detected the event. This can be different from the Enterprise Manager time (displayed in the Date/Time column) due to latency."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This data grid employs features for sorting, filtering, searching, and more. See the ",(0,r.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/navigation/datagrid",children:" Data Grid Functionality"})," topic for additional information."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},667216:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/kerberosweakencryption-50da7cba34429baef007333acfa301a8.webp"}}]);