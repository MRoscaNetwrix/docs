"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[316789],{28453:(e,i,n)=>{n.d(i,{R:()=>c,x:()=>o});var t=n(296540);const s={},r=t.createContext(s);function c(e){const i=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(r.Provider,{value:i},e.children)}},115934:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/manualconfig_fileserver_graudit_secpol2016-82e525ba8e58e1c3ef63bd7a7ad221de.webp"},384690:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>c,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"auditor/configuration/windowsserver/advancedpolicy","title":"Configure Advanced Audit Policies","description":"Advanced audit policies can be configured instead of local policies. Any of them are required if you want to get the \\"Who\\" and \\"When\\" values for the changes to the following monitored system components:","source":"@site/docs/auditor/auditor/configuration/windowsserver/advancedpolicy.md","sourceDirName":"auditor/configuration/windowsserver","slug":"/auditor/configuration/windowsserver/advancedpolicy","permalink":"/docs/auditor/auditor/configuration/windowsserver/advancedpolicy","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/windowsserver/advancedpolicy.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"VMware Ports","permalink":"/docs/auditor/auditor/configuration/vmware/ports"},"next":{"title":"Adjust DHCP Server Operational Log Settings","permalink":"/docs/auditor/auditor/configuration/windowsserver/dhcp"}}');var s=n(474848),r=n(28453);const c={},o="Configure Advanced Audit Policies",d={},a=[{value:"Configure Security Options",id:"configure-security-options",level:2},{value:"Configure Advanced Audit Policy on Windows Server 2016",id:"configure-advanced-audit-policy-on-windows-server-2016",level:2},{value:"Configure Advanced Audit Policy on Windows Server 2016 and Above",id:"configure-advanced-audit-policy-on-windows-server-2016-and-above",level:2}];function l(e){const i={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"configure-advanced-audit-policies",children:"Configure Advanced Audit Policies"})}),"\n",(0,s.jsx)(i.p,{children:'Advanced audit policies can be configured instead of local policies. Any of them are required if you want to get the "Who" and "When" values for the changes to the following monitored system components:'}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Audit policies"}),"\n",(0,s.jsx)(i.li,{children:"File shares"}),"\n",(0,s.jsx)(i.li,{children:"Hardware and system drivers"}),"\n",(0,s.jsx)(i.li,{children:"General computer settings"}),"\n",(0,s.jsx)(i.li,{children:"Local users and groups"}),"\n",(0,s.jsx)(i.li,{children:"Services"}),"\n",(0,s.jsx)(i.li,{children:"Scheduled tasks"}),"\n",(0,s.jsx)(i.li,{children:"Windows registry"}),"\n",(0,s.jsx)(i.li,{children:"Removable storage media"}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"configure-security-options",children:"Configure Security Options"}),"\n",(0,s.jsxs)(i.p,{children:["Setting up both basic and advanced audit policies may lead to incorrect audit reporting. To force basic audit policies to be ignored and prevent conflicts, enable the ",(0,s.jsx)(i.em,{children:"Audit: Force audit policy subcategory settings"})," policy."]}),"\n",(0,s.jsx)(i.p,{children:"Follow the steps to enforce advanced policies."}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 1 \u2013"})," On the audited server, open the Local Security Policy snap-in and navigate to Start > Windows Administrative Tools > Local Security Policy."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 2 \u2013"})," Navigate to Security Settings > Local Policies > Security Options and locate the Audit: Force audit policy subcategory settings policy."]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Local Security Policy snap-in ",src:n(115934).A+"",width:"693",height:"315"})}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 3 \u2013"})," Double-click the policy and enable it."]}),"\n",(0,s.jsx)(i.h2,{id:"configure-advanced-audit-policy-on-windows-server-2016",children:"Configure Advanced Audit Policy on Windows Server 2016"}),"\n",(0,s.jsxs)(i.p,{children:["In Windows Server 2016 audit policies are not integrated with the Group Policies and can only be deployed using logon scripts generated with the native Windows ",(0,s.jsx)(i.strong,{children:"auditpol.exe"})," command line tool. Therefore, these settings are not permanent and will be lost after server reboot."]}),"\n",(0,s.jsxs)(i.p,{children:["The procedure below explains how to configure Advanced audit policy for a single server. If you audit multiple servers, you may want to create logon scripts and distribute them to all target machines via Group Policy. Refer to the ",(0,s.jsx)(i.a,{href:"https://technet.microsoft.com/en-us/library/dd630947.aspx",children:"Create System Startup / Shutdown and User Logon / Logoff Scripts"})," Microsoft article for more information."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 1 \u2013"}),' On an audited server, navigate to Start > Run and type "cmd".']}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 2 \u2013"})," Disable the Object Access, Account Management, and Policy Change categories by executing the following command in the command line interface:"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:'auditpol /set /category:"Object Access" /success:disable /failure:disable  \nauditpol /set /category:"Account Management" /success:disable /failure:disable  \nauditpol /set /category:"Policy Change" /success:disable /failure:disable\n'})}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 3 \u2013"})," Enable the following audit subcategories:"]}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Audit subcategory"}),(0,s.jsx)(i.th,{children:"Command"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Security Group Management"}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:'auditpol /set /subcategory:"Security Group Management" /success:enable /failure:disable'})})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"User Account Management"}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:'auditpol /set /subcategory:"User Account Management" /success:enable /failure:disable'})})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Handle Manipulation"}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:'auditpol /set /subcategory:"Handle Manipulation" /success:enable /failure:disable'})})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Other Object Access Events"}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:'auditpol /set /subcategory:"Other Object Access Events" /success:enable /failure:disable'})})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Registry"}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:'auditpol /set /subcategory:"Registry" /success:enable /failure:disable'})})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"File Share"}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:'auditpol /set /subcategory:"File Share" /success:enable /failure:disable'})})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Audit Policy Change"}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:'auditpol /set /subcategory:"Audit Policy Change" /success:enable /failure:disable'})})]})]})]}),"\n",(0,s.jsx)(i.p,{children:"It is recommended to disable all other subcategories unless you need them for other purposes. You can check your current effective settings by executing the following commands:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:'auditpol /set /category:"Object Access"\xa0  \nauditpol /set /category:"Account Management"\xa0  \nauditpol /set /category:"Policy Change"\xa0\n'})}),"\n",(0,s.jsx)(i.h2,{id:"configure-advanced-audit-policy-on-windows-server-2016-and-above",children:"Configure Advanced Audit Policy on Windows Server 2016 and Above"}),"\n",(0,s.jsx)(i.p,{children:"In Windows Server 2016 and above, Advanced audit policies are integrated with Group Policies, so they can be applied via Group Policy Object or Local Security Policies. The procedure below describes how to apply Advanced policies via Local Security Policy console."}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 1 \u2013"})," On the audited server, open the ",(0,s.jsx)(i.strong,{children:"Local Security Policy"})," snap-in and navigate to Start > Windows Administrative Tools\xa0>Local Security Policy."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 2 \u2013"})," In the left pane, navigate to Security Settings > Advanced Audit Policy Configuration > System Audit Policies."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 3 \u2013"})," Configure the following audit policies."]}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Policy Subnode"}),(0,s.jsx)(i.th,{children:"Policy Name"}),(0,s.jsx)(i.th,{children:"Audit Events"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Account Management"}),(0,s.jsx)(i.td,{children:"- Audit Security Group Management - Audit User Account Management"}),(0,s.jsx)(i.td,{children:'"Success"'})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Object Access"}),(0,s.jsx)(i.td,{children:"- Audit Handle Manipulation - Audit Other Object Access Events - Audit Registry - Audit File Share"}),(0,s.jsx)(i.td,{children:'"Success"'})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Policy Change"}),(0,s.jsx)(i.td,{children:"- Audit Audit Policy Change"}),(0,s.jsx)(i.td,{children:'"Success"'})]})]})]})]})}function u(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);