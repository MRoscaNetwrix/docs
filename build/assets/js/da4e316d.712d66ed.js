"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[653581],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var i=t(296540);const s={},o=i.createContext(s);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:n},e.children)}},434851:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/manualconfig_ws_eventviewerpr2016_thumb_0_0-d5eedb88d0d616a7809fd263d7d3b220.webp"},784306:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/gpo_eventlog_regedit_thumb_0_0-9c6f1da55a376db2f3c65501aa0f1b99.webp"},908355:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"auditor/configuration/windowsserver/eventlog","title":"Adjusting Event Log Size and Retention Settings","description":"Consider that if the event log size is insufficient, overwrites may occur before data is written to the Long-Term Archive and the Audit Database, and some audit data may be lost.","source":"@site/docs/auditor/auditor/configuration/windowsserver/eventlog.md","sourceDirName":"auditor/configuration/windowsserver","slug":"/auditor/configuration/windowsserver/eventlog","permalink":"/docs/auditor/auditor/configuration/windowsserver/eventlog","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/windowsserver/eventlog.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Adjust DHCP Server Operational Log Settings","permalink":"/docs/auditor/auditor/configuration/windowsserver/dhcp"},"next":{"title":"Internet Information Services (IIS)","permalink":"/docs/auditor/auditor/configuration/windowsserver/iis"}}');var s=t(474848),o=t(28453);const r={},l="Adjusting Event Log Size and Retention Settings",c={},d=[{value:"Configure the Event Log Size Manually",id:"configure-the-event-log-size-manually",level:2},{value:"Configure the Event Log Size Using Group Policy",id:"configure-the-event-log-size-using-group-policy",level:2}];function a(e){const n={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"adjusting-event-log-size-and-retention-settings",children:"Adjusting Event Log Size and Retention Settings"})}),"\n",(0,s.jsx)(n.p,{children:"Consider that if the event log size is insufficient, overwrites may occur before data is written to the Long-Term Archive and the Audit Database, and some audit data may be lost."}),"\n",(0,s.jsxs)(n.p,{children:['To prevent overwrites, you can increase the maximum size of the event logs and set retention method for these logs to "',(0,s.jsx)(n.em,{children:"Overwrite events as needed"}),'". This refers to the following event logs:']}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Application"}),"\n",(0,s.jsx)(n.li,{children:"Security"}),"\n",(0,s.jsx)(n.li,{children:"Setup"}),"\n",(0,s.jsx)(n.li,{children:"System"}),"\n",(0,s.jsx)(n.li,{children:"Applications and Services logs > Microsoft>Windows > TaskScheduler > Operational"}),"\n",(0,s.jsx)(n.li,{children:"Applications and Services logs > Microsoft > Windows > DNS-Server > Audit (only for DCs running Windows Server 2012 R2 and above)"}),"\n",(0,s.jsx)(n.li,{children:"Applications and Services logs > AD FS > Admin log (for AD FS servers )"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Refer to the following Microsoft ",(0,s.jsx)(n.a,{href:"https://support.microsoft.com/en-us/help/957662/recommended-settings-for-event-log-sizes-in-windows",children:"article to read about the recommended event log settings"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"The procedure below provides a possible way to specify the event log settings manually. However, if you have multiple target computers, consider configuring these settings via Group Policy as also described in this section"}),"\n",(0,s.jsx)(n.h2,{id:"configure-the-event-log-size-manually",children:"Configure the Event Log Size Manually"}),"\n",(0,s.jsx)(n.p,{children:"Follow the steps to configure Event Log Size and Retention Settings."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 1 \u2013"})," On a target server, navigate to Start > Windows Administrative Tools > Event Viewer."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 2 \u2013"})," Navigate to Event Viewer tree > Windows Logs, right-click ",(0,s.jsx)(n.strong,{children:"Security"})," and select ",(0,s.jsx)(n.strong,{children:"Properties"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Log Properties dialog box",src:t(434851).A+"",width:"650",height:"578"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 3 \u2013"})," Make sure Enable logging is selected."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 4 \u2013"})," In the Maximum log size field, specify the desired log size."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 5 \u2013"})," Make sure the Do not overwrite events (Clear logs manually) check box is cleared. If selected, change the retention method to ",(0,s.jsx)(n.em,{children:"Overwrite events as needed (oldest events first)"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Make sure the Maximum security log size group policy does not overwrite your log settings. To check this, start the Group Policy Management console, proceed to the GPO that affects your server, and navigate to Computer Configuration > Policies > Windows Settings > Security Settings > Event Log."}),"\n",(0,s.jsx)(n.p,{children:"Repeat these steps for the following event logs:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Windows Logs"})," ",(0,s.jsx)(n.strong,{children:">"})," ",(0,s.jsx)(n.strong,{children:"Application"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Windows Logs"})," ",(0,s.jsx)(n.strong,{children:">"})," ",(0,s.jsx)(n.strong,{children:"System"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Applications and Services Logs > Microsoft > Windows > TaskScheduler > Operational"})}),"\n",(0,s.jsx)(n.p,{children:"Configure setting for TaskScheduler/Operational log only if you want to monitor scheduled tasks."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Applications and Services Logs > Microsoft > Windows > DNS-Server > Audit"})}),"\n",(0,s.jsx)(n.p,{children:"Configure setting for DNS log only if you want to monitor DNS changes. The log is available on Windows Server 2012 R2 and above and is not enabled by default. See Microsoft documentation for more information on how to enable this log."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Applications and Services Logs"})," ",(0,s.jsx)(n.strong,{children:">"})," ",(0,s.jsx)(n.strong,{children:"AD FS"})," ",(0,s.jsx)(n.strong,{children:">"})," ",(0,s.jsx)(n.strong,{children:"Admin"})]}),"\n",(0,s.jsx)(n.p,{children:"Applies to the AD FS servers."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"configure-the-event-log-size-using-group-policy",children:"Configure the Event Log Size Using Group Policy"}),"\n",(0,s.jsx)(n.p,{children:"Personnel with administrative rights can use Group Policy Objects to apply configuration settings to multiple servers in bulk."}),"\n",(0,s.jsx)(n.p,{children:"Follow the steps to configure settings for Application, System and Security event logs."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 1 \u2013"})," Open the Group Policy Management Editor on the domain controller and go to ",(0,s.jsx)(n.strong,{children:"Computer Configuration > Policies > Administrative Templates > Windows Components > Event Log Service"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 2 \u2013"})," Select the log you need."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 3 \u2013"})," Edit Specify the maximum log file size setting; the value is usually set to ",(0,s.jsx)(n.em,{children:"4194240 KB"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 4 \u2013"})," Specify retention settings for the log; usually it is Overwrite as needed."]}),"\n",(0,s.jsx)(n.p,{children:"Follow the steps to configure settings for other logs."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 1 \u2013"})," Open the registry editor and go to\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\EventLog<log_name>. For example: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\EventLog\\Directory Service"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 2 \u2013"})," Set the MaxSize to the required decimal value (in bytes)."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"gpo_eventlog_regedit_thumb_0_0",src:t(784306).A+"",width:"851",height:"368"})}),"\n",(0,s.jsx)(n.p,{children:"You can configure Group Policy Preferences to push registry changes to the target domain computers. For the example above (Directory Service Log), perform the following steps."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 1 \u2013"})," In Group Policy Management Console on the domain controller go to ",(0,s.jsx)(n.strong,{children:"Computer > Preferences > Windows Settings > Registry"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 2 \u2013"})," Right-click Registry and select ",(0,s.jsx)(n.strong,{children:"New > Registry Item"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 3 \u2013"})," In the Properties window on the General tab select the following:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Action > Create"}),"\n",(0,s.jsx)(n.li,{children:"Hive > HKEY_LOCAL_MACHINE"}),"\n",(0,s.jsxs)(n.li,{children:["Key Path \u2013 browse to MaxSize value at the\nSYSTEM\\CurrentControlSet\\Services\\EventLog\\Directory Service",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{alt:"gpo_eventlog_gpmc_thumb_0_0",src:t(995013).A+"",width:"908",height:"607"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 4 \u2013"})," Change the MaxSize REG_DWORD to the required decimal value (in bytes)."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Step 5 \u2013"})," Save the preferences and link them to the necessary servers (OUs)."]}),"\n",(0,s.jsxs)(n.p,{children:["When finished, run the ",(0,s.jsx)(n.code,{children:"gpupdate /force"})," command to force group policy update."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},995013:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/gpo_eventlog_gpmc_thumb_0_0-daabcd53c9ebc2cc1044f95eaeaca61f.webp"}}]);