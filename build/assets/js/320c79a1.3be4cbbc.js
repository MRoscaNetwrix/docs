"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[77697],{28453:(e,i,t)=>{t.d(i,{R:()=>d,x:()=>s});var n=t(296540);const o={},r=n.createContext(o);function d(e){const i=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function s(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),n.createElement(r.Provider,{value:i},e.children)}},115934:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/manualconfig_fileserver_graudit_secpol2016-82e525ba8e58e1c3ef63bd7a7ad221de.webp"},655429:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>d,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"auditor/configuration/fileservers/windows/advancedpolicy","title":"Configure Advanced Audit Policies","description":"Configure advanced audit policies to limit the range of events tracked and recorded by the product, thus preventing your AuditArchive and the Security event log from overfilling. Perform procedures below instead of the Configure Local Audit Policies.","source":"@site/docs/auditor/auditor/configuration/fileservers/windows/advancedpolicy.md","sourceDirName":"auditor/configuration/fileservers/windows","slug":"/auditor/configuration/fileservers/windows/advancedpolicy","permalink":"/docs/auditor/auditor/configuration/fileservers/windows/advancedpolicy","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/fileservers/windows/advancedpolicy.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Synology Ports","permalink":"/docs/auditor/auditor/configuration/fileservers/synology/ports"},"next":{"title":"Configure the Back up Files and Directories Policy","permalink":"/docs/auditor/auditor/configuration/fileservers/windows/configuration"}}');var o=t(474848),r=t(28453);const d={},s="Configure Advanced Audit Policies",c={},a=[{value:"Configure Security Options",id:"configure-security-options",level:2},{value:"Configure Advanced Audit Policy on Windows Server 2016 and Above",id:"configure-advanced-audit-policy-on-windows-server-2016-and-above",level:2}];function l(e){const i={a:"a",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.header,{children:(0,o.jsx)(i.h1,{id:"configure-advanced-audit-policies",children:"Configure Advanced Audit Policies"})}),"\n",(0,o.jsxs)(i.p,{children:["Configure advanced audit policies to limit the range of events tracked and recorded by the product, thus preventing your AuditArchive and the Security event log from overfilling. Perform procedures below instead of the ",(0,o.jsx)(i.a,{href:"/docs/auditor/auditor/configuration/fileservers/windows/localpolicy",children:"Configure Local Audit Policies"}),"."]}),"\n",(0,o.jsx)(i.h2,{id:"configure-security-options",children:"Configure Security Options"}),"\n",(0,o.jsxs)(i.p,{children:["Setting up both basic and advanced audit policies may lead to incorrect audit reporting. To force basic audit policies to be ignored and prevent conflicts, enable the ",(0,o.jsx)(i.em,{children:"Audit: Force audit policy subcategory settings"})," policy."]}),"\n",(0,o.jsx)(i.p,{children:"Follow the steps to enforce advanced policies."}),"\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Step 1 \u2013"})," On the audited server, open the Local Security Policy snap-in and navigate to Start > Windows Administrative Tools > Local Security Policy."]}),"\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Step 2 \u2013"})," Navigate to Security Settings > Local Policies > Security Options and locate the Audit: Force audit policy subcategory settings policy."]}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.img,{alt:"Local Security Policy snap-in ",src:t(115934).A+"",width:"693",height:"315"})}),"\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Step 3 \u2013"})," Double-click the policy and enable it."]}),"\n",(0,o.jsx)(i.h2,{id:"configure-advanced-audit-policy-on-windows-server-2016-and-above",children:"Configure Advanced Audit Policy on Windows Server 2016 and Above"}),"\n",(0,o.jsx)(i.p,{children:"In Windows Server 2016 and above, Advanced audit policies are integrated with Group Policies, so they can be applied via Group Policy Object or Local Security Policies. The procedure below describes how to apply Advanced policies via Local Security Policy console."}),"\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Step 1 \u2013"})," On the audited server, open the ",(0,o.jsx)(i.strong,{children:"Local Security Policy"})," snap-in and navigate to Start > Windows Administrative Tools\xa0> Local Security Policy."]}),"\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Step 2 \u2013"})," In the left pane, navigate to Security Settings > Advanced Audit Policy Configuration > System Audit Policies."]}),"\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"Step 3 \u2013"})," Configure the following audit policies."]}),"\n",(0,o.jsxs)(i.table,{children:[(0,o.jsx)(i.thead,{children:(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.th,{children:"Policy Subnode"}),(0,o.jsx)(i.th,{children:"Policy Name"}),(0,o.jsx)(i.th,{children:"Audit Events"})]})}),(0,o.jsxs)(i.tbody,{children:[(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:"Object Access"}),(0,o.jsx)(i.td,{children:"- Audit File System - Audit Handle Manipulation"}),(0,o.jsx)(i.td,{children:'"Success" and/or "Failure" depending on the type of events you want to track.'})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:"- Audit Detailed File Share"}),(0,o.jsx)(i.td,{children:'"Failure"'}),(0,o.jsx)(i.td,{})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:"- Audit File Share"}),(0,o.jsx)(i.td,{children:'"Success"'}),(0,o.jsx)(i.td,{})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:"Policy Change"}),(0,o.jsx)(i.td,{children:"- Audit Policy Change"}),(0,o.jsx)(i.td,{children:'"Success"'})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:"Logon/Logoff"}),(0,o.jsx)(i.td,{children:"- Logon"}),(0,o.jsx)(i.td,{children:'"Success"'})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:"- Logoff"}),(0,o.jsx)(i.td,{children:'"Success"'}),(0,o.jsx)(i.td,{})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:"System"}),(0,o.jsx)(i.td,{children:"- Security State Change"}),(0,o.jsx)(i.td,{children:'"Success"'})]})]})]})]})}function u(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}}}]);