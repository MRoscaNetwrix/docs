"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[449856],{28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var t=i(296540);const r={},s=t.createContext(r);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(s.Provider,{value:n},e.children)}},802041:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"auditor/configuration/microsoft365/exchangeonline/modernauth","title":"Access Exchange Online Using Modern Authentication","description":"Support for modern authentication will allow you to audit the organizations where MFA is enabled for all users, including service accounts.","source":"@site/docs/auditor/auditor/configuration/microsoft365/exchangeonline/modernauth.md","sourceDirName":"auditor/configuration/microsoft365/exchangeonline","slug":"/auditor/configuration/microsoft365/exchangeonline/modernauth","permalink":"/docs/auditor/auditor/configuration/microsoft365/exchangeonline/modernauth","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/microsoft365/exchangeonline/modernauth.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Configure Exchange Online State-in-Time Modern Authentication Manually","permalink":"/docs/auditor/auditor/configuration/microsoft365/exchangeonline/manualconfig"},"next":{"title":"Exchange Online","permalink":"/docs/auditor/auditor/configuration/microsoft365/exchangeonline/overview"}}');var r=i(474848),s=i(28453);const o={},a="Access Exchange Online Using Modern Authentication",c={},l=[{value:"Create and Register a New App in Microsoft Entra ID",id:"create-and-register-a-new-app-in-microsoft-entra-id",level:3},{value:"Grant Required Permissions",id:"grant-required-permissions",level:3},{value:"Grant Admin Consent to a Tenant",id:"grant-admin-consent-to-a-tenant",level:4},{value:"Grant Required Roles",id:"grant-required-roles",level:3},{value:"Configure Client Secret",id:"configure-client-secret",level:3},{value:"Add an Exchange Online Monitoring Plan",id:"add-an-exchange-online-monitoring-plan",level:2},{value:"Obtain the Tenant Name",id:"obtain-the-tenant-name",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"access-exchange-online-using-modern-authentication",children:"Access Exchange Online Using Modern Authentication"})}),"\n",(0,r.jsx)(n.p,{children:"Support for modern authentication will allow you to audit the organizations where MFA is enabled for all users, including service accounts."}),"\n",(0,r.jsx)(n.p,{children:"This option is recommended for organizations that use modern authentication as the identity management approach, having multi-factor authentication (MFA) enabled for their user accounts. In this scenario, Netwrix Auditor will access the cloud-based infrastructure via Microsoft Graph and other modern APIs, being authenticated through a pre-configured Microsoft Entra ID application with appropriate access permissions."}),"\n",(0,r.jsx)(n.p,{children:"If you plan to implement this scenario, you should register an Microsoft Entra ID app manually and provide its settings to Netwrix Auditor when configuring a monitored item."}),"\n",(0,r.jsx)(n.h3,{id:"create-and-register-a-new-app-in-microsoft-entra-id",children:"Create and Register a New App in Microsoft Entra ID"}),"\n",(0,r.jsx)(n.p,{children:"You will need to create a dedicated app for each cloud-based data source you plan to audit:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Microsoft Entra ID (formerly Azure AD)"}),"\n",(0,r.jsx)(n.li,{children:"Exchange Online"}),"\n",(0,r.jsx)(n.li,{children:"SharePoint Online"}),"\n",(0,r.jsx)(n.li,{children:"MS\xa0Teams"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"If you plan to audit all of them, you need to create 4 apps."}),"\n",(0,r.jsx)(n.p,{children:"Follow the steps to register a new Microsoft Entra ID application."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 1 \u2013"})," Sign into the ",(0,r.jsx)(n.strong,{children:"Microsoft 365 Admin Center"})," with your ",(0,r.jsx)(n.em,{children:"Global Administrator"}),", ",(0,r.jsx)(n.em,{children:"Application Administrator"})," or ",(0,r.jsx)(n.em,{children:"Cloud Application Administrator"})," account and go to the ",(0,r.jsx)(n.strong,{children:"Microsoft Entra ID admin center"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 2 \u2013"})," Under the App registrations section, select ",(0,r.jsx)(n.strong,{children:"New registration"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 3 \u2013"})," In the Name field, enter the application name."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 4 \u2013"})," In the Supported account types select who can use this application \u2013 use the ",(0,r.jsx)(n.strong,{children:"Accounts in this organizational directory only"})," option."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 5 \u2013"})," Click the ",(0,r.jsx)(n.strong,{children:"Register"})," button. Application ",(0,r.jsx)(n.strong,{children:"Redirect URI"})," is optional, you can leave it blank."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 6 \u2013"})," Your Application (client) ID is now available in the Overview section. Copy it to a safe location."]}),"\n",(0,r.jsxs)(n.p,{children:["See the following Microsoft article for additional information on how to create an application and service principal using Microsoft Entra ID Admin portal: ",(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal",children:"Create an Microsoft Entra ID application and service principal that can access resources"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"grant-required-permissions",children:"Grant Required Permissions"}),"\n",(0,r.jsxs)(n.p,{children:["You need to grant your new application the required API permissions. Microsoft Entra ID applications can be assigned ",(0,r.jsx)(n.em,{children:"Delegated"})," or ",(0,r.jsx)(n.em,{children:"Application"})," permissions:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Delegated"})," permissions require a signed-in user present who consents to the permissions every time an API call is sent."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Application"})," permissions are consented by an administrator once granted."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For the newly created app, you should use the ",(0,r.jsx)(n.em,{children:"Application"})," permissions."]}),"\n",(0,r.jsxs)(n.p,{children:["To grant required permissions, assign granular ",(0,r.jsx)(n.em,{children:"Application"})," permissions required for Netwrix Auditor to collect data from the application. To do so, perform the following steps:"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 1 \u2013"})," Go to the ",(0,r.jsx)(n.strong,{children:"App registrations"})," and open the app you created to assign Auditor permissions."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 2 \u2013"})," Go to ",(0,r.jsx)(n.strong,{children:"Manage > API permissions"})," and click ",(0,r.jsx)(n.strong,{children:"Add a permission"})," button."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 3 \u2013"})," Assign the required permissions."]}),"\n",(0,r.jsx)(n.p,{children:"Permission assignment will depend on the data you plan to collect:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Activity data only"}),"\n",(0,r.jsx)(n.li,{children:"Both activity and state-in-time data"}),"\n"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"To..."}),(0,r.jsx)(n.th,{children:"Requirement"}),(0,r.jsx)(n.th,{children:"Comment"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Collect audit data"}),(0,r.jsxs)(n.td,{children:["Microsoft Entra ID app requires the following ",(0,r.jsx)(n.strong,{children:"Application"})," permissions:   1. ",(0,r.jsx)(n.strong,{children:"Microsoft Graph"}),"    - Directory.Read.All    - Application.ReadWrite.All    - ",(0,r.jsx)(n.strong,{children:"Mail.ReadBasic.All"}),"    - ",(0,r.jsx)(n.strong,{children:"MailboxSettings.Read"})," 2. ",(0,r.jsx)(n.strong,{children:"Office 365 Management APIs"}),"    - ",(0,r.jsx)(n.strong,{children:"ActivityFeed.Read"})," 3. ",(0,r.jsx)(n.strong,{children:"Office 365 Exchange Online"}),"     - ",(0,r.jsx)(n.strong,{children:"Exchange.ManageAsApp"})]}),(0,r.jsxs)(n.td,{children:["To learn how to assign required permissions, see the ",(0,r.jsx)(n.a,{href:"#Access-Exchange-Online-Using-Modern-Authentication",children:"Access Exchange Online Using Modern Authentication"})," section for additional information."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Roles"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.em,{children:"Exchange Administrator"})," (",(0,r.jsx)(n.em,{children:"Exchange Service Administrator"}),") assigned to application service principal  OR  ",(0,r.jsx)(n.em,{children:"Global Administrator"})," assigned to application service principal"]}),(0,r.jsx)(n.td,{})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"NOTE:"})," You can also assign application permissions by editing Microsoft Entra app manifest. See the ",(0,r.jsx)(n.a,{href:"#Access-Exchange-Online-Using-Modern-Authentication",children:"Access Exchange Online Using Modern Authentication"})," topic for additional information on how to assign the required permissions. Information about manifest is also described in the following Microsoft article:\xa0",(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/active-directory/develop/reference-app-manifest",children:" Microsoft Entra app manifest"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"grant-admin-consent-to-a-tenant",children:"Grant Admin Consent to a Tenant"}),"\n",(0,r.jsx)(n.p,{children:"Follow the steps to grant Admin consent to a tenant."}),"\n",(0,r.jsxs)(n.p,{children:["Go back to the ",(0,r.jsx)(n.strong,{children:"Microsoft Entra ID admin center"})," > ",(0,r.jsx)(n.strong,{children:"Applications"})," > ",(0,r.jsx)(n.strong,{children:"App registrations"})," >  ",(0,r.jsx)(n.strong,{children:"API permissions"})," and click ",(0,r.jsx)(n.strong,{children:"Grant admin consent for"}),"\xa0",(0,r.jsx)(n.em,{children:(0,r.jsx)(n.code,{children:"<tenant name>"})}),".\nWhen prompted to confirm, click ",(0,r.jsx)(n.strong,{children:"Yes"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"NOTE:"})," For Office 365 permissions, go to ",(0,r.jsx)(n.strong,{children:"Request API Permissions"})," > ",(0,r.jsx)(n.strong,{children:"APIs my organization users"}),' and type "Office 365" in the search bar.']}),"\n",(0,r.jsxs)(n.p,{children:["See the following Microsoft article for additional information on how to create an application and service principal using Microsoft Entra ID Admin portal: ",(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal",children:"Create an Microsoft Entra application and service principal that can access resources"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"grant-required-roles",children:"Grant Required Roles"}),"\n",(0,r.jsx)(n.p,{children:"Follow the steps to grant the required Microsoft Entra ID (formerly Azure AD) roles to the new application."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 1 \u2013"})," In the Entra portal, click ",(0,r.jsx)(n.strong,{children:"View"})," under Manage Azure Active Directory."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 2 \u2013"})," Select ",(0,r.jsx)(n.strong,{children:"Roles and admins"})," under Applications ."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 3 \u2013"})," Select the Exchange Administrator or Global Administrator role."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 4 \u2013"})," On the Assignments page that appears, click Add assignments."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 5 \u2013"})," In the Add assignments flyout that appears, find and select the created application, and click Add."]}),"\n",(0,r.jsxs)(n.p,{children:["See the following Microsoft article for additional information on how to create an application and service principal using Azure AD Admin portal: ",(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal",children:"Create an Azure Active Directory application and service principal that can access resources"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"configure-client-secret",children:"Configure Client Secret"}),"\n",(0,r.jsx)(n.p,{children:"Follow the steps to create a new client secret to be used by the app."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 1 \u2013"})," Go to ",(0,r.jsx)(n.strong,{children:"Manage"})," > ",(0,r.jsx)(n.strong,{children:"Certificates & secrets"})," and click ",(0,r.jsx)(n.strong,{children:"New client secret"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 2 \u2013"})," Enter the description. From the expiration options select ",(0,r.jsx)(n.strong,{children:"24 months"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 3 \u2013"})," Click ",(0,r.jsx)(n.strong,{children:"Add"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 4 \u2013"})," The new secret will be displayed in the list. Click ",(0,r.jsx)(n.strong,{children:"Copy to clipboard"}),' icon on the "Value" parameter on the right side of the screen.']}),"\n",(0,r.jsxs)(n.p,{children:["See the following Microsoft article for more information on how to add a client secret: ",(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app#add-a-client-secret",children:"Add a client secret"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"add-an-exchange-online-monitoring-plan",children:"Add an Exchange Online Monitoring Plan"}),"\n",(0,r.jsx)(n.p,{children:"Follow the steps to add Exchange Online monitoring plan in the Netwrix Auditor:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 1 \u2013"})," In the Monitoring Plans, click ",(0,r.jsx)(n.strong,{children:"Add Plan"})," button."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 2 \u2013"})," Create a monitoring plan with the Exchange Online data source."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 3 \u2013"}),' Add the "Office 365 tenant" item.']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 4 \u2013"})," Click ",(0,r.jsx)(n.strong,{children:"Select"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 5 \u2013"})," Enter your tenant name."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 6 \u2013"})," Choose modern authentication."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 7 \u2013"})," Enter Application ID and Application secret you have created before."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 8 \u2013"})," Click ",(0,r.jsx)(n.strong,{children:"Add"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Exchange Online monitoring plan has been added to Auditor and initial data collection has begun."}),"\n",(0,r.jsx)(n.h3,{id:"obtain-the-tenant-name",children:"Obtain the Tenant Name"}),"\n",(0,r.jsx)(n.p,{children:"Follow the steps to obtain the tenant name."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 1 \u2013"})," Navigate to ",(0,r.jsx)(n.strong,{children:"Microsoft Entra ID"})," >  ",(0,r.jsx)(n.strong,{children:"Overview"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 2 \u2013"})," In the ",(0,r.jsx)(n.strong,{children:"Tenant information"})," locate the ",(0,r.jsx)(n.strong,{children:"Primary domain"})," field, copy its value and store to a safe location."]}),"\n",(0,r.jsxs)(n.p,{children:["See the following Microsoft article for additional information on how to obtain tenant name: ",(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/partner-center/find-ids-and-domain-names",children:"Locate important IDs for a user"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Then, create a corresponding monitoring plan in Netwrix Auditor and add an item (Office 365 tenant) to it. See the ",(0,r.jsx)(n.a,{href:"/docs/auditor/auditor/admin/monitoringplans/microsoftentraid/overview",children:"Microsoft Entra ID"})," topic for additional information."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);