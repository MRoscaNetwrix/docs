"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[36955],{17420:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/1320_4_129d10341515bde5b5cc94db70557eba-e61368eb721cbf30f346c95f241c95c9.webp"},22192:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>d,frontMatter:()=>l,metadata:()=>s,toc:()=>p});const s=JSON.parse('{"id":"policypak/leastprivilege/allow/uipathassistant","title":"How to Allow UiPath Assistant to run when running PowerShell is blocked for all Users","description":"Blocking PowerShell for everyone can also cause applications that depend on PowerShell to not run properly.","source":"@site/docs/policypak/policypak/leastprivilege/allow/uipathassistant.md","sourceDirName":"policypak/leastprivilege/allow","slug":"/policypak/leastprivilege/allow/uipathassistant","permalink":"/docs/policypak/policypak/leastprivilege/allow/uipathassistant","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/leastprivilege/allow/uipathassistant.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"How to Allow a Non-Admin user to manage a specific Service using SC.EXE with Least Privilege Manager","permalink":"/docs/policypak/policypak/leastprivilege/allow/nonadminuser"},"next":{"title":"When to Use \u201cApply to Child Processes\u201d","permalink":"/docs/policypak/policypak/leastprivilege/bestpractices/childprocesses"}}');var o=t(474848),i=t(28453);const l={},c="How to Allow UiPath Assistant to run when running PowerShell is blocked for all Users",a={},p=[];function r(e){const n={a:"a",code:"code",h1:"h1",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"how-to-allow-uipath-assistant-to-run-when-running-powershell-is-blocked-for-all-users",children:"How to Allow UiPath Assistant to run when running PowerShell is blocked for all Users"})}),"\n",(0,o.jsx)(n.p,{children:"Blocking PowerShell for everyone can also cause applications that depend on PowerShell to not run properly.\nFor example, when using the UiPath Assistant application with PowerShell blocked, the two UiPath Assistant commands below are also be blocked."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"1320_1_5c7b0bb711837088e14ba56fe0191b4e",src:t(50344).A+"",width:"711",height:"484"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"1320_2_2b07a73f4f7ad9bd4005effc11de64c9",src:t(477761).A+"",width:"809",height:"449"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"1320_3_e63350e252dcfbfbbe47a6949ab99f53",src:t(405912).A+"",width:"619",height:"305"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"1320_4_129d10341515bde5b5cc94db70557eba",src:t(17420).A+"",width:"1052",height:"334"})}),"\n",(0,o.jsx)(n.p,{children:"To work around this issue you need to create two LPM Path and Command line Executable Policies using the settings below."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"1320_5_0c63e13faa75539ef18a64527e8fc5c7",src:t(341699).A+"",width:"1293",height:"142"})}),"\n",(0,o.jsx)(n.p,{children:"For Policy # 1 use these settings:"}),"\n",(0,o.jsxs)(n.p,{children:["Path: ",(0,o.jsx)(n.code,{children:"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"})]}),"\n",(0,o.jsxs)(n.p,{children:["Arguments: ",(0,o.jsx)(n.code,{children:'*"$assemblies=(\\"System\\");$source=\\"*'})]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"1320_6_53331fee44652a08986eec464b49ee4e",src:t(413159).A+"",width:"1006",height:"644"})}),"\n",(0,o.jsx)(n.p,{children:"For Policy #2 use these settings:"}),"\n",(0,o.jsxs)(n.p,{children:["Path: ",(0,o.jsx)(n.code,{children:"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"})]}),"\n",(0,o.jsxs)(n.p,{children:["Arguments: ",(0,o.jsx)(n.code,{children:'"$FileContent = Get-Content -Encoding unicode %Temp%\\shortcuts-params.txt; Invoke-Expression $FileContent"'})]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"1320_7_ee314a383e4b4e2d6f0723c6562c2fff",src:t(173985).A+"",width:"959",height:"647"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"NOTE:"})," For both policies above be sure to set ",(0,o.jsx)(n.strong,{children:"Ignore arguments"})," case to ",(0,o.jsx)(n.strong,{children:"True"}),", and ",(0,o.jsx)(n.strong,{children:"Comparison mode"})," to ",(0,o.jsx)(n.strong,{children:"Strict Equality"}),"."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"javascript:void(0);",children:"Copy"})}),"\n",(0,o.jsx)(n.p,{children:"Allowed with Path Rule 1"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'<?xml version="1.0" encoding="utf-8"?>  \n<policy xmlns:lpm="http://www.policypak.com/2016/LPM/CommonTypes" xmlns:ext="http://www.policypak.com/2019/LPM/PolicyEntryExtension" xmlns:security="http://www.policypak.com/2016/LPM/Security" xmlns:pd="http://www.policypak.com/2014/Policies/PolicyData" xmlns:pp="http://www.policypak.com/2014/CommonTypes" id="{f15e00f9-31ab-4e3c-956a-21d4b49e280b}" productId="{58DE0268-6384-49E0-A333-20EC46654B82}" scope="machine" timestamp="1711029993" xmlns="http://www.policypak.com/2016/LPM/PolicyData">  \n\xa0\xa0<collection order="0" id="{245fa453-d68a-49ea-ab81-54c96152fe5d}" displayName="Container for policy: UiPath.Assistant PowerShell command Allowed with PATH rule 1">  \n\xa0\xa0\xa0\xa0<entry order="0" scope="machine" id="{e495c7c7-c377-439b-8cbb-48619daaef82}" displayName="UiPath.Assistant PowerShell command Allowed with PATH rule 1">  \n\xa0\xa0\xa0\xa0\xa0\xa0<rule-v1>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<executableRule xmlns="http://www.policypak.com/2016/LPM/Rules-V1">  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<conditions xmlns="http://www.policypak.com/2016/LPM/ExecutableRule">  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<pathCondition xmlns="http://www.policypak.com/2016/LPM/Rules">  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<path kind="File">C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe</path>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0</pathCondition>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<commandLineCondition xmlns="http://www.policypak.com/2016/LPM/Rules">  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<value>*"$assemblies=(\\"System\\");$source=\\"*</value>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<useAndSpecifierForArguments>false</useAndSpecifierForArguments>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0</commandLineCondition>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0</conditions>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<settings justificationTextRequired="false" xmlns="http://www.policypak.com/2016/LPM/ExecutableRule">  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<applyToChildProcesses>true</applyToChildProcesses>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0</settings>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<action xmlns="http://www.policypak.com/2016/LPM/ExecutableRule">  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<doNothing xmlns="http://www.policypak.com/2016/LPM/Actions" />  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0</action>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0</executableRule>  \n\xa0\xa0\xa0\xa0\xa0\xa0</rule-v1>  \n\xa0\xa0\xa0\xa0</entry>  \n\xa0\xa0</collection>  \n</policy>\n'})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"javascript:void(0);",children:"Copy"})}),"\n",(0,o.jsx)(n.p,{children:"Allowed with Path Rule 2"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'<?xml version="1.0" encoding="utf-8"?>  \n<policy xmlns:lpm="http://www.policypak.com/2016/LPM/CommonTypes" xmlns:ext="http://www.policypak.com/2019/LPM/PolicyEntryExtension" xmlns:security="http://www.policypak.com/2016/LPM/Security" xmlns:pd="http://www.policypak.com/2014/Policies/PolicyData" xmlns:pp="http://www.policypak.com/2014/CommonTypes" id="{7e0b0353-402e-44c9-9138-109c2701678f}" productId="{58DE0268-6384-49E0-A333-20EC46654B82}" scope="machine" timestamp="1711029984" xmlns="http://www.policypak.com/2016/LPM/PolicyData">  \n\xa0\xa0<collection order="0" id="{813b29c6-dbe8-44af-a423-293a68d8955a}" displayName="Container for policy: UiPath.Assistant PowerShell Command Allowed with PATH rule 2">  \n\xa0\xa0\xa0\xa0<entry order="1" scope="machine" id="{3b19b7c4-c55e-44b3-9065-503c8e6faad2}" displayName="UiPath.Assistant PowerShell Command Allowed with PATH rule 2">  \n\xa0\xa0\xa0\xa0\xa0\xa0<rule-v1>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<executableRule xmlns="http://www.policypak.com/2016/LPM/Rules-V1">  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<conditions xmlns="http://www.policypak.com/2016/LPM/ExecutableRule">  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<pathCondition xmlns="http://www.policypak.com/2016/LPM/Rules">  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<path kind="File">C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe</path>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0</pathCondition>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<commandLineCondition xmlns="http://www.policypak.com/2016/LPM/Rules">  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<value>"$FileContent = Get-Content -Encoding unicode %Temp%\\shortcuts-params.txt; Invoke-Expression $FileContent"</value>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<useAndSpecifierForArguments>false</useAndSpecifierForArguments>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0</commandLineCondition>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0</conditions>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<settings justificationTextRequired="false" xmlns="http://www.policypak.com/2016/LPM/ExecutableRule">  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<applyToChildProcesses>true</applyToChildProcesses>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0</settings>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<action xmlns="http://www.policypak.com/2016/LPM/ExecutableRule">  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0<doNothing xmlns="http://www.policypak.com/2016/LPM/Actions" />  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0</action>  \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0</executableRule>  \n\xa0\xa0\xa0\xa0\xa0\xa0</rule-v1>  \n\xa0\xa0\xa0\xa0</entry>  \n\xa0\xa0</collection>  \n</policy>\n'})})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(r,{...e})}):r(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>c});var s=t(296540);const o={},i=s.createContext(o);function l(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),s.createElement(i.Provider,{value:n},e.children)}},50344:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/1320_1_5c7b0bb711837088e14ba56fe0191b4e-10ae27a58bfaa5da16c1ed9bad9d5a43.webp"},173985:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/1320_7_ee314a383e4b4e2d6f0723c6562c2fff-c2335c87c01ca5f51fc83897dc304ee8.webp"},341699:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/1320_5_0c63e13faa75539ef18a64527e8fc5c7-143b7c150bad57d1370c79e88d2d151a.webp"},405912:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/1320_3_e63350e252dcfbfbbe47a6949ab99f53-98a11709dcd93f3a6beb8da92666e8fc.webp"},413159:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/1320_6_53331fee44652a08986eec464b49ee4e-5d74f9db76141c60b14fc6a7e3eec050.webp"},477761:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/1320_2_2b07a73f4f7ad9bd4005effc11de64c9-7d32ee55e1ef20bf6ec2ac64cef9fc75.webp"}}]);