"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[592844],{28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>c});var i=s(296540);const t={},o=i.createContext(t);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(o.Provider,{value:n},e.children)}},307433:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"admin/datacollection/activedirectory/permissionsregistrykeys","title":"Assigning Permission To Read the Registry Key","description":"This permission is required only if the account selected for data collection is not a member of the Domain Admins group.","source":"@site/docs/1secure/admin/datacollection/activedirectory/permissionsregistrykeys.md","sourceDirName":"admin/datacollection/activedirectory","slug":"/admin/datacollection/activedirectory/permissionsregistrykeys","permalink":"/docs/1secure/admin/datacollection/activedirectory/permissionsregistrykeys","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/1secure/admin/datacollection/activedirectory/permissionsregistrykeys.md","tags":[],"version":"current","frontMatter":{},"sidebar":"oneSecureSidebar","previous":{"title":"Granting Permissions for \'Deleted Objects\' Container","permalink":"/docs/1secure/admin/datacollection/activedirectory/permissionsadcontainer"},"next":{"title":"Configure the Back up Files and Directories Policy","permalink":"/docs/1secure/admin/datacollection/computer/backupfilesdirectories"}}');var t=s(474848),o=s(28453);const r={},c="Assigning Permission To Read the Registry Key",a={},d=[{value:"To assign permission via the Registry Editor snap-in",id:"to-assign-permission-via-the-registry-editor-snap-in",level:2},{value:"To assign permission using the Group Policy Management console",id:"to-assign-permission-using-the-group-policy-management-console",level:2}];function l(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"assigning-permission-to-read-the-registry-key",children:"Assigning Permission To Read the Registry Key"})}),"\n",(0,t.jsx)(n.p,{children:"This permission is required only if the account selected for data collection is not a member of the Domain Admins group."}),"\n",(0,t.jsx)(n.p,{children:"This permission should be assigned on each domain controller in the audited domain, so if your domain contains multiple domain controllers, it is recommended to assign permissions through Group Policy."}),"\n",(0,t.jsx)(n.p,{children:"To assign permissions manually, use the Registry Editor snap-in or the Group Policy Management console."}),"\n",(0,t.jsx)(n.h2,{id:"to-assign-permission-via-the-registry-editor-snap-in",children:"To assign permission via the Registry Editor snap-in"}),"\n",(0,t.jsx)(n.p,{children:'On your target server, open Registry Editor: navigate to Start \u2192 Run and type "regedit".'}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 1 \u2013"})," In the left pane, navigate to ",(0,t.jsx)(n.em,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControl Set\\Services\\EventLog\\Security"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 2 \u2013"})," Right-click the ",(0,t.jsx)(n.strong,{children:"Security"})," node and select ",(0,t.jsx)(n.strong,{children:"Permissions"})," from the pop-up menu."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 3 \u2013"})," Click ",(0,t.jsx)(n.strong,{children:"Add"})," and enter the name of the user that you want to grant permissions to."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 4 \u2013"})," Check ",(0,t.jsx)(n.strong,{children:"Allow"})," next to the ",(0,t.jsx)(n.strong,{children:"Read"})," permission."]}),"\n",(0,t.jsxs)(n.p,{children:["For auditing Logon Activity, you also need to assign the Read permission to the ",(0,t.jsx)(n.em,{children:"HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\PolAdtEv"})," registry key."]}),"\n",(0,t.jsx)(n.h2,{id:"to-assign-permission-using-the-group-policy-management-console",children:"To assign permission using the Group Policy Management console"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 1 \u2013"})," Open the Group Policy Management console on any domain controller in the target domain: navigate to Start \u2192 Windows Administrative Tools (Windows Server 2016/2019) or Administrative Tools (Windows 2012 R2 and below) \u2192 Group Policy Management."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 2 \u2013"})," In the left pane, navigate to Forest: ",(0,t.jsx)(n.code,{children:"<forest name>"})," \u2192 Domains \u2192 ",(0,t.jsx)(n.code,{children:"<domain name>"})," \u2192 Domain Controllers. Right-click the effective domain controllers policy (by default, it is the ",(0,t.jsx)(n.em,{children:"Default Domain Controllers Policy"}),"), and select Edit ."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 3 \u2013"})," In the Group Policy Management Editor dialog, expand the Computer Configuration node on the left and navigate to Policies \u2192 Windows Settings \u2192 Security Settings \u2192 Registry."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 4 \u2013"})," Right-click in the pane and select Add Key."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 5 \u2013"})," Navigate to ",(0,t.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\PolAdtEv"})," and click OK."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 6 \u2013"})," Click Add and enter the name of the user that you want to grant permissions to and press Enter."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 7 \u2013"})," Check Allow next to the ",(0,t.jsx)(n.em,{children:'"Read"'})," permission and click OK."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 8 \u2013"})," In the pop-up window, select Propagate inheritable permissions to all subkeys and click OK."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 9 \u2013"})," Repeat the steps 4-8 for keys below:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurePipeServers\\winreg"}),";"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\EventLog\\Security"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 10 \u2013"})," Close Group Policy Management console."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 11 \u2013"}),' Navigate to Start \u2192 Run and type "',(0,t.jsx)(n.em,{children:"cmd"}),'". Input the ',(0,t.jsx)(n.code,{children:"gpupdate /force"})," command and press Enter. The group policy will be updated."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 12 \u2013"})," Type ",(0,t.jsx)(n.code,{children:"repadmin /syncall"})," command and press Enter for replicate GPO changes to other domain controllers."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 13 \u2013"})," Ensure that new GPO settings were applied to the domain controllers."]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}}}]);