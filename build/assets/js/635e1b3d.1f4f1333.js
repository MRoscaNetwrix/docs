"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[588432],{28453:(e,i,n)=>{n.d(i,{R:()=>t,x:()=>l});var r=n(296540);const s={},o=r.createContext(s);function t(e){const i=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(o.Provider,{value:i},e.children)}},496126:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"config/activedirectory/access","title":"Active Directory Auditing Configuration","description":"The Access Analyzer for Active Directory Solution is compatible with the following Active Directory versions as targets:","source":"@site/docs/accessanalyzer/config/activedirectory/access.md","sourceDirName":"config/activedirectory","slug":"/config/activedirectory/access","permalink":"/docs/accessanalyzer/config/activedirectory/access","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/config/activedirectory/access.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","next":{"title":"Active Directory Activity Auditing Configuration","permalink":"/docs/accessanalyzer/config/activedirectory/activity"}}');var s=n(474848),o=n(28453);const t={},l="Active Directory Auditing Configuration",c={},a=[{value:"Permissions",id:"permissions",level:2},{value:"Ports",id:"ports",level:2},{value:"Least Privilege Model",id:"least-privilege-model",level:2},{value:"Variable Definitions",id:"variable-definitions",level:3}];function d(e){const i={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"active-directory-auditing-configuration",children:"Active Directory Auditing Configuration"})}),"\n",(0,s.jsx)(i.p,{children:"The Access Analyzer for Active Directory Solution is compatible with the following Active Directory versions as targets:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Windows Server 2016 and later"}),"\n",(0,s.jsx)(i.li,{children:"Windows 2003 Forest level or higher"}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"NOTE:"})," See the Microsoft ",(0,s.jsx)(i.a,{href:"https://learn.microsoft.com/en-us/deployoffice/endofsupport/windows-server-support",children:"Windows Server end of support and Microsoft 365 Apps"})," article for additional information."]}),"\n",(0,s.jsx)(i.p,{children:"Domain Controller Requirements"}),"\n",(0,s.jsx)(i.p,{children:"The following are requirements for the domain controllers to be scanned:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:".NET Framework 4.5+ installed"}),"\n",(0,s.jsx)(i.li,{children:"WINRM Service installed"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Data Collectors"}),"\n",(0,s.jsx)(i.p,{children:"Successful use of the Access Analyzer Active Directory solution requires the necessary settings and permissions in a Microsoft\xae Active Directory\xae environment described in this topic and its subtopics. This solution employs the following data collectors to scan for groups, users, computers, passwords, permissions, group policies, and domain information:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/adinventory/overview",children:"ADInventory Data Collector"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/activedirectory/overview",children:"ActiveDirectory Data Collector"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/adactivity/overview",children:"ADActivity Data Collector"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/grouppolicy/overview",children:"GroupPolicy Data Collector"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/ldap",children:"LDAP Data Collector"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/passwordsecurity/overview",children:"PasswordSecurity Data Collector"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/powershell/overview",children:"PowerShell Data Collector"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/registry",children:"Registry Data Collector"})}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"permissions",children:"Permissions"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Member of the Domain Administrators group"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"The majority of jobs in the Active Directory solutions rely on tables with queried data from the data collectors mentioned above to perform analysis and generate reports. The remaining jobs utilize data collectors to scan environments, and require additional permissions on the target host."}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.em,{children:(0,s.jsx)(i.strong,{children:"RECOMMENDED:"})})," Use Domain/Local Administrator privileges to run Access Analyzer against an Active Directory domain controller."]}),"\n",(0,s.jsxs)(i.p,{children:["There is a least privilege model for scanning your domain. See the ",(0,s.jsx)(i.a,{href:"#least-privilege-model",children:"Least Privilege Model"})," topic for additional information."]}),"\n",(0,s.jsx)(i.h2,{id:"ports",children:"Ports"}),"\n",(0,s.jsx)(i.p,{children:"The following firewall ports are needed:"}),"\n",(0,s.jsx)(i.p,{children:"For ADInventory Data Collector"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"TCP 389"}),"\n",(0,s.jsx)(i.li,{children:"TCP 135-139"}),"\n",(0,s.jsx)(i.li,{children:"Randomly allocated high TCP ports"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"For ActiveDirectory Data Collector"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"TCP 389/636"}),"\n",(0,s.jsx)(i.li,{children:"TCP 135-139"}),"\n",(0,s.jsx)(i.li,{children:"Randomly allocated high TCP ports"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"For ADActivity Data Collector"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"TCP 4494 (configurable within the Netwrix Activity Monitor)"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"For GroupPolicy Data Collector"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"TCP 389"}),"\n",(0,s.jsx)(i.li,{children:"TCP 135-139"}),"\n",(0,s.jsx)(i.li,{children:"Randomly allocated high TCP ports"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"For LDAP Data Collector"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"TCP 389"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"For PasswordSecurity Collector"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"TCP 389/636"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"For PowerShell Data Collector"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Randomly allocated high TCP ports"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"For Registry Data Collector"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"TCP 135-139"}),"\n",(0,s.jsx)(i.li,{children:"Randomly allocated high TCP ports"}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"least-privilege-model",children:"Least Privilege Model"}),"\n",(0,s.jsx)(i.p,{children:"A least privilege model can be configured based on your auditing needs and the data collection jobs you will be using. The following jobs and their corresponding data collectors can be run with a least privilege permissions model."}),"\n",(0,s.jsx)(i.p,{children:"1-AD_Scan Job Permissions"}),"\n",(0,s.jsx)(i.p,{children:"The ADInventory Data Collector in the .Active Directory Inventory > 1-AD_Scan Job has the following minimum requirements, which must be configured at the Domain level in Active Directory:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"Read access to directory tree"}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"List Contents & Read Property on the Deleted Objects Container"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"NOTE:"})," See the Microsoft ",(0,s.jsx)(i.a,{href:"https://technet.microsoft.com/en-us/library/cc978013.aspx",children:"Searching for Deleted Objects"})," article and the Microsoft ",(0,s.jsx)(i.a,{href:"https://technet.microsoft.com/en-us/library/cc771151(v=ws.11).aspx",children:"Dsacls"})," article for additional information."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"AD_WeakPasswords Job Permissions"}),"\n",(0,s.jsx)(i.p,{children:"The PasswordSecurity Data Collector in the 2.Users > AD_WeakPasswords Job has the following minimum requirements:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"At the domain level:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Read"}),"\n",(0,s.jsx)(i.li,{children:"Replicating Directory Changes"}),"\n",(0,s.jsx)(i.li,{children:"Replicating Directory Changes All"}),"\n",(0,s.jsx)(i.li,{children:"Replicating Directory Changes in a Filtered Set"}),"\n",(0,s.jsx)(i.li,{children:"Replication Synchronization"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"AD_CPassword Job Permissions"}),"\n",(0,s.jsx)(i.p,{children:"While the PowerShell Data Collector typically requires Domain Administrator permissions when targeting a domain controller, that level of access is not required to run the 4.Group Policy > AD_CPasswords job. The minimum requirements for running this job are:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Read access to SYSVOL on the targeted Domain Controller(s) and all of its children"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"AD_GroupPolicy Job Permissions"}),"\n",(0,s.jsx)(i.p,{children:"While the GroupPolicy Data Collector typically requires Domain Administrator permissions when targeting a domain controller, that level of access is not required to run the 4.Group Policy > AD_GroupPolicy Job. The minimum requirements for running this job are:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Requires Read permissions on Group Policy Objects"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"AD_PasswordPolicies Job Permissions"}),"\n",(0,s.jsx)(i.p,{children:"While the LDAP Data Collector typically requires Domain Administrator permissions when targeting a domain controller, that level of access is not required to run the 4.Group Policy > AD_PasswordPolicies Job. The minimum requirements for running this job are:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Requires Read permissions on the Password Settings Container"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"AD_DomainControllers Job Permissions"}),"\n",(0,s.jsx)(i.p,{children:"While the LDAP Data Collector and Active Directory Data Collector typically requires Domain Administrator permissions when targeting a domain controller, that level of access is not required to run the 5.Domains > 0.Collection > AD_DomainControllers Job. The minimum requirements for running this job are:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Read access to CN=Servers,%SITEDN% and its children"}),"\n",(0,s.jsx)(i.li,{children:"Read access to: %PARTITIONDNS% and its children"}),"\n",(0,s.jsx)(i.li,{children:"Read access to: %SCHEMADN%"}),"\n",(0,s.jsx)(i.li,{children:"Read access to: %SITESDN% and its children"}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["See the ",(0,s.jsx)(i.a,{href:"#variable-definitions",children:"Variable Definitions"})," for variable definitions."]}),"\n",(0,s.jsx)(i.p,{children:"AD_DSRM Job Permissions"}),"\n",(0,s.jsx)(i.p,{children:"While the Registry Data Collector typically requires Domain Administrator permissions when targeting a domain controller, that level of access is not required to run the 5.Domains > 0.Collection > AD_DSRM Job. The minimum requirements for running this job are:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Requires read access to the following Registry key and its children:",(0,s.jsx)(i.br,{}),"\n","HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa"]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"AD_TimeSync Job Permissions"}),"\n",(0,s.jsx)(i.p,{children:"While the Registry Data Collector typically requires Domain Administrator permissions when targeting a domain controller, that level of access is not required to run the 5.Domains > 0.Collection > AD_TimeSync Job. The minimum requirements for running this job are:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Requires Read access to the following Registry keys and its children: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"AD_DomainInfo Job Permissions"}),"\n",(0,s.jsx)(i.p,{children:"While the LDAP Data Collector and Active Directory Data Collector typically requires Domain Administrator permissions when targeting a domain controller, that level of access is not required to run the 5.Domains > AD_DomainInfo Job. The minimum requirements for running this job, which must be configured at the Domain level in Active Directory, are:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Read access to: %DOMAINDN% and its children"}),"\n",(0,s.jsx)(i.li,{children:"Read access to: CN=System,%DOMAINDN% and its children"}),"\n",(0,s.jsx)(i.li,{children:"Read access to: %SITEDN% and its children"}),"\n",(0,s.jsx)(i.li,{children:"Read access to: %PARTITIONDNS% and its children"}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["See the ",(0,s.jsx)(i.a,{href:"#variable-definitions",children:"Variable Definitions"})," for variable definitions."]}),"\n",(0,s.jsx)(i.p,{children:"AD_ActivityCollection Job Permission"}),"\n",(0,s.jsx)(i.p,{children:"The ADActivity Data Collector in the 6.Activity > 0.Collection > AD_ActivityCollection Job has the following minimum requirements:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Netwrix Activity Monitor API Access activity data"}),"\n",(0,s.jsx)(i.li,{children:"Netwrix Activity Monitor API Read"}),"\n",(0,s.jsx)(i.li,{children:"Read access to the Netwrix Activity Monitor Log Archive location"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"variable-definitions",children:"Variable Definitions"}),"\n",(0,s.jsx)(i.p,{children:"The following variables are referenced for Active Directory Least Privileged Models:"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"%PARTITIONDNS%"})," is the distinguished name of the accessed partition; ",(0,s.jsx)(i.code,{children:"CN=Partitions,CN=Configuration,DC=contoso,DC=com"})]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"%SITEDN%"})," is the distinguished name of the accessed site; ",(0,s.jsx)(i.code,{children:"CN=Sites,CN=Configuration,DC=contoso,DC=com"})]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"%CONFIGDN%"})," is the distinguished name of the configuration naming context; ",(0,s.jsx)(i.code,{children:"CN=Configuration,DC=company,DC=com"})]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"%SCHEMADN%"})," is the distinguished name of the accessed schema; ",(0,s.jsx)(i.code,{children:"CN=Schema,CN=Configuration,DC=company,DC=com"})]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"%DOMAINDN%"}),'" is the distinguished name of the accessed domain object; ',(0,s.jsx)(i.code,{children:"DC=company,DC=com"})]})]})}function h(e={}){const{wrapper:i}={...(0,o.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);