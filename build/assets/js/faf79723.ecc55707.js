"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[645948],{28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>c});var t=i(296540);const r={},o=t.createContext(r);function s(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(o.Provider,{value:n},e.children)}},299138:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"auditor/configuration/fileservers/nutanix/notificationpolicy","title":"Create a Notification Policy","description":"To monitor operations with files and folders on Nutanix File Server, you should configure a notification policy for the related events.","source":"@site/docs/auditor/auditor/configuration/fileservers/nutanix/notificationpolicy.md","sourceDirName":"auditor/configuration/fileservers/nutanix","slug":"/auditor/configuration/fileservers/nutanix/notificationpolicy","permalink":"/docs/auditor/auditor/configuration/fileservers/nutanix/notificationpolicy","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/fileservers/nutanix/notificationpolicy.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Configure ONTAPI\\\\RESTAPI Web Access","permalink":"/docs/auditor/auditor/configuration/fileservers/netappcmode/webaccess"},"next":{"title":"Nutanix","permalink":"/docs/auditor/auditor/configuration/fileservers/nutanix/overview"}}');var r=i(474848),o=i(28453);const s={},c="Create a Notification Policy",l={},d=[{value:"Monitored Operations",id:"monitored-operations",level:2},{value:"Configuration Procedure",id:"configuration-procedure",level:2},{value:"Auditing Specific Folders",id:"auditing-specific-folders",level:2},{value:"Example",id:"example",level:2}];function a(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"create-a-notification-policy",children:"Create a Notification Policy"})}),"\n",(0,r.jsx)(n.p,{children:"To monitor operations with files and folders on Nutanix File Server, you should configure a notification policy for the related events."}),"\n",(0,r.jsx)(n.h2,{id:"monitored-operations",children:"Monitored Operations"}),"\n",(0,r.jsx)(n.p,{children:"The list of supported operations is provided in the table below. Your notification policy can include any of them."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"To audit..."}),(0,r.jsx)(n.th,{children:"Operation name to specify at policy creation"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Successful ",(0,r.jsx)(n.em,{children:"create"})," operations"]}),(0,r.jsx)(n.td,{children:"FILE_CREATE  DIRECTORY_CREATE"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Successful ",(0,r.jsx)(n.em,{children:"read"})," operations"]}),(0,r.jsx)(n.td,{children:"FILE_READ"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Successful ",(0,r.jsx)(n.em,{children:"modify"})," operations"]}),(0,r.jsx)(n.td,{children:"FILE_WRITE  RENAME  SECURITY"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Successful ",(0,r.jsx)(n.em,{children:"delete"})," operations"]}),(0,r.jsx)(n.td,{children:"FILE_DELETE  DIRECTORY_DELETE"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Failed ",(0,r.jsx)(n.em,{children:"read/modify/delete"})," attempts*"]}),(0,r.jsx)(n.td,{children:"FILE_OPEN"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"* - Failed attempt to move/rename file are not audited."}),"\n",(0,r.jsx)(n.h2,{id:"configuration-procedure",children:"Configuration Procedure"}),"\n",(0,r.jsxs)(n.p,{children:["Notification policy creation procedure involves API requests usage. It is assumed that you have a good understanding of REST API concepts, as well as enough experience in working with JSON-formatted requests in any API client. To get acquainted with Nutanix REST API Explorer client, refer to ",(0,r.jsx)(n.a,{href:"https://portal.nutanix.com/#nutanix-documentation",children:"Nutanix documentation"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"To create a notification policy for Nutanix File Server via API:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Open the ",(0,r.jsx)(n.strong,{children:"File Server REST API Explorer"})," client using the following URL:"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"https://<fileserver_ip>:9440/api/nutanix/v3/api_explorer/index.html#/"})}),"\n",(0,r.jsxs)(n.p,{children:["here ",(0,r.jsx)(n.code,{children:"< fileserver_ip >"})," - IP address of the Nutanix File Server to be audited."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["If you select to launch the RestAPI Explorer from the Prism menu, the ",(0,r.jsx)(n.strong,{children:"RestAPI Explorer for Prism"})," client will be opened."]}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In the ",(0,r.jsx)(n.strong,{children:"username"})," and ",(0,r.jsx)(n.strong,{children:"password"})," fields, enter the credentials of the ",(0,r.jsx)(n.a,{href:"/docs/auditor/auditor/configuration/fileservers/nutanix/useraccount",children:"Create User Account to Access Nutanix REST API"})," you have created."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click\xa0",(0,r.jsx)(n.strong,{children:"Explore"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In the ",(0,r.jsx)(n.strong,{children:"File Server REST API Explorer"})," REST API client, locate the POST request for ",(0,r.jsx)(n.code,{children:"notification_policies"})," :"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"POST /notification_policies"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"In the request body, enter the following JSON-formatted structure:"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'{\n\n"spec": {\n\n"name": "<NAME_OF_NOTIFICATION_POLICY>",\n\n"resources": {\n\n"all_mount_targets" : true,\n\n"protocol_type_list" : ["SMB"],\n\n"file_operation_list" : [<LIST_OF_FILE_OPERATIONS>],\n\n"partner_server_reference_list" : [{\n\n"kind" : "partner_server",\n\n"uuid" : "<UUID_OF_PARTNER_SERVER>"\n\n}]\n\n},\n\n"description": "<optional_string>"\n\n},\n\n"api_version": "3.0",\n\n"metadata": {\n\n"kind": "notification_policy"\n\n}\n\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"here:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:'"all_mount_targets" : true'})," - instructs to notify on changes to all shares"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:'"protocol_type_list" : ["SMB"]'})," - instructs to track SMB shares (the only currently supported)"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:(0,r.jsx)(n.code,{children:"<NAME_OF_NOTIFICATION_POLICY>"})})," \u2013 enter the name of notification policy you want to create"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:(0,r.jsx)(n.code,{children:"<UUID_OF_PARTNER_SERVER>"})})," - enter the ",(0,r.jsx)(n.code,{children:"uuid"})," of ",(0,r.jsx)(n.a,{href:"/docs/auditor/auditor/configuration/fileservers/nutanix/partnerserver",children:"Configure Partner Server"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:(0,r.jsx)(n.code,{children:"<LIST_OF_FILE_OPERATIONS>"})})," - enter the list of operations to be audited."]}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Send the request, clicking ",(0,r.jsx)(n.strong,{children:"Try it out"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Get the response - ",(0,r.jsx)(n.code,{children:"Response Code"})," should be ",(0,r.jsx)(n.em,{children:"200"}),". In the response body, locate the ",(0,r.jsx)(n.code,{children:"uuid"})," of the created notification policy."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"To check that a new policy was included in the list of existing policies, retrieve the list of policies, sending the POST request to the following endpoint:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"POST /notification_policies/list"}),". The request body must be empty - for that, enter empty brackets as the ",(0,r.jsx)(n.strong,{children:"value"})," for ",(0,r.jsx)(n.em,{children:"get_entities_request"})," parameter : ",(0,r.jsx)(n.code,{children:"{ }"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"auditing-specific-folders",children:"Auditing Specific Folders"}),"\n",(0,r.jsx)(n.p,{children:"If you want to audit only the certain folders on Nutanix File Server (mount targets), then do the following:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Retrieve the list of existing mount targets using the ",(0,r.jsx)(n.code,{children:"mount_target POST /mount_targets/list"})," request with empty body, as described above."]}),"\n",(0,r.jsxs)(n.li,{children:["In the response, locate the ",(0,r.jsx)(n.code,{children:"uuids"})," of the target folders you want to audit."]}),"\n",(0,r.jsxs)(n.li,{children:["In the notification policy creation request (described above) instead of ",(0,r.jsx)(n.code,{children:'"all_mount_targets" : true'})," in the request body enter the following JSON-formatted structure:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'"mount_target_reference_list": [\n{\n"kind" : "mount_target",\n"uuid" : "<UUID_OF_MOUNT_TARGET1>"\n},\n{\n"kind" : "mount_target",\n"uuid" : "<UUID_OF_MOUNT_TARGET2>"\n},\n]\n'})}),"\n",(0,r.jsx)(n.p,{children:"here:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.em,{children:[(0,r.jsx)(n.code,{children:"<UUID_OF_MOUNT_TARGET"}),">"]})," \u2013 enter the uuid of target you want to audit."]}),"\n",(0,r.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,r.jsxs)(n.p,{children:["The JSON-formatted structure below is an example of the request body that can be used to create a notification policy named ",(0,r.jsx)(n.em,{children:"MOUNT_POINT_POLICY"})," to audit the mount a share on Nutanix File Server with the ",(0,r.jsx)(n.em,{children:"uuid=378896fd-e829-4869-84a2-6c29268acfff"}),". The following operations will be audited:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'"FILE_READ",'}),"\n",(0,r.jsx)(n.li,{children:'"FILE_CREATE",'}),"\n",(0,r.jsx)(n.li,{children:'"FILE_DELETE",'}),"\n",(0,r.jsx)(n.li,{children:'"DIRECTORY_CREATE",'}),"\n",(0,r.jsx)(n.li,{children:'"DIRECTORY_DELETE",'}),"\n",(0,r.jsx)(n.li,{children:'"FILE_WRITE",'}),"\n",(0,r.jsx)(n.li,{children:'"RENAME",'}),"\n",(0,r.jsx)(n.li,{children:'"SECURITY",'}),"\n",(0,r.jsx)(n.li,{children:'"FILE_OPEN"'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"JSON structure is as follows:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'{\n\n"spec": {\n\n"name": "MOUNT_POINT_POLICY ",\n\n"resources": {\n\n"mount_target_reference_list": [\n\n{\n\n"kind" : "mount_target",\n\n"uuid" : "378896fd-e829-4869-84a2-6c29268acfff\u201d\n\n}\n\n],\n\n"protocol_type_list" : ["SMB"],\n\n"file_operation_list" :[\n\n"FILE_READ",\n\n"FILE_CREATE",\n\n"FILE_DELETE",\n\n"DIRECTORY_CREATE",\n\n"DIRECTORY_DELETE",\n\n"FILE_WRITE",\n\n"RENAME",\n\n"SECURITY",\n\n"FILE_OPEN"\n\n],\n\n"partner_server_reference_list" : [\n\n{\n\n"kind" : "partner_server",\n\n"uuid" : " d0bfb952-924b-459e-bd32-44c8b5a62838"\n\n}\n\n]\n\n},\n\n"description": "<optional_string>"\n\n},\n\n"api_version": "3.0",\n\n"metadata": {\n\n"kind": "notification_policy"\n\n}\n\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);