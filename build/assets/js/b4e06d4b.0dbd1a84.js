"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[357690],{28453:(e,o,t)=>{t.d(o,{R:()=>i,x:()=>a});var s=t(296540);const n={},r=s.createContext(n);function i(e){const o=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function a(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),s.createElement(r.Provider,{value:o},e.children)}},598683:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"policypak/video/scriptstriggers/lockunlocksession","title":"Endpoint Policy Manager Scripts + Triggers: Perform actions at LOCK and UNLOCK of session","description":"In this demo you\'ll see how to use Session Lock and Session Unlock trigger types with Netwrix Endpoint Policy Manager (formerly PolicyPak) Scripts. It\'s easy to do ! Pre-test your script first, then you\'re off to the races. Remember which processes require RUN INTERACTIVE though !","source":"@site/docs/policypak/policypak/video/scriptstriggers/lockunlocksession.md","sourceDirName":"policypak/video/scriptstriggers","slug":"/policypak/video/scriptstriggers/lockunlocksession","permalink":"/docs/policypak/policypak/video/scriptstriggers/lockunlocksession","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/video/scriptstriggers/lockunlocksession.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Removing Unwanted Windows Apps Using Endpoint Policy Manager and PDQ Deploy","permalink":"/docs/policypak/policypak/video/scriptstriggers/integration/pdqdeploy"},"next":{"title":"Endpoint Policy Manager Scripts + Triggers: Map a printer or drive when a process runs and un-map it when closed.","permalink":"/docs/policypak/policypak/video/scriptstriggers/mapdrivetriggers"}}');var n=t(474848),r=t(28453);const i={},a="Endpoint Policy Manager Scripts + Triggers: Perform actions at LOCK and UNLOCK of session",c={},l=[];function h(e){const o={h1:"h1",header:"header",p:"p",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.header,{children:(0,n.jsx)(o.h1,{id:"endpoint-policy-manager-scripts--triggers-perform-actions-at-lock-and-unlock-of-session",children:"Endpoint Policy Manager Scripts + Triggers: Perform actions at LOCK and UNLOCK of session"})}),"\n",(0,n.jsx)(o.p,{children:"In this demo you'll see how to use Session Lock and Session Unlock trigger types with Netwrix Endpoint Policy Manager (formerly PolicyPak) Scripts. It's easy to do ! Pre-test your script first, then you're off to the races. Remember which processes require RUN INTERACTIVE though !"}),"\n",(0,n.jsx)(o.p,{children:"Hi, this is Jeremy Moskowitz, and in this video, I'm going to show you how you can use Endpoint Policy Manager scripts and triggers to fire off activities when the session is locked and unlocked. Now you should practice what you're doing to do before you jump into Endpoint Policy Manager scripts and triggers. In this simple example, I'm going to start a process, Notepad, when I unlock the computer, and I'm going to kill all Notepads when I lock the computer. I'm going to start when I unlock and I'm going to kill all Notepads when I unlock."}),"\n",(0,n.jsx)(o.p,{children:"Let's try this out one by one. If I were to have a Notepad already running here \u2013 in fact, if I were to have multiple Notepads here just to prove a point, I can run PowerShell as a standard user here. It doesn't have to be PowerShell, by the way; you can do the same thing with Batch Files or whatever. If you wanted to see what happens if you stop the \u2013 if you were to run the PowerShell command stopprocessnotepadforce, bang, you can see that that worked. If you wanted to see that starting a process, Notepads works with this script, startprocess, C windowsnotepad. Bang, you can see that that works."}),"\n",(0,n.jsx)(o.p,{children:"Now that you've pretested your scripts, you're ready to go into group policy land and of course, this works as well, perfectly well, in MDM or Endpoint Policy Manager Cloud. I'm just using group policy in my example here. I do \"PP scripts and triggers with lock and unlock.\" If I were to dive in here and click Edit, what I'll do is I'll go to the users side here and then you could go to Scripts Manager, and then right-click Add a New Policy here. What we'll do \u2013 again, I'm using PowerShell scripts but you don't have to. You can use Batch or VB for Javascript. I'm going to use PowerShell here and I've got the same script hanging out right here."}),"\n",(0,n.jsx)(o.p,{children:"What I'm going to do is kill all Notepads on lock, so bang. This script does not have to be run interactively because soon as you hit lock \u2013 there's no output to the screen, so it doesn't have to be run interactively. There's no revert action here required for scripts. Then the trigger that we said that we want is going to be at session locked. That's when we're going to nuke these things. Session lock trigger policy, that's good enough for now."}),"\n",(0,n.jsx)(o.p,{children:"Now let's create another policy here for the other guy, so let's go to PowerShell script, and now we're going to start process on unlock. There's the start process for Notepad. Now this does have to be run interactively because this is going to throw something out on the screen. Now this is going to throw a little micro PowerShell blue for a second. If you don't like that, you can probably get away with Batch script or one of the other scripts. I'm just using PowerShell for whatever reason."}),"\n",(0,n.jsx)(o.p,{children:"There's no revert action here and again, this is going to be on the trigger of the unlock. That's it. We're ready to rock, and we're ready to test it out. Let's go back over here. We'll run GP Update, give this a second to catch up. Alright, now that we've got all this, let's go ahead and run a couple of Notepads just to get started and we'll go ahead and get another one up and running here, bing, bing, bing. Alright, so again, we're just testing out the trigger mechanism."}),"\n",(0,n.jsx)(o.p,{children:"What we want to do is hit Control-Alt-Delete and lock and when we do that, what do we expect? We expect that those two Notepads are obliterated and now let's go ahead and unlock and what should we see? We should see that one new Notepad show up here. There we go. We can see we've only got the one Notepad session here and if we were to lock again \u2013 okay, lock, bang, it's obliterated in the background. Of course, we can't see it. Now if we unlock, bang, we put it back on."}),"\n",(0,n.jsx)(o.p,{children:"Endpoint Policy Manager scripts and triggers enables you to at session lock or unlock time, do some superpower magic and hopefully this example will give you some great stuff for your imagination. Hope this helps you out. Looking forward to helping you get started real soon."})]})}function d(e={}){const{wrapper:o}={...(0,r.R)(),...e.components};return o?(0,n.jsx)(o,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}}}]);