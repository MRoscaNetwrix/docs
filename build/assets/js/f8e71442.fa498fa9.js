"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[324920],{28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>t});var r=i(296540);const s={},l=r.createContext(s);function a(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(l.Provider,{value:n},e.children)}},44628:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/administratorcommandprompt-2fba0ab406c6c63218adf850e5eaf3fd.webp"},650391:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>E,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"enterpriseauditor/requirements/target/config/databaseoracle","title":"Oracle Target Least Privilege Model","description":"We recommend using an account DBA privilege to run Access Analyzer against an Oracle database. However, if that is not acceptable all the privileges that are required to configure and run the solution are below and can be used to implement the least privileges necessary.","source":"@site/docs/accessanalyzer/enterpriseauditor/requirements/target/config/databaseoracle.md","sourceDirName":"enterpriseauditor/requirements/target/config","slug":"/enterpriseauditor/requirements/target/config/databaseoracle","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/target/config/databaseoracle","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/enterpriseauditor/requirements/target/config/databaseoracle.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"AzureSQL Target Least Privilege Model","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/target/config/databaseazuresql"},"next":{"title":"Target Db2 Requirements, Permissions, and Ports","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/target/databasedb2"}}');var s=i(474848),l=i(28453);const a={},t="Oracle Target Least Privilege Model",o={},c=[{value:"Create Session Privilege",id:"create-session-privilege",level:2},{value:"User Credentials Role",id:"user-credentials-role",level:2},{value:"Oracle Server Discovery",id:"oracle-server-discovery",level:2},{value:"Oracle SID Discovery",id:"oracle-sid-discovery",level:2},{value:"Oracle Instance Discovery",id:"oracle-instance-discovery",level:2},{value:"Oracle Permission Auditing",id:"oracle-permission-auditing",level:2},{value:"Oracle Database 19c Series Permissions",id:"oracle-database-19c-series-permissions",level:3},{value:"Oracle Database 12c Series Permissions",id:"oracle-database-12c-series-permissions",level:3},{value:"Oracle Database 11g Series Permissions",id:"oracle-database-11g-series-permissions",level:3},{value:"Oracle Sensitive Data Auditing",id:"oracle-sensitive-data-auditing",level:2},{value:"Oracle Database 12c Series Sensitive Data",id:"oracle-database-12c-series-sensitive-data",level:3},{value:"Oracle Database 11g Series Sensitive Data",id:"oracle-database-11g-series-sensitive-data",level:3},{value:"Oracle Activity Auditing",id:"oracle-activity-auditing",level:2},{value:"Oracle Database 12c Series Activity Data",id:"oracle-database-12c-series-activity-data",level:3},{value:"Oracle Database 11g Series Activity Data",id:"oracle-database-11g-series-activity-data",level:3},{value:"Oracle Users with Default Passwords Job",id:"oracle-users-with-default-passwords-job",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"oracle-target-least-privilege-model",children:"Oracle Target Least Privilege Model"})}),"\n",(0,s.jsx)(n.p,{children:"We recommend using an account DBA privilege to run Access Analyzer against an Oracle database. However, if that is not acceptable all the privileges that are required to configure and run the solution are below and can be used to implement the least privileges necessary."}),"\n",(0,s.jsx)(n.h2,{id:"create-session-privilege",children:"Create Session Privilege"}),"\n",(0,s.jsxs)(n.p,{children:["Before getting started with the least privilege model, ensure that the Access Analyzer Connection Profile user has the ",(0,s.jsx)(n.strong,{children:"Create Session"})," privilege granted. To do it, run the following command in Oracle environment (SQL Plus or SQL Developer):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT CREATE SESSION TO %USERNAME%;\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"NOTE:"})," The above command will grant the privilege only in the current container. To follow the least privilege model, only grant the privilege on the containers (or pluggable databases) that you will be scanning with Access Analyzer."]}),"\n",(0,s.jsxs)(n.p,{children:["However, if you target all of your pluggable databases, then to grant the ",(0,s.jsx)(n.strong,{children:"Create Session"})," privilege on all of those containers at once, run the following command:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT CREATE SESSION TO %USERNAME% CONTAINER=ALL;\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\n"})}),"\n",(0,s.jsx)(n.h2,{id:"user-credentials-role",children:"User Credentials Role"}),"\n",(0,s.jsxs)(n.p,{children:["When using a least privileged model for Oracle, ",(0,s.jsx)(n.strong,{children:"SYSDBA"})," must be selected for the Role in the User Credentials window for the Oracle Connection Profile. See the ",(0,s.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/settings/connection/profile/oracle",children:"Oracle for User Credentials"})," topic for additional information."]}),"\n",(0,s.jsx)(n.h2,{id:"oracle-server-discovery",children:"Oracle Server Discovery"}),"\n",(0,s.jsxs)(n.p,{children:["This Job uses Nmap to locate listening Oracle ports on servers by scanning for ports using the service Oracle TNS Listener or optionally using specified ports, such as 1521. The Nmap utility can be downloaded from ",(0,s.jsx)(n.a,{href:"http://www.nmap.org/",children:"nmap.org"}),". To run this job, the user needs to have a permission to execute any PowerShell script on the local host if the host is running the Microsoft Windows operating system. In addition, on the Windows host, PowerShell execution policy needs to be sent as well. For example, to set the execution policy to ",(0,s.jsx)(n.code,{children:"Unrestricted"}),", run the following command on the PowerShell command line:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Set-ExecutionPolicy -ExecutionPolicy Unrestricted\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In case of Linux and UNIX hosts, the ",(0,s.jsx)(n.code,{children:"plink"})," command needs to be executed on the Access Analyzer Console server to update the local file with the SSH keys."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"NOTE:"})," The plink utility in the Access Analyzer installation directory has to be used. A version of plink gets installed with the Nmap utility."]}),"\n",(0,s.jsx)(n.p,{children:"The syntax is as follows:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"administratorcommandprompt",src:i(44628).A+"",width:"959",height:"741"})}),"\n",(0,s.jsx)(n.p,{children:"Run the following on the command prompt:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"C:\\Program Files (x86)\\Stealthbits\\StealthAUDIT\\plink <hostname>\xa0\xa0-store_new_keys\xa0\xa0\xa0\xa0\xa0\xa0\n"})}),"\n",(0,s.jsx)(n.h2,{id:"oracle-sid-discovery",children:"Oracle SID Discovery"}),"\n",(0,s.jsx)(n.p,{children:"This Job collects the Oracle SID from discovered Oracle servers and uses WMI or SSH to collect running Oracle processes from the Oracle servers. The process is used to determine the name of the Oracle SID. When multiple Oracle instances are running on a server, each SID will have its own entry in this table."}),"\n",(0,s.jsx)(n.p,{children:"This Job requires local administrator rights on the target hosts in order to read the running processes using either WMI or SSH."}),"\n",(0,s.jsx)(n.h2,{id:"oracle-instance-discovery",children:"Oracle Instance Discovery"}),"\n",(0,s.jsx)(n.p,{children:"This Job verifies Oracle SID, IP Address, and Port combinations and inserts them into the SA_SQL_Instances table."}),"\n",(0,s.jsx)(n.p,{children:"This Job requires read rights on the Oracle table DUAL, all users with any read right on an Oracle server should be able to validate this query."}),"\n",(0,s.jsxs)(n.p,{children:["For example, to grant a user ",(0,s.jsx)(n.code,{children:"SELECT"})," permission on DUAL, run the following command in SQL Developer or SQL*Plus:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT SELECT ON DUAL TO %USERNAME%;\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"NOTE:"})," Replace ",(0,s.jsx)(n.code,{children:"%USERNAME%"})," with the actual username of the user."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"CONTAINER_DATA=ALL FOR %NAME_OF_PLUGGABLE_DATABASE% CONTAINER = CURRENT;\n"})}),"\n",(0,s.jsx)(n.p,{children:"If you want to scan all pluggable databases in the given environment, run the following command in the root container:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ALTER USER %USERNAME% SET CONTAINER_DATA=ALL CONTAINER = CURRENT;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"oracle-permission-auditing",children:"Oracle Permission Auditing"}),"\n",(0,s.jsx)(n.p,{children:"The Oracle Permissions Scan job is responsible for collecting all permissions from all licensed database types for all target instances."}),"\n",(0,s.jsx)(n.h3,{id:"oracle-database-19c-series-permissions",children:"Oracle Database 19c Series Permissions"}),"\n",(0,s.jsxs)(n.p,{children:["In order to collect permissions from Oracle Database 19c series, the user credential requires at least the following ",(0,s.jsx)(n.code,{children:"SELECT"})," privilege on the targeted database for the following views and tables:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CDB_COL_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_TAB_COLS view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_OBJECTS view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_PROFILES view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_ROLE_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_ROLES view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_SYS_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_TABLESPACES view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_TAB_PRIVS view."}),"\n",(0,s.jsx)(n.li,{children:"CDB_USERS view."}),"\n",(0,s.jsx)(n.li,{children:"V_$DATABASE view."}),"\n",(0,s.jsx)(n.li,{children:"V_$RSRC_CONSUMER_GROUP view."}),"\n",(0,s.jsx)(n.li,{children:"V_$CONTAINERS view."}),"\n",(0,s.jsx)(n.li,{children:"V_$PARAMETER view."}),"\n",(0,s.jsx)(n.li,{children:"V_$PDBS view."}),"\n",(0,s.jsx)(n.li,{children:"V_$INSTANCE view."}),"\n",(0,s.jsx)(n.li,{children:"SYS.USER$ table."}),"\n",(0,s.jsx)(n.li,{children:"DBA_TABLESPACES view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_ROLES view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_USERS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_OBJECTS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_COL_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_TAB_COLS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_ROLE_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_SYS_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_TAB_PRIVS view"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For example, to grant all of the above privileges, run the following set of commands in SQL Developer or SQL*Plus:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT CONNECT TO %USERNAME%;  \nGRANT CREATE SESSION TO %USERNAME%;  \nGRANT SELECT ON DUAL TO %USERNAME%;  \nGRANT SELECT ON CDB_COL_PRIVS TO %USERNAME%;  \nGRANT SELECT ON CDB_TAB_COLS TO %USERNAME%;  \nGRANT SELECT ON CDB_OBJECTS TO %USERNAME%;  \nGRANT SELECT ON CDB_PROFILES TO %USERNAME%;  \nGRANT SELECT ON CDB_ROLE_PRIVS TO %USERNAME%;  \nGRANT SELECT ON CDB_ROLES TO %USERNAME%;  \nGRANT SELECT ON CDB_SYS_PRIVS TO %USERNAME%;  \nGRANT SELECT ON CDB_TABLESPACES TO %USERNAME%;  \nGRANT SELECT ON CDB_TAB_PRIVS TO %USERNAME%;  \nGRANT SELECT ON CDB_USERS TO %USERNAME%;  \nGRANT SELECT ON V_$DATABASE TO %USERNAME%;  \nGRANT SELECT ON V_$RSRC_CONSUMER_GROUP TO %USERNAME%;  \nGRANT SELECT ON V_$CONTAINERS TO %USERNAME%;  \nGRANT SELECT ON V_$PARAMETER TO %USERNAME%;  \nGRANT SELECT ON V_$PDBS TO %USERNAME%;  \nGRANT SELECT ON V_$INSTANCE TO %USERNAME%;  \nGRANT SELECT ON SYS.USER$ TO %USERNAME%;  \nGRANT SELECT ON DBA_TABLESPACES TO %USERNAME%;  \nGRANT SELECT ON DBA_ROLES TO %USERNAME%;  \nGRANT SELECT ON DBA_USERS TO %USERNAME%;  \nGRANT SELECT ON DBA_OBJECTS TO %USERNAME%;  \nGRANT SELECT ON DBA_COL_PRIVS TO %USERNAME%;  \nGRANT SELECT ON DBA_TAB_COLS TO %USERNAME%;  \nGRANT SELECT ON DBA_ROLE_PRIVS TO %USERNAME%;  \nGRANT SELECT ON DBA_SYS_PRIVS TO %USERNAME%;  \nGRANT SELECT ON DBA_TAB_PRIVS TO %USERNAME%;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"oracle-database-12c-series-permissions",children:"Oracle Database 12c Series Permissions"}),"\n",(0,s.jsxs)(n.p,{children:["In order to collect permissions from Oracle Database 12c series, the user credential requires at least the following ",(0,s.jsx)(n.code,{children:"SELECT"})," privilege on the targeted database for the following views and tables:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CDB_COL_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_TAB_COLS view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_OBJECTS view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_PROFILES view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_ROLE_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_ROLES view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_SYS_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_TABLESPACES view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_TAB_PRIVS view."}),"\n",(0,s.jsx)(n.li,{children:"CDB_USERS view."}),"\n",(0,s.jsx)(n.li,{children:"V_$RSRC_CONSUMER_GROUP view."}),"\n",(0,s.jsx)(n.li,{children:"V_$DATABASE view."}),"\n",(0,s.jsx)(n.li,{children:"V_$PARAMETER view."}),"\n",(0,s.jsx)(n.li,{children:"V_$PDBS view."}),"\n",(0,s.jsx)(n.li,{children:"V_$CONTAINERS view."}),"\n",(0,s.jsx)(n.li,{children:"SYS.USER$ table."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For example, to grant all of the above privileges, run the following set of commands in SQL Developer or SQL*Plus:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT SELECT ON CDB_COL_PRIVS TO %USERNAME%;  \nGRANT SELECT ON CDB_TAB_COLS TO %USERNAME%;  \nGRANT SELECT ON CDB_OBJECTS TO %USERNAME%;  \nGRANT SELECT ON CDB_PROFILES TO %USERNAME%;  \nGRANT SELECT ON CDB_ROLE_PRIVS TO %USERNAME%;  \nGRANT SELECT ON CDB_ROLES TO %USERNAME%;  \nGRANT SELECT ON CDB_SYS_PRIVS TO %USERNAME%;  \nGRANT SELECT ON CDB_TABLESPACES TO %USERNAME%;  \nGRANT SELECT ON CDB_TAB_PRIVS TO %USERNAME%;  \nGRANT SELECT ON CDB_USERS TO %USERNAME%;  \nGRANT SELECT ON V_$DATABASE TO %USERNAME%;  \nGRANT SELECT ON V_$RSRC_CONSUMER_GROUP TO %USERNAME%;  \nGRANT SELECT ON V_$CONTAINERS TO %USERNAME%;  \nGRANT SELECT ON V_$PARAMETER TO %USERNAME%;  \nGRANT SELECT ON V_$PDBS TO %USERNAME%;  \nGRANT SELECT ON SYS.USER$ TO %USERNAME%;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"oracle-database-11g-series-permissions",children:"Oracle Database 11g Series Permissions"}),"\n",(0,s.jsxs)(n.p,{children:["In order to collect permissions from Oracle Database 11g series, the user credential requires at least the following ",(0,s.jsx)(n.code,{children:"SELECT"})," privileges on the targeted database for the following views and tables:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"DBA_COL_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_TAB_COLS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_OBJECTS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_PROFILES view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_ROLES view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_ROLE_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_SYS_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_TABLESPACES view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_TAB_PRIVS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_USERS view"}),"\n",(0,s.jsx)(n.li,{children:"V_$RSRC_CONSUMER_GROUP view"}),"\n",(0,s.jsx)(n.li,{children:"V_$DATABASE view"}),"\n",(0,s.jsx)(n.li,{children:"V_$PARAMETER view"}),"\n",(0,s.jsx)(n.li,{children:"SYS.USER$ table"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For example, to grant all of the above privileges, run the following set of commands in Oracle SQL Developer or SQL*Plus:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT SELECT ON DBA_TAB_COLS TO %USERNAME%;  \nGRANT SELECT ON DBA_OBJECTS TO %USERNAME%;  \nGRANT SELECT ON DBA_TABLESPACES TO %USERNAME%;  \nGRANT SELECT ON DBA_PROFILES TO %USERNAME%;  \nGRANT SELECT ON DBA_TAB_PRIVS TO %USERNAME%;  \nGRANT SELECT ON DBA_ROLES TO %USERNAME%;  \nGRANT SELECT ON DBA_ROLE_PRIVS TO %USERNAME%;  \nGRANT SELECT ON DBA_SYS_PRIVS TO %USERNAME%;  \nGRANT SELECT ON DBA_COL_PRIVS TO %USERNAME%;  \nGRANT SELECT ON DBA_USERS TO %USERNAME%;  \nGRANT SELECT ON V_$RSRC_CONSUMER_GROUP TO %USERNAME%;  \nGRANT SELECT ON V_$DATABASE TO %USERNAME%;  \nGRANT SELECT ON V_$PARAMETER TO %USERNAME%;  \nGRANT SELECT ON SYS.USER$ TO %USERNAME%;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"oracle-sensitive-data-auditing",children:"Oracle Sensitive Data Auditing"}),"\n",(0,s.jsx)(n.p,{children:"This job is responsible for identifying sensitive data that has been stored within target database instances."}),"\n",(0,s.jsx)(n.p,{children:"Before running this scan, ensure that Oracle database statistics are up to date at least for the targeted schema or tables. Use one of the following commands:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"EXEC DBMS_STATS.GATHER_SCHEMA_STATS('%SCHEMA_NAME%');  \nEXEC DBMS_STATS.GATHER_TABLE_STATS('%SCHEMA_NAME%', \u2018%TABLE_NAME%\u2019);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"oracle-database-12c-series-sensitive-data",children:"Oracle Database 12c Series Sensitive Data"}),"\n",(0,s.jsxs)(n.p,{children:["In order to perform a sensitive data scan on Oracle database 12c series, the user credential requires at least the following ",(0,s.jsx)(n.code,{children:"SELECT"})," privileges on the targeted database for the following views:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"V_$CONTAINERS view"}),"\n",(0,s.jsx)(n.li,{children:"V_$DATABASE view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_TAB_COLS view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_OBJECTS view"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For example, to grant the above privileges, run the following set of commands in SQL Developer or SQL*Plus:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT SELECT ON V_$CONTAINERS TO %USERNAME%;  \nGRANT SELECT ON V_$DATABASE TO %USERNAME%;  \nGRANT SELECT ON CDB_TAB_COLS TO %USERNAME%;  \nGRANT SELECT ON CDB_OBJECTS TO %USERNAME%;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"oracle-database-11g-series-sensitive-data",children:"Oracle Database 11g Series Sensitive Data"}),"\n",(0,s.jsxs)(n.p,{children:["In order to perform a sensitive data scan on Oracle database 11g series, the user credential requires at least the following ",(0,s.jsx)(n.code,{children:"SELECT"})," privileges on the targeted database for the following views:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"V_$DATABASE view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_TAB_COLS view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_OBJECTS view"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For example, to grant the above privileges, run the following set of commands in SQL Developer or SQL*Plus:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT SELECT ON V_$DATABASE TO %USERNAME%;  \nGRANT SELECT ON DBA_TAB_COLS TO %USERNAME%;  \nGRANT SELECT ON DBA_OBJECTS TO %USERNAME%;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Please note that the ",(0,s.jsx)(n.code,{children:"SELECT"})," privilege needs to be granted individually on all sensitive data tables to be targeted (more secure). To accomplish it, run the following command for each targeted sensitive data table:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT SELECT ON %YOUR_SENSITIVE_DATA_TABLE% TO %USERNAME%;\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"(Optional)"}),"\xa0Grant the ",(0,s.jsx)(n.code,{children:"SELECT"})," privilege on any table (less secure) by running the following command:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT SELECT ANY TABLE TO %USERNAME%;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"oracle-activity-auditing",children:"Oracle Activity Auditing"}),"\n",(0,s.jsx)(n.p,{children:"This job is responsible for collecting audit data from configured database server audits on target endpoints."}),"\n",(0,s.jsx)(n.h3,{id:"oracle-database-12c-series-activity-data",children:"Oracle Database 12c Series Activity Data"}),"\n",(0,s.jsxs)(n.p,{children:["In order to perform an activity data scan on Oracle database 12c series, the user credential requires at least the following ",(0,s.jsx)(n.code,{children:"SELECT"})," privileges on the targeted database for the following views:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"V_$DATABASE view"}),"\n",(0,s.jsx)(n.li,{children:"CDB_COMMON_AUDIT_TRAIL view"}),"\n",(0,s.jsx)(n.li,{children:"UNIFIED_AUDIT_TRAIL view"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For example, to grant the above privileges, run the following set of commands in SQL Developer or SQL*Plus:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT SELECT ON V_$DATABASE TO %USERNAME%;  \nGRANT SELECT ON CDB_COMMON_AUDIT_TRAIL TO %USERNAME%;  \nGRANT SELECT ON UNIFIED_AUDIT_TRAIL TO %USERNAME%;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If the audit trail mode is ",(0,s.jsx)(n.code,{children:"QUEUED"}),", then audit records are not written to disk until the in-memory queues are full. The following procedure explicitly flushes the queues to disk, so that the audit trail records are viewable in the ",(0,s.jsx)(n.code,{children:"UNIFIED_AUDIT_TRAIL"})," view:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"EXEC SYS.DBMS_AUDIT_MGMT.FLUSH_UNIFIED_AUDIT_TRAIL;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"oracle-database-11g-series-activity-data",children:"Oracle Database 11g Series Activity Data"}),"\n",(0,s.jsxs)(n.p,{children:["In order to perform an activity data scan on Oracle database 11g series, the user credential required at least the following ",(0,s.jsx)(n.code,{children:"SELECT"})," privileges on the targeted database for the following views:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"V_$DATABASE view"}),"\n",(0,s.jsx)(n.li,{children:"DBA_COMMON_AUDIT_TRAIL view"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For example, to grant the above privileges, run the following set of commands in SQL Developer or SQL*Plus:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT SELECT ON V_$DATABASE TO %USERNAME%;  \nGRANT SELECT ON DBA_COMMON_AUDIT_TRAIL TO %USERNAME%;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"oracle-users-with-default-passwords-job",children:"Oracle Users with Default Passwords Job"}),"\n",(0,s.jsx)(n.p,{children:"The 4-Oracle_DefaultPasswordUsers job is responsible for collecting usernames of users whose passwords have not been updated since the database creation."}),"\n",(0,s.jsxs)(n.p,{children:["The user needs to have a ",(0,s.jsx)(n.code,{children:"SELECT"})," privilege on ",(0,s.jsx)(n.code,{children:"CDB_USERS_WITH_DEFPWD"})," table for Oracle container databases (version 12c and higher) or ",(0,s.jsx)(n.code,{children:"DBA_USERS_WITH_DEFPWD"})," for the non-container database (any version below 12c)."]}),"\n",(0,s.jsx)(n.p,{children:"To grant the required privileges, execute the following statements in SQL Developer or SQL*Plus:"}),"\n",(0,s.jsx)(n.p,{children:"For version 12c and later:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT SELECT ON CDB_USERS_WITH_DEFPWD TO %USERNAME%;\n"})}),"\n",(0,s.jsx)(n.p,{children:"For version 11g:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT SELECT ON DBA_USERS_WITH_DEFPWD TO %USERNAME%;\n"})})]})}function E(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);