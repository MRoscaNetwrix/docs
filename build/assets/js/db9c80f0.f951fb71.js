"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[573755],{28206:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/hostfrom-844bfeb7e523abefcd1088488c95fbc0.webp"},28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>a});var n=i(296540);const o={},s=n.createContext(o);function r(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),n.createElement(s.Provider,{value:t},e.children)}},124275:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/userstab-88b0911ddab65c3147b7b6fa747b6119.webp"},156502:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"activitymonitor/admin/monitoreddomains/admonitoringconfiguration/authentication","title":"Authentication Tab","description":"The Authentication tab on a domain\u2019s Configuration window allows users to configure communication with servers.","source":"@site/docs/activitymonitor/activitymonitor/admin/monitoreddomains/admonitoringconfiguration/authentication.md","sourceDirName":"activitymonitor/admin/monitoreddomains/admonitoringconfiguration","slug":"/activitymonitor/admin/monitoreddomains/admonitoringconfiguration/authentication","permalink":"/docs/activitymonitor/activitymonitor/admin/monitoreddomains/admonitoringconfiguration/authentication","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/activitymonitor/activitymonitor/admin/monitoreddomains/admonitoringconfiguration/authentication.md","tags":[],"version":"current","frontMatter":{},"sidebar":"activityMonitorSidebar","previous":{"title":"Qumulo Tab","permalink":"/docs/activitymonitor/activitymonitor/admin/agents/properties/qumulo"},"next":{"title":"Changes Tab","permalink":"/docs/activitymonitor/activitymonitor/admin/monitoreddomains/admonitoringconfiguration/changes"}}');var o=i(474848),s=i(28453);const r={},a="Authentication Tab",c={},d=[{value:"Forged PAC Analytic",id:"forged-pac-analytic",level:2},{value:"Host (From)",id:"host-from",level:2},{value:"Host (To)",id:"host-to",level:2},{value:"IP Addresses (From)",id:"ip-addresses-from",level:2},{value:"IP Addresses (To)",id:"ip-addresses-to",level:2},{value:"Operations",id:"operations",level:2},{value:"Servers",id:"servers",level:2},{value:"Users",id:"users",level:2}];function l(e){const t={h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"authentication-tab",children:"Authentication Tab"})}),"\n",(0,o.jsx)(t.p,{children:"The Authentication tab on a domain\u2019s Configuration window allows users to configure communication with servers."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"AD Monitoring Configuration - Authentication Tab",src:i(353333).A+"",width:"743",height:"852"})}),"\n",(0,o.jsx)(t.p,{children:"After checking the Enable Authentication box, the following event filters can be modified on the sub-tabs:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Forged PAC Analytic"}),"\n",(0,o.jsx)(t.li,{children:"Host (From)"}),"\n",(0,o.jsx)(t.li,{children:"Host (To)"}),"\n",(0,o.jsx)(t.li,{children:"IP Addresses (From)"}),"\n",(0,o.jsx)(t.li,{children:"IP Addresses (To)"}),"\n",(0,o.jsx)(t.li,{children:"Operations"}),"\n",(0,o.jsx)(t.li,{children:"Servers"}),"\n",(0,o.jsx)(t.li,{children:"Users"}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"forged-pac-analytic",children:"Forged PAC Analytic"}),"\n",(0,o.jsx)(t.p,{children:"The Forged Privilege Account Certificate (PAC) analytic type identifies Kerberos tickets with a modified PAC. By manipulating the PAC, a field in the Kerberos ticket that contains a user\u2019s authorization data (in Active Directory this is group membership), an attacker is able to grant themselves additional elevated privileges."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"AD Monitoring Configuration - Authentication Tab",src:i(577371).A+"",width:"743",height:"852"})}),"\n",(0,o.jsxs)(t.p,{children:["Double-click text box to enter specific ",(0,o.jsx)(t.strong,{children:"RIDs"}),". Click OK. The AD agent then compares against the PAC and user\u2019s access token for a mismatch to trigger the incident."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"NOTE:"})," The Forged PAC analytic is monitoring for when the user is not a member of a group that is listed in the PAC section of the user\u2019s Kerberos ticket. This analytic can be scoped to monitor specific groups. To reduce the number of false positives, the AD agent only checks for a mismatch of sensitive groups as selected in the policy Settings tab."]}),"\n",(0,o.jsx)(t.h2,{id:"host-from",children:"Host (From)"}),"\n",(0,o.jsx)(t.p,{children:"The Hosts (from) option is where the policy can be scoped to only monitor specific hosts as originators of an authentication event or to exclude specific hosts from being monitored for authentication events."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Host (From) Tab in the Authentication Tab",src:i(28206).A+"",width:"743",height:"852"})}),"\n",(0,o.jsx)(t.p,{children:"Underneath each section, there are additional Host details:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"IP \u2013 Field must contain IP address, e.g. 123.456.7.890"}),"\n",(0,o.jsx)(t.li,{children:"DNS \u2013 Field must contain a fully qualified domain name of the host, e.g. dc01.nwxtech.com"}),"\n",(0,o.jsx)(t.li,{children:"Netbios \u2013 Field must contain NetBIOS name of the host, e.g. dc01"}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Double-click the text boxes within the column, then enter all three methods of identification for a host (IP Address, NETBIOS host name, or DNS host name) to include or exclude the originating host from authentication event collection."}),"\n",(0,o.jsx)(t.h2,{id:"host-to",children:"Host (To)"}),"\n",(0,o.jsx)(t.p,{children:"The Hosts (to) option is where the policy can be scoped to only monitor specific hosts as target hosts of an authentication event or to exclude specific hosts from being monitored as targets of authentication events."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Host (To) Tab in the Authentication Tab",src:i(900347).A+"",width:"743",height:"852"})}),"\n",(0,o.jsx)(t.p,{children:"Underneath each section, there are additional Host details:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"IP \u2013 Field must contain IP address, e.g. 123.456.7.890"}),"\n",(0,o.jsx)(t.li,{children:"DNS \u2013 Field must contain a fully qualified domain name of the host, e.g. dc01.nwxtech.com"}),"\n",(0,o.jsx)(t.li,{children:"Netbios \u2013 Field must contain NetBIOS name of the host, e.g. dc01"}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Double-click the text boxes within the column, then enter all three methods of identification for a host (IP Address, NETBIOS host name, or DNS host name) to include or exclude the target host from authentication event collection."}),"\n",(0,o.jsx)(t.h2,{id:"ip-addresses-from",children:"IP Addresses (From)"}),"\n",(0,o.jsx)(t.p,{children:"The IP Addresses (from) option is where the policy can be scoped to only monitor specific IP Addresses as originators of an authentication event or to exclude specific IP Addresses from being monitored for authentication events."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"IP Addresses (From) Tab in the Authenticatoin Tab",src:i(501847).A+"",width:"743",height:"852"})}),"\n",(0,o.jsx)(t.p,{children:"Underneath each section, there is an additional Address detail:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Value \u2013 Must be provided in IP address format"}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["Double-click the text box beneath ",(0,o.jsx)(t.strong,{children:"Value"})," to enter the desired IP Addresses to include or exclude. Press the Enter or Tab key to add another text box."]}),"\n",(0,o.jsx)(t.h2,{id:"ip-addresses-to",children:"IP Addresses (To)"}),"\n",(0,o.jsx)(t.p,{children:"The IP Addresses (to) option is where the policy can be scoped to only monitor specific IP Addresses as target hosts of an authentication event or to exclude specific IP Addresses from being monitored as targets of authentication events."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"IP Addresses (To) Tab in the Authentication Tab",src:i(260226).A+"",width:"743",height:"852"})}),"\n",(0,o.jsx)(t.p,{children:"Underneath each section, there is an additional Address detail:"}),"\n",(0,o.jsx)(t.p,{children:"Value \u2013 Must be provided in IP address format"}),"\n",(0,o.jsxs)(t.p,{children:["Double-click the text box beneath ",(0,o.jsx)(t.strong,{children:"Value"})," to enter the desired IP Addresses to include or exclude. Press the Enter or Tab key to add another text box."]}),"\n",(0,o.jsx)(t.h2,{id:"operations",children:"Operations"}),"\n",(0,o.jsx)(t.p,{children:"The Operations option filters for successful events, failed events, or both."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Operations Tab in the Authentication Tab",src:i(353333).A+"",width:"743",height:"852"})}),"\n",(0,o.jsxs)(t.p,{children:["The ",(0,o.jsx)(t.strong,{children:"Monitor These Attempts"})," section is where monitoring is set to filter for successful events, failed events, or both:"]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Success \u2013 Monitors successful events"}),"\n",(0,o.jsx)(t.li,{children:"Failure \u2013 Monitors failed events"}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["The ",(0,o.jsx)(t.strong,{children:"Monitor These Protocols"})," section is where authentication protocols to be monitored are selected for the policy. Check the box to select the authentication protocol(s) to be monitored:"]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"All"}),"\n",(0,o.jsx)(t.li,{children:"Kerberos"}),"\n",(0,o.jsx)(t.li,{children:"NTLM"}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"CAUTION:"})," If Login Type is enabled, authentication events will be received from Domain Controllers only."]}),"\n",(0,o.jsx)(t.p,{children:"The Login Type options apply only to Domain Controllers. These options provide the choice to monitor Local Interactive and/or Remote Interactive logins to the Domain Controllers:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"All - Report all authentication activity approved by the Domain Controller which includes any local or RDP direct connections to the DC."}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Local - Report only local login to the Domain Controller - ignore all else"}),"\n",(0,o.jsx)(t.li,{children:"Remote - Report only remote/RDP access to the Domain Controller - ignore all else"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Exclude failed authentications with previously valid (N-2) password \u2013 If enabled, allows to ignore failed authentications that failed due to use of a previously valid, but now expired, password"}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Exclude failed authentications with expired password \u2013 If enabled, allows to ignore failed authentications that failed due to use of still valid, but now expired, password"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"servers",children:"Servers"}),"\n",(0,o.jsx)(t.p,{children:"The Servers option targets servers to be included or excluded when filtering for authentication."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Servers Tab in the Authentication Tab",src:i(730411).A+"",width:"742",height:"852"})}),"\n",(0,o.jsx)(t.p,{children:"In both sections, servers must be specified in the form 'DOMAIN\\SERVER', where DOMAIN is NetBIOS Domain name and SERVER is NetBIOS server name."}),"\n",(0,o.jsx)(t.p,{children:"Double-click the text box beneath Name to enter the desired servers to include or exclude. Press the Enter or Tab key to add another text box."}),"\n",(0,o.jsx)(t.h2,{id:"users",children:"Users"}),"\n",(0,o.jsx)(t.p,{children:"The Users filter is where the policy can be scoped to only monitor specific security principals committing changes within Active Directory or to exclude specific users committing changes from being monitored."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Users Tab in the Authentication Tab",src:i(124275).A+"",width:"743",height:"852"})}),"\n",(0,o.jsx)(t.p,{children:"The following details appear beneath both sections:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Subtree \u2013 If checked, the filter is applied to the parent and all child contexts. If unchecked, the filter is only applied to the listed context."}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Type \u2013 Field must describe the type of the select Active Directory object and can have the following values:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"user \u2013 Indicates that selected object is user"}),"\n",(0,o.jsx)(t.li,{children:"group \u2013 Indicates that selected object is group"}),"\n",(0,o.jsx)(t.li,{children:"context \u2013 Indicates that selected object is container"}),"\n",(0,o.jsx)(t.li,{children:"sidType \u2013 Indicates that selected object is well-known SID type"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Distinguished Name \u2013 Field must be specified in the form of 'distinguishedName' attribute syntax, e.g. 'CN=Users,DC=Domain,DC=com'. However, for objects with 'sidType' type, it must be in the form of WellKnownSidType Enum, e.g. 'AnonymousSid' or 'LocalSid'."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["Double-click the text box beneath Distinguished Name to enter the desired group types to include or exclude. Double-click the text box beneath ",(0,o.jsx)(t.strong,{children:"Type"})," to enter the desired AD object to include or exclude. Press the Enter or Tab key to add another text box. Check the box under ",(0,o.jsx)(t.strong,{children:"Subtree"})," to include or exclude child contexts."]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},260226:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/ipaddressesto-79374e4e5c47c231cd0cf26c33b55756.webp"},353333:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/operationstab-7ece80368e25e37a1aa54f9a6f0a0945.webp"},501847:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/ipaddressesfrom-15840ed52b6796904f165eaf85bfbd3d.webp"},577371:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/forgedpac-1b52fb005de8867ea070e6be76b4c3d1.webp"},730411:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/serverstab-2ba5a6493884772fb041e6474ef7fcce.webp"},900347:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/hostto-63b3cf6ea927fb375cb6d7770e455ee0.webp"}}]);