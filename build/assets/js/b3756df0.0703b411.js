"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[366870],{28453:(e,s,t)=>{t.d(s,{R:()=>i,x:()=>h});var r=t(296540);const a={},n=r.createContext(a);function i(e){const s=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function h(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(n.Provider,{value:s},e.children)}},682534:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>o,contentTitle:()=>h,default:()=>l,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"threatmanager/threats/filesystem","title":"File System Threats","description":"The following threats are monitored for File System:","source":"@site/docs/threatmanager/threatmanager/threats/filesystem.md","sourceDirName":"threatmanager/threats","slug":"/threatmanager/threats/filesystem","permalink":"/docs/threatmanager/threatmanager/threats/filesystem","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/threatmanager/threatmanager/threats/filesystem.md","tags":[],"version":"current","frontMatter":{},"sidebar":"threatManagerSidebar","previous":{"title":"Entra ID Threats","permalink":"/docs/threatmanager/threatmanager/threats/entraid"},"next":{"title":"General Threats","permalink":"/docs/threatmanager/threatmanager/threats/general"}}');var a=t(474848),n=t(28453);const i={},h="File System Threats",o={},d=[{value:"High Risk Permissions",id:"high-risk-permissions",level:2},{value:"NTDS.dit File Access",id:"ntdsdit-file-access",level:2},{value:"Ransomware",id:"ransomware",level:2},{value:"Unusual Processes",id:"unusual-processes",level:2}];function c(e){const s={h1:"h1",h2:"h2",header:"header",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"file-system-threats",children:"File System Threats"})}),"\n",(0,a.jsx)(s.p,{children:"The following threats are monitored for File System:"}),"\n",(0,a.jsx)(s.h2,{id:"high-risk-permissions",children:"High Risk Permissions"}),"\n",(0,a.jsx)(s.p,{children:"High Risk Permissions are those which grant unrestricted access to a file or folder. When high risk permissions are added or increased on a folder or file, a threat is created."}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"High Risk Permissions"}),(0,a.jsx)(s.th,{})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Definition"}),(0,a.jsx)(s.td,{children:"The High Risk Permissions threat creates a threat when a high risk trustee (Domain Users, Anonymous Logon, Authenticated Users, and Everyone) is added to the ACL on a folder or file. These permissions are high risk because they grant unrestricted access to a resource."})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Example"}),(0,a.jsx)(s.td,{children:"Domain Users are given Read access to a folder.  Everyone is given Full Control on a folder which already had Domain Users with Read Access."})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Trigger"}),(0,a.jsx)(s.td,{children:"A threat is created when a user adds a high risk trustee (defined above) to a folder or file, which increases the amount of open access. This threat is updated with the total number of folders or files affected due to the inherited permissions."})]})]})]}),"\n",(0,a.jsx)(s.h2,{id:"ntdsdit-file-access",children:"NTDS.dit File Access"}),"\n",(0,a.jsx)(s.p,{children:"Unauthorized file system interaction with the NTDS.dit file stored on Active Directory Domain Controllers will be detected as a threat."}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"NTDS.dit File Access"}),(0,a.jsx)(s.th,{})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Definition"}),(0,a.jsx)(s.td,{children:"By accessing the NTDS.dit file, Active Directory's database, an attacker can extract a copy of every user's password hash and subsequently act as any user in the domain. Threat Manager audits all activity related to the NTDS file and VSS copy to notify when an attacker could be accessing the information for an offline attack."})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Trigger"}),(0,a.jsx)(s.td,{children:"Perform File or VSS activity against the NTDS.DIT file."})]})]})]}),"\n",(0,a.jsx)(s.h2,{id:"ransomware",children:"Ransomware"}),"\n",(0,a.jsx)(s.p,{children:"When a user creates or renames at least 100 files with a known ransomware extension or a name that resembles common ransom notes, a threat is created for each rename action."}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Ransomware"}),(0,a.jsx)(s.th,{})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Definition"}),(0,a.jsx)(s.td,{children:"Detects file activity that involves a file with a known ransomware extension or a file with a name that resembles common ransom notes."})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Example"}),(0,a.jsx)(s.td,{children:'A user created a ".locky" file, and created and renamed more than 100 files with common ransomware extensions.'})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Trigger"}),(0,a.jsx)(s.td,{children:"Using a pre-defined library of known ransomware extensions, Threat Manager alerts on file create/rename activity with known extensions."})]})]})]}),"\n",(0,a.jsx)(s.h2,{id:"unusual-processes",children:"Unusual Processes"}),"\n",(0,a.jsx)(s.p,{children:"If a user runs a process on a monitored server for the first time, a threat is created."}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Unusual Processes"}),(0,a.jsx)(s.th,{})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Definition"}),(0,a.jsx)(s.td,{children:"The Unusual Processes threat detects if previously unseen processes are launched on critical file servers."})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Example"}),(0,a.jsx)(s.td,{children:'A user launches a "python.exe" process that has never been launched by anyone else in the environment.'})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Trigger"}),(0,a.jsx)(s.td,{children:"Threat Manager records the name of the processes associated with file access activities. Over a learning period (e.g. 30 days), Threat Manager profiles which processes are normal by aggregating data across all file servers. After that, if a new process is identified that has not been seen on any other file servers, a threat will be created.  NOTE: This threat is only applicable on Windows file servers when the activity is performed locally."})]})]})]})]})}function l(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);