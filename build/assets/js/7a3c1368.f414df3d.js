"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[166459],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var i=t(296540);const o={},s=i.createContext(o);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(s.Provider,{value:n},e.children)}},710989:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"enterpriseauditor/admin/datacollector/spaa/configurejob","title":"SharePoint Custom Connection Profile & Host List","description":"The SPAA Data Collector requires a custom Connection Profile and a custom host list to be created and assigned to the job conducting the data collection. The host inventory option during host list creation makes it necessary to configure the Connection Profile first. While SharePoint on-premises uses the Active Directory account type for the credential within a Connection Profile, it is necessary for online credentials to be listed first in the credentials list within a Connection Profile housing credentials to both environments.","source":"@site/docs/accessanalyzer/enterpriseauditor/admin/datacollector/spaa/configurejob.md","sourceDirName":"enterpriseauditor/admin/datacollector/spaa","slug":"/enterpriseauditor/admin/datacollector/spaa/configurejob","permalink":"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/spaa/configurejob","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/enterpriseauditor/admin/datacollector/spaa/configurejob.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"SPAA: Category","permalink":"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/spaa/category"},"next":{"title":"SPAA: DLP Audit Settings","permalink":"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/spaa/dlpauditsettings"}}');var o=t(474848),s=t(28453);const r={},a="SharePoint Custom Connection Profile & Host List",c={},l=[{value:"SharePoint Farm",id:"sharepoint-farm",level:2},{value:"SharePoint Farm Credential for a Connection Profile",id:"sharepoint-farm-credential-for-a-connection-profile",level:3},{value:"SharePoint Farm Host in a Custom Host List",id:"sharepoint-farm-host-in-a-custom-host-list",level:3},{value:"SharePoint Online",id:"sharepoint-online",level:2},{value:"SharePoint Online Credential for a Connection Profile using Modern Authentication",id:"sharepoint-online-credential-for-a-connection-profile-using-modern-authentication",level:3},{value:"SharePoint Online Host in a Custom Host List",id:"sharepoint-online-host-in-a-custom-host-list",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"sharepoint-custom-connection-profile--host-list",children:"SharePoint Custom Connection Profile & Host List"})}),"\n",(0,o.jsx)(n.p,{children:"The SPAA Data Collector requires a custom Connection Profile and a custom host list to be created and assigned to the job conducting the data collection. The host inventory option during host list creation makes it necessary to configure the Connection Profile first. While SharePoint on-premises uses the Active Directory account type for the credential within a Connection Profile, it is necessary for online credentials to be listed first in the credentials list within a Connection Profile housing credentials to both environments."}),"\n",(0,o.jsx)(n.h2,{id:"sharepoint-farm",children:"SharePoint Farm"}),"\n",(0,o.jsx)(n.p,{children:"This section describes the process to configure the Connection Profile and custom host list for scanning SharePoint On-Premises."}),"\n",(0,o.jsx)(n.h3,{id:"sharepoint-farm-credential-for-a-connection-profile",children:"SharePoint Farm Credential for a Connection Profile"}),"\n",(0,o.jsx)(n.p,{children:"The provisioned credential used should be an Active Directory account."}),"\n",(0,o.jsx)(n.p,{children:"Create a Connection Profile and set the following information on the User Credentials window:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Select Account Type \u2013 Active Directory Account"}),"\n",(0,o.jsx)(n.li,{children:"Domain \u2013 Drop-down menu with available trusted domains displays. Either type the short domain name in the textbox or select a domain from the menu."}),"\n",(0,o.jsx)(n.li,{children:"User name \u2013 Type the user name"}),"\n",(0,o.jsxs)(n.li,{children:["Password Storage \u2013 Choose the for credential password storage:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Application \u2013 Uses Access Analyzer\u2019s configured Profile Security setting as selected at the ",(0,o.jsx)(n.strong,{children:"Settings"})," > ",(0,o.jsx)(n.strong,{children:"Application"})," node"]}),"\n",(0,o.jsx)(n.li,{children:"CyberArk \u2013 Uses the CyberArk Enterprise Password Vault"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.li,{children:"Password \u2013 Type the password"}),"\n",(0,o.jsx)(n.li,{children:"Confirm \u2013 Re-type the password"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Once the Connection Profile is created, it is time to create the custom host list. See the ",(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/settings/connection/overview",children:"Connection"})," topic for additional information."]}),"\n",(0,o.jsx)(n.h3,{id:"sharepoint-farm-host-in-a-custom-host-list",children:"SharePoint Farm Host in a Custom Host List"}),"\n",(0,o.jsx)(n.p,{children:"The custom host list should include:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"One application server per farm"}),"\n",(0,o.jsx)(n.li,{children:"Host name without a domain suffix, this means the host name should not contain a period character"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["See the ",(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/hostmanagement/actions/add",children:"Add Hosts"})," section for instruction on creating a custom static host list."]}),"\n",(0,o.jsx)(n.h2,{id:"sharepoint-online",children:"SharePoint Online"}),"\n",(0,o.jsx)(n.p,{children:"This section describes the process to configure the Connection Profile and custom host list for scanning SharePoint Online using Modern Authentication."}),"\n",(0,o.jsx)(n.h3,{id:"sharepoint-online-credential-for-a-connection-profile-using-modern-authentication",children:"SharePoint Online Credential for a Connection Profile using Modern Authentication"}),"\n",(0,o.jsxs)(n.p,{children:["The provisioned credential should be an Microsoft Entra ID Application. See the ",(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/config/sharepointonline/access",children:"SharePoint Online Access & Sensitive Data Auditing Configuration"})," topic for instructions on registering and provisioning the Microsoft Entra ID Application manually or via the SP_RegisterAzureAppAuth Instant Job."]}),"\n",(0,o.jsx)(n.p,{children:"Create a Connection Profile and set the following information on the User Credentials window:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Select Account Type \u2013 Azure Active Directory"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Client ID \u2013 Application (client) ID of the Access Analyzer application registered with Microsoft Entra ID"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Password Storage \u2013 Application (Uses the configured Profile Security setting as selected at the ",(0,o.jsx)(n.strong,{children:"Settings"})," > ",(0,o.jsx)(n.strong,{children:"Application"})," node. See the ",(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/settings/application/overview",children:"Application"})," topic for additional information.)"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Key \u2013 The comma delimited string containing the path to the certificate PFX file, certificate password, and the Microsoft Entra ID environment identifier ( ",(0,o.jsx)(n.code,{children:"CertPath,CertPassword,AzureEnvironment"}),")"]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"AzureEnvironment"})," is typically 0 for the default Azure Production Environment. Other possible values are:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"1 \u2013 PPE"}),"\n",(0,o.jsx)(n.li,{children:"2 \u2013 China"}),"\n",(0,o.jsx)(n.li,{children:"3 \u2013 Germany"}),"\n",(0,o.jsx)(n.li,{children:"4 \u2013 US Government"}),"\n",(0,o.jsx)(n.li,{children:"5 \u2013 US Government-High"}),"\n",(0,o.jsx)(n.li,{children:"6 \u2013 US Government-DoD"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"An example string matching the configuration from above is:"}),"\n",(0,o.jsx)(n.p,{children:"C:\\Program Files (x86)\\STEALTHbits\\StealthAUDIT\\PrivateAssemblies\\spaa_cert_myorg.pfx,PasswordGoesHere,0"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"NOTE:"})," ",(0,o.jsx)(n.code,{children:"PasswordGoesHere"})," should be replaced with the password used when generating the self-signed X.509 certificate if the Microsoft Entra ID Application was Registered and Provisioned manually or the $appPassword parameter used in the SP_RegisterAzureAppAuth Instant Job if that method was used."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Once the Connection Profile is created, it is time to create the custom host list. See the ",(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/settings/connection/overview",children:"Connection"})," topic for additional information."]}),"\n",(0,o.jsx)(n.h3,{id:"sharepoint-online-host-in-a-custom-host-list",children:"SharePoint Online Host in a Custom Host List"}),"\n",(0,o.jsx)(n.p,{children:"The custom host list should include:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Web or cloud hosts should be specified using the full web DNS part of the site URL, for example an Office 365 site with the URL ",(0,o.jsx)(n.a,{href:"http://TestSite.sharepoint.com",children:"http://TestSite.sharepoint.com"})," should be added as a host with name TestSite.sharepoint.com"]}),"\n",(0,o.jsx)(n.li,{children:"Do not use the admin site, for example TestSite-admin.sharepoint.com"}),"\n",(0,o.jsx)(n.li,{children:"Do not use IP Addresses"}),"\n",(0,o.jsx)(n.li,{children:"Host name must be in DNS format"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["See the ",(0,o.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/hostmanagement/actions/add",children:"Add Hosts"})," topic for instructions on creating a custom static host list."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);