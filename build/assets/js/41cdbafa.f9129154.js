"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[163683],{28453:(e,t,o)=>{o.d(t,{R:()=>n,x:()=>a});var i=o(296540);const s={},r=i.createContext(s);function n(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:n(e.components),i.createElement(r.Provider,{value:t},e.children)}},37138:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>n,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"policypak/video/preferences/delivergpprefs","title":"Deliver GPPrefs items without using loopback mode","description":"Not every GPPrefs item can be used on the Computer side. In this demonstration learn how to use Printers, Drive Maps and Internet settings\u2026 and deploy them to an OU of computers\u2026 regardless of where the user resides.","source":"@site/docs/policypak/policypak/video/preferences/delivergpprefs.md","sourceDirName":"policypak/video/preferences","slug":"/policypak/video/preferences/delivergpprefs","permalink":"/docs/policypak/policypak/video/preferences/delivergpprefs","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/video/preferences/delivergpprefs.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Endpoint Policy Manager Preferences: Registry Items (Consolidate GPOs and also deploy them via PP Cloud and your MDM service)","permalink":"/docs/policypak/policypak/video/preferences/consolidateregistry"},"next":{"title":"Endpoint Policy Manager Preferences: Drive Maps (Consolidate GPOs and also deploy them via PP Cloud and your MDM service)","permalink":"/docs/policypak/policypak/video/preferences/drivemaps"}}');var s=o(474848),r=o(28453);const n={},a="Deliver GPPrefs items without using loopback mode",l={},h=[{value:"GPprefs without loopback",id:"gpprefs-without-loopback",level:3}];function d(e){const t={a:"a",code:"code",h1:"h1",h3:"h3",header:"header",p:"p",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"deliver-gpprefs-items-without-using-loopback-mode",children:"Deliver GPPrefs items without using loopback mode"})}),"\n",(0,s.jsx)(t.p,{children:"Not every GPPrefs item can be used on the Computer side. In this demonstration learn how to use Printers, Drive Maps and Internet settings\u2026 and deploy them to an OU of computers\u2026 regardless of where the user resides."}),"\n",(0,s.jsx)(t.h3,{id:"gpprefs-without-loopback",children:"GPprefs without loopback"}),"\n",(0,s.jsx)(t.p,{children:"Hi. This is Jeremy Moskowitz, former Group Policy MVP and Founder of PolicyPak Software. In this demonstration, I'm going to show you how you can deploy Group Policy Preferences items that would only normally apply on the user side to any computer you want."}),"\n",(0,s.jsxs)(t.p,{children:["This is kind of an advanced under-the-hood technique, but you're an advanced under-the-hood technique kind of guy, so I'm going to show you how this works. Basically, we're going to do some magic with Group Policy Preferences without ",(0,s.jsx)(t.a,{href:"https://www.policypak.com/pp-blog/group-policy-loopback",children:"https://www.policypak.com/pp-blog/group-policy-loopback"}),", but it does require that you're licensed for the PolicyPak On-Prem Suite or the PolicyPak Cloud Suite."]}),"\n",(0,s.jsx)(t.p,{children:'To set the stage here, you can see I have "West Sales Desktops." Inside my "West Sales Desktops," I have a bunch of computers here. Here are three of those four computers \u2013 one, two, and three. For this example, I\'m going to be deploying a shared printer to all three of these computers.'}),"\n",(0,s.jsx)(t.p,{children:'If we take a look at that, if we try to do this by hand in "West Sales Desktops" here, if we try to do this with Group Policy Preferences, "Deploy Shared Printer to all these desktops," you would have to do this on the computer side. If we go over to computer side, "Preferences" and go to "Printers/New," there is no Shared Printer. What are you going to do?'}),"\n",(0,s.jsxs)(t.p,{children:["That's the whole point of this demonstration. There's no way to actually get Shared Printers to be eaten by computers unless you're using PolicyPak and you don't want to use loopback. We'll do this on the user side. What we'll do is we'll just go to \"Printers\" and we'll create a \"New\" \"Shared Printer\" item. I happen to have a printer already set up, \"",(0,s.jsx)(t.code,{children:"\\dcprinter1"}),".\" That's all you're going to do."]}),"\n",(0,s.jsxs)(t.p,{children:["But this isn't going to work. You know that because you'd have to have a user in this OU, and there are no users in this OU. What I'm going to do now is I'm going to take this item and just drag it to the desktop here. I'm going to save it for later. I'm going to put it into",(0,s.jsx)(t.code,{children:" C:share"}),'. I already have a "share" set up. I\'m just going to drag that file called "printer1.xml" into that share. That\'s it.']}),"\n",(0,s.jsxs)(t.p,{children:["Now going back to the Group Policy Object, this isn't going to work. So what we're going to do is just \"Delete\" this. That doesn't really help us very much. We're just going to now use Group Policy \"Preferences/Files,\" and we're going to copy in that file which is in \"",(0,s.jsx)(t.code,{children:"\\dcshare"}),'." It\'s called "printer1."']}),"\n",(0,s.jsxs)(t.p,{children:["We have to copy that to a very special location inside PolicyPak land. What I'm going to do is show you what this special location is. It's \"",(0,s.jsx)(t.code,{children:"%programdata%PolicyPakXmlDataComputer"}),".\" That's a folder, so you're putting it to the computer."]}),"\n",(0,s.jsxs)(t.p,{children:['The trick is that you also must give it an actual file name. You can call it the same name "printer1.xml" or else it\'s not going to work. This is just the way Group Policy Preferences work. You have to give it the "Source" and give it the entire "Destination." The secret location is "',(0,s.jsx)(t.code,{children:"%programdata%PolicyPakXmlDataComputer"}),'" and then give it a name like whatever.xml.']}),"\n",(0,s.jsx)(t.p,{children:"What we're doing is we're taking this Group Policy Preferences item and we're jamming it into every computer by means of delivery using Group Policy Preferences. No loopback involved, I promise."}),"\n",(0,s.jsxs)(t.p,{children:['Let\'s take a look. I\'m logged on as a guy called "eastsalesuser1," so no loopback required. If I just go here and run "',(0,s.jsx)(t.code,{children:"GP Update"}),",\" we should get that file delivered using Group Policy Preferences. It's getting delivered to the secret PolicyPak location, and that is saying zap that printer down even though it's a user side only thing. There it is. Perfect. Excellent."]}),"\n",(0,s.jsxs)(t.p,{children:['Let\'s go to the next guy here. No printer. This is "westsalesuser1," so not in this OU either. If we run "',(0,s.jsx)(t.code,{children:"GP Update"}),"\" on this guy, let's take a look and see if we get that printer the way we expect. Alright, let's give it a second or two here. Bingo! Just like that."]}),"\n",(0,s.jsxs)(t.p,{children:["If we go over to the third machine, you're getting the picture, I'm sure. We'll run \"",(0,s.jsx)(t.code,{children:"GP Update"}),"\" and we'll wait for this to happen. This is a totally different guy. He's an \"Admin,\" so he's not in this OU either. What I'm showing you here is that you're able to deliver Group Policy Preferences items in a unique way using not loopback if you're willing to copy the file in."]}),"\n",(0,s.jsx)(t.p,{children:"This should also work for Internet settings and drive maps and other things that are only on the user side, but I figured I would show you Shared Printers because I think it's the most interesting of the three."}),"\n",(0,s.jsx)(t.p,{children:"Okay, thanks so very much, and I hope this helps you out."}),"\n",(0,s.jsx)(t.p,{children:"Talk to you soon."})]})}function c(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);