"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[139682],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>l});var i=t(296540);const r={},o=i.createContext(r);function s(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:n},e.children)}},411810:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"threatprevention/api/overview","title":"PowerShell API\xa0Integration","description":"Using PowerShell, you can obtain information on or manipulate specific policy, collection, and Netwrix Threat Manager integration configurations in the Threat Prevention Administration Console without having it open. This can be done on the same machine or from a remote server where the Enterprise Manager is not located. The following PowerShell APIs can be used:","source":"@site/docs/threatprevention/threatprevention/api/overview.md","sourceDirName":"threatprevention/api","slug":"/threatprevention/api/overview","permalink":"/docs/threatprevention/threatprevention/api/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/threatprevention/threatprevention/api/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"threatPreventionSidebar","previous":{"title":"Load the PowerShell Module","permalink":"/docs/threatprevention/threatprevention/api/loadmodule"},"next":{"title":"Policy APIs","permalink":"/docs/threatprevention/threatprevention/api/policy"}}');var r=t(474848),o=t(28453);const s={},l="PowerShell API\xa0Integration",a={},h=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Not a Policy XML Expert",id:"not-a-policy-xml-expert",level:2}];function c(e){const n={a:"a",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"powershell-apiintegration",children:"PowerShell API\xa0Integration"})}),"\n",(0,r.jsx)(n.p,{children:"Using PowerShell, you can obtain information on or manipulate specific policy, collection, and Netwrix Threat Manager integration configurations in the Threat Prevention Administration Console without having it open. This can be done on the same machine or from a remote server where the Enterprise Manager is not located. The following PowerShell APIs can be used:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Initial Configuration:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Connect-SIEnterpriseManager"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Informative APIs"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"NOTE:"})," These APIs do not require any additional configuration. They display Agent status from the ",(0,r.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/agents/overview",children:"Agents Interface"})," and a list of available PowerShell APIs the user can utilize."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Get-SIAgentStatus \u2013 Displays Agent status from the Agent grid columns on the ",(0,r.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/agents/overview",children:"Agents Interface"})]}),"\n",(0,r.jsx)(n.li,{children:"Get-SI Help \u2013 Lists available PowerShell APIs for Threat Prevention"}),"\n",(0,r.jsx)(n.li,{children:"Get-SIHelp [API Name] \u2013 Displays detailed information about the PowerShell API"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Policies and Collections:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Get-SIPolicy"}),"\n",(0,r.jsx)(n.li,{children:"Enable-SIPolicy"}),"\n",(0,r.jsx)(n.li,{children:"Remove-SIPolicy"}),"\n",(0,r.jsx)(n.li,{children:"Export-SIPolicy"}),"\n",(0,r.jsx)(n.li,{children:"Import-SIPolicy"}),"\n",(0,r.jsx)(n.li,{children:"Get-SICollection"}),"\n",(0,r.jsx)(n.li,{children:"Remove-SICollection"}),"\n",(0,r.jsx)(n.li,{children:"Export-SICollection"}),"\n",(0,r.jsx)(n.li,{children:"Import-SICollection"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Enterprise Password Enforcement (EPE):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Test-ValidatePassword"}),"\n",(0,r.jsx)(n.li,{children:"Export-SICharacterSubstitution"}),"\n",(0,r.jsx)(n.li,{children:"Import-SICharacterSubstitution"}),"\n",(0,r.jsx)(n.li,{children:"Export-SICharacterSubstitutionWords"}),"\n",(0,r.jsx)(n.li,{children:"Import-SICharacterSubstitutionWords"}),"\n",(0,r.jsx)(n.li,{children:"Export-SIPasswordsDictionary"}),"\n",(0,r.jsx)(n.li,{children:"Import-SIPasswordsDictionary"}),"\n",(0,r.jsx)(n.li,{children:"Set-SIPwnedDB"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Threat Manager Event Sink Tab"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Get-SIDefendConfig"}),"\n",(0,r.jsx)(n.li,{children:"Set-SIDefendConfig"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"LDAP Deception for Threat Manager:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Get-SILdapDeception"}),"\n",(0,r.jsx)(n.li,{children:"Set-SILdapDeception"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"The following prerequisites must be met before using the APIs:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["The PowerShell service account must be an Active Directory account with the Threat Prevention administrator role assigned to it. The role is assigned through the ",(0,r.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/userroles/overview",children:"Users and Roles Window"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"The Threat Prevention PowerShell module (SI.SIMonitor.PowerShell.dll) must be loaded into PowerShell. This module is stored in the installation directory within the Enterprise Manager folder:"}),"\n",(0,r.jsx)(n.p,{children:"\u2026\\Netwrix\\Netwrix Threat Prevention\\SIEnterpriseManager\\"}),"\n",(0,r.jsx)(n.p,{children:"To disallow the use of the PowerShell module, remove the module from the Enterprise Manager folder."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"PowerShell commands are executed through a PowerShell console on either the Enterprise Manager server or on a remote server. When PowerShell is used on a remote server without the Enterprise Manager installed, see the Remote PowerShell Connection section for requirements."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"not-a-policy-xml-expert",children:"Not a Policy XML Expert"}),"\n",(0,r.jsx)(n.p,{children:"Follow the steps to compare two XML files as exported from Threat Prevention."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 1 \u2013"})," Craft the desired policy in the Administration Console and export as a XML file."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 2 \u2013"})," In the Administration Console, edit the same policy settings and filters through the Event Type tab. Export as a second XML file with a different name."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 3 \u2013"})," Open both XML files and compare the XML to see how policies are altered."]}),"\n",(0,r.jsxs)(n.p,{children:["Once you identify how Threat Prevention modifies XML files, you can apply that to the ",(0,r.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/api/policy#add-or-modify-policies",children:"Add or Modify Policies"})," instructions."]})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);