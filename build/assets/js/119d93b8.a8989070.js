"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[475660],{28453:(e,i,n)=>{n.d(i,{R:()=>c,x:()=>d});var t=n(296540);const o={},r=t.createContext(o);function c(e){const i=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),t.createElement(r.Provider,{value:i},e.children)}},126840:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>s,contentTitle:()=>d,default:()=>u,frontMatter:()=>c,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"auditor/configuration/activedirectory/advancedpolicy","title":"Configure Advanced Audit Policies","description":"You can configure advanced audit policies instead of basic domain policies to collect Active Directory changes with more granularity. Either basic or advanced audit policies must be configured to track changes to accounts and groups, and to identify workstations where changes were made.","source":"@site/docs/auditor/auditor/configuration/activedirectory/advancedpolicy.md","sourceDirName":"auditor/configuration/activedirectory","slug":"/auditor/configuration/activedirectory/advancedpolicy","permalink":"/docs/auditor/auditor/configuration/activedirectory/advancedpolicy","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/activedirectory/advancedpolicy.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Additional Configuration to Review Changes Made via Exchange Server","permalink":"/docs/auditor/auditor/configuration/activedirectory/additional"},"next":{"title":"Active Directory: Automatic Configuration","permalink":"/docs/auditor/auditor/configuration/activedirectory/automatic"}}');var o=n(474848),r=n(28453);const c={},d="Configure Advanced Audit Policies",s={},a=[{value:"To configure security options",id:"to-configure-security-options",level:2},{value:"To configure advanced audit policies",id:"to-configure-advanced-audit-policies",level:2}];function l(e){const i={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.header,{children:(0,o.jsx)(i.h1,{id:"configure-advanced-audit-policies",children:"Configure Advanced Audit Policies"})}),"\n",(0,o.jsx)(i.p,{children:"You can configure advanced audit policies instead of basic domain policies to collect Active Directory changes with more granularity. Either basic or advanced audit policies must be configured to track changes to accounts and groups, and to identify workstations where changes were made."}),"\n",(0,o.jsx)(i.p,{children:"Perform the following procedures:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:(0,o.jsx)(i.a,{href:"#To-configure-security-options",children:"To configure security options"})}),"\n",(0,o.jsx)(i.li,{children:(0,o.jsx)(i.a,{href:"#To-configure-advanced-audit-policies",children:"To configure advanced audit policies"})}),"\n"]}),"\n",(0,o.jsx)(i.h2,{id:"to-configure-security-options",children:"To configure security options"}),"\n",(0,o.jsxs)(i.p,{children:["Setting up both basic and advanced audit policies may lead to incorrect audit reporting. To force basic audit policies to be ignored and prevent conflicts, enable the ",(0,o.jsx)(i.em,{children:"Audit: Force audit policy subcategory settings"})," policy."]}),"\n",(0,o.jsx)(i.p,{children:"To do it, perform the following steps:"}),"\n",(0,o.jsxs)(i.ol,{children:["\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:["Open the ",(0,o.jsx)(i.strong,{children:"Group Policy Management"})," console on any domain controller in the target domain: navigate to Start\xa0>\xa0Windows Administrative Tools (Windows Server 2016 and higher) or Administrative Tools (Windows 2012) ",(0,o.jsx)(i.strong,{children:"Group Policy Management."})]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:["In the left pane, navigate to ",(0,o.jsxs)(i.strong,{children:["Forest: ",(0,o.jsx)(i.code,{children:"<forest_name>"})," > Domains > ",(0,o.jsx)(i.code,{children:"<domain_name>"})]})," ",(0,o.jsx)(i.strong,{children:"> Domain Controllers"}),". Right-click the effective domain controllers policy (by default, it is the ",(0,o.jsx)(i.strong,{children:"Default Domain Controllers Policy"}),"), and select ",(0,o.jsx)(i.strong,{children:"Edit"})," from the pop-up menu."]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:"In the Group Policy Management Editor dialog, expand the Computer Configuration node on the left and navigate to Policies \u2192 Windows Settings \u2192 Security Settings \u2192 Local Policies \u2192 Security Options."}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:["Locate the Audit: Force audit policy subcategory settings to override audit policy category settings and make sure that policy setting is set to ",(0,o.jsx)(i.em,{children:'"Enabled"'}),"."]}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.img,{alt:"manualconfig_ad_nla_audit_force_winserver2016",src:n(158652).A+"",width:"783",height:"321"})}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:"Run the following command to update group policy:"}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.code,{children:"gpupdate /force"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(i.h2,{id:"to-configure-advanced-audit-policies",children:"To configure advanced audit policies"}),"\n",(0,o.jsxs)(i.ol,{children:["\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:["Open the ",(0,o.jsx)(i.strong,{children:"Group Policy Management"})," console on any domain controller in the target domain: navigate to Start\xa0>\xa0Windows Administrative Tools (Windows Server 2016 and higher) or Administrative Tools (Windows 2012) ",(0,o.jsx)(i.strong,{children:"Group Policy Management."})]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:["In the left pane, navigate to ",(0,o.jsxs)(i.strong,{children:["Forest: ",(0,o.jsx)(i.code,{children:"<forest_name>"})," > Domains > ",(0,o.jsx)(i.code,{children:"<domain_name>"})]})," ",(0,o.jsx)(i.strong,{children:"> Domain Controllers"}),". Right-click the effective domain controllers policy (by default, it is the ",(0,o.jsx)(i.strong,{children:"Default Domain Controllers Policy"}),"), and select ",(0,o.jsx)(i.strong,{children:"Edit"})," from the pop-up menu."]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:"In the Group Policy Management Editor dialog, expand the Computer Configuration node on the left and navigate to Policies \u2192 Windows Settings \u2192 Security Settings \u2192 Advanced Audit Policy Configuration \u2192 Audit Policies."}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:"Configure the following audit policies."}),"\n",(0,o.jsxs)(i.table,{children:[(0,o.jsx)(i.thead,{children:(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.th,{children:"Policy Subnode"}),(0,o.jsx)(i.th,{children:"Policy Name"}),(0,o.jsx)(i.th,{children:"Audit Events"})]})}),(0,o.jsxs)(i.tbody,{children:[(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:"Account Management"}),(0,o.jsx)(i.td,{children:"- Audit Computer Account Management - Audit Distribution Group Management - Audit Security Group Management - Audit User Account Management"}),(0,o.jsx)(i.td,{children:(0,o.jsx)(i.em,{children:'"Success"'})})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:"DS Access"}),(0,o.jsx)(i.td,{children:"Audit Directory Service Access"}),(0,o.jsx)(i.td,{children:(0,o.jsx)(i.em,{children:'"Success"'})})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:"Logon/Logoff"}),(0,o.jsx)(i.td,{children:"- Audit Logoff - Audit Logon These policies are only required to collect the information on the originating workstation, i.e., the computer from which a change was made."}),(0,o.jsx)(i.td,{children:(0,o.jsx)(i.em,{children:'"Success"'})})]})]})]}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.img,{alt:"manualconfig_ad_advpol_winserver2016",src:n(842609).A+"",width:"783",height:"303"})}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:"Run the following command to update group policy:"}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.code,{children:"gpupdate /force"})}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},158652:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/manualconfig_ad_nla_audit_force_winserver2016-a7872607d987f07964b830133888fadd.webp"},842609:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/manualconfig_ad_advpol_winserver2016-cbb8bf0f602da28e99b747b9add7e7c7.webp"}}]);