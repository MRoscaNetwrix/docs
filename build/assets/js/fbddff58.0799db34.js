"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[943500],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var r=s(296540);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}},462123:(e,n,s)=>{s.d(n,{A:()=>r});const r="data:image/webp;base64,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"},691723:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"usercube/integration-guide/connectors/references-connectors/powershellprov/index","title":"PowerShellProv","description":"This connector writes to an external system via a PowerShell script.","source":"@site/docs/usercube_saas/usercube/integration-guide/connectors/references-connectors/powershellprov/index.md","sourceDirName":"usercube/integration-guide/connectors/references-connectors/powershellprov","slug":"/usercube/integration-guide/connectors/references-connectors/powershellprov/","permalink":"/docs/usercube_saas/usercube/integration-guide/connectors/references-connectors/powershellprov/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/usercube_saas/usercube/integration-guide/connectors/references-connectors/powershellprov/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"userCubeSaasSidebar","previous":{"title":"OpenLDAP","permalink":"/docs/usercube_saas/usercube/integration-guide/connectors/references-connectors/openldap/"},"next":{"title":"PowerShellSync","permalink":"/docs/usercube_saas/usercube/integration-guide/connectors/references-connectors/powershellsync/"}}');var t=s(474848),i=s(28453);const o={},c="PowerShellProv",l={},d=[{value:"Overview",id:"overview",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Export",id:"export",level:2},{value:"Fulfill",id:"fulfill",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Setting attributes",id:"setting-attributes",level:4},{value:"Write a script",id:"write-a-script",level:3},{value:"Authentication",id:"authentication",level:2},{value:"Password reset",id:"password-reset",level:3},{value:"Credential protection",id:"credential-protection",level:3}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"powershellprov",children:"PowerShellProv"})}),"\n",(0,t.jsxs)(n.p,{children:["This connector writes to an external system via a ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/powershell/scripting/overview",children:"PowerShell"})," script."]}),"\n",(0,t.jsxs)(n.p,{children:["This page is about ",(0,t.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/connectors/references-packages/powershellprov/",children:"\nPowerShellProv\n"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Package: Custom/PowerShellProv",src:s(462123).A+"",width:"230",height:"55"})}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"PowerShell is a cross-platform task automation and configuration management framework, consisting of a command-line shell and scripting language. Unlike most shells which accept and return text, PowerShell is built on top of the .NET Common Language Runtime (CLR), and accepts and returns .NET objects. This fundamental change brings entirely new tools and methods for automation."}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(n.p,{children:"Implementing this connector requires:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["making sure that the command ",(0,t.jsx)(n.code,{children:"powershell.exe"}),", inside the command prompt (",(0,t.jsx)(n.code,{children:"cmd.exe"}),"), does execute a PowerShell terminal;"]}),"\n",(0,t.jsxs)(n.li,{children:["knowledge of scripting in PowerShell 5.1 or later, ",(0,t.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/powershell/scripting/windows-powershell/install/windows-powershell-system-requirements",children:"see here PowerShell's requirements"}),";"]}),"\n",(0,t.jsx)(n.li,{children:"making sure that the device hosting the agent has its execution policy properly configured to execute the given PowerShell script;"}),"\n",(0,t.jsx)(n.li,{children:"checking the targeted system's requirements (environment, libraries, etc.), as this connector is meant to connect Identity Manager\xa0to a PowerShell-compatible system;"}),"\n",(0,t.jsxs)(n.li,{children:["writing and testing a PowerShell script (",(0,t.jsx)(n.code,{children:".ps1"}),") according to Netwrix Identity Manager (formerly Usercube)' guidelines below."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"export",children:"Export"}),"\n",(0,t.jsx)(n.p,{children:"There are no export capabilities for this connector."}),"\n",(0,t.jsx)(n.h2,{id:"fulfill",children:"Fulfill"}),"\n",(0,t.jsx)(n.p,{children:"This connector executes a PowerShell script for the creation, deletion and update of any entity linked to the managed system."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["For example, it can fulfill the ",(0,t.jsx)(n.code,{children:"mailboxes"})," entity from Microsoft Exchange."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["This process is configured through a ",(0,t.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/connectors/connection/",children:"\nConnection\n"})," in the UI and/or the XML configuration, and in the ",(0,t.jsx)(n.code,{children:"appsettings.agent.json > Connections"})," section:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'appsettings.agent.json\n{\n  ...\n  "Connections": {\n    ...\n    "<ConnectionIdentifier>": {\n      ...\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"The identifier of the connection and thus the name of the subsection must:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"be unique."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"not begin with a digit."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["not contain ",(0,t.jsx)(n.code,{children:"<"}),", ",(0,t.jsx)(n.code,{children:">"}),", ",(0,t.jsx)(n.code,{children:":"}),", ",(0,t.jsx)(n.code,{children:'"'}),", ",(0,t.jsx)(n.code,{children:"/"}),", ",(0,t.jsx)(n.code,{children:"\\"}),", ",(0,t.jsx)(n.code,{children:"|"}),", ",(0,t.jsx)(n.code,{children:"?"}),", ",(0,t.jsx)(n.code,{children:"*"})," and ",(0,t.jsx)(n.code,{children:"_"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["The following example fills a CSV file through the script ",(0,t.jsx)(n.code,{children:"Fulfill-CSV.ps1"}),", for a single target managed system identified by the ",(0,t.jsx)(n.code,{children:"PowerShellCsvFulfillment"})," subsection:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'appsettings.agent.json\n{\n  ...\n  "Connections": {\n    ...\n    "PowerShellCsvFulfillment": {\n      "PowerShellScriptPath": "C:/UsercubeDemo/Scripts/Fulfill-CSV.ps1",\n      "Options": {\n        "Message": "Hello",\n        "Login": "admin",\n        "Password": "secret"\n      }\n    }\n  }\n}\n'})}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"setting-attributes",children:"Setting attributes"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Name"}),(0,t.jsx)(n.th,{children:"Details"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"PowerShellScriptPath   required"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Type"}),"    String   ",(0,t.jsx)(n.strong,{children:"Description"})," Path of the executed PowerShell script (.ps1)."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Options   optional"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Type"}),"    String Pair List   ",(0,t.jsx)(n.strong,{children:"Description"})," List of key-value pairs for all the variables required by the PowerShell script. ",(0,t.jsx)(n.strong,{children:"Example"})," ",(0,t.jsx)(n.code,{children:'   "Options": {    "Login": "admin",    "Password": "secret"   }'}),"  In order for the script to access these options, the following two lines of code must be included in the script:  ",(0,t.jsx)(n.code,{children:"$options = [System.Console]::ReadLine()   $options = ConvertFrom-Json $options"}),"  Afterwards, any one of these variables can be easily accessed:  ",(0,t.jsx)(n.code,{children:"$options.Login$options.Password   # -> admin and secret"})]})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"write-a-script",children:"Write a script"}),"\n",(0,t.jsxs)(n.p,{children:["See how to ",(0,t.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/connectors/how-tos/write-fulfill-powershell-script/",children:"\nWrite a PowerShell Script for Provisioning\n"}),"to allow provisioning with this connector."]}),"\n",(0,t.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,t.jsx)(n.h3,{id:"password-reset",children:"Password reset"}),"\n",(0,t.jsx)(n.p,{children:"The PowerShell script manages password reset."}),"\n",(0,t.jsx)(n.h3,{id:"credential-protection",children:"Credential protection"}),"\n",(0,t.jsx)(n.p,{children:"Data protection can be ensured through:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/connectors/connection/",children:"\nConnection\n"}),", configured in the ",(0,t.jsx)(n.code,{children:"appsettings.encrypted.agent.json"})," file;"]}),"\n",(0,t.jsxs)(n.li,{children:["An ",(0,t.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/connectors/connection/",children:"\nConnection\n"})," safe;"]}),"\n"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Attribute"}),(0,t.jsx)(n.th,{children:"Naming Convention for the Key in Azure Key Vault"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Login (optional)"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Connections--<identifier>--Options--Login"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Password (optional)"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Connections--<identifier>--Options--Password"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"PowerShellScriptPath"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Connections--<identifier>--PowerShellScriptPath"})})]})]})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["A ",(0,t.jsx)(n.a,{href:"/docs/usercube_saas/usercube/integration-guide/toolkit/xml-configuration/connectors/connection/",children:"\nConnection\n"})," able to store the attributes from the ",(0,t.jsx)(n.code,{children:"Options"})," section that are compatible with CyberArk."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Protected attributes are stored inside a safe in CyberArk, into an account whose identifier can be retrieved by Identity Manager\xa0from ",(0,t.jsx)(n.code,{children:"appsettings.cyberark.agent.json"}),"."]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["For example, consider ",(0,t.jsx)(n.code,{children:"Login"})," and ",(0,t.jsx)(n.code,{children:"Password"})," values stored in the ",(0,t.jsx)(n.code,{children:"PowerShellCsv_Account"})," account:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'appsettings.cyberark.agent.json\n{\n  "Connections": {\n    ...\n    "PowerShellCsvFulfillment": {\n      "Options": {\n        "Login": "PowerShellCsv_Account",\n        "Password": "PowerShellCsv_Account"\n      }\n    }\n  }\n}\n'})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);