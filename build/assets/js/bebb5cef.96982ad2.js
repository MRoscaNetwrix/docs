"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[520649],{28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>r});var i=n(296540);const o={},s=i.createContext(o);function a(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(s.Provider,{value:t},e.children)}},557537:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/emailnotificationssetup-c82d21b5966bec3b8307b63a359c2779.webp"},579807:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"threatprevention/admin/templates/actions","title":"Actions Tab","description":"The Actions tab is for configuring various responses, or event consumers, to the event data a policy captures.","source":"@site/docs/threatprevention/threatprevention/admin/templates/actions.md","sourceDirName":"threatprevention/admin/templates","slug":"/threatprevention/admin/templates/actions","permalink":"/docs/threatprevention/threatprevention/admin/templates/actions","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/threatprevention/threatprevention/admin/templates/actions.md","tags":[],"version":"current","frontMatter":{},"sidebar":"threatPreventionSidebar","previous":{"title":"Tags Node","permalink":"/docs/threatprevention/threatprevention/admin/tags/overview"},"next":{"title":"Template Configuration","permalink":"/docs/threatprevention/threatprevention/admin/templates/configuration"}}');var o=n(474848),s=n(28453);const a={},r="Actions Tab",c={},l=[{value:"Send to Events DB",id:"send-to-events-db",level:2},{value:"Send to SIEM",id:"send-to-siem",level:2},{value:"Send to Netwrix Threat Manager",id:"send-to-netwrix-threat-manager",level:2},{value:"Email Notifications",id:"email-notifications",level:2},{value:"Custom Scripts",id:"custom-scripts",level:2}];function h(e){const t={a:"a",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"actions-tab",children:"Actions Tab"})}),"\n",(0,o.jsx)(t.p,{children:"The Actions tab is for configuring various responses, or event consumers, to the event data a policy captures."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Template \u2013 Actions tab",src:n(861114).A+"",width:"1056",height:"853"})}),"\n",(0,o.jsx)(t.p,{children:"The following types of actions are available:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Send to Events DB \u2013 Logs events to the event database for reporting, using the built-in database event consumer"}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Send to SIEM \u2013 Sends formatted messages to a SIEM server as configured in a profile"}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Send to Netwrix Threat Manager \u2013 Sends data for this policy to Netwrix Threat Manager, formerly StealthDEFEND"}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Email Notifications \u2013 Sends formatted email notifications to the selected message profile"}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Add Custom Scripts"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"File Actions \u2013 Records the events to a log (text) file in XML or Comma Delimited (CSV) format"}),"\n",(0,o.jsx)(t.li,{children:".NET Script Actions \u2013 Runs a user\u2010supplied script that implements an automated action in response to the event. Scripts can be written in Visual Basic or C#"}),"\n",(0,o.jsx)(t.li,{children:"PowerShell 4.0 Actions \u2013 Runs a user-supplied PowerShell script that implements an automated action in response to the event"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Multiple event consumers can be configured for a single policy, even multiple event consumers of the same type. However, only one database event consumer can be added per policy."}),"\n",(0,o.jsx)(t.p,{children:"Actions are configured to run on a separate thread from the policy\u2019s event processing thread. Incoming events have a dedicated thread/queue for processing. Email notification has a dedicated thread/queue for processing. Custom Script actions has a dedicated thread/queue for processing. This allows the action to process without blocking new events from going into the database while the action completes."}),"\n",(0,o.jsx)(t.p,{children:"You can enable or disable an action in any of the following ways:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Check or uncheck the Enabled checkbox for an action in the Action Configurations list"}),"\n",(0,o.jsx)(t.li,{children:"On selecting an action in the Action Configurations list, its details are displayed on the Actions tab. You can check or uncheck the Enabled checkbox for the action here."}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Save all changes made to a policy or a template before leaving the configuration interface."}),"\n",(0,o.jsx)(t.h2,{id:"send-to-events-db",children:"Send to Events DB"}),"\n",(0,o.jsx)(t.p,{children:"This is the primary action and is enabled by default in new policies. It saves the event data a policy monitors and captures to the NVMonitorData database. Typically this option is only unchecked by Netwrix Support during a troubleshooting session or when the only desired output is a file for an alert. Reporting uses the events database."}),"\n",(0,o.jsx)(t.h2,{id:"send-to-siem",children:"Send to SIEM"}),"\n",(0,o.jsxs)(t.p,{children:["This action is added by selecting the desired SIEM profile to be the recipient of the SIEM notifications from the drop-down menu. Only SIEM profiles previously created are available for selection. This action can also be assigned on the ",(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/systemalerting/siem",children:"SIEM Tab"})," of the System Alerting Window."]}),"\n",(0,o.jsxs)(t.p,{children:["All notifications sent to SIEM are also displayed on the ",(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/siemoutputviewer",children:"SIEM Output Viewer"})," window."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"NOTE:"})," To enable this feature, a Threat Prevention administrator must first establish a connection with the SIEM server and configure the mapping file through the ",(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/systemalerting/overview",children:"System Alerting Window"}),"."]}),"\n",(0,o.jsx)(t.h2,{id:"send-to-netwrix-threat-manager",children:"Send to Netwrix Threat Manager"}),"\n",(0,o.jsx)(t.p,{children:"This action can be checked to send event data for the policy to Netwrix Threat Manager. This is specific to integration with a full version deployment of Netwrix Threat Manager. The Netwrix Threat Manager Reporting Module uses the NVMonitorData database (Send to Events DB option) for reporting purposes."}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"NOTE:"})," To enable this feature, the Web Request Action Module (Netwrix Threat Manager URI) must be created and configured by a Threat Prevention administrator through the ",(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/threatmanagerconfiguration#event-sink-tab",children:"Event Sink Tab"})," on the Netwrix Threat Manager Configuration window."]}),"\n",(0,o.jsx)(t.h2,{id:"email-notifications",children:"Email Notifications"}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"CAUTION:"})," Email notifications should not be used on highly active policies. Please reserve this feature for policies where immediate notification of an event is needed."]}),"\n",(0,o.jsxs)(t.p,{children:["To enable email notifications, select the desired message profile to be recipient of the email notifications from the drop-down menu. Only message profiles previously created are available for selection. This action can also be assigned on the ",(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/systemalerting/overview",children:"System Alerting Window"}),"."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Actions tab - Email Notifications section",src:n(557537).A+"",width:"300",height:"384"})}),"\n",(0,o.jsxs)(t.p,{children:["Enable the Email Notifications checkbox, select a message profile and then choose to enable the ",(0,o.jsx)(t.strong,{children:"Prevent Repeat Emails by"})," option. If enabled:"]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Select the radio button for either Policy or Subject:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Policy \u2013 Threat Prevention will send an email notification for the first event only, and skip notifications for any other events captured by the same policy during the duration you specify in the boxes below."}),"\n",(0,o.jsx)(t.li,{children:"Subject \u2013 Threat Prevention will send an email notification (say, Notification1) for the first event only, and skip notifications for any other events whose email notification will have the same subject line as Notification1. It will skip sending notifications for the duration you specify in the boxes below. Note that the subject line is configured within the message profile."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Set the duration (in minutes or hours) for which emails notifications are skipped after an email is sent for a policy/subject line."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Example:"}),"\n",(0,o.jsx)(t.p,{children:"In the following example, let\u2019s assume you have the following settings for Prevent Repeat Emails by:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Option selected: Policy"}),"\n",(0,o.jsx)(t.li,{children:"Duration set: 5 minutes"}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"In a situation where Threat Prevention captures 15 events in 5 minutes against a policy, an email notification will be sent in real time for the first event only. The remaining events will be logged in the application but email notifications will not be generated."}),"\n",(0,o.jsx)(t.p,{children:"Two hours later, when another event is captured against that same policy, Threat Prevention will send an email notification for it. If more events are captured within the next five minutes, email notifications will not be generated."}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"NOTE:"})," To enable email notifications, the SMTP gateway must first be configured and message profiles created by a Threat Prevention\xa0 administrator, which is done through the ",(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/systemalerting/overview",children:"System Alerting Window"}),"."]}),"\n",(0,o.jsx)(t.h2,{id:"custom-scripts",children:"Custom Scripts"}),"\n",(0,o.jsx)(t.p,{children:"In the Actions Configurations area at the top of the tab, assigned File, .NET Script, or PowerShell 4.0 actions are listed with their name, type, description, and whether they are enabled or disabled."}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["Click ",(0,o.jsx)(t.strong,{children:"Add"})," (+) to open the Add Action window. Choose the type of action and configure the script."]}),"\n",(0,o.jsx)(t.li,{children:"Use the Remove (x) button to delete a custom script action from a policy."}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"See the following topics for additional information:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/policies/actions/file",children:"File Actions"})}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/policies/actions/netscript",children:".NET Script Actions"})}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Optionally, custom scripts can be provided through a Netwrix Statement of Work."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/policies/actions/powershell",children:"PowerShell 4.0 Actions"})}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Optionally, custom scripts can be provided through a Netwrix Statement of Work."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"NOTE:"})," There are custom scripts created by Netwrix Engineers that execute the notification emails. See the ",(0,o.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/templates/folder/actions#custom-scripts",children:"Custom Scripts"})," topic for additional information."]})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},861114:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/actionstab-b97cd78b5605eb9bbad5f6d90027d55d.webp"}}]);