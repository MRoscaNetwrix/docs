"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[120675],{28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>h});var r=t(296540);const i={},a=r.createContext(i);function o(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function h(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(a.Provider,{value:n},e.children)}},794231:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>h,default:()=>l,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"threatprevention/api/threatmanager","title":"Netwrix Threat Manager APIs","description":"The following APIs are related to where Threat Prevention sends the event data to, and how to retrieve the current settings:","source":"@site/docs/threatprevention/threatprevention/api/threatmanager.md","sourceDirName":"threatprevention/api","slug":"/threatprevention/api/threatmanager","permalink":"/docs/threatprevention/threatprevention/api/threatmanager","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/threatprevention/threatprevention/api/threatmanager.md","tags":[],"version":"current","frontMatter":{},"sidebar":"threatPreventionSidebar","previous":{"title":"Policy APIs","permalink":"/docs/threatprevention/threatprevention/api/policy"},"next":{"title":"Site Account Management APIs","permalink":"/docs/threatprevention/threatprevention/eperestsite/accountmanagement"}}');var i=t(474848),a=t(28453);const o={},h="Netwrix Threat Manager APIs",s={},c=[{value:"Set Threat Manager Configuration",id:"set-threat-manager-configuration",level:2},{value:"Get Threat Manager Configuration",id:"get-threat-manager-configuration",level:2},{value:"Get LDAP Deception",id:"get-ldap-deception",level:2},{value:"Set LDAP Deception",id:"set-ldap-deception",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"netwrix-threat-manager-apis",children:"Netwrix Threat Manager APIs"})}),"\n",(0,i.jsx)(n.p,{children:"The following APIs are related to where Threat Prevention sends the event data to, and how to retrieve the current settings:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Set-SIDefendConfig"}),"\n",(0,i.jsx)(n.li,{children:"Get-SIDefendConfig"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The following APIs are related to the LDAP Deception trap options on the Honey Token Tab of the ",(0,i.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/threatmanagerconfiguration",children:"Netwrix Threat Manager Configuration Window"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Get-SILdapDeception"}),"\n",(0,i.jsx)(n.li,{children:"Set-SILdapDeception"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"set-threat-manager-configuration",children:"Set Threat Manager Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Set-SIDefendConfig"})," command tells Threat Prevention where to send the event data from all tab settings on the ",(0,i.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/threatmanagerconfiguration",children:"Netwrix Threat Manager Configuration Window"}),". There are three methods available for data output:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Threat Manager AMQP\xa0(URI/Port) \u2013 Sends event data directly to Threat Manager"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"File on an Agent \u2013 Sends event data to a specified file. The server must have a deployed Agent."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Activity Monitor \u2013 Sends event data either directly to an Activity Monitor port or a file, that Activity Monitor will access on a domain controller where both the Threat Prevention Agent and Activity Monitor agent are located. Then Activity Monitor must be configured to send the data to Threat Manager. See the ",(0,i.jsx)(n.a,{href:"https://helpcenter.netwrix.com/category/activitymonitor",children:"Netwrix Activity Monitor Documentation"})," for additional information."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"Remember,"})," the port number for Activity Monitor is 4499."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The following parameters are required:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"AppToken \u2013 String generated on the App Tokens page of Threat Manager Configuration menu"}),"\n",(0,i.jsx)(n.li,{children:"URI \u2013 Threat Manager hostname or IP address"}),"\n",(0,i.jsx)(n.li,{children:"Protocol \u2013 Specifies the behavior of the string as AMQP or File path"}),"\n",(0,i.jsx)(n.li,{children:"Path \u2013 File path to the Agent location where Threat Prevention event data is sent. This parameter is required when the protocol is set to File."}),"\n",(0,i.jsx)(n.li,{children:"ComputerName \u2013 Location the Threat Prevention Agents send event data for Threat Manager. This parameter is required when the protocol is set to AMQP."}),"\n",(0,i.jsx)(n.li,{children:"Port \u2013 Threat Manager port. The default is 10001."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example using URI and AppToken to connect to Threat Manager:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:'Set-SIDefendConfig -URI "amqp://192.168.9.52:10001" -AppToken "egJhbGciOiJIi8of71eg0Ulwk5o2nm5p..."'})}),"\n",(0,i.jsx)(n.p,{children:"Example using an output file on an Agent:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:'Set-SIDefendConfig -Path "C:\\TestOutput" -Protocol "File"'})}),"\n",(0,i.jsx)(n.p,{children:"Example using Activity Monitor to send to Threat Manager:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:'Set-SIDefendConfig -Protocol "amqp" -ComputerName "LocalHost" -Port "4499"'})}),"\n",(0,i.jsx)(n.h2,{id:"get-threat-manager-configuration",children:"Get Threat Manager Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Get-SIDefendConfig"})," command is used to return all settings on the Event Sink Tab of the ",(0,i.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/threatmanagerconfiguration",children:"Netwrix Threat Manager Configuration Window"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"get-ldap-deception",children:"Get LDAP Deception"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Get-SILdapDeception"})," command provides the current information configured in the Honey Token Tab of the ",(0,i.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/threatmanagerconfiguration",children:"Netwrix Threat Manager Configuration Window"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"set-ldap-deception",children:"Set LDAP Deception"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Set-SILdapDeception"})," command changes the settings on the Honey Token Tab of the ",(0,i.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/threatmanagerconfiguration",children:"Netwrix Threat Manager Configuration Window"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"Remember,"})," these settings must be an exact match to the configuration set up in the Threat Manager Honey Token threat."]}),"\n",(0,i.jsx)(n.p,{children:"The following parameters are required:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Enable [Bool]","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"1 to enable"}),"\n",(0,i.jsx)(n.li,{children:"0 to disable"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"ReplacementSamAccountName"}),"\n",(0,i.jsx)(n.li,{children:"SourceSamAccountName"}),"\n",(0,i.jsxs)(n.li,{children:["SubstitutionType","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"1 for exact match"}),"\n",(0,i.jsx)(n.li,{children:"2 for a substring"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example of LDAP Deception parameters:"}),"\n",(0,i.jsx)(n.p,{children:'Set-SILdapDeception -E "1" -S "SamAccountName" -R "NameToReplace" -T "1"'})]})}function l(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);