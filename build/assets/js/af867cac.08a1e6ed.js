"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[16646],{28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>a});var i=n(296540);const r={},o=i.createContext(r);function s(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:t},e.children)}},155883:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/adpendingmodealert-2a17da02c973ae6096493d7bb978159a.webp"},189886:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>c,frontMatter:()=>s,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"threatprevention/admin/agents/safemode","title":"Agent Safe Mode","description":"To collect real-time activity data, the Agent hooks into (intercepts) specific Microsoft APIs in the LSASS process. Below are some considerations:","source":"@site/docs/threatprevention/threatprevention/admin/agents/safemode.md","sourceDirName":"threatprevention/admin/agents","slug":"/threatprevention/admin/agents/safemode","permalink":"/docs/threatprevention/threatprevention/admin/agents/safemode","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/threatprevention/threatprevention/admin/agents/safemode.md","tags":[],"version":"current","frontMatter":{},"sidebar":"threatPreventionSidebar","previous":{"title":"Agents Interface","permalink":"/docs/threatprevention/threatprevention/admin/agents/overview"},"next":{"title":"Agent Installer Update Window","permalink":"/docs/threatprevention/threatprevention/admin/agents/window/agentinstallerupdate"}}');var r=n(474848),o=n(28453);const s={},a="Agent Safe Mode",d={},l=[{value:"Enable Agent Started in AD Monitor Pending Mode Email Alert",id:"enable-agent-started-in-ad-monitor-pending-mode-email-alert",level:2}];function h(e){const t={a:"a",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"agent-safe-mode",children:"Agent Safe Mode"})}),"\n",(0,r.jsx)(t.p,{children:"To collect real-time activity data, the Agent hooks into (intercepts) specific Microsoft APIs in the LSASS process. Below are some considerations:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["Occasionally a Microsoft Security Bulletin impacting LSASS can interfere with the Agent instrumentation resulting in LSASS shutting down. The Agent is configured to monitor for an LSASS process termination shortly after a server reboot. The ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/troubleshooting/lsass",children:"LSASS Process Terminated"})," alert (Operations alert) is triggered in this event and the Agent is stopped. As a result, all monitoring/blocking by that Agent stops. To resolve the issue, either upgrade to the latest version of the Agent or simply upgrade SI.ActiveDirectoryMonitor.dll - commonly known as ADMonitor DLL (recommended). See the ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/agents/management/upgradeadmonitor",children:"Upgrade ADMonitor"}),"topic\xa0for additional information."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.em,{children:(0,r.jsx)(t.strong,{children:"RECOMMENDED:"})}),"  Activate an email notification for the ",(0,r.jsx)(t.em,{children:"LSASS process terminated"})," alert. See the ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/troubleshooting/lsass#enable-the-lsass-process-terminated-email-alert",children:"Enable the 'LSASS Process Terminated' Email Alert"})," topic for additional information."]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["In addition to the LSASS process termination check, the Agent can be configured for a Safe Mode. In Safe Mode, the Agent records the version of the LSASS DLLs that it hooks into during installation. When an Agent is restarted, it compares the DLL versions with the recorded list. If the versions do not match, the Windows AD Events monitoring module is not loaded. The Agent\u2019s status in the Agents interface changes to Active (Modules Pending), and all Active Directory monitoring/blocking by that Agent stops. The 'Agent Started in AD Monitor pending mode' alert (Operations alert) is triggered in this event. To resolve the issue temporarily, the Threat Prevention administrator should start the pending modules. See the ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/agents/management/startpendingmodules",children:"Start Pending Modules"})," topic for additional information. It is also recommended to upgrade SI.ActiveDirectoryMonitor.dll (commonly known as ADMonitor DLL) to resolve the issue permanently. See the ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/agents/management/upgradeadmonitor",children:"Upgrade ADMonitor"})," topic\xa0for additional information."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.em,{children:(0,r.jsx)(t.strong,{children:"RECOMMENDED:"})})," Activate an email notification for this alert. See the ",(0,r.jsx)(t.a,{href:"#Enable-Agent-Started-in-AD-Monitor-Pending-Mode-Email-Alert",children:"Enable Agent Started in AD Monitor Pending Mode Email Alert"})," topic for additional information."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.em,{children:"Remember,"})," in Safe Mode, Threat Prevention does not terminate the LSASS process; it only prevents the Active Directory monitoring/blocking module from loading on the Agent machine every time key LSASS DLLs are changed."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"NOTE:"})," Most Microsoft Security Bulletins that alter LSASS will not interfere with Agent instrumentation."]}),"\n",(0,r.jsxs)(t.p,{children:["Active Directory monitoring/blocking will not resume until the pending modules are started. To determine if the LSASS changes will conflict with the Agent instrumentation, start the pending modules on one domain controller (see the ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/agents/management/startpendingmodules",children:"Start Pending Modules"})," topic). If there are no issues after five minutes, it is unlikely that the changes are conflicting with the Agent instrumentation. If there are any concerns about the changes, reach out to ",(0,r.jsx)(t.a,{href:"mailto:support@stealthbits.com"}),(0,r.jsx)(t.a,{href:"https://www.netwrix.com/support.html",children:"Netwrix Support"})," for more information. Netwrix tests Microsoft Security Bulletins affecting LSASS prior to their becoming public and sends notifications to Threat Prevention users when an issue is identified."]}),"\n",(0,r.jsx)(t.p,{children:"When the pending modules are started, the recorded versions of the LSASS DLLs the Agent hooks into are overwritten with the current versions."}),"\n",(0,r.jsx)(t.h2,{id:"enable-agent-started-in-ad-monitor-pending-mode-email-alert",children:"Enable Agent Started in AD Monitor Pending Mode Email Alert"}),"\n",(0,r.jsx)(t.p,{children:"Follow the steps to enable email notifications for the Agent Started in AD Monitor pending mode Operations alert."}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"NOTE:"})," These steps require the Threat Prevention administrator role. They also assume that the ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/systemalerting/overview",children:"System Alerting Window"})," has been configured and email alerts have been enabled."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 1 \u2013"})," Clck ",(0,r.jsx)(t.strong,{children:"Configuration"})," > ",(0,r.jsx)(t.strong,{children:"Alerts"})," on the menu. The Netwrix Threat Prevention System Alerting window opens."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 2 \u2013"})," On the Email tab, click ",(0,r.jsx)(t.strong,{children:"Configure"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 3 \u2013"})," Create a message profile for the Safe Mode notification with the recipient(s) to be notified when the AD modules are pending. See the ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/systemalerting/email#create-message-profiles",children:"Create Message Profiles"})," topic for additional information."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Netwrix Threat Prevention System Alerting window",src:n(155883).A+"",width:"975",height:"797"})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 4 \u2013"})," Select ",(0,r.jsx)(t.strong,{children:"Events"}),", and then ",(0,r.jsx)(t.strong,{children:"Operations"})," on the left. Check the ",(0,r.jsx)(t.strong,{children:"Agent Started in AD Monitor pending mode"})," event alert and select the message profile you created in Step 3 from the drop-down menu to assign it to the alert. See the ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/systemalerting/email",children:"Email Tab"})," topic for additional information."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Step 5 \u2013"})," Ensure that the email alerts are ",(0,r.jsx)(t.strong,{children:"Enabled"})," and click ",(0,r.jsx)(t.strong,{children:"OK"}),"."]}),"\n",(0,r.jsx)(t.p,{children:"When the Agent Started in AD Monitor pending mode event alert is triggered, an email notification is sent to the recipient(s) in the selected message profile."})]})}function c(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);