"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[206019],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var o=t(296540);const i={},s=o.createContext(i);function r(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(s.Provider,{value:n},e.children)}},244994:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>c,default:()=>l,frontMatter:()=>r,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"policypak/scriptstriggers/vpnconnection","title":"How does Endpoint Policy Manager Scripts & Triggers know when the VPN connection is made or lost?","description":"Netwrix Endpoint Policy Manager (formerly PolicyPak) Scripts & Triggers VPN connection supports the following VPN connections:","source":"@site/docs/policypak/policypak/scriptstriggers/vpnconnection.md","sourceDirName":"policypak/scriptstriggers","slug":"/policypak/scriptstriggers/vpnconnection","permalink":"/docs/policypak/policypak/scriptstriggers/vpnconnection","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/scriptstriggers/vpnconnection.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"How do I use Scripts Manager to update the Registry on end-user workstations","permalink":"/docs/policypak/policypak/scriptstriggers/updateregistry"},"next":{"title":"What is the expected behavior on Windows 10 when you MODIFY an existing Endpoint Policy Manager Scripts script?","permalink":"/docs/policypak/policypak/scriptstriggers/windows10modifyscript"}}');var i=t(474848),s=t(28453);const r={},c="How does Endpoint Policy Manager Scripts & Triggers know when the VPN connection is made or lost?",p={},a=[{value:"Microsoft VPN",id:"microsoft-vpn",level:2},{value:"OpenVPN GUI",id:"openvpn-gui",level:2},{value:"OpenVPN Connect",id:"openvpn-connect",level:2},{value:"Cisco VPN",id:"cisco-vpn",level:2},{value:"Fortinet VPN",id:"fortinet-vpn",level:2}];function d(e){const n={h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"how-does-endpoint-policy-manager-scripts--triggers-know-when-the-vpn-connection-is-made-or-lost",children:"How does Endpoint Policy Manager Scripts & Triggers know when the VPN connection is made or lost?"})}),"\n",(0,i.jsx)(n.p,{children:"Netwrix Endpoint Policy Manager (formerly PolicyPak) Scripts & Triggers VPN connection supports the following VPN connections:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Microsoft VPN"}),"\n",(0,i.jsx)(n.li,{children:"OpenVPN GUI"}),"\n",(0,i.jsx)(n.li,{children:"OpenVPN Connect"}),"\n",(0,i.jsx)(n.li,{children:"Cisco VPN"}),"\n",(0,i.jsx)(n.li,{children:"Fortinet VPN"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"microsoft-vpn",children:"Microsoft VPN"}),"\n",(0,i.jsx)(n.p,{children:"PPScripts uses Microsoft RAS API to listen when RAS connection is created or closed. Windows sends notification for it with server's name. PPScripts checks if this is VPN connection and lookup for policy with VPN trigger and same server's name. If policy found, PPScripts executes corresponding script."}),"\n",(0,i.jsx)(n.h2,{id:"openvpn-gui",children:"OpenVPN GUI"}),"\n",(0,i.jsx)(n.p,{children:"OpenVPN doesn't use Microsoft RAS API, but it VPN profile allow execute script for connect/disconnect. PPScripts lookup for OpenVPN profile and modifies them. Add script for connect/disconnect with PP utility that notifies PPScripts about OpenVPN connect/Disconnect."}),"\n",(0,i.jsx)(n.h2,{id:"openvpn-connect",children:"OpenVPN Connect"}),"\n",(0,i.jsx)(n.p,{children:"This version of OpenVPN doesn't allow execute scripts for connect/disconnect. PPScripts uses Windows API to listen if new network adapter was added/removed. Then PPScripts trying to check OpenVPN logs for this adapter name and find corresponding server's name."}),"\n",(0,i.jsx)(n.h2,{id:"cisco-vpn",children:"Cisco VPN"}),"\n",(0,i.jsx)(n.p,{children:"Cisco VPN provides API for their VPN. PPScripts uses this API to get notification about connect/disconnect and server's name."}),"\n",(0,i.jsx)(n.h2,{id:"fortinet-vpn",children:"Fortinet VPN"}),"\n",(0,i.jsx)(n.p,{children:'Fortinet doesn\'t provide API that notifies about connection/disconnection. But Fortinet VPN creates virtual network adapter that matched to following mask "FortinetVirtual Ethernet Adapter"'}),"\n",(0,i.jsx)(n.p,{children:"PPScripts listens if new network adapter was added/removed, check adapter's name, and execute corresponding script but without name of server."})]})}function l(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);