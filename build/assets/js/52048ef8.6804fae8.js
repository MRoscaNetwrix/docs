"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[301701],{28453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>a});var o=r(296540);const s={},n=o.createContext(s);function i(e){const t=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(n.Provider,{value:t},e.children)}},892520:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>p});const o=JSON.parse('{"id":"policypak/leastprivilege/adminapproval/secretkeysecure","title":"Securing the Secret Key When Using the Group Policy Method","description":"The secret key of Admin Approval is stored within the XML inside the GPO, as seen here.","source":"@site/docs/policypak/policypak/leastprivilege/adminapproval/secretkeysecure.md","sourceDirName":"policypak/leastprivilege/adminapproval","slug":"/policypak/leastprivilege/adminapproval/secretkeysecure","permalink":"/docs/policypak/policypak/leastprivilege/adminapproval/secretkeysecure","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/leastprivilege/adminapproval/secretkeysecure.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Creating the Secret Key","permalink":"/docs/policypak/policypak/leastprivilege/adminapproval/secretkey"},"next":{"title":"Testing Admin Approval","permalink":"/docs/policypak/policypak/leastprivilege/adminapproval/test"}}');var s=r(474848),n=r(28453);const i={},a="Securing the Secret Key When Using the Group Policy Method",c={},p=[];function l(e){const t={code:"code",h1:"h1",header:"header",p:"p",strong:"strong",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"securing-the-secret-key-when-using-the-group-policy-method",children:"Securing the Secret Key When Using the Group Policy Method"})}),"\n",(0,s.jsx)(t.p,{children:"The secret key of Admin Approval is stored within the XML inside the GPO, as seen here."}),"\n",(0,s.jsx)(t.p,{children:"![A screenshot of a computer"}),"\n",(0,s.jsx)(t.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/adminapproval/securing_the_secret_key_when.webp)"}),"\n",(0,s.jsxs)(t.p,{children:["If you look closely, you will see it is not the same key that was used earlier. Indeed, it is re-hashed or re-encrypted before it is placed within the XML within the GPO. Even so, it is best practice to remove the ability for users to be able to read the encrypted key. As you can see, a Standard User can, by default, read the GPO\u2019s contents, because the default rights of a GPO are ",(0,s.jsx)(t.strong,{children:"Authenticated Users::Read"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"If you wish to remove this access from users, follow these steps:"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 1 \u2013"})," Create an Active Directory group containing the computers that need to read the key."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 2 \u2013"})," Make the GPO readable and writeable to Group Policy Admins (Domain Admins or a group of admins who create and edit GPOs)."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 3 \u2013"})," Remove the Authenticated Users group from the GPO."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 4 \u2013"})," Add in Domain Computers with Read access and Apply Group Policy access (required once you remove Authenticated Users)."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"NOTE:"})," You will have to reboot the computer to pick up the new computer group membership."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.strong,{children:"Scope"})," tab of the GPO, shown here, displays an example of a GPO where only Sales Desktops would be able to determine the contents of the GPO (and therefore download the key as a Computer, but never expose it to a User)."]}),"\n",(0,s.jsx)(t.p,{children:"![A screenshot of a computer screen"}),"\n",(0,s.jsx)(t.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/adminapproval/securing_the_secret_key_when_1.webp)"}),"\n",(0,s.jsx)(t.p,{children:"This immediately prevents Standard Users from reading the Computer side of the GPO, as shown in here."}),"\n",(0,s.jsx)(t.p,{children:"![A screenshot of a computer"}),"\n",(0,s.jsx)(t.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/adminapproval/securing_the_secret_key_when.jpg)"}),"\n",(0,s.jsx)(t.p,{children:"Again, if you choose to place computers into an Active Directory security group, you will need to reboot the computer so it will pick up the new computer group membership and then the GPO."}),"\n",(0,s.jsxs)(t.p,{children:["You can verify the computer got the GPO key by opening an Admin command prompt, running ",(0,s.jsx)(t.code,{children:"GPresult /R"}),", and verifying that the GPO was applied and that the computer is in the group, as shown here."]}),"\n",(0,s.jsx)(t.p,{children:"![A screenshot of a computer"}),"\n",(0,s.jsx)(t.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/adminapproval/securing_the_secret_key_when_2.webp)"})]})}function d(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);