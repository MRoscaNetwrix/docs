"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[73341],{28453:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>c});var t=o(296540);const i={},r=t.createContext(i);function s(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(r.Provider,{value:n},e.children)}},781138:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"admin/datacollection/gmsa/gmsa","title":"Using Group Managed Service Account (gMSA)","description":"Netwrix 1Secure supports using Group Managed Service Accounts (gMSA) for data collection and storage. This can help you to simplify Netwrix 1Secure administration, providing the following benefits:","source":"@site/docs/1secure/admin/datacollection/gmsa/gmsa.md","sourceDirName":"admin/datacollection/gmsa","slug":"/admin/datacollection/gmsa/","permalink":"/docs/1secure/admin/datacollection/gmsa/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/1secure/admin/datacollection/gmsa/gmsa.md","tags":[],"version":"current","frontMatter":{},"sidebar":"oneSecureSidebar","previous":{"title":"Exchange Online Auditing","permalink":"/docs/1secure/admin/datacollection/exchangeonline"},"next":{"title":"Configure Non-Administrative Account to Collect Logon Activity","permalink":"/docs/1secure/admin/datacollection/logonactivity/nondomainadmin"}}');var i=o(474848),r=o(28453);const s={},c="Using Group Managed Service Account (gMSA)",a={},l=[{value:"Checking for KDS root key",id:"checking-for-kds-root-key",level:2},{value:"Creating a gMSA",id:"creating-a-gmsa",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"using-group-managed-service-account-gmsa",children:"Using Group Managed Service Account (gMSA)"})}),"\n",(0,i.jsx)(n.p,{children:"Netwrix 1Secure supports using Group Managed Service Accounts (gMSA) for data collection and storage. This can help you to simplify Netwrix 1Secure administration, providing the following benefits:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"There is no password to manage this account: Windows handles the password management for it. User interaction for password update on a regular basis is not required."}),"\n",(0,i.jsx)(n.li,{children:"Using the gMSA also eliminates a need in service accounts with static passwords that are set upon creation and then never cycled."}),"\n",(0,i.jsx)(n.li,{children:"The gMSA also helps to ensure that service account is only used to run a service (gMSA accounts cannot be used to log on interactively to domain computers)."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"checking-for-kds-root-key",children:"Checking for KDS root key"}),"\n",(0,i.jsx)(n.p,{children:"To generate password for gMSA accounts, domain controllers require a Key Distribution Services (KDS) root key. This key is created once, so if there are any gMSA accounts in your domain, this means the root key already exists."}),"\n",(0,i.jsx)(n.p,{children:"Follow the steps to check whether the root key exists in your domain."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 1 \u2013"})," Open the ",(0,i.jsx)(n.strong,{children:"Active Directory Sites and Services"})," Console, select ",(0,i.jsx)(n.strong,{children:"View"})," \u2192 ",(0,i.jsx)(n.strong,{children:"Show Services Node"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 2 \u2013"})," Browse to ",(0,i.jsx)(n.strong,{children:"Services"})," \u2192",(0,i.jsx)(n.strong,{children:"Group Key Distribution Services"})," \u2192",(0,i.jsx)(n.strong,{children:"Master Root Keys"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 3 \u2013"})," Alternatively, you can run the ",(0,i.jsx)(n.code,{children:"Get-KdsRootKey"})," cmdlet. If the key does not exist, it will not return any output."]}),"\n",(0,i.jsx)(n.p,{children:"If the KDS key does not exist, then you can create is as described below, or contact your Active Directory administrator."}),"\n",(0,i.jsx)(n.p,{children:"To create a KDS key (on a domain controller running Windows Server 2012 or later)"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"On the domain controller, run Windows PowerShell."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"In the command prompt of Windows PowerShell Active Directory module, run the following cmdlet:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Add-KdsRootKey -EffectiveImmediately"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["A root key will be added to the target DC which will be used by the KDS service immediately. Note, however, that it requires a 10-hours wait, as other domain controllers will be able to use the root key only after a successful replication. See ",(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows-server/security/group-managed-service-accounts/create-the-key-distribution-services-kds-root-key",children:"this Microsoft article"})," for more information."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Alternatively, you can use the following cmdlet:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Add-KdsRootKey -EffectiveTime MM/DD/YYYY"})}),"\n",(0,i.jsxs)(n.p,{children:["This cmdlet generates a KDS root key that will take effect on the specified date. Use the ",(0,i.jsx)(n.em,{children:"mm/dd/yyyy"})," format, for example: ",(0,i.jsx)(n.code,{children:"Add-KdsRootKey -EffectiveTime 02/27/21"})]}),"\n",(0,i.jsx)(n.p,{children:"This approach, however, should be used with care."}),"\n",(0,i.jsx)(n.h2,{id:"creating-a-gmsa",children:"Creating a gMSA"}),"\n",(0,i.jsx)(n.p,{children:"When creating a new gMSA, you will need to specify:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"New account name and FQDN"}),"\n",(0,i.jsx)(n.li,{children:"Computer account(s) that will be allowed to make use of that gMSA. Here it will be:"}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Your Netwrix Cloud Agent host"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If you are going to collect data using the network traffic compression (see the following section for more information: ",(0,i.jsx)(n.a,{href:"/docs/1secure/configuration/networktrafficcompression",children:"Network Traffic Compression"}),"), provide the following:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"For Logon Activity \u2014 domain controllers of the monitored domain"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["For example, you can create a gMSA using the ",(0,i.jsx)(n.code,{children:"New-ADServiceAccount"})," PowerShell cmdlet. If so, you should specify your Netwrix Cloud Agent account in the ",(0,i.jsx)(n.code,{children:"-PrincipalsAllowedToRetrieveManagedPassword"})," attribute."]}),"\n",(0,i.jsx)(n.p,{children:"Make sure you specify a valid computer object in this attribute."}),"\n",(0,i.jsx)(n.p,{children:"To create a new gMSA in the root domain using PowerShell:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Run the command as follows:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"New-ADServiceAccount -name ncagmsa -DNSHostName ncagmsa.mydomain.local -PrincipalsAllowedToRetrieveManagedPassword NCASrv$"})}),"\n",(0,i.jsx)(n.p,{children:"here:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"name"})," \u2014 new gMSA\xa0name, here ",(0,i.jsx)(n.strong,{children:"ncagmsa"}),". Make sure the name refers to a valid computer objects."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"DNSHostName"})," \u2014 FQDN of the new gMSA account, here ",(0,i.jsx)(n.strong,{children:"ncagmsa.mydomain.local"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"PrincipalsAllowedToRetrieveManagedPassword"})," \u2014 your Netwrix Cloud Agent host NETBIOS name ended with $, here ",(0,i.jsx)(n.strong,{children:"NCASrv$"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["To learn about the data collecting account, which collects data from the monitored items, go to",(0,i.jsx)(n.a,{href:"/docs/1secure/admin/datacollection/datacollectingaccount/overview",children:" Data Collecting Account"})," article."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);