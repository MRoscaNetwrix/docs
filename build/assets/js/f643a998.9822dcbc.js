"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[208029],{28453:(e,t,r)=>{r.d(t,{R:()=>o,x:()=>a});var i=r(296540);const n={},s=i.createContext(n);function o(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),i.createElement(s.Provider,{value:t},e.children)}},355622:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"auditor/addon/intelsecurity/powershell","title":"Run the Add-On with PowerShell","description":"First, provide a path to your add-on followed by script parameters with their values. Each parameter is preceded with a dash; a space separates a parameter name from its value. You can skip some parameters\u2014 the script uses a default value unless a parameter is explicitly defined. If necessary, modify the parameters as required.","source":"@site/docs/auditor/auditor/addon/intelsecurity/powershell.md","sourceDirName":"auditor/addon/intelsecurity","slug":"/auditor/addon/intelsecurity/powershell","permalink":"/docs/auditor/auditor/addon/intelsecurity/powershell","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/addon/intelsecurity/powershell.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Define Parameters","permalink":"/docs/auditor/auditor/addon/intelsecurity/parameters"},"next":{"title":"Work with Collected Data","permalink":"/docs/auditor/auditor/addon/linux/collecteddata"}}');var n=r(474848),s=r(28453);const o={},a="Run the Add-On with PowerShell",d={},l=[{value:"Applying Filters",id:"applying-filters",level:2}];function c(e){const t={a:"a",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"run-the-add-on-with-powershell",children:"Run the Add-On with PowerShell"})}),"\n",(0,n.jsx)(t.p,{children:"First, provide a path to your add-on followed by script parameters with their values. Each parameter is preceded with a dash; a space separates a parameter name from its value. You can skip some parameters\u2014 the script uses a default value unless a parameter is explicitly defined. If necessary, modify the parameters as required."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"To run the script with PowerShell:"})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 1 \u2013"})," On computer where you want to execute the add-on, start ",(0,n.jsx)(t.strong,{children:"Windows PowerShell"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 2 \u2013"})," Type a path to the add-on. Or simply drag and drop the add-on file in the console window."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 3 \u2013"})," Add script parameters. The console will look similar to the following:"]}),"\n",(0,n.jsx)(t.p,{children:"Windows PowerShell"}),"\n",(0,n.jsx)(t.p,{children:"Copyright (C) 2014 Microsoft Corporation. All rights reserved."}),"\n",(0,n.jsx)(t.p,{children:"PS C:\\Users\\AddOnUser> C:\\Add-ons\\Netwrix_Auditor_Add-on_for_Intel_Security.ps1 - NetwrixAuditorHost 172.28.6.15"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"NOTE:"})," If the script path contains spaces (e.g., _C:\\Netwrix Add-ons_), embrace it in double quotes and insert the ampersand (",(0,n.jsx)(t.strong,{children:"&"}),') symbol in front (e.g., & "_C:\\Netwrix Add-ons_").']}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 4 \u2013"})," Hit ",(0,n.jsx)(t.strong,{children:"Enter"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["Depending on the number of Activity Records stored in Netwrix Auditor Audit Database execution may take a while. Ensure the script execution completed successfully. The Netwrix Auditor ",(0,n.jsx)(t.strong,{children:"Integration"})," event log will be created and filled with events."]}),"\n",(0,n.jsxs)(t.p,{children:["By default, the Netwrix Auditor ",(0,n.jsx)(t.strong,{children:"Integration"}),' event log size is set to 1GB, and retention is set to "',(0,n.jsx)(t.em,{children:"Overwrite events as needed"}),'". See the ',(0,n.jsx)(t.a,{href:"/docs/auditor/auditor/addon/intelsecurity/integrationeventlog",children:"Integration Event Log Fields"})," topic for additional information."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"NOTE:"})," Event records with more than 30,000 characters length will be trimmed."]}),"\n",(0,n.jsxs)(t.p,{children:["At the end of each run, the script creates the ",(0,n.jsx)(t.strong,{children:"Netwrix_Auditor_Event_Log_Export_Add-on_EventIDs.txt"})," file. It defines mapping between the Activity Records and related Event IDs . You can use this file to track possible duplicates of Event IDs created at each script execution. Duplicates, if any, are written to the ",(0,n.jsx)(t.strong,{children:"Netwrix_Auditor_Event_Log_Export_Add-on_EventIDsDuplicates.txt"})," file."]}),"\n",(0,n.jsxs)(t.p,{children:["Similarly, the add-on also creates the ",(0,n.jsx)(t.strong,{children:"Netwrix_Auditor_Event_Log_Export_Add-on_CategoriesIDs.txt"})," file that defines mapping between the Data Source and related Category ID."]}),"\n",(0,n.jsx)(t.h2,{id:"applying-filters",children:"Applying Filters"}),"\n",(0,n.jsx)(t.p,{children:"Every time you run the script, Auditor makes a timestamp. The next time you run the script, it will start retrieving new Activity Records. Consider the following:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"By default, the add-on does not apply any filters when exporting Activity Records. If you are running the add-on for the first time (there is no timestamp yet) with no filters, it will export Activity Records for the last month only. This helps to optimize solution performance during the first run. At the end of the first run, the timestamp will be created, and the next run will start export from that timestamp."}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"However, if you have specified a time period for Activity Records to be exported, then this filter will be applied at the add-on first run and the runs that follow."}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}}}]);