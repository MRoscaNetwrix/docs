"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[636860],{28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var i=t(296540);const r={},s=i.createContext(r);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:n},e.children)}},127888:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"config/activedirectory/filearchive","title":"File Archive Repository Option","description":"As an alternative to using an API\xa0Server, Netwrix Activity Monitor can be configured to store all archived logs to a network share. This option requires all of the domain logs to be stored in the same share location in order for Access Analyzer to collect the AD Activity data.","source":"@site/docs/accessanalyzer/config/activedirectory/filearchive.md","sourceDirName":"config/activedirectory","slug":"/config/activedirectory/filearchive","permalink":"/docs/accessanalyzer/config/activedirectory/filearchive","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/config/activedirectory/filearchive.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"Active Directory Activity Auditing Configuration","permalink":"/docs/accessanalyzer/config/activedirectory/activity"},"next":{"title":"Active Directory Domain Target Requirements","permalink":"/docs/accessanalyzer/config/activedirectory/overview"}}');var r=t(474848),s=t(28453);const o={},c="File Archive Repository Option",l={},h=[{value:"Configure Domain Controller Agent",id:"configure-domain-controller-agent",level:2},{value:"Configure Monitored Domain Output",id:"configure-monitored-domain-output",level:2},{value:"Configure Connection Profile",id:"configure-connection-profile",level:2},{value:"Configure the AD_ActivityCollection Job",id:"configure-the-ad_activitycollection-job",level:2}];function a(e){const n={em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"file-archive-repository-option",children:"File Archive Repository Option"})}),"\n",(0,r.jsx)(n.p,{children:"As an alternative to using an API\xa0Server, Netwrix Activity Monitor can be configured to store all archived logs to a network share. This option requires all of the domain logs to be stored in the same share location in order for Access Analyzer to collect the AD Activity data."}),"\n",(0,r.jsx)(n.p,{children:"Prerequisite"}),"\n",(0,r.jsx)(n.p,{children:"Deploy the AD Agent to each domain controller in the target domain."}),"\n",(0,r.jsx)(n.h2,{id:"configure-domain-controller-agent",children:"Configure Domain Controller Agent"}),"\n",(0,r.jsx)(n.p,{children:"Follow the steps to configure the agent deployed to the domain controller."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"NOTE:"})," These steps assume the network share where the activity log files will be archived already exists."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 1 \u2013"})," On the Agents tab of the Activity Monitor Console, select an agent deployed to domain controller."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 2 \u2013"})," Click Edit. The Agent properties window opens."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 3 \u2013"})," Select the Archiving tab and configure the following:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Check the Enable Archiving for this agent box."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Select the ",(0,r.jsx)(n.strong,{children:"Archive log files on a UNC path"})," option. Click the ... button and navigate to the desired network share."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"User name"})," and ",(0,r.jsx)(n.strong,{children:"User password"})," fields only need to be filled in if the account used to install the agent does not have access to this share."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:"Remember,"})," The account used to install the agent on a domain controller is a Domain Administrator account. This is typically the credential that will be used in the Netwrix Access Analyzer (formerly Enterprise Auditor) Connection Profile. However, a least privilege option is a domain user account with Read access to this share."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Test"})," to ensure a successful connection to the network share."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 4 \u2013"})," Click OK to save the configuration and close the Agent properties window."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 5 \u2013"})," Repeat Steps 1-4 for each agent deployed to domain controller pointing to the same network share in Step 3 for each agent."]}),"\n",(0,r.jsx)(n.p,{children:"These agent are configured to save the Archive logs to the selected share."}),"\n",(0,r.jsx)(n.h2,{id:"configure-monitored-domain-output",children:"Configure Monitored Domain Output"}),"\n",(0,r.jsx)(n.p,{children:"Follow the steps configure the monitored domain output for Netwrix Access Analyzer (formerly Enterprise Auditor)."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 1 \u2013"})," Select the ",(0,r.jsx)(n.strong,{children:"Monitored Domains"})," tab."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 2 \u2013"}),"  Select the desired domain and click ",(0,r.jsx)(n.strong,{children:"Add Output"}),". The Add New Ouptut window opens."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 3 \u2013"})," Configure the following:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Configure the desired number of days for the ",(0,r.jsx)(n.strong,{children:"Period to keep Log files"}),". This is the number of days the log files are kept on the API server configured in the sections above. This needs to be set to a greater value than the days between Access Analyzer scans."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["For example, if Access Analyzer runs the ",(0,r.jsx)(n.strong,{children:"AD_ActivityCollection"})," Job once a week (every 7 days), then the Activity Monitor output should be configured to retain at least 10 days of log files."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Check the ",(0,r.jsx)(n.strong,{children:"This log file is for StealthAUDIT"})," box."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Optionally select the ",(0,r.jsx)(n.strong,{children:"Enable periodic AD Status Check event reporting"})," checkbox. When enabled, the agent will send out status messages every five minutes to verify whether the connection is still active."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 4 \u2013"})," Click ",(0,r.jsx)(n.strong,{children:"Add Output"})," to save and close the Add New Output window."]}),"\n",(0,r.jsx)(n.p,{children:"Access Analyzer now has access to the agent log files for this domain."}),"\n",(0,r.jsx)(n.h2,{id:"configure-connection-profile",children:"Configure Connection Profile"}),"\n",(0,r.jsx)(n.p,{children:"Follow the steps to configure the Connection Profile in Access Analyzer."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 1 \u2013"})," On the Settings > Connection node of the Access Analyzer Console, select the Connection Profile for the Active Directory solution. If you haven't yet created a Connection Profile or desire a specific one for AD Activity, create a new one and provide a unique descriptive name."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 2 \u2013"})," Click Add User credential. The User Credentials window opens."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 3 \u2013"})," Configure the following:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Select Account Type \u2013 Select ",(0,r.jsx)(n.strong,{children:"Active Directory Account"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Domain \u2013 Select the domain where the network share resides"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"User name \u2013 Enter the account with Read access to the network share"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Provide the account password:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Password Storage \u2013 Select the password storage location, if it is being stored in a vault, like CyberArk"}),"\n",(0,r.jsx)(n.li,{children:"Password / Confirm \u2013 Enter the account password in both fields"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 4 \u2013"})," Click OK to save and close the User Credentials window."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 5 \u2013"})," Click ",(0,r.jsx)(n.strong,{children:"Save"})," and then ",(0,r.jsx)(n.strong,{children:"OK"})," to confirm the changes to the Connection Profile."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 6 \u2013"})," Navigate to the Jobs >\xa0Active Directory > 6.Activity > 0.Collection Job Group. Select the ",(0,r.jsx)(n.strong,{children:"Settings > Connection"})," node."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 7 \u2013"})," Select the ",(0,r.jsx)(n.strong,{children:"Select one of the following user defined profiles"})," option. Expand the drop-down menu and select the Connection Profile with this credential."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 8 \u2013"})," Click ",(0,r.jsx)(n.strong,{children:"Save"})," and then ",(0,r.jsx)(n.strong,{children:"OK"})," to confirm the changes to the job group settings."]}),"\n",(0,r.jsx)(n.p,{children:"The Connection Profile will now be used for AD Activity collection."}),"\n",(0,r.jsx)(n.h2,{id:"configure-the-ad_activitycollection-job",children:"Configure the AD_ActivityCollection Job"}),"\n",(0,r.jsxs)(n.p,{children:["Access Analyzer requires additional configurations in order to collect domain activity data. Follow the steps to configure the ",(0,r.jsx)(n.strong,{children:"AD_ActivityCollection"})," Job."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"NOTE:"})," Ensure that the .Active Directory Inventory Job Group has been successfully run against the target domain."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 1 \u2013"})," Navigate to the ",(0,r.jsx)(n.strong,{children:"Jobs"})," >\xa0",(0,r.jsx)(n.strong,{children:"Active Directory"})," > ",(0,r.jsx)(n.strong,{children:"6.Activity"})," > ",(0,r.jsx)(n.strong,{children:"0.Collection"})," > ",(0,r.jsx)(n.strong,{children:"AD_ActivityCollection"})," Job. Select the ",(0,r.jsx)(n.strong,{children:"Configure"})," > ",(0,r.jsx)(n.strong,{children:"Queries"})," node."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 2 \u2013"})," Click ",(0,r.jsx)(n.strong,{children:"Query Properties"}),". The Query Properties window displays."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 3 \u2013"})," On the Data Source tab, select ",(0,r.jsx)(n.strong,{children:"Configure"}),". The Active Directory Activity DC wizard opens."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Active Directory Activity DC wizard Category page",src:t(753034).A+"",width:"750",height:"488"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 4 \u2013"})," On the Category page, choose ",(0,r.jsx)(n.strong,{children:"Import from Share"})," option and click ",(0,r.jsx)(n.strong,{children:"Next"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Active Directory Activity DC wizard Share settings page",src:t(997969).A+"",width:"750",height:"476"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 5 \u2013"})," On the Share page, provide the UNC path to the AD Activity share archive location. If there are multiple archives in the same network share, check the ",(0,r.jsx)(n.strong,{children:"Include Sub-Directories"})," box. Click ",(0,r.jsx)(n.strong,{children:"Next"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Active Directory Activity DC wizard Scoping and Retention page",src:t(516038).A+"",width:"750",height:"518"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 6 \u2013"})," On the Scope page, set the Timespan as desired. There are two options:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Relative Timespan \u2013 Set the number of days of activity logs to collect when the scan is run"}),"\n",(0,r.jsx)(n.li,{children:"Absolute Timespan \u2013 Set the date range for activity logs to collect when the scan is run"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:(0,r.jsx)(n.strong,{children:"RECOMMENDED:"})})," The threshold should be set to ensure the logs are collected before the Activity Monitor domain output log retention expires. For example, if Access Analyzer runs the ",(0,r.jsx)(n.strong,{children:"AD_ActivityCollection"})," Job once a week (every 7 days), then the Activity Monitor output should be configured to retain at least 10 days of log files."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 7 \u2013"})," Set the Retention period as desired. This is the number of days Access Analyzer keeps the collected data in the SQL Server database."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 8 \u2013"})," Click ",(0,r.jsx)(n.strong,{children:"Next"})," and then ",(0,r.jsx)(n.strong,{children:"Finish"})," to save the changes and close the wizard."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Step 9 \u2013"})," Click ",(0,r.jsx)(n.strong,{children:"OK"})," to save the changes and close the Query Properties page."]}),"\n",(0,r.jsx)(n.p,{children:"The query is now configured to target the network share where the Activity Monitor domain activity logs are archived."})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},516038:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/scope-7bc8fdada2f547ae8f24f284315c6724.webp"},753034:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/categoryimportfromshare-b73dafe1f519785a1d880f79e6fd0447.webp"},997969:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/share-4ecd46eb816609ad915dd73c69957ef8.webp"}}]);