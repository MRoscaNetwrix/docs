"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[400911],{28453:(e,t,i)=>{i.d(t,{R:()=>n,x:()=>l});var o=i(296540);const a={},s=o.createContext(a);function n(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:n(e.components),o.createElement(s.Provider,{value:t},e.children)}},922638:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>r,contentTitle:()=>l,default:()=>d,frontMatter:()=>n,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"policypak/leastprivilege/bestpractices/examplesavoid","title":"What Not to Do (Some Examples)","description":"Let\'s say you want to allow users to install Google Earth on their machines. To make it easy, you could select the application\'s Signature as the rule condition and then check Apply to child processes (which is the default.","source":"@site/docs/policypak/policypak/leastprivilege/bestpractices/examplesavoid.md","sourceDirName":"policypak/leastprivilege/bestpractices","slug":"/policypak/leastprivilege/bestpractices/examplesavoid","permalink":"/docs/policypak/policypak/leastprivilege/bestpractices/examplesavoid","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/leastprivilege/bestpractices/examplesavoid.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"When to Use \u201cDon\u2019t Elevate Open/Save Dialog\u201d","permalink":"/docs/policypak/policypak/leastprivilege/bestpractices/dontelevate"},"next":{"title":"Deeper Dive on File Info","permalink":"/docs/policypak/policypak/leastprivilege/bestpractices/fileinfo"}}');var a=i(474848),s=i(28453);const n={},l="What Not to Do (Some Examples)",r={},c=[];function p(e){const t={h1:"h1",header:"header",p:"p",strong:"strong",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"what-not-to-do-some-examples",children:"What Not to Do (Some Examples)"})}),"\n",(0,a.jsxs)(t.p,{children:["Let's say you want to allow users to install Google Earth on their machines. To make it easy, you could select the application's ",(0,a.jsx)(t.strong,{children:"Signature"})," as the rule condition and then check ",(0,a.jsx)(t.strong,{children:"Apply to child processes"})," (which is the default."]}),"\n",(0,a.jsx)(t.p,{children:"![A screenshot of a computer"}),"\n",(0,a.jsx)(t.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/bestpractices/what_not_to_do_some_examples.webp)"}),"\n",(0,a.jsx)(t.p,{children:"While these settings would ensure that the install would run uninhibited without UAC prompt interruptions, you would also be allowing all applications that have that signature to install as well as allowing additional child processes. The rule as stated would also allow Chrome to install with admin rights, which could make it an attack vector for bad actors.."}),"\n",(0,a.jsx)(t.p,{children:"As such, Endpoint Policy Manager (formerly PolicyPak) Least Privilege Manager editor will give you a warning and a recommendation against attempting this."}),"\n",(0,a.jsx)(t.p,{children:"![A screenshot of a computer"}),"\n",(0,a.jsx)(t.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/bestpractices/what_not_to_do_some_examples_1.webp)"}),"\n",(0,a.jsxs)(t.p,{children:["Saying ",(0,a.jsx)(t.strong,{children:"Yes"})," generates an additional rule match for File info condition enabling you to get more specific than just ",(0,a.jsx)(t.strong,{children:"Signature"})," alone. This is the Endpoint Policy Manager (formerly PolicyPak) Least Privilege Manager Best Practice: ",(0,a.jsx)(t.strong,{children:"Signature Condition"})," and ",(0,a.jsx)(t.strong,{children:"File Info condition"}),". Endpoint Policy Manager (formerly PolicyPak) Least Privilege Manager UI is requesting you create a Combo Rule (more details later.)"]}),"\n",(0,a.jsx)(t.p,{children:"![A screenshot of a computer"}),"\n",(0,a.jsx)(t.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/bestpractices/what_not_to_do_some_examples_2.webp)"}),"\n",(0,a.jsx)(t.p,{children:"Therefore, it is important not to take shortcuts. Size your privilege levels accordingly, allocating the least amount of privilege possible in order to get the job done."}),"\n",(0,a.jsx)(t.p,{children:"Additionally, and similarly, don\u2019t create rules which automatically elevate \u201cEverything by Microsoft by certificate.\u201d Most applications, including most of Windows and Office, are not designed to be running elevated all the time. As such you are breaking applications and opening up to attack vectors."}),"\n",(0,a.jsx)(t.p,{children:"Equally bad is elevating entire programs and/or folders which might not need elevating. For instance, a developer package, Cygwin has hundreds of little utilities in it like."}),"\n",(0,a.jsx)(t.p,{children:"![A screenshot of a computer"}),"\n",(0,a.jsx)(t.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/bestpractices/what_not_to_do_some_examples_3.webp)"}),"\n",(0,a.jsx)(t.p,{children:"But very few require elevation. A common mistake is to elevate all files in the folder making it easy for the admin and for the user."}),"\n",(0,a.jsx)(t.p,{children:"![A screenshot of a computer"}),"\n",(0,a.jsx)(t.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/bestpractices/what_not_to_do_some_examples_4.webp)"}),"\n",(0,a.jsx)(t.p,{children:"However, giving full admin rights on all these utilities, without understanding the ramifications, could open the door to attacks."}),"\n",(0,a.jsx)(t.p,{children:"In summary, use Endpoint Policy Manager (formerly PolicyPak) Least Privilege Manager as its name suggest: for the Least Amount of Privileges required."}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"CAUTION:"})," Avoid taking shortcuts by elevating everything by signature or whole folder- even if it takes a little more work to make the exact rules you need for the least amount of privilege required for users to do their jobs."]})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}}}]);