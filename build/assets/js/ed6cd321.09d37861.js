"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[917117],{28453:(e,o,n)=>{n.d(o,{R:()=>r,x:()=>l});var i=n(296540);const s={},t=i.createContext(s);function r(e){const o=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function l(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(t.Provider,{value:o},e.children)}},658423:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"policypak/troubleshooting/log/manual","title":"How do I manually collect logs if PPLOGS as User or Admin does not launch?","description":"NOTE:  PPLOGs\xa0does not magically stop working, there is always some underlying cause.\xa0 Typically some sort of barrier which prevents it... pplogs\xa0or other tools used in the pplogs process (like reg.exe) from working. If there is something in your environment that is blocking the automated (pplogs) way of gathering log information you can still fetch this information by hand.","source":"@site/docs/policypak/policypak/troubleshooting/log/manual.md","sourceDirName":"policypak/troubleshooting/log","slug":"/policypak/troubleshooting/log/manual","permalink":"/docs/policypak/policypak/troubleshooting/log/manual","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/troubleshooting/log/manual.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Restore Windows 11 Specific Right-Click Context Menu","permalink":"/docs/policypak/policypak/troubleshooting/log/leastprivilege/restorecontextmenu"},"next":{"title":"How can I increase the depth of what Endpoint Policy Manager reports (minidump files).","permalink":"/docs/policypak/policypak/troubleshooting/log/minidumpfiles"}}');var s=n(474848),t=n(28453);const r={},l="How do I manually collect logs if PPLOGS as User or Admin does not launch?",c={},a=[{value:"First, manually collect the information for the ADMIN Logs:",id:"first-manually-collect-the-information-for-the-admin-logs",level:2},{value:"Next, manually collect the information for the USER Logs:",id:"next-manually-collect-the-information-for-the-user-logs",level:2}];function d(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.header,{children:(0,s.jsx)(o.h1,{id:"how-do-i-manually-collect-logs-if-pplogs-as-user-or-admin-does-not-launch",children:"How do I manually collect logs if PPLOGS as User or Admin does not launch?"})}),"\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"NOTE:"}),"  PPLOGs\xa0does not magically stop working, there is always some underlying cause.\xa0 Typically some sort of barrier which prevents it... pplogs\xa0or other tools used in the pplogs process (like reg.exe) from working. If there is something in your environment that is blocking the automated (pplogs) way of gathering log information you can still fetch this information by hand."]}),"\n",(0,s.jsx)(o.h2,{id:"first-manually-collect-the-information-for-the-admin-logs",children:"First, manually collect the information for the ADMIN Logs:"}),"\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"Step 1 \u2013"})," Login as an Administrator to the computer where the issue is occurring then gather the following:"]}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsxs)(o.p,{children:["Copy entire ",(0,s.jsx)(o.code,{children:"%programdata%\\PolicyPak "}),"folder, this folder includes logs, dumps, policy store, and xmldata files."]}),"\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"NOTE:"})," Some of these files cannot be accessed without elevation. The easiest UI way to get them might be to copy the",(0,s.jsx)(o.code,{children:" %programdata%\\PolicyPak"})," folder to Desktop and then approve the elevation when prompted."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"Step 2 \u2013"})," Run Regedit as Administrator, then export the following registry keys if they are present, ignore any keys that do not exist."]}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\PolicyPak\\Client-Side Extensions\\{1659C456-08FC-4359-B125-BB70EE34DD55}"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\Classes\\PPBRURL"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\Classes\\PPBRNURL"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\Clients\\StartMenuInternet"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\Policies\\Google\\Chrome"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\Policies\\Microsoft\\Windows\\Explorer"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\Policies\\Microsoft\\Windows\\System"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\Policies\\PolicyPak"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\PolicyPak"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Ext\\CLSID"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\Microsoft\\Internet Explorer\\Low Rights\\ElevationPolicy \\{123AA0DB-7D32-4E82-9CBB-14E096E802AF}"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\GPExtensions"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKLM\\Software\\RegisteredApplications"})}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"Step 3 \u2013"})," Launch Event Viewer as Administrator:"]}),"\n",(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:'Expand "Applications and Services Logs", right-click on "Netwrix Endpoint Policy Manager (formerly PolicyPak)" event log and choose "Save All Events As\u2026", save the file as'}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:'"PolicyPak.evtx"'})}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:'Expand "Applications and Services Logs" > "Microsoft" > "Windows", right-click on "GroupPolicy" event log and choose "Save All Events As\u2026", save the file as'}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:'"GroupPolicy.evtx"'})}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:'Expand "Windows Logs" then right-click the "Application" log and choose "Save All Events As\u2026" save the file as'}),"\n",(0,s.jsx)(o.p,{children:(0,s.jsx)(o.code,{children:'"Application.evtx".'})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"Step 4 \u2013"})," Lastly, zip up everything you have collected on the ADMIN side as",(0,s.jsx)(o.code,{children:"pplogs_as_admin_SRX#.zip"}),'(substitute your Service request number for "SRX#") then upload to the SUPPORT INBOX on SHAREFILE: ',(0,s.jsx)(o.a,{href:"https://policypak.sharefile.com/share/getinfo/rc857a57f16b4d4b9",children:"https://policypak.sharefile.com/share/getinfo/rc857a57f16b4d4b9"})]}),"\n",(0,s.jsx)(o.h2,{id:"next-manually-collect-the-information-for-the-user-logs",children:"Next, manually collect the information for the USER Logs:"}),"\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"Step 1 \u2013"})," Login as a regular (non-admin) user to the computer where the issue is occurring then gather the following:"]}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Copy entire ",(0,s.jsx)(o.code,{children:"%localappdata%\\PolicyPak"}),", this folder is important for troubleshooting all and any CSE issues."]}),"\n",(0,s.jsxs)(o.li,{children:["Locate and gather any Endpoint Policy Manager log files in the ",(0,s.jsx)(o.code,{children:"%TEMP%, %USERPROFILE%"}),", ",(0,s.jsx)(o.code,{children:"%APPDATA%"}),", and ",(0,s.jsx)(o.code,{children:"%LOCALAPPDATA%"})," folders."]}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"Step 2 \u2013"})," Run Regedit then export the following registry keys if they are present, ignore any keys that do not exist."]}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKCU\\Software\\Mozilla\\Firefox\\Extensions"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKCU\\Software\\Microsoft\\Internet Explorer\\Low Rights\\ElevationPolicy\\{123AA0DB-7D32-4E82-9CBB-14E096E802AF}"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKCU\\Software\\Microsoft\\Internet Explorer\\Main\\EnterpriseMode"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\\"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKCU\\Software\\Microsoft\\Windows\\Shell\\Associations\\UrlAssociations\\http\\UserChoice"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKCU\\Software\\Microsoft\\Windows\\Shell\\Associations\\UrlAssociations\\https\\UserChoice"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKCU\\Software\\Policies\\Microsoft\\Internet Explorer\\Main\\EnterpriseMode"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKCU\\Software\\Policies\\Microsoft\\Windows\\Explorer"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.code,{children:"HKCU\\Software\\PolicyPak"})}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:[(0,s.jsx)(o.strong,{children:"Step 3 \u2013"})," Lastly, zip up everything you have collected on the USER side as ",(0,s.jsx)(o.code,{children:"pplogs_as_user_SRX#.zip"}),' (substitute your Service request number for "SRX#") then upload to the SUPPORT INBOX on SHAREFILE: ',(0,s.jsx)(o.a,{href:"https://policypak.sharefile.com/share/getinfo/rc857a57f16b4d4b9",children:"https://policypak.sharefile.com/share/getinfo/rc857a57f16b4d4b9"})]})]})}function h(e={}){const{wrapper:o}={...(0,t.R)(),...e.components};return o?(0,s.jsx)(o,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);