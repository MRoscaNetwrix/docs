"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[351041],{28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var s=t(296540);const a={},o=s.createContext(a);function i(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(o.Provider,{value:n},e.children)}},669983:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/sqlserverconfigurationmanager-66f648ce3f4bae61426138bc03e03e84.webp"},753154:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"enterpriseauditor/install/application/otherlanguages","title":"Non-English Language Environments","description":"There are specific SQL Server requirements when installing Access Analyzer in a non-English Language environment, specifically when the environment uses a non-Latin alphabet.","source":"@site/docs/accessanalyzer/enterpriseauditor/install/application/otherlanguages.md","sourceDirName":"enterpriseauditor/install/application","slug":"/enterpriseauditor/install/application/otherlanguages","permalink":"/docs/accessanalyzer/enterpriseauditor/install/application/otherlanguages","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/enterpriseauditor/install/application/otherlanguages.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"Access Analyzer Initial Configuration","permalink":"/docs/accessanalyzer/enterpriseauditor/install/application/firstlaunch"},"next":{"title":"Installation & Configuration Overview","permalink":"/docs/accessanalyzer/enterpriseauditor/install/application/overview"}}');var a=t(474848),o=t(28453);const i={},l="Non-English Language Environments",r={},c=[{value:"Requirements",id:"requirements",level:2},{value:"Database &amp; Server Collation Settings",id:"database--server-collation-settings",level:3},{value:"Change Collation at the Database Level",id:"change-collation-at-the-database-level",level:4},{value:"Change Collation at the SQL Server Level",id:"change-collation-at-the-sql-server-level",level:4},{value:"Case Sensitive Collation",id:"case-sensitive-collation",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Resources",id:"resources",level:3}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"non-english-language-environments",children:"Non-English Language Environments"})}),"\n",(0,a.jsx)(n.p,{children:"There are specific SQL Server requirements when installing Access Analyzer in a non-English Language environment, specifically when the environment uses a non-Latin alphabet."}),"\n",(0,a.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,a.jsx)(n.p,{children:"The following collation requirements need to be met prior to the Access Analyzer installation."}),"\n",(0,a.jsx)(n.h3,{id:"database--server-collation-settings",children:"Database & Server Collation Settings"}),"\n",(0,a.jsx)(n.p,{children:"The collation settings at the database level must match what is set at the server level."}),"\n",(0,a.jsx)(n.p,{children:"Symptoms"}),"\n",(0,a.jsx)(n.p,{children:"Common errors that occur are:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Implicit conversion of VARCHAR value to VARCHAR cannot be performed because the collation of the value is unresolved due to a collation conflict.","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Could not find stored procedure ",(0,a.jsx)(n.code,{children:"#SA_ImportObject"})]}),"\n",(0,a.jsxs)(n.li,{children:["Cannot drop the procedure ",(0,a.jsx)(n.code,{children:"#SA_ImportObject"}),", because it does not exist or lack of permission"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Cannot resolve the collation conflict between ",(0,a.jsx)(n.strong,{children:"SQL_Latin1_General_CP1_CI_AS"})," and ",(0,a.jsx)(n.strong,{children:"French_CI_AS"})," in the equal to operation."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Cause"}),"\n",(0,a.jsx)(n.p,{children:"These errors occur because the Access Analyzer solutions use many temporary functions and procedures which in turn use the collation at the server level. Temporary tables created within a stored procedure use the TEMPDB database\u2019s collation instead of the current user database\u2019s collation. Therefore, there will be issues in analysis due to the mismatch."}),"\n",(0,a.jsx)(n.p,{children:"Resolution"}),"\n",(0,a.jsx)(n.p,{children:"The following is a work-around which we use to avoid collation errors. However, when making changes at the SQL Server level, use caution as it actually rebuilds all user/system database objects. If there are schema bound objects (i.e. Constraints), the whole operation will fail. Make sure to have all of the information or scripts needed to recreate the Access Analyzer user\u2019s databases and all of the objects in them. Customers should use a localized version of the SQL Server, and this should not be done in production environments."}),"\n",(0,a.jsx)(n.h4,{id:"change-collation-at-the-database-level",children:"Change Collation at the Database Level"}),"\n",(0,a.jsx)(n.p,{children:"Follow the steps to change the collation at the database level."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Step 1 \u2013"})," Access the Database Properties in SQL Server Management Studio."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"SQL Server Management Studio Database Properties window",src:t(805354).A+"",width:"695",height:"193"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Step 2 \u2013"})," Select ",(0,a.jsx)(n.strong,{children:"Options"})," and set the collation."]}),"\n",(0,a.jsx)(n.p,{children:"Now that the collations match, proceed with Access Analyzer installation."}),"\n",(0,a.jsx)(n.h4,{id:"change-collation-at-the-sql-server-level",children:"Change Collation at the SQL Server Level"}),"\n",(0,a.jsx)(n.p,{children:"Follow the steps to change the collation at the SQL Server level."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"SQL Server Configuration Manager",src:t(669983).A+"",width:"769",height:"338"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Step 1 \u2013"})," Stop the SQL Server service from the Configuration Manager."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Step 2 \u2013"})," Open CMD console as Administrator, and go to the following path (or the path where the binary files are):"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"\u2026\\Microsoft SQL Server\\MSSQL11.MSSQLSERVER\\MSSQL\\Binn\xa0\xa0\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Step 3 \u2013"})," Execute the following command (or whichever collation is needed):"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'sqlservr.exe\xa0\xa0-m -T4022 -T3659 -q "French _CS_AS"\n'})}),"\n",(0,a.jsxs)(n.p,{children:["See the Microsoft ",(0,a.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/sql/relational-databases/collations/collation-and-unicode-support",children:"Collation and Unicode support"})," article for collation matches."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Step 4 \u2013"})," Wait until it finishes and start the SQL Server service again."]}),"\n",(0,a.jsx)(n.p,{children:"Now that the collations match, proceed with Access Analyzer installation."}),"\n",(0,a.jsx)(n.h3,{id:"case-sensitive-collation",children:"Case Sensitive Collation"}),"\n",(0,a.jsxs)(n.p,{children:["Access Analyzer does not support case sensitive collation settings. Case insensitive collations are notated by having ",(0,a.jsx)(n.strong,{children:"CI"})," in the collation, for example ",(0,a.jsx)(n.strong,{children:"Latin1_General_CI_AS"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Cause"}),"\n",(0,a.jsxs)(n.p,{children:["For example, ",(0,a.jsx)(n.code,{children:"SYS.INDEXES"})," will be unable to be found if there was an English install of SQL Server but a Turkish collation which is case sensitive. So ",(0,a.jsx)(n.code,{children:"'SYS.INDEXES != 'sys.indexes' "}),"in the environment."]}),"\n",(0,a.jsx)(n.p,{children:"Resolution"}),"\n",(0,a.jsx)(n.p,{children:"All collation settings must be case insensitive."}),"\n",(0,a.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,a.jsx)(n.p,{children:"The following are possible problems for future consideration."}),"\n",(0,a.jsx)(n.p,{children:"During comparison or joining of columns, collation conflict error occurs in two cases if collation of one column does not match with collation of another column:"}),"\n",(0,a.jsx)(n.p,{children:"This can be generated by the following script:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"CREATE TABLE TestTab  \n(PrimaryKey int PRIMARY KEY,  \nCharCol char(10) COLLATE French_CI_AS,  \nCharCol2 char(10) COLLATE greek_ci_as  \n)  \nINSERT INTO TestTab VALUES (1, 'abc', 'abc')\xa0  \nSELECT * FROM TestTab WHERE CharCol = CharCol2\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Error Returned \u2013 Cannot resolve the collation conflict between ",(0,a.jsx)(n.strong,{children:"Greek_CI_AS"})," and ",(0,a.jsx)(n.strong,{children:"French_CI_AS"})," in the equal to operation."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Resolution \u2013 If the select statement is changed as below, then it would run successfully."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"SELECT * FROM TestTab WHERE CharCol = CharCol2 COLLATE Albanian_CI_AI\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"NOTE:"})," Explicit collation (Albanian_CI_AI) is not one of any column, but after that it will complete successfully. The collation of two columns have not been matched, instead the third rule of collation precedence was implemented. See the Microsoft ",(0,a.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/sql/t-sql/statements/collation-precedence-transact-sql",children:"Collation Precedence"})," article for additional information."]}),"\n",(0,a.jsx)(n.h3,{id:"resources",children:"Resources"}),"\n",(0,a.jsx)(n.p,{children:"The following articles may be of assistance:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Microsoft ",(0,a.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/sql/relational-databases/collations/collation-and-unicode-support",children:"Collation and Unicode support"})," article"]}),"\n",(0,a.jsxs)(n.li,{children:["Microsoft ",(0,a.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/sql/t-sql/statements/collation-precedence-transact-sql",children:"Collation Precedence"})," article"]}),"\n",(0,a.jsxs)(n.li,{children:["Microsoft ",(0,a.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/sql/relational-databases/collations/set-or-change-the-server-collation",children:"Set or change the server collation"})," article"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},805354:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/databasepropertiescollation-b36d1aaac5fa58ffef36674e395fa12e.webp"}}]);