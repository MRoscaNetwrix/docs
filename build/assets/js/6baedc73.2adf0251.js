"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[580816],{28453:(n,e,i)=>{i.d(e,{R:()=>s,x:()=>a});var t=i(296540);const r={},o=t.createContext(r);function s(n){const e=t.useContext(o);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:s(n.components),t.createElement(o.Provider,{value:e},n.children)}},412958:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"auditor/configuration/microsoft365/sharepointonline/modernauth","title":"Using Modern Authentication with SharePoint Online","description":"This option is recommended for organizations that use modern authentication as the identity management approach, having multi-factor authentication (MFA) enabled for their user accounts. In this scenario,Netwrix Auditor will access the cloud-based infrastructure via Microsoft Graph and other modern APIs, being authenticated through a pre-configured Microsoft Entra ID application with appropriate access permissions.","source":"@site/docs/auditor/auditor/configuration/microsoft365/sharepointonline/modernauth.md","sourceDirName":"auditor/configuration/microsoft365/sharepointonline","slug":"/auditor/configuration/microsoft365/sharepointonline/modernauth","permalink":"/docs/auditor/auditor/configuration/microsoft365/sharepointonline/modernauth","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/microsoft365/sharepointonline/modernauth.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Assigning Application Permissions Using Manifest","permalink":"/docs/auditor/auditor/configuration/microsoft365/sharepointonline/manifest"},"next":{"title":"SharePoint Online","permalink":"/docs/auditor/auditor/configuration/microsoft365/sharepointonline/overview"}}');var r=i(474848),o=i(28453);const s={},a="Using Modern Authentication with SharePoint Online",c={},d=[{value:"Configuring Microsoft Entra ID App for Auditing SharePoint Online",id:"configuring-microsoft-entra-id-app-for-auditing-sharepoint-online",level:2},{value:"Creating and registering a new app in Microsoft Entra ID",id:"creating-and-registering-a-new-app-in-microsoft-entra-id",level:3},{value:"Granting required permissions",id:"granting-required-permissions",level:3},{value:"Granting Admin consent to a tenant",id:"granting-admin-consent-to-a-tenant",level:3},{value:"Configuring client secret",id:"configuring-client-secret",level:3},{value:"Obtaining tenant name",id:"obtaining-tenant-name",level:3}];function l(n){const e={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"using-modern-authentication-with-sharepoint-online",children:"Using Modern Authentication with SharePoint Online"})}),"\n",(0,r.jsx)(e.p,{children:"This option is recommended for organizations that use modern authentication as the identity management approach, having multi-factor authentication (MFA) enabled for their user accounts. In this scenario,Netwrix Auditor will access the cloud-based infrastructure via Microsoft Graph and other modern APIs, being authenticated through a pre-configured Microsoft Entra ID application with appropriate access permissions."}),"\n",(0,r.jsx)(e.p,{children:"If you plan to implement such scenario, you should register an Microsoft Entra ID app manually and provide its settings to Auditor when configuring a monitored item."}),"\n",(0,r.jsx)(e.p,{children:"Support for modern authentication will allow you to audit the organizations where MFA is enabled for all users, including service accounts."}),"\n",(0,r.jsx)(e.p,{children:"Required configuration procedure includes several manual steps, as described in the corresponding section:"}),"\n",(0,r.jsx)(e.h2,{id:"configuring-microsoft-entra-id-app-for-auditing-sharepoint-online",children:"Configuring Microsoft Entra ID App for Auditing SharePoint Online"}),"\n",(0,r.jsx)(e.p,{children:"To collect data with modern authentication, you should do the following:"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 1 \u2013"})," Create an Microsoft Entra ID app that will be used for modern authentication. See the ",(0,r.jsx)(e.a,{href:"#Creating-and-registering-a-new-app-in-Microsoft-Entra-ID",children:"Creating and registering a new app in Microsoft Entra ID"})," topic for additional information."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 2 \u2013"})," Grant required permissions to that application using Microsoft Entra ID app manifest. See the ",(0,r.jsx)(e.a,{href:"#Granting-required-permissions",children:"Granting required permissions"})," topic for additional information."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 3 \u2013"})," Configure client secret for that application. See the ",(0,r.jsx)(e.a,{href:"#Configuring-client-secret",children:"Configuring client secret"})," topic for additional information."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 4 \u2013"})," Obtain tenant ID \u2013 you will need it when configuring a monitored item (Office 365 tenant) settings. See the ",(0,r.jsx)(e.a,{href:"#Obtaining-tenant-name",children:"Obtaining tenant name"})," topic for additional information."]}),"\n",(0,r.jsx)(e.h3,{id:"creating-and-registering-a-new-app-in-microsoft-entra-id",children:"Creating and registering a new app in Microsoft Entra ID"}),"\n",(0,r.jsx)(e.p,{children:"You will need to create a dedicated app for each cloud-based data source you plan to audit:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Microsoft Entra ID (formerly Azure AD)"}),"\n",(0,r.jsx)(e.li,{children:"Exchange Online"}),"\n",(0,r.jsx)(e.li,{children:"SharePoint Online"}),"\n",(0,r.jsx)(e.li,{children:"MS\xa0Teams"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"If you plan to audit all of them, you need to create 4 apps."}),"\n",(0,r.jsx)(e.p,{children:"Follow the steps to register a new Microsoft Entra ID application."}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 1 \u2013"})," Sign into the ",(0,r.jsx)(e.strong,{children:"Microsoft 365 Admin Center"})," with your ",(0,r.jsx)(e.em,{children:"Global Administrator"}),", ",(0,r.jsx)(e.em,{children:"Application Administrator"})," or ",(0,r.jsx)(e.em,{children:"Cloud Application Administrator"})," account and go to the ",(0,r.jsx)(e.strong,{children:"Microsoft Entra ID admin center"}),"."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 2 \u2013"})," Under the App registrations section, select ",(0,r.jsx)(e.strong,{children:"New registration"}),"."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 3 \u2013"})," In the Name field, enter the application name."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 4 \u2013"})," In the Supported account types select who can use this application \u2013 use the ",(0,r.jsx)(e.strong,{children:"Accounts in this organizational directory only"})," option."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 5 \u2013"})," Click the ",(0,r.jsx)(e.strong,{children:"Register"})," button. Application ",(0,r.jsx)(e.strong,{children:"Redirect URI"})," is optional, you can leave it blank."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 6 \u2013"})," Your Application (client) ID is now available in the Overview section. Copy it to a safe location."]}),"\n",(0,r.jsxs)(e.p,{children:["See the following Microsoft article for additional information on how to create an application and service principal using Microsoft Entra ID Admin portal: ",(0,r.jsx)(e.a,{href:"https://learn.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal",children:"Create an Microsoft Entra ID application and service principal that can access resources"}),"."]}),"\n",(0,r.jsx)(e.h3,{id:"granting-required-permissions",children:"Granting required permissions"}),"\n",(0,r.jsxs)(e.p,{children:["You need to grant your new application the required API permissions. Microsoft Entra ID applications can be assigned ",(0,r.jsx)(e.em,{children:"Delegated"})," or ",(0,r.jsx)(e.em,{children:"Application"})," permissions:"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.em,{children:"Delegated"})," permissions require a signed-in user present who consents to the permissions every time an API call is sent."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.em,{children:"Application"})," permissions are consented by an administrator once granted."]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["For the newly created app, you should use the ",(0,r.jsx)(e.em,{children:"Application"})," permissions."]}),"\n",(0,r.jsxs)(e.p,{children:["To grant required permissions, assign granular ",(0,r.jsx)(e.em,{children:"Application"})," permissions required for Netwrix Auditor to collect data from the application. To do so, perform the following steps:"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 1 \u2013"})," Go to the ",(0,r.jsx)(e.strong,{children:"App registrations"})," and open the app you created to assign Auditor permissions."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 2 \u2013"})," Go to ",(0,r.jsx)(e.strong,{children:"Manage > API permissions"})," and click ",(0,r.jsx)(e.strong,{children:"Add a permission"})," button."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 3 \u2013"})," Assign the required permissions."]}),"\n",(0,r.jsx)(e.p,{children:"Permission assignment will depend on the data you plan to collect:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Activity data only"}),"\n",(0,r.jsx)(e.li,{children:"Both activity and state-in-time data"}),"\n"]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"To..."}),(0,r.jsx)(e.th,{children:"Requirement"}),(0,r.jsx)(e.th,{children:"Comment"})]})}),(0,r.jsx)(e.tbody,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Collect activity and State-in-Time data"}),(0,r.jsx)(e.td,{children:"Microsoft Entra ID app requires the following Application permissions:   1. Office 365 Management APIs    - ActivityFeed.Read 2. Microsoft Graph    - Application.ReadWrite.All    - Directory.Read.All 3. SharePoint     - Sites.FullControl.All"}),(0,r.jsxs)(e.td,{children:["To learn how to assign required permissions, see the ",(0,r.jsx)(e.a,{href:"#Configuring-Microsoft-Entra-ID-App-for-Auditing-SharePoint-Online",children:"Configuring Microsoft Entra ID App for Auditing SharePoint Online"})," section for additional information.  Application.ReadWrite.All is required for automatic rotation of the certificate. Rotating certificates in the Entra ID application is important for the following reasons:   - Mitigate Risks from Expired Certificates - Enhance Security - Compliance Requirements - Operational Continuity"]})]})})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"NOTE:"})," You can also assign application permissions by editing Microsoft Entra app manifest. See the ",(0,r.jsx)(e.a,{href:"#Using-Modern-Authentication-with-SharePoint-Online",children:"Using Modern Authentication with SharePoint Online"})," topic for additional information on how to assign the required permissions. Information about manifest is also described in the following Microsoft article:\xa0",(0,r.jsx)(e.a,{href:"https://learn.microsoft.com/en-us/azure/active-directory/develop/reference-app-manifest",children:" Microsoft Entra app manifest"}),"."]}),"\n",(0,r.jsx)(e.h3,{id:"granting-admin-consent-to-a-tenant",children:"Granting Admin consent to a tenant"}),"\n",(0,r.jsxs)(e.p,{children:["Go back to the ",(0,r.jsx)(e.strong,{children:"Microsoft Entra ID admin center"})," > ",(0,r.jsx)(e.strong,{children:"Applications"})," > ",(0,r.jsx)(e.strong,{children:"App registrations"})," >  ",(0,r.jsx)(e.strong,{children:"API permissions"})," and click ",(0,r.jsx)(e.strong,{children:"Grant admin consent for"}),"\xa0",(0,r.jsx)(e.em,{children:(0,r.jsx)(e.code,{children:"<tenant name>"})}),".\nWhen prompted to confirm, click ",(0,r.jsx)(e.strong,{children:"Yes"}),"."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"NOTE:"})," For Office 365 permissions, go to ",(0,r.jsx)(e.strong,{children:"Request API Permissions"})," > ",(0,r.jsx)(e.strong,{children:"APIs my organization users"}),' and type "Office 365" in the search bar.']}),"\n",(0,r.jsxs)(e.p,{children:["See the following Microsoft article for additional information on how to create an application and service principal using Microsoft Entra ID Admin portal: ",(0,r.jsx)(e.a,{href:"https://learn.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal",children:"Create an Microsoft Entra application and service principal that can access resources"}),"."]}),"\n",(0,r.jsx)(e.h3,{id:"configuring-client-secret",children:"Configuring client secret"}),"\n",(0,r.jsx)(e.p,{children:"Follow the steps to create a new client secret to be used by the app."}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 1 \u2013"})," Go to ",(0,r.jsx)(e.strong,{children:"Manage"})," > ",(0,r.jsx)(e.strong,{children:"Certificates & secrets"})," and click ",(0,r.jsx)(e.strong,{children:"New client secret"}),"."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 2 \u2013"})," Enter the description. From the expiration options select ",(0,r.jsx)(e.strong,{children:"24 months"}),"."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 3 \u2013"})," Click ",(0,r.jsx)(e.strong,{children:"Add"}),"."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 4 \u2013"})," The new secret will be displayed in the list. Click ",(0,r.jsx)(e.strong,{children:"Copy to clipboard"}),' icon on the "Value" parameter on the right side of the screen.']}),"\n",(0,r.jsxs)(e.p,{children:["See the following Microsoft article for more information on how to add a client secret: ",(0,r.jsx)(e.a,{href:"https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app#add-a-client-secret",children:"Add a client secret"}),"."]}),"\n",(0,r.jsx)(e.h3,{id:"obtaining-tenant-name",children:"Obtaining tenant name"}),"\n",(0,r.jsx)(e.p,{children:"Follow the steps to obtain the tenant name."}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 1 \u2013"})," Navigate to ",(0,r.jsx)(e.strong,{children:"Microsoft Entra ID"})," >  ",(0,r.jsx)(e.strong,{children:"Overview"}),"."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Step 2 \u2013"})," In the ",(0,r.jsx)(e.strong,{children:"Tenant information"})," locate the ",(0,r.jsx)(e.strong,{children:"Primary domain"})," field, copy its value and store to a safe location."]}),"\n",(0,r.jsxs)(e.p,{children:["See the following Microsoft article for additional information on how to obtain tenant name: ",(0,r.jsx)(e.a,{href:"https://learn.microsoft.com/en-us/partner-center/find-ids-and-domain-names",children:"Locate important IDs for a user"}),"."]}),"\n",(0,r.jsxs)(e.p,{children:["Then, create a corresponding monitoring plan in Netwrix Auditor and add an item (Office 365 tenant) to it. See the ",(0,r.jsx)(e.a,{href:"/docs/auditor/auditor/admin/monitoringplans/microsoftentraid/overview",children:"Microsoft Entra ID"})," topic for additional information."]})]})}function h(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(l,{...n})}):l(n)}}}]);