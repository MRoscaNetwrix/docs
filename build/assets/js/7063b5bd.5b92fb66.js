"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[523274],{28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>a});var i=n(296540);const o={},r=i.createContext(o);function s(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(r.Provider,{value:t},e.children)}},234460:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/robotframeworkflaui_flauixpathexample-17ef2b64ef2b275635fd6e7bdf67a458.webp"},318613:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/robotframeworkflaui_flauishowxpath-148e31441d44200a3529669aefac88f1.webp"},998666:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"usercube/integration-guide/connectors/how-tos/interact-gui-robotframework/index","title":"Interact with a GUI Application via Robot Framework","description":"This guide shows how to write a Robot Framework script which interacts with an external application.","source":"@site/docs/usercube_saas/usercube/integration-guide/connectors/how-tos/interact-gui-robotframework/index.md","sourceDirName":"usercube/integration-guide/connectors/how-tos/interact-gui-robotframework","slug":"/usercube/integration-guide/connectors/how-tos/interact-gui-robotframework/","permalink":"/docs/usercube_saas/usercube/integration-guide/connectors/how-tos/interact-gui-robotframework/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/usercube_saas/usercube/integration-guide/connectors/how-tos/interact-gui-robotframework/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"userCubeSaasSidebar","previous":{"title":"Run the HR Demo Application","permalink":"/docs/usercube_saas/usercube/integration-guide/connectors/how-tos/demoapp-hr/"},"next":{"title":"Interact with a Web Page via Robot Framework","permalink":"/docs/usercube_saas/usercube/integration-guide/connectors/how-tos/interact-web-page-robotframework/"}}');var o=n(474848),r=n(28453);const s={},a="Interact with a GUI Application via Robot Framework",l={},d=[{value:"Example: Interacting with an application via a GUI",id:"example-interacting-with-an-application-via-a-gui",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Inspecting tools",id:"inspecting-tools",level:2},{value:"Use Case: Set a file to read-only",id:"use-case-set-a-file-to-read-only",level:2},{value:"Define settings",id:"define-settings",level:3},{value:"Define variables",id:"define-variables",level:3},{value:"Define custom keywords",id:"define-custom-keywords",level:3},{value:"Define mandatory keywords",id:"define-mandatory-keywords",level:3},{value:"Define test cases",id:"define-test-cases",level:3},{value:"Read the full script",id:"read-the-full-script",level:3}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"interact-with-a-gui-application-via-robot-framework",children:"Interact with a GUI Application via Robot Framework"})}),"\n",(0,o.jsx)(t.p,{children:"This guide shows how to write a Robot Framework script which interacts with an external application."}),"\n",(0,o.jsx)(t.h2,{id:"example-interacting-with-an-application-via-a-gui",children:"Example: Interacting with an application via a GUI"}),"\n",(0,o.jsx)(t.p,{children:"Consider an external system that is accessible through a GUI program, and that does not offer an API. In this situation, we can either interact manually with the external system , or with a Robot Framework connection."}),"\n",(0,o.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsxs)(t.p,{children:["This guide will focus only on how to interact with a GUI application. The guide on how to write a Robot Framework script explains the basics of Robot Framework. The basic prerequisites can be found on the Robot Framework connector page. See the ",(0,o.jsx)(t.a,{href:"/docs/usercube_saas/usercube/integration-guide/connectors/how-tos/write-fulfill-robotframework-script/",children:"\nWrite a Robot Framework Script\n"})," and ",(0,o.jsx)(t.a,{href:"/docs/usercube_saas/usercube/integration-guide/connectors/references-connectors/robotframework/",children:"\nRobot Framework\n"})," topics for additional information."]}),"\n",(0,o.jsx)(t.p,{children:"The requirements specific to the Robot Framework FlaUI library are as follows:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["Python 3.7 or 3.8. For Python 3.9, using ",(0,o.jsx)(t.code,{children:"pip install wheel"})," in the command prompt may solve installation errors."]}),"\n",(0,o.jsxs)(t.li,{children:["Robot Framework FlaUI library: use ",(0,o.jsx)(t.code,{children:"pip install --upgrade robotframework-flaui"})," in the command prompt."]}),"\n",(0,o.jsx)(t.li,{children:"The application with the GUI."}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Other Robot Framework libraries can interact with applications. The [desktop part of the zoomba library] can also interact with a program, but requires an appium server."}),"\n",(0,o.jsxs)(t.p,{children:["While not strictly required, it is highly recommended that the ",(0,o.jsx)(t.a,{href:"https://gdatasoftwareag.github.io/robotframework-flaui/keywords/1.6.6.html",children:"Robot Framework FlaUI library documentation"})," be consulted."]}),"\n",(0,o.jsx)(t.h2,{id:"inspecting-tools",children:"Inspecting tools"}),"\n",(0,o.jsxs)(t.p,{children:["Most FlaUI keywords require an XPath locator. These XPaths can be found using the FlaUI inspection tool. Download the ",(0,o.jsx)(t.a,{href:"https://github.com/FlaUI/FlaUInspect/releases",children:"FlaUI inspection tool zip archive"}),", then extract the files to a folder. The inspection tool can be launched simply by running ",(0,o.jsx)(t.code,{children:"FlaUIInspect.exe"}),"."]}),"\n",(0,o.jsx)(t.p,{children:"This tool lets you choose the UIA (UI Automation) version. Picking UIA3 should work in most use cases."}),"\n",(0,o.jsxs)(t.p,{children:["The FlaUI inspection tool shows each window that is open on the computer. To find the element the script is supposed to interact with, it is possible to manually search through the windows, and through the elements. However, the easiest way is to use the Hover Mode, which is accessible in the tool bar by clicking on ",(0,o.jsx)(t.strong,{children:"Mode"})," > ",(0,o.jsx)(t.strong,{children:"Hover Mode (use Ctrl)"}),". To see the XPath, click on ",(0,o.jsx)(t.strong,{children:"Mode"})," > ",(0,o.jsx)(t.strong,{children:"Show XPath"}),"."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Show XPath",src:n(318613).A+"",width:"1714",height:"1350"})}),"\n",(0,o.jsx)(t.p,{children:"To see the XPath of an element, hover over the element, and press control. A red box should appear around the element, and the FlaUI inspection tool should show the element's information. The XPath should be at the bottom left of the FlaUI element."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Highlight Element",src:n(234460).A+"",width:"1717",height:"1356"})}),"\n",(0,o.jsxs)(t.p,{children:["As an example, imagine an application showing a list of files and folders. Targeting a specific file would produce an XPath in the shape of ",(0,o.jsx)(t.code,{children:"/Window/Pane[3]/Pane/Pane[2]/List/Group[1]/ListItem[1]"}),". The important parts of this path are the beginning and the end. The beginning of the XPath specifies the window. The middle part of the XPath, in most cases, is irrelevant."]}),"\n",(0,o.jsxs)(t.p,{children:["The last part of the XPath however, ",(0,o.jsx)(t.code,{children:"/Group[1]/ListItem[1]"}),", is what should be modified to find the right file. ",(0,o.jsx)(t.code,{children:"Group[1]"})," means the element is in the first file group. ",(0,o.jsx)(t.code,{children:"ListItem[1]"})," means the element is the first file of the group. Depending on the file explorer view mode, the XPath may end with ",(0,o.jsx)(t.code,{children:"Edit[1]"}),", which means the targeted element is the name section of the file."]}),"\n",(0,o.jsxs)(t.p,{children:["As the Window's number may change, it should be specified by name. For the Downloads folder, ",(0,o.jsx)(t.code,{children:"Window[@Name='Downloads']"})," specifies the window. The file may not always be at the same position, so it should also be specified. If the file is ",(0,o.jsx)(t.code,{children:"FlaUInspect.exe"}),", it can be specified with ",(0,o.jsx)(t.code,{children:"ListItem[@Name='FlaUInspect.exe']"}),". The Group may also change. It is not easy to find the right group, so the best method is to remove the groups, by right clicking, then selecting ",(0,o.jsx)(t.strong,{children:"Group by"})," > ",(0,o.jsx)(t.strong,{children:"(None)"}),"."]}),"\n",(0,o.jsx)(t.h2,{id:"use-case-set-a-file-to-read-only",children:"Use Case: Set a file to read-only"}),"\n",(0,o.jsx)(t.p,{children:"Consider an HR system that creates a file for each employee. When an employee retires, it may be interesting to set the file to read-only, so that it is not modified by accident. It is possible to set the file to read-only by provisioning it with the Robot Framework."}),"\n",(0,o.jsx)(t.h3,{id:"define-settings",children:"Define settings"}),"\n",(0,o.jsx)(t.p,{children:"As with every other Robot Framework script, the Identity Manager\xa0Robot Framework resource needs to be imported to launch the provisioning. The FlaUI library also needs to be imported to use its keywords."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"\n*** Settings ***\nResource C:/UsercubeDemo/Runtime/UsercubeRobotFramework.resource\nLibrary FlaUILibrary\n\n"})}),"\n",(0,o.jsx)(t.h3,{id:"define-variables",children:"Define variables"}),"\n",(0,o.jsxs)(t.p,{children:["The ",(0,o.jsx)(t.code,{children:"Variables"})," section contains variables that are used in the rest of the script. As the section is at the start of the script, the variables are easy to update. In this case, the folder's name and path are important variables that may be changed."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"\n*** Variables ***\n${FOLDERNAME}  RobotFrameworkIdentity\n${FOLDERPATH}  C:/UsercubeDemo/${FOLDERNAME}\n\n"})}),"\n",(0,o.jsx)(t.h3,{id:"define-custom-keywords",children:"Define custom keywords"}),"\n",(0,o.jsx)(t.p,{children:"To modify a file's properties, the script needs custom keywords that allow the desired actions to be accomplished. In this case, to navigate through the explorer program. These keywords were written with the Windows 10 File Explorer in mind."}),"\n",(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:"Keyword"}),(0,o.jsx)(t.th,{children:"Details"})]})}),(0,o.jsxs)(t.tbody,{children:[(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Open Explorer"}),(0,o.jsxs)(t.td,{children:["Opens and attaches the explorer program to FlaUI. A program can be attached to FlaUI by its name or by its ",(0,o.jsx)(t.code,{children:"Pid"}),", which stands for process identifier. The ",(0,o.jsx)(t.code,{children:"Launch Application"})," keyword returns a ",(0,o.jsx)(t.code,{children:"Pid"}),", however the program may launch multiple processes. In the case of the explorer, it is almost always running, even if no explorer windows are open. The ",(0,o.jsx)(t.code,{children:"Pid"})," returned may not be the correct one. Attaching by the program name seems to work in this case."]})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Open Folder"}),(0,o.jsxs)(t.td,{children:["Opens the folder specified in the ",(0,o.jsx)(t.code,{children:"Variables"})," section. Accessing the address bar is not trivial, as it is not a text field until it is clicked. However, clicking on most elements of the address bar does not open the text field. In this keyword, the icon in the address bar is clicked, which opens the text field."]})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Get File Name"}),(0,o.jsx)(t.td,{children:"Returns the file's name. This allows the computation of the file's name through a keyword instead of an expression, which can make syntax easier."})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Set File To Read Only"}),(0,o.jsx)(t.td,{children:"Sets the file corresponding to the user to read only. This keyword calls the other keywords in the right order, and is used to simplify the readability of the script."})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Open File Properties"}),(0,o.jsx)(t.td,{children:"Right clicks on a file, then opens the file's properties. The right click is on the file's image, but it could be changed to any of the file's fields. Note that changing the folder's view mode or ordering may alter the file's XPath."})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Select Read Only"}),(0,o.jsxs)(t.td,{children:["Selects the read only option. This keyword simply clicks on the radio button, then clicks on the ",(0,o.jsx)(t.code,{children:"Ok"})," button. If the radio button is already ticked, the file will no longer be in read only mode. The script clicks on the ",(0,o.jsx)(t.code,{children:"Ok"})," button as it automatically closes the properties window, unlike the ",(0,o.jsx)(t.code,{children:"Apply"})," button."]})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:"Close Explorer"}),(0,o.jsxs)(t.td,{children:["Clicks on the cross to close the explorer window. It is also possible to close the program with the ",(0,o.jsx)(t.code,{children:"Close Application"})," keyword, however that also closes the background explorer process, so closing only the window is better."]})]})]})]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"\nOpen Explorer\n    Launch Application explorer\n    Attach Application By Name explorer\n    Open Folder\n\nOpen Folder\n    Click  /Window[@Name='File Explorer']/Pane[2]/Pane[3]/ProgressBar/Pane/ToolBar/SplitButton\n    Set Text To Textbox  /Window[@Name='File Explorer']/Pane[2]/Pane[3]/ProgressBar/ComboBox/Edit[@Name='Address']  ${FOLDERPATH}\n    Press Key s'ENTER'\n\nGet File Name\n    [Arguments]  ${order}\n    [return]  ${order['Changes']['Identifier']}.txt\n\nSet File To Read Only\n    [Arguments]  ${order}\n    ${FileName}=  Get File Name  ${order}\n    Open File Properties  ${FileName}\n    Select ReadOnly  ${FileName}\n\nOpen File Properties\n    [Arguments]  ${filename}\n    Right Click  /Window[@Name='${FOLDERNAME}']/Pane[3]/Pane/Pane[2]/List/ListItem[@Name='${filename}']/Image\n    Click  /Menu[@Name='Context']/MenuItem[@Name='Properties']\n\nSelect Read Only\n    [Arguments]  ${filename}\n    Click  /Window[@Name='${filename} Properties']/CheckBox[@Name='Read-only']\n    Click  /Window[@Name='${filename} Properties']/Button[@Name='OK']\n\nClose Explorer\n    Click  /Window[@Name='${FOLDERNAME}']/TitleBar/Button[@Name='Close']\n\n"})}),"\n",(0,o.jsx)(t.h3,{id:"define-mandatory-keywords",children:"Define mandatory keywords"}),"\n",(0,o.jsxs)(t.p,{children:["To provision the system, the script must contain the three mandatory keywords: ",(0,o.jsx)(t.code,{children:"ExecuteAdd"}),", ",(0,o.jsx)(t.code,{children:"ExecuteDelete"}),", and ",(0,o.jsx)(t.code,{children:"ExecuteModify"}),". In this case, only ExecuteDelete is implemented. (It is considered, perhaps foolishly, that employees will not come out of retirement!)"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"\n*** Keywords ***\nExecuteAdd\n    [Arguments]  ${order}\n    Log To Console ExecuteAdd is not implemented\n\nExecuteDelete\n    [Arguments]  ${order}\n    Set File To Read Only  ${order}\n\nExecuteModify\n    [Arguments]  ${order}\n    Log To Console ExecuteModify is not implemented\n\n"})}),"\n",(0,o.jsx)(t.h3,{id:"define-test-cases",children:"Define test cases"}),"\n",(0,o.jsxs)(t.p,{children:["Although the Robot Framework is used for provisioning in Identity Manager, it is most often used for testing, which is why the ",(0,o.jsx)(t.code,{children:"Test Cases"})," section defines what should happen when Identity Manager\xa0starts the Robot Framework task. The ",(0,o.jsx)(t.code,{children:"Launch Provisioning"})," keyword is the one that will fetch the provisioning orders."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"\n*** Test Cases ***\nRun Provisioning \n    Open Explorer\n    Launch Provisioning\n    Close Explorer\n\n"})}),"\n",(0,o.jsx)(t.h3,{id:"read-the-full-script",children:"Read the full script"}),"\n",(0,o.jsx)(t.p,{children:"The full script is as follows:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"\n*** Settings ***\nResource C:/UsercubeDemo/Runtime/UsercubeRobotFramework.resource\nLibrary FlaUILibrary\n\n*** Variables ***\n${FOLDERNAME}  RobotFrameworkIdentity\n${FOLDERPATH}  C:/UsercubeDemo/${FOLDERNAME}\n\n*** Keywords ***\nExecuteAdd\n    [Arguments]  ${order}\n    Log To Console ExecuteAdd is not implemented\n\nExecuteDelete\n    [Arguments]  ${order}\n    Set File To Read Only  ${order}\n\nExecuteModify\n    [Arguments]  ${order}\n    Log To Console ExecuteModify is not implemented\n\nOpen Explorer\n    Launch Application explorer\n    Attach Application By Name explorer\n    Open Folder\n\nOpen Folder\n    Click  /Window[@Name='File Explorer']/Pane[2]/Pane[3]/ProgressBar/Pane/ToolBar/SplitButton\n    Set Text To Textbox  /Window[@Name='File Explorer']/Pane[2]/Pane[3]/ProgressBar/ComboBox/Edit[@Name='Address']  ${FOLDERPATH}\n    Press Key s'ENTER'\n\nGet File Name\n    [Arguments]  ${order}\n    [return]  ${order['Changes']['Identifier']}.txt\n\nSet File To Read Only\n    [Arguments]  ${order}\n    ${FileName}=  Get File Name  ${order}\n    Open File Properties  ${FileName}\n    Select ReadOnly  ${FileName}\n\nOpen File Properties\n    [Arguments]  ${filename}\n    Right Click  /Window[@Name='${FOLDERNAME}']/Pane[3]/Pane/Pane[2]/List/ListItem[@Name='${filename}']/Image\n    Click  /Menu[@Name='Context']/MenuItem[@Name='Properties']\n\nSelect Read Only\n    [Arguments]  ${filename}\n    Click  /Window[@Name='${filename} Properties']/CheckBox[@Name='Read-only']\n    Click  /Window[@Name='${filename} Properties']/Button[@Name='OK']\n\nClose Explorer\n    Click  /Window[@Name='${FOLDERNAME}']/TitleBar/Button[@Name='Close']\n\n*** Test Cases ***\nRun Provisioning \n    Open Explorer\n    Launch Provisioning\n    Close Explorer\n\n"})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);