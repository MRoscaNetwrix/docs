"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[403421],{28453:(e,i,n)=>{n.d(i,{R:()=>s,x:()=>a});var o=n(296540);const r={},t=o.createContext(r);function s(e){const i=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(t.Provider,{value:i},e.children)}},809865:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"auditor/configuration/sharepoint/permissions","title":"Permissions for SharePoint Auditing","description":"Before you start creating a monitoring plan to audit your SharePoint farm, plan for the account that will be used for data collection \u2013 it should meet the requirements listed below. Then you will provide this account in the monitoring plan wizard.","source":"@site/docs/auditor/auditor/configuration/sharepoint/permissions.md","sourceDirName":"auditor/configuration/sharepoint","slug":"/auditor/configuration/sharepoint/permissions","permalink":"/docs/auditor/auditor/configuration/sharepoint/permissions","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/sharepoint/permissions.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"SharePoint","permalink":"/docs/auditor/auditor/configuration/sharepoint/overview"},"next":{"title":"SharePoint Ports","permalink":"/docs/auditor/auditor/configuration/sharepoint/ports"}}');var r=n(474848),t=n(28453);const s={},a="Permissions for SharePoint Auditing",c={},l=[{value:"Assigning &#39;SharePoint_Shell_Access&#39; Role",id:"assigning-sharepoint_shell_access-role",level:2},{value:"Define Log On As a Service Policy",id:"define-log-on-as-a-service-policy",level:2}];function d(e){const i={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.header,{children:(0,r.jsx)(i.h1,{id:"permissions-for-sharepoint-auditing",children:"Permissions for SharePoint Auditing"})}),"\n",(0,r.jsx)(i.p,{children:"Before you start creating a monitoring plan to audit your SharePoint farm, plan for the account that will be used for data collection \u2013 it should meet the requirements listed below. Then you will provide this account in the monitoring plan wizard."}),"\n",(0,r.jsx)(i.p,{children:"Starting with version 9.96, you can use group Managed Service Accounts (gMSA) as data collecting accounts."}),"\n",(0,r.jsxs)(i.p,{children:["For more information on gMSA, refer to ",(0,r.jsx)(i.a,{href:"/docs/auditor/auditor/requirements/gmsa",children:"Use Group Managed Service Account (gMSA)"}),(0,r.jsx)(i.a,{href:"https://docs.microsoft.com/en-us/windows-server/security/group-managed-service-accounts/group-managed-service-accounts-overview",children:"Microsoft documentation"}),"."]}),"\n",(0,r.jsx)(i.p,{children:"These group Managed Service Accounts should meet the related requirements."}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.strong,{children:"On the target SharePoint farm:"})}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:["On the SharePoint server where the Netwrix Auditor Core Service will be deployed: the account must be a member of the local Administrators group.",(0,r.jsx)(i.br,{}),"\n","To learn more about Netwrix Auditor Core Services, refer to ",(0,r.jsx)(i.a,{href:"/docs/auditor/auditor/install/overview",children:"Installation"})," topic."]}),"\n",(0,r.jsxs)(i.li,{children:["On the SQL Server hosting SharePoint database: the SharePoint_Shell_Access role.",(0,r.jsx)(i.br,{}),"\n","See the ",(0,r.jsx)(i.a,{href:"#Assigning-SharePoint_Shell_Access-Role",children:"Assigning 'SharePoint_Shell_Access' Role"})," topic for additional information."]}),"\n",(0,r.jsxs)(i.li,{children:["If you plan to collect state-in-time data from a SharePoint farm, the account should also meet the requirements below:","\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["For site collection processing \u2014 lock status for this account must differ from ",(0,r.jsx)(i.em,{children:"No access"})]}),"\n",(0,r.jsxs)(i.li,{children:["For web application processing \u2014 the following permissions must be assigned to this account:","\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Open items"}),"\n",(0,r.jsx)(i.li,{children:"View items"}),"\n",(0,r.jsx)(i.li,{children:"Browse directories"}),"\n",(0,r.jsx)(i.li,{children:"View pages"}),"\n",(0,r.jsx)(i.li,{children:"Browse user information"}),"\n",(0,r.jsx)(i.li,{children:"Open"}),"\n",(0,r.jsx)(i.li,{children:"Enumerate permissions"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"assigning-sharepoint_shell_access-role",children:"Assigning 'SharePoint_Shell_Access' Role"}),"\n",(0,r.jsx)(i.p,{children:"The account that runs Netwrix Auditor for SharePoint Core Service installation must be granted the SharePoint_Shell_Access role on SharePoint SQL Server configuration database. If you select to deploy the Netwrix Auditor for SharePoint Core Service automatically when configuring auditing in Netwrix Auditor, the installation will be performed under the account specified for data collection."}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["In your SharePoint server, click Start \u2192 Microsoft SharePoint Products ",(0,r.jsx)(i.code,{children:"<version>"})," SharePoint Management Shell."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsx)(i.p,{children:"Execute the following command:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{children:"Add-SPShellAdmin \u2013UserName <domain\\user>\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"define-log-on-as-a-service-policy",children:"Define Log On As a Service Policy"}),"\n",(0,r.jsx)(i.p,{children:"On the SharePoint monitoring plan creation, the Log on as a service policy is automatically defined for the Data Processing Account as a local security policy. However, if you have the Deny log on as a service policy defined locally or on the domain level, the local Log on as a service policy will be reset. In this case, redefine the Deny log on as a service policy through the Local Security Policy console on your computer or on the domain level through the Group Policy Management console."}),"\n",(0,r.jsx)(i.p,{children:"Follow the steps to define log on as a service policy:"}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Step 1 \u2013"})," On the computer where Auditor Server is installed, open the ",(0,r.jsx)(i.strong,{children:"Local Security Policy"})," snap-in: navigate to Start > Windows Administrative Tools and select Local Security Policy."]}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Step 2 \u2013"})," Navigate to ",(0,r.jsx)(i.strong,{children:"Security Settings > Local Policies > User Rights Assignment"})," and locate the ",(0,r.jsx)(i.strong,{children:"Log on as a service"})," policy."]}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Step 3 \u2013"})," Double-click the ",(0,r.jsx)(i.strong,{children:"Log on as a service"})," policy, and click ",(0,r.jsx)(i.strong,{children:"Add User or Group"}),". Specify the account that you want to define this policy for."]}),"\n",(0,r.jsx)(i.p,{children:"The Log On is now defined as a policy."})]})}function h(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);