"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[926866],{28453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>c});var r=n(296540);const i={},t=r.createContext(i);function o(e){const s=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:s},e.children)}},798747:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"enterpriseauditor/requirements/solutions/exchange/mailflow","title":"Exchange Mail-Flow Permissions","description":"The ExchangeMetrics Data Collector collects Mail-Flow metrics from the Exchange Message Tracking Logs on the Exchange servers. Some examples of this include server volume and message size statistics. This data collector utilizes an applet to process and collect summarized metrics from the Message Tracking Log.","source":"@site/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/mailflow.md","sourceDirName":"enterpriseauditor/requirements/solutions/exchange","slug":"/enterpriseauditor/requirements/solutions/exchange/mailflow","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/mailflow","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/mailflow.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"Entra ID Solution","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/entraid"},"next":{"title":"MAPI-Based Data Collector Permissions","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/mapi"}}');var i=n(474848),t=n(28453);const o={},c="Exchange Mail-Flow Permissions",l={},a=[];function d(e){const s={code:"code",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"exchange-mail-flow-permissions",children:"Exchange Mail-Flow Permissions"})}),"\n",(0,i.jsx)(s.p,{children:"The ExchangeMetrics Data Collector collects Mail-Flow metrics from the Exchange Message Tracking Logs on the Exchange servers. Some examples of this include server volume and message size statistics. This data collector utilizes an applet to process and collect summarized metrics from the Message Tracking Log."}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"HUB Metrics Job Group Requirement"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"In addition to the permissions required by the ExchangeMetrics Data Collector, the Connection Profile assigned to the 1. HUB Metrics Job Group requires the following permission and User Rights (based on default settings):"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Member of the local Administrator group on the targeted Exchange server(s) where the Hub Transport service is running"}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Log on as a Service Group Policy:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Go to ",(0,i.jsx)(s.code,{children:"GPedit.msc"})]}),"\n",(0,i.jsx)(s.li,{children:"Go to Computer Configuration > Windows Settings > Security Settings > Local Policies > User Rights"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Applet Permissions"}),"\n",(0,i.jsx)(s.p,{children:"This is required because the ExchangeMetrics Data Collector is an applet-based data collector. It requires"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Member of the local Administrator group on the targeted Exchange server(s)"}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["This grants access to the Message Tracking Logs and the ability to create the ",(0,i.jsx)(s.code,{children:"SA_ExchangeMetricsData"})," folder, which will contain the applet files and the processed message tracking log files stored inside a SQLite database for each day. For example:"]}),"\n",(0,i.jsx)(s.p,{children:"\\ExchangeServerName\\c$\\Program Files\\Microsoft\\Exchange Server\\V14\\TransportRoles\\Logs\\MessageTracking"}),"\n",(0,i.jsx)(s.p,{children:"If there have been additional security or permission modifications on the server(s), the following rights and policies may need to be enabled on the targeted host:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Ensure the Administrator group has been granted Full Control over Message Tracking Log Directories"}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["WMI Control (",(0,i.jsx)(s.code,{children:"wmimgmt.msc"}),") > Right Click Properties > Security"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Security Tab > Root > CIMV2 > Click Security"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Ensure the Administrators group has been assigned:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Execute Methods"}),"\n",(0,i.jsx)(s.li,{children:"Remote Enable"}),"\n",(0,i.jsx)(s.li,{children:"Enable Account"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Local Security Policy (",(0,i.jsx)(s.code,{children:"secpol.msc"}),"):"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Local Policies > User Rights Assignment:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Ensure the \u2018Replace a Process Level Token\u2019 right grants access to Local Service, Network Service, and Administrators"}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Ensure the \u2018Adjust Memory Quotas for a Process\u2019 right grants access to Local Service, Network Service, and Administrators"}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Ensure the \u2018Impersonate a client after authentication\u2019 right grants access to Local Service and Administrators"}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Ensure the Administrators group has been granted the following rights:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Access this computer from a network"}),"\n",(0,i.jsx)(s.li,{children:"Allow Log on Locally"}),"\n",(0,i.jsx)(s.li,{children:"Log on as a batch job"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);