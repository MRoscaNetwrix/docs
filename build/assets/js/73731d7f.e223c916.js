"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[805167],{28453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>o});var s=r(296540);const a={},n=s.createContext(a);function i(e){const t=s.useContext(n);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(n.Provider,{value:t},e.children)}},423490:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"enterpriseauditor/requirements/target/config/databaseazuresql","title":"AzureSQL Target Least Privilege Model","description":"To access the AzureSQL\xa0database, users require the Control permission for the target database. Users with the Control Database permission have access to perform activity scans due to the function leveraged by AzureSQL to return the required audit logs. See the Auditing for Azure SQL Database and Azure Synapse Analytics Microsoft Knowledge Base article for additional information.","source":"@site/docs/accessanalyzer/enterpriseauditor/requirements/target/config/databaseazuresql.md","sourceDirName":"enterpriseauditor/requirements/target/config","slug":"/enterpriseauditor/requirements/target/config/databaseazuresql","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/target/config/databaseazuresql","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/enterpriseauditor/requirements/target/config/databaseazuresql.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"Azure SQL Auditing Configuration","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/target/config/azuresqlaccess"},"next":{"title":"Oracle Target Least Privilege Model","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/target/config/databaseoracle"}}');var a=r(474848),n=r(28453);const i={},o="AzureSQL Target Least Privilege Model",c={},l=[];function d(e){const t={a:"a",em:"em",h1:"h1",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"azuresql-target-least-privilege-model",children:"AzureSQL Target Least Privilege Model"})}),"\n",(0,a.jsxs)(t.p,{children:["To access the AzureSQL\xa0database, users require the Control permission for the target database. Users with the Control Database permission have access to perform activity scans due to the function leveraged by AzureSQL to return the required audit logs. See the ",(0,a.jsx)(t.a,{href:"https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview?view=azuresql",children:"Auditing for Azure SQL Database and Azure Synapse Analytics"})," Microsoft Knowledge Base article for additional information."]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.em,{children:(0,a.jsx)(t.strong,{children:"RECOMMENDED:"})})," It is recommended to create a new user when leveraging a least privilege access model to access the AzureSQL\xa0database because the user must exist in the master database and all target database(s). A least privilege access model is one that uses the bare minimum privileges required to carry out collections for the AzureSQL data collector."]}),"\n",(0,a.jsx)(t.p,{children:"The following role and permission are required for the Least Privilege Model:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"db_datareader role"}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"View Database Performance State permission"}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Control permission on target database(s)"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"NOTE:"})," Control permission must be granted on any database you wish to collect data for."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"Follow the steps to configure the least privilege access model for AzureSQL\xa0collections."}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Step 1 \u2013"})," To login with the user, run the following script against the master database:"]}),"\n",(0,a.jsx)(t.p,{children:"CREATE LOGIN LPAUser WITH PASSWORD = [insert password]"}),"\n",(0,a.jsx)(t.p,{children:"CREATE USER LPAUser FROM LOGIN LPAUser"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Step 2 \u2013"})," Create the user in the target database with the following script:"]}),"\n",(0,a.jsx)(t.p,{children:"CREATE USER LPAUser FROM LOGIN LPAUser"}),"\n",(0,a.jsx)(t.p,{children:"Once complete, confirm that the newly created user exists in the instance of the master database and the target database before proceeding to the next step."}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Step 3 \u2013"})," Run the following script against the target database to apply the db_datareader role:"]}),"\n",(0,a.jsx)(t.p,{children:"EXEC sp_addrolemember N\u2019db_datareader\u2019, N\u2019LPAUser\u2019"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Step 4 \u2013"})," Apply the View Database State Permission against the target database with the following script:"]}),"\n",(0,a.jsx)(t.p,{children:"GRANT VIEW DATABASE PERFORMANCE STATE TO LPAUSER"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Step 5 \u2013"})," Grant the control permission with the following script:"]}),"\n",(0,a.jsx)(t.p,{children:"GRANT CONTROL ON DATABASE"}),"\n",(0,a.jsx)(t.p,{children:"The user is granted Control permission based on the least privilege access model."})]})}function u(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);