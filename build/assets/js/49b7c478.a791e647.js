"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[182299],{28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var t=i(296540);const s={},r=t.createContext(s);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:n},e.children)}},129279:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"ndc/configuration/configinfrastructure/spomodernauth","title":"Accessing SharePoint Online Using Modern Authentication","description":"This option is recommended for organizations that use modern authentication as the identity management approach, having multi-factor authentication (MFA) enabled for their user accounts. In this scenario, Netwrix Data Classification will access the cloud-based infrastructure via Microsoft Graph and other modern APIs, being authenticated through a pre-configured Azure AD application with appropriate access permissions.","source":"@site/docs/dataclassification/ndc/configuration/configinfrastructure/spomodernauth.md","sourceDirName":"ndc/configuration/configinfrastructure","slug":"/ndc/configuration/configinfrastructure/spomodernauth","permalink":"/docs/dataclassification/ndc/configuration/configinfrastructure/spomodernauth","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/dataclassification/ndc/configuration/configinfrastructure/spomodernauth.md","tags":[],"version":"current","frontMatter":{},"sidebar":"dataClassificationSidebar","previous":{"title":"Configuring defaults","permalink":"/docs/dataclassification/ndc/configuration/configinfrastructure/spodefaults"},"next":{"title":"Configuring subsite and list processing","permalink":"/docs/dataclassification/ndc/configuration/configinfrastructure/sposubsiteandlistprocessing"}}');var s=i(474848),r=i(28453);const a={},o="Accessing SharePoint Online Using Modern Authentication",c={},l=[{value:"Step 1: Prepare an Application Certificate",id:"step-1-prepare-an-application-certificate",level:2},{value:"Step 2: Create and Register a New App in Azure AD",id:"step-2-create-and-register-a-new-app-in-azure-ad",level:2},{value:"Step 3: Grant Required Permissions",id:"step-3-grant-required-permissions",level:2},{value:"Step 4: Configure Certificates &amp; Secrets",id:"step-4-configure-certificates--secrets",level:2},{value:"Step 5: Obtain Tenant ID",id:"step-5-obtain-tenant-id",level:2}];function d(e){const n={a:"a",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"accessing-sharepoint-online-using-modern-authentication",children:"Accessing SharePoint Online Using Modern Authentication"})}),"\n",(0,s.jsx)(n.p,{children:"This option is recommended for organizations that use modern authentication as the identity management approach, having multi-factor authentication (MFA) enabled for their user accounts. In this scenario, Netwrix Data Classification will access the cloud-based infrastructure via Microsoft Graph and other modern APIs, being authenticated through a pre-configured Azure AD application with appropriate access permissions."}),"\n",(0,s.jsx)(n.p,{children:"So, if you plan to implement such scenario, you should register an Azure AD app manually and provide its settings to Netwrix Data Classification when configuring a monitored item."}),"\n",(0,s.jsx)(n.h2,{id:"step-1-prepare-an-application-certificate",children:"Step 1: Prepare an Application Certificate"}),"\n",(0,s.jsx)(n.p,{children:"Prepare application certificate as follows:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Create (or load) an IIS certificate on NDC Server (recommended)."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"NOTE:"})," This certificate should be installed for the local machine so that it can be accessed by Netwrix Data Classification and other services."]}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Export the certificate (.CER file):"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Open the certificate in IIS management console."}),"\n",(0,s.jsxs)(n.li,{children:["Go to the ",(0,s.jsx)(n.strong,{children:"Details"})," tab."]}),"\n",(0,s.jsxs)(n.li,{children:["Select ",(0,s.jsx)(n.strong,{children:"Copy to File"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"NOTE:"})}),"\n",(0,s.jsx)(n.p,{children:"Do not export private key."}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsxs)(n.li,{children:["Set file type to ",(0,s.jsx)(n.em,{children:"DER-encoded CER"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-2-create-and-register-a-new-app-in-azure-ad",children:"Step 2: Create and Register a New App in Azure AD"}),"\n",(0,s.jsx)(n.p,{children:"To register a new Azure AD application, do the following:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Sign into the ",(0,s.jsx)(n.strong,{children:"Microsoft 365"})," ",(0,s.jsx)(n.strong,{children:"Admin Center"})," (with your ",(0,s.jsx)(n.em,{children:"Global Administrator"}),", ",(0,s.jsx)(n.em,{children:"Application Administrator"})," or ",(0,s.jsx)(n.em,{children:"Cloud Application Administrator"})," account)."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Search for and select the ",(0,s.jsx)(n.strong,{children:"Azure Active Directory admin center"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Under the Azure Directory select the ",(0,s.jsx)(n.strong,{children:"App registrations"})," section."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Select ",(0,s.jsx)(n.strong,{children:"New registration"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.strong,{children:"Name"})," field, enter the application name."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.strong,{children:"Supported account types"})," select who can use this application \u2013 use the ",(0,s.jsx)(n.strong,{children:"Accounts in this organizational directory only"})," option."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Click the ",(0,s.jsx)(n.strong,{children:"Register"})," button."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"NOTE:"})," Application redirect URl is optional, you can leave it blank on this step."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Copy your application ID from the ",(0,s.jsx)(n.strong,{children:"Overview"})," section it to a safe location."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-3-grant-required-permissions",children:"Step 3: Grant Required Permissions"}),"\n",(0,s.jsx)(n.p,{children:"Next, you need to grant your new application the required API permissions."}),"\n",(0,s.jsxs)(n.p,{children:["Azure AD applications can be assigned ",(0,s.jsx)(n.em,{children:"Delegated"})," or ",(0,s.jsx)(n.em,{children:"Application"})," permissions:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"Delegated"})," permissions require a signed-in user present who consents to the permissions every time an API call is sent."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"Application"})," permissions are consented by an administrator once granted."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["For the newly created app, you should use ",(0,s.jsx)(n.em,{children:"Application"})," permissions."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"NOTE:"})," By default, a new application is granted one delegated permission for ",(0,s.jsx)(n.strong,{children:"Microsoft Graph API"})," \u2013 ",(0,s.jsx)(n.strong,{children:"User.Read"}),". It is not required and can be removed."]}),"\n",(0,s.jsx)(n.p,{children:"Do the following:"}),"\n",(0,s.jsx)(n.p,{children:"When found, click on the entry and proceed with adding the necessary permissions. The steps from here on remain the same, so in most cases you would need the Application permissions entry, and the relevant set of permissions therein."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Select the relevant entries, hit the Add permissions."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["On the ",(0,s.jsx)(n.strong,{children:"Request API permissions"}),"\u2192Microsoft APIs pane, scroll down and select SharePoint."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Select Application Permissions."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Apply the following permissions:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Graph \u2013 Application permissions (With admin consent granted)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Sites.FullControl.All (Crawling)"}),"\n",(0,s.jsx)(n.li,{children:"Sites.Read.All"}),"\n",(0,s.jsx)(n.li,{children:"Sites.ReadWrite.All"}),"\n",(0,s.jsx)(n.li,{children:"TermStore.ReadWrite.All"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"SharePoint \u2013 Application permissions (With admin consent granted)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Sites.FullControl.All (Crawling)"}),"\n",(0,s.jsx)(n.li,{children:"TermStore.ReadWrite.All (Term Set access)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"NOTE:"})," For taxonomy manager to full operate you must also make the user \u201capp@sharepoint\u201d a taxonomy admin (or group admin)."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Click ",(0,s.jsx)(n.strong,{children:"Add permissions"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-4-configure-certificates--secrets",children:"Step 4: Configure Certificates & Secrets"}),"\n",(0,s.jsx)(n.p,{children:"Having configured the app, you can upload its application certificate."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["In the app settings, click ",(0,s.jsx)(n.strong,{children:"Certificates & secrets"})," and select ",(0,s.jsx)(n.strong,{children:"Upload certificate"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Upload the .CER file you prepared at ",(0,s.jsx)(n.a,{href:"#Step-1-Prepare-an-Application-Certificate",children:"Step 1: Prepare an Application Certificate"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Copy the certificate thumbprint to a safe location."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-5-obtain-tenant-id",children:"Step 5: Obtain Tenant ID"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Open ",(0,s.jsx)(n.strong,{children:"Azure Active Directory admin center"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Select ",(0,s.jsx)(n.strong,{children:"Azure Active Directory > Overview"})," section for the required Exchange Online organization."]}),"\n",(0,s.jsxs)(n.li,{children:["Locate the ",(0,s.jsx)(n.strong,{children:"Tenant ID"})," and copy it to a safe location."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);