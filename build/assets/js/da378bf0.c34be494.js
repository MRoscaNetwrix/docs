"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[854368],{28453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>o});var i=t(296540);const s={},r=i.createContext(s);function d(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),i.createElement(r.Provider,{value:n},e.children)}},863952:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"auditor/configuration/exchange/overview","title":"Exchange","description":"Netwrix Auditor relies on native logs for collecting audit data. Therefore, successful change and access auditing requires a certain configuration of native audit settings in the audited environment and on the Auditor console computer. Configuring your IT infrastructure may also include enabling certain built-in Windows services, etc. Proper audit configuration is required to ensure audit data integrity, otherwise your change reports may contain warnings, errors or incomplete audit data.","source":"@site/docs/auditor/auditor/configuration/exchange/overview.md","sourceDirName":"auditor/configuration/exchange","slug":"/auditor/configuration/exchange/overview","permalink":"/docs/auditor/auditor/configuration/exchange/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/exchange/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Configure Exchange for Monitoring Mailbox Access","permalink":"/docs/auditor/auditor/configuration/exchange/mailboxacccess"},"next":{"title":"Permissions for Exchange Auditing","permalink":"/docs/auditor/auditor/configuration/exchange/permissions"}}');var s=t(474848),r=t(28453);const d={},o="Exchange",c={},a=[{value:"Monitored Object Types, Actions, and Attributes",id:"monitored-object-types-actions-and-attributes",level:2},{value:"Non-Owner Mailbox Access",id:"non-owner-mailbox-access",level:2}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"exchange",children:"Exchange"})}),"\n",(0,s.jsx)(n.p,{children:"Netwrix Auditor relies on native logs for collecting audit data. Therefore, successful change and access auditing requires a certain configuration of native audit settings in the audited environment and on the Auditor console computer. Configuring your IT infrastructure may also include enabling certain built-in Windows services, etc. Proper audit configuration is required to ensure audit data integrity, otherwise your change reports may contain warnings, errors or incomplete audit data."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"CAUTION:"})," Folder associated with Netwrix Auditor must be excluded from antivirus scanning. See the ",(0,s.jsx)(n.a,{href:"https://helpcenter.netwrix.com/bundle/z-kb-articles-salesforce/page/kA04u0000000HirCAE.html",children:"Antivirus Exclusions for Netwrix Auditor"})," knowledge base article for additional information."]}),"\n",(0,s.jsx)(n.p,{children:"You can configure your\xa0IT Infrastructure for monitoring in one of the following ways:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Automatically through a monitoring plan \u2013 This is a recommended method. If you select to automatically configure audit in the target environment, your current audit settings will be checked on each data collection and adjusted if necessary."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Manually \u2013 Native audit settings must be adjusted manually to ensure collecting comprehensive and reliable audit data. You can enable Auditor to continually enforce the relevant audit policies or configure them manually:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"In the Exchange environment:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install the ADSI Edit utility to the server from which configuration is performed if it is not a domain controller"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The following policies must be set to ",(0,s.jsx)(n.em,{children:'"Success"'})," for the effective domain controllers policy:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Audit account management"}),"\n",(0,s.jsx)(n.li,{children:"Audit directory service access"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The Audit logon events policy must be set to ",(0,s.jsx)(n.em,{children:'"Success"'})," (or ",(0,s.jsx)(n.em,{children:'"Success"'}),' and "',(0,s.jsx)(n.em,{children:'Failure"'}),") for the effective domain controllers policy."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"The Advanced audit policy settings can be configured instead of basic."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The Maximum Security event log size must be set to 4GB. The retention method of the Security event log must be set to ",(0,s.jsx)(n.em,{children:"\u201cOverwrite events as needed.\u201d"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Auto archiving must be enabled to prevent audit data loss if log overwrites occur."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"The Object-level audit settings must be configured for the Domain, Configuration and Schema partitions."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The AD tombstoneLifetime attribute must be set to ",(0,s.jsx)(n.em,{children:'"730"'}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If you have an on-premises Exchange server 2019, 2016, 2013 or 2010 in your Active Directory domain, consider that some changes can be made via that Exchange server. To be able to audit and report who made those changes, you should configure the Exchange Administrator Audit Logging (AAL) settings, as described in the ",(0,s.jsx)(n.a,{href:"/docs/auditor/auditor/configuration/exchange/auditlog",children:"Exchange Administrator Audit Logging Settings"})," topic."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The Administrator Audit Logging settings must be configured (only required for Exchange 2019, 2016, 2013 or 2010). See the ",(0,s.jsx)(n.a,{href:"/docs/auditor/auditor/configuration/exchange/auditlog",children:"Exchange Administrator Audit Logging Settings"})," topic for additional information."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"In order to audit mailbox access, native audit logging must be enabled for user, shared, equipment, linked, and room mailboxes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Access types: administrator , delegate user"}),"\n",(0,s.jsx)(n.li,{children:"Actions: Update, Move, MoveToDeletedItems, SoftDelete, HardDelete, FolderBind, SendAs, SendOnBehalf, Create"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If you want to track non-owner access, configure mailbox monitoring. See the ",(0,s.jsx)(n.a,{href:"/docs/auditor/auditor/configuration/exchange/mailboxacccess",children:"Configure Exchange for Monitoring Mailbox Access"})," topic for additional information."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"On the Auditor console computer:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If you have enabled automatic log backup for the Security log of your domain controller, you can instruct Auditor to clear the old backups automatically. For that, use the ",(0,s.jsx)(n.strong,{children:"CleanAutoBackupLogs"})," registry key, as described in the ",(0,s.jsx)(n.a,{href:"/docs/auditor/auditor/configuration/activedirectory/registrykey",children:"Active Directory Registry Key Configuration"})," topic."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:(0,s.jsx)(n.strong,{children:"RECOMMENDED:"})})," Adjust retention period for the backup files accordingly (default is ",(0,s.jsx)(n.strong,{children:"50"})," hours). See the ",(0,s.jsx)(n.a,{href:"/docs/auditor/auditor/configuration/activedirectory/securitylog",children:"Adjust Security Event Log Size and Retention"})," topic."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["To provide for event data collection, the Secondary Logon service must be up and running . Open ",(0,s.jsx)(n.strong,{children:"Administrative Tools"})," > ",(0,s.jsx)(n.strong,{children:"Services"}),", right-click the ",(0,s.jsx)(n.strong,{children:"Secondary Logon"})," service and on the ",(0,s.jsx)(n.strong,{children:"General"})," tab make sure that Startup type for this service is other than ",(0,s.jsx)(n.em,{children:"Disabled"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Remember,"})," for Exchange auditing, do the following:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Configure Data Collecting Account, as described in the ",(0,s.jsx)(n.a,{href:"/docs/auditor/auditor/admin/monitoringplans/dataaccounts",children:"Data Collecting Account"})," topic."]}),"\n",(0,s.jsxs)(n.li,{children:["Configure required protocols and ports, as described in the ",(0,s.jsx)(n.a,{href:"/docs/auditor/auditor/configuration/exchange/ports",children:"Exchange Ports"})," topic."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"monitored-object-types-actions-and-attributes",children:"Monitored Object Types, Actions, and Attributes"}),"\n",(0,s.jsx)(n.p,{children:"Netwrix Auditor tracks changes that have been made to all Exchange server object classes and attributes. The list of Exchange object classes is version-dependent."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The list of schema changes for Exchange 2013 can be found in the following Microsoft article: ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/exchange/exchange-2013-active-directory-schema-changes-exchange-2013-help",children:"https://learn.microsoft.com/en-us/exchange/exchange-2013-active-directory-schema-changes-exchange-2013-help"})]}),"\n",(0,s.jsxs)(n.li,{children:["The list of schema changes for Exchange 2016 can be found in the following Microsoft article: ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/exchange/plan-and-deploy/active-directory/ad-schema-changes?view=exchserver-2016",children:"https://learn.microsoft.com/en-us/exchange/plan-and-deploy/active-directory/ad-schema-changes?view=exchserver-2016"})]}),"\n",(0,s.jsxs)(n.li,{children:["The list of schema changes for Exchange 2019 can be found in the following Microsoft article: ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/exchange/plan-and-deploy/active-directory/ad-schema-changes?view=exchserver-2019",children:"https://learn.microsoft.com/en-us/exchange/plan-and-deploy/active-directory/ad-schema-changes?view=exchserver-2019"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"non-owner-mailbox-access",children:"Non-Owner Mailbox Access"}),"\n",(0,s.jsx)(n.p,{children:"Netwrix Auditor can monitor non-owner access to mailboxes in on-premises Exchange organization. The following mailbox types will be monitored by default:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"UserMailbox"}),"\n",(0,s.jsx)(n.li,{children:"EquipmentMailbox"}),"\n",(0,s.jsx)(n.li,{children:"LinkedMailbox"}),"\n",(0,s.jsx)(n.li,{children:"RoomMailbox"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Here is the list of actions captured:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Item"}),(0,s.jsx)(n.th,{children:"Action"}),(0,s.jsx)(n.th,{children:"Audited"}),(0,s.jsx)(n.th,{children:"How this change is reported by the product"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Emails and Folders"}),(0,s.jsx)(n.td,{children:"New email"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["The message was created in \\Drafts folder with subject ",(0,s.jsx)(n.code,{children:"<...>"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"A user with Send as or Send on behalf permissions tried to send an email"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Message located in Root with subject ",(0,s.jsx)(n.code,{children:"<...>"})," was queued for delivery to IPM.Message."]}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Delete email"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Message with subject ",(0,s.jsx)(n.code,{children:"<...>"})," was moved from folder \\Drafts to folder \\Deleted Items."]}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Move email to another folder"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Message with subject ",(0,s.jsx)(n.code,{children:"<...>"})," was moved from folder ",(0,s.jsx)(n.code,{children:"<...>"})," to folder ",(0,s.jsx)(n.code,{children:"<...>"}),"."]}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Create rules for emails"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"\u2014"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Email read attempt"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"\u2014"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"New folder"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"\u2014"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Open folder"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["The folder ",(0,s.jsx)(n.code,{children:"<...>"})," was opened."]}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Delete folder"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Folder ",(0,s.jsx)(n.code,{children:"<...>"})," was moved from folder ",(0,s.jsx)(n.code,{children:"<...>"})," to folder \\Deleted Items."]}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Empty folder"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["The folder ",(0,s.jsx)(n.code,{children:"<...>"})," was opened."]}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Edit folder permissions"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"\u2014"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Calendar"}),(0,s.jsx)(n.td,{children:"New event"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Message was created in \\Calendar with subject ",(0,s.jsx)(n.code,{children:"<...>"}),"."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Event read attempt"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"\u2014"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Edit event"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Message located in \\Calendar with subject ",(0,s.jsx)(n.code,{children:"<...>"})," was modified."]}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Delete event"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Message with subject ",(0,s.jsx)(n.code,{children:"<...>"})," was moved from folder \\Calendar to folder \\Deleted Items."]}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"People"}),(0,s.jsx)(n.td,{children:"New contact"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Message was created in \\Contacts\\Recipient Cache with subject ",(0,s.jsx)(n.code,{children:"<contact name>"}),"."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Contact read attempt"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Folder \\Contacts\\Recipient Cache was opened."}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Edit contact"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"\u2014"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Delete contact"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Message with subject ",(0,s.jsx)(n.code,{children:"<...>"})," was moved from folder \\Contacts to folder \\Deleted Items."]}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Tasks"}),(0,s.jsx)(n.td,{children:"New task"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Message was created in \\Tasks with subject ",(0,s.jsx)(n.code,{children:"<...>"}),"."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Task read attempt"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"\u2014"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Edit task"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Message located in \\Tasks with subject ",(0,s.jsx)(n.code,{children:"<...>"})," was modified."]}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Delete task"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Message with subject ",(0,s.jsx)(n.code,{children:"<...>"})," was moved from folder \\Tasks to folder \\Deleted Items."]}),(0,s.jsx)(n.td,{})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);