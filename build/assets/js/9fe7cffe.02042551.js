"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[963702],{28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var i=n(296540);const s={},r=i.createContext(s);function o(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:t},e.children)}},840319:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/cterasyslogmsg-1b30b599570fe74bd2fdee2989e13c8c.webp"},851496:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"config/ctera/Activity","title":"CTERA Activity Auditing Configuration","description":"The Netwrix Activity Monitor can be configured to monitor file system activity on CTERA Edge Filer appliances.","source":"@site/docs/activitymonitor/config/ctera/Activity.md","sourceDirName":"config/ctera","slug":"/config/ctera/Activity","permalink":"/docs/activitymonitor/config/ctera/Activity","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/activitymonitor/config/ctera/Activity.md","tags":[],"version":"current","frontMatter":{},"sidebar":"activityMonitorSidebar","previous":{"title":"Getting Data from NTP for AD Activity Reporting","permalink":"/docs/activitymonitor/config/activedirectory/threatprevention"},"next":{"title":"Dell Celerra & Dell VNX Activity Auditing Configuration","permalink":"/docs/activitymonitor/config/dellcelerravnx/Activity"}}');var s=n(474848),r=n(28453);const o={},a="CTERA Activity Auditing Configuration",l={},c=[{value:"Provision Account",id:"provision-account",level:2},{value:"Enable Auditing on\xa0CTERA Edge Filer",id:"enable-auditing-onctera-edge-filer",level:2},{value:"Enable Services on\xa0CTERA Portal",id:"enable-services-onctera-portal",level:2},{value:"Enable the Messaging Service",id:"enable-the-messaging-service",level:3},{value:"Enable the Edge Filer Syslog Service",id:"enable-the-edge-filer-syslog-service",level:3}];function d(e){const t={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"ctera-activity-auditing-configuration",children:"CTERA Activity Auditing Configuration"})}),"\n",(0,s.jsx)(t.p,{children:"The Netwrix Activity Monitor can be configured to monitor file system activity on CTERA Edge Filer appliances."}),"\n",(0,s.jsx)(t.p,{children:"The monitoring process relies on the SMB auditing feature of the CTERA Edge Filer. A local audit log file is generated by each Edge Filer and audit events from these files are collected by the\xa0CTERA Portal. The CTERA Portal forwards the events from the Edge Filers to the Activity Monitor Agent through the Messaging and Syslog services."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Monitoring Process -CTERA Portal",src:n(840319).A+"",width:"1185",height:"431"})}),"\n",(0,s.jsx)(t.p,{children:"To prepare CTERA for monitoring:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Provision an account."}),"\n",(0,s.jsx)(t.li,{children:"Enable auditing on the CTERA Edge Filer."}),"\n",(0,s.jsx)(t.li,{children:"Enable Messaging and Edge Filer Syslog services on the CTERA Portal."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"provision-account",children:"Provision Account"}),"\n",(0,s.jsxs)(t.p,{children:["Netwrix Activity Monitor uses the CTERA Portal API to retrieve information about portals, Edge Filers, their auditing configurations, and optionally to enable syslog forwarding automatically. To access the API, Activity Monitor requires an account in the CTERA Portal with the ",(0,s.jsx)(t.strong,{children:"Read Only Administrator"})," role."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 1 \u2013"})," Log in to the CTERA Portal web interface. In the global administration view, select ",(0,s.jsx)(t.strong,{children:"Users"})," > ",(0,s.jsx)(t.strong,{children:"Administrators"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 2 \u2013"})," Click New Admin, specify a username, password, email, and the ",(0,s.jsx)(t.strong,{children:"Read Only Administrator"})," role."]}),"\n",(0,s.jsx)(t.p,{children:"This credential will then be used when configuring the Activity Monitor Agent to monitor the CTERA portal."}),"\n",(0,s.jsx)(t.h2,{id:"enable-auditing-onctera-edge-filer",children:"Enable Auditing on\xa0CTERA Edge Filer"}),"\n",(0,s.jsx)(t.p,{children:"The CTERA Edge Filer can generate audit log events for the SMB access. Audit events are stored in a local file and then forwarded to the CTERA Portal for further processing. The audit log is disabled by default and must be enabled."}),"\n",(0,s.jsx)(t.p,{children:"Follow the steps to enable SMB audit logs."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 1 \u2013"})," Log in to the Edge Filer web interface. In the Configuration view, select ",(0,s.jsx)(t.strong,{children:"Logs"})," > ",(0,s.jsx)(t.strong,{children:"Audit Logs"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 2 \u2013"})," Select the ",(0,s.jsx)(t.strong,{children:"Enable CIFS/SMB Audit Logs"})," option."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 3 \u2013"})," Specify a share to save the audit logs in the Save log files option. If a share does not exist, create a new one first."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"NOTE:"})," CTERA recommends that SMB Audit logging is saved to a folder that is local on the Edge Filer and not synced to the cloud. For example, in the root of vol1, which can then be used to create a share."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 4 \u2013"})," Adjust the ",(0,s.jsx)(t.strong,{children:"Keep closed files for"})," parameter. Otherwise, use the default value."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 5 \u2013"})," Check all events except the ",(0,s.jsx)(t.strong,{children:"Read Extended Attributes"})," event in Events to log list. If you do not require monitoring of ",(0,s.jsx)(t.em,{children:"Directory Read/List"})," operations, which typically generate a high volume of data, uncheck the ",(0,s.jsx)(t.strong,{children:"List Folder Read Data"})," event."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 6 \u2013"})," Make sure that ",(0,s.jsx)(t.strong,{children:"Log permission changes in human readable format"})," is unchecked."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 7 \u2013"})," Click ",(0,s.jsx)(t.strong,{children:"Save"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["To verify that the auditing is enabled, generate some file activity and check the share specified in ",(0,s.jsx)(t.strong,{children:"Step 3"}),". An audit log should be created in ",(0,s.jsx)(t.code,{children:"audit.log.dir/audit.log"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["See the ",(0,s.jsx)(t.a,{href:"https://kb.ctera.com/docs/auditing-smb-file-access-5",children:"Auditing SMB File Access"})," article in the CTERA Edge Filer Administrator Guide for additional information."]}),"\n",(0,s.jsx)(t.h2,{id:"enable-services-onctera-portal",children:"Enable Services on\xa0CTERA Portal"}),"\n",(0,s.jsx)(t.p,{children:"The following services must be enabled and configured on the\xa0CTERA Portal:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"CTERA Messaging Service -\u2013 Enables sending notifications to various consumers, including the Edge\xa0Filer Syslog service."}),"\n",(0,s.jsx)(t.li,{children:"CTERA Edge Filer Syslog Service \u2013 Consolidates audit events from Edge\xa0Filers and sends them to the Activity Monitor Agent and other consumers."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Both services are disabled by default and must be enabled. The Messaging service must be enabled first."}),"\n",(0,s.jsx)(t.h3,{id:"enable-the-messaging-service",children:"Enable the Messaging Service"}),"\n",(0,s.jsxs)(t.p,{children:["See the ",(0,s.jsx)(t.a,{href:"https://kb.ctera.com/docs/managing-the-ctera-messaging-service-2",children:"Managing the CTERA Messaging Service"})," article in the CTERA Portal Global Administrator Guide for additional information on requirements and recommendations for production and POC environments."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 1 \u2013"})," Before setting up the Messaging Service in the web interface, first initialize the messaging components with the following CLI command:"]}),"\n",(0,s.jsx)(t.p,{children:"set /settings/platformServicesSetting/enabled true"}),"\n",(0,s.jsx)(t.p,{children:"Initialization takes a few minutes."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 2 \u2013"})," Log in to the CTERA Portal web interface. In the global administration view, select ",(0,s.jsx)(t.strong,{children:"Services"})," > ",(0,s.jsx)(t.strong,{children:"Messaging"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 3 \u2013"})," To add a new messaging server, click ",(0,s.jsx)(t.strong,{children:"Add Messaging Servers"}),". Select the servers to use as messaging servers. Click ",(0,s.jsx)(t.strong,{children:"Save"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"NOTE:"})," In a production environment, designate three servers as messaging servers. In a small or test environment, CTERA supports using a single messaging server, typically the main database server. However, in all other cases, exactly three servers must be assigned as messaging servers.",(0,s.jsx)(t.br,{}),"\n","See the ",(0,s.jsx)(t.a,{href:"https://kb.ctera.com/docs/managing-the-ctera-messaging-service-2",children:"Managing the CTERA Messaging Service"})," article for additional information."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 4 \u2013"})," Deploying the messaging service takes a few minutes. The status will change to STARTING and then to ACTIVE. Wait until the status is ACTIVE before proceeding to the next step."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"NOTE:"})," If the status does not change to ACTIVE, the log files need to be collected from ",(0,s.jsx)(t.code,{children:"/usr/local/lib/ctera/work/logs/services"})," directory.",(0,s.jsx)(t.br,{}),"\n","See the ",(0,s.jsx)(t.a,{href:"https://kb.ctera.com/docs/setting-up-the-ctera-messaging-service-2#ctera-messaging-service-logs",children:"CTERA Messaging Service Logs"})," article for additional information."]}),"\n",(0,s.jsx)(t.h3,{id:"enable-the-edge-filer-syslog-service",children:"Enable the Edge Filer Syslog Service"}),"\n",(0,s.jsxs)(t.p,{children:["Ensure the ",(0,s.jsx)(t.a,{href:"#Enable-the-Messaging-Service",children:"Enable the Messaging Service"})," section is completed before proceeding to enable the Syslog Service."]}),"\n",(0,s.jsx)(t.p,{children:"The Edge Filer Syslog Service can be configured in two ways:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Automatically by the Activity Monitor using the API from CTERA Portal."}),"\n",(0,s.jsx)(t.li,{children:"Manually using the CTERA Portal web interface."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["It is recommended to configure the service automatically. With automatic configuration, the Activity Monitor\xa0Agent will apply the settings and perform periodic checks to ensure correctness. To enable automatic configuration, use the ",(0,s.jsx)(t.strong,{children:"Enable Edge Filer Syslog auditing"})," option in the host properties and specify credentials to access the CTERA Portal API."]}),"\n",(0,s.jsx)(t.p,{children:"Follow the steps to configure the Edge\xa0Filer Syslog Service manually."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 1 \u2013"})," Configure monitoring of the CTERA Portal in the Activity Monitor Console."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 2 \u2013"}),"  Add a CTERA host on the Monitored Hosts page and specify the portal host name, username, password, and complete the wizard."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 3 \u2013"})," Enable the newly added host."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 4 \u2013"})," Copy a TLS certificate file, ",(0,s.jsx)(t.code,{children:"certca.pem"}),", from ",(0,s.jsx)(t.code,{children:"%ProgramData%\\Netwrix\\Activity Monitor\\Agent\\Data"})," folder on the agent's server."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 5 \u2013"})," Log in to the CTERA Portal web interface. In the global administration view, select ",(0,s.jsx)(t.strong,{children:"Services"})," > ",(0,s.jsx)(t.strong,{children:"Edge Filer\xa0Syslog"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 6 \u2013"})," Click ",(0,s.jsx)(t.strong,{children:"Add a Server"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 7 \u2013"})," Specify the ",(0,s.jsx)(t.strong,{children:"FQDN of the agent"})," or ",(0,s.jsx)(t.strong,{children:"IP address"})," in the Addressfield."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 8 \u2013"})," Specify 4488 in the Port field."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"NOTE:"})," The default port can be changed in the properties of the agent on the CTERA page."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 9 \u2013"})," Change the protocol to ",(0,s.jsx)(t.strong,{children:"TCP/TLS"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 10 \u2013"})," Click ",(0,s.jsx)(t.strong,{children:"Server Certificate"})," > ",(0,s.jsx)(t.strong,{children:"Select File"})," to upload the file collected at Step 2."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 11 \u2013"})," Click ",(0,s.jsx)(t.strong,{children:"Save"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Step 12 \u2013"})," Click ",(0,s.jsx)(t.strong,{children:"Enable"})," in the status bar."]}),"\n",(0,s.jsxs)(t.p,{children:["The status will change to STARTING. If the CTERA Portal manages to connect to the Activity Monitor Agent, the status changes to ACTIVE. If not, review the error message and check ",(0,s.jsx)(t.strong,{children:"Logs & Alerts"})," > ",(0,s.jsx)(t.strong,{children:"System Log"})," for details."]}),"\n",(0,s.jsxs)(t.p,{children:["See the ",(0,s.jsx)(t.a,{href:"https://kb.ctera.com/docs/managing-the-edge-filer-syslong-service",children:"Managing the Edge Filer Syslog Service"})," article in the CTERA Portal Global Administrator Guide for additional information."]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);