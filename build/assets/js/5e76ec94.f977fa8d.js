"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[830933],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>r});var a=t(296540);const i={},o=a.createContext(i);function s(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),a.createElement(o.Provider,{value:n},e.children)}},93415:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"threatprevention/admin/configuration/databasemaintenance/overview","title":"Database Maintenance Window","description":"The database maintenance function grooms the NVMonitorData database to optimize performance. It automatically deletes or archives data aged beyond a specified threshold. The threshold can be set per Event Type, per Analytics, and/or per Policy. While all three options can be enabled with different retention periods, the Event Type maintenance settings take precedence over Policy maintenance settings where the selected policy employs that event type.","source":"@site/docs/threatprevention/threatprevention/admin/configuration/databasemaintenance/overview.md","sourceDirName":"threatprevention/admin/configuration/databasemaintenance","slug":"/threatprevention/admin/configuration/databasemaintenance/overview","permalink":"/docs/threatprevention/threatprevention/admin/configuration/databasemaintenance/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/threatprevention/threatprevention/admin/configuration/databasemaintenance/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"threatPreventionSidebar","previous":{"title":"Enable Database Maintenance","permalink":"/docs/threatprevention/threatprevention/admin/configuration/databasemaintenance/enable"},"next":{"title":"Schedule Database Maintenance","permalink":"/docs/threatprevention/threatprevention/admin/configuration/databasemaintenance/schedule"}}');var i=t(474848),o=t(28453);const s={},r="Database Maintenance Window",c={},d=[{value:"Event Type Tab",id:"event-type-tab",level:2},{value:"Analytics Tab",id:"analytics-tab",level:2},{value:"Policy Tab",id:"policy-tab",level:2}];function l(e){const n={a:"a",blockquote:"blockquote",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"database-maintenance-window",children:"Database Maintenance Window"})}),"\n",(0,i.jsx)(n.p,{children:"The database maintenance function grooms the NVMonitorData database to optimize performance. It automatically deletes or archives data aged beyond a specified threshold. The threshold can be set per Event Type, per Analytics, and/or per Policy. While all three options can be enabled with different retention periods, the Event Type maintenance settings take precedence over Policy maintenance settings where the selected policy employs that event type."}),"\n",(0,i.jsx)(n.p,{children:"If you choose to archive data instead of deleting it, then you have to specify a database for data archiving. For this database, you can also define settings to delete data aged beyond a specified threshold."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"Remember,"})," See the Database Maintenance Permission details in the ",(0,i.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/requirements/dbmaintenance",children:"Database Maintenance Feature Requirements"})," topic."]}),"\n",(0,i.jsxs)(n.p,{children:["See the ",(0,i.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/databasemaintenance/storedprocedures",children:"Stored Procedures"})," topic for additional information on stored procedures Threat Prevention uses on its SQL Server databases."]}),"\n",(0,i.jsx)(n.p,{children:"Follow the steps to configure database maintenance."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 1 \u2013"})," Click ",(0,i.jsx)(n.strong,{children:"Configuration"})," > ",(0,i.jsx)(n.strong,{children:"Database"})," > ",(0,i.jsx)(n.strong,{children:"Maintenance"})," on the menu. The Database Maintenance window is displayed."]}),"\n",(0,i.jsx)(n.p,{children:"This window is only available to Threat Prevention administrators."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Threat Prevention WinConsole Warning window",src:t(113921).A+"",width:"493",height:"208"})}),"\n",(0,i.jsx)(n.p,{children:"The database maintenance feature is only available if the SQL Server Agent service is running on the SQL Server host. A warning message displays instead of the Database Maintenance window if this service is not running."}),"\n",(0,i.jsxs)(n.p,{children:["To enable the service, go to ",(0,i.jsx)(n.strong,{children:"Start"})," > ",(0,i.jsx)(n.strong,{children:"Administrative Tools"})," > ",(0,i.jsx)(n.strong,{children:"Services"})," interface and start the SQL Server Agent (MSSQLSERVER)."]}),"\n",(0,i.jsx)(n.p,{children:"When the SQL Server Agent service is running, the Database Maintenance window opens."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Database Maintenance window",src:t(568909).A+"",width:"864",height:"758"})}),"\n",(0,i.jsx)(n.p,{children:"The following information is displayed at the top of the window:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Database Information:"}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Server \u2013 SQL Server where database maintenance is performed"}),"\n",(0,i.jsx)(n.li,{children:"Database \u2013 Name of the database"}),"\n",(0,i.jsx)(n.li,{children:"Database Size \u2013 Current size of the database"}),"\n",(0,i.jsx)(n.li,{children:"Oldest Data \u2013 Date of the oldest data in the database"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Job Information:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Last run \u2013 Date timestamp when the last database maintenance job was executed"}),"\n",(0,i.jsxs)(n.li,{children:["Status \u2013 Status of the job. Different statuses are:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Idle \u2013 Indicates that no database maintenance task is running"}),"\n",(0,i.jsx)(n.li,{children:"Succeeded \u2013 Indicates that the most recent job finished without error"}),"\n",(0,i.jsx)(n.li,{children:"Running \u2013 Indicates that a job is running"}),"\n",(0,i.jsx)(n.li,{children:"Error \u2013 Indicates that the job started but terminated on an error"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Running Step \u2013 During job execution, this field populates with the step being executed"}),"\n",(0,i.jsx)(n.li,{children:"Elapsed Time \u2013 Overall elapsed time of job execution"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The Refresh button in the upper-right corner refreshes this database and job information."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 2 \u2013"}),"  On the Event Type, Analytics, and/or Policy tabs, enable maintenance for all or some of the options. See the ",(0,i.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/databasemaintenance/enable",children:"Enable Database Maintenance"})," topic for additional information."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 3 \u2013"})," On the Schedule tab, set the frequency and time when the database maintenance job runs. See the ",(0,i.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/databasemaintenance/schedule",children:"Schedule Database Maintenance"})," topic for additional information."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 4 \u2013"})," To use the Move operation, you must specify a database on the Archive DB tab. You can also define settings to delete data aged beyond a specified threshold from the archive database. See the ",(0,i.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/admin/configuration/databasemaintenance/archive",children:"Archive Data"})," topic for additional information."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 5 \u2013"})," Click ",(0,i.jsx)(n.strong,{children:"Save"})," to save the changes."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"RECOMMENDED:"})})," The SQL Server databases should be configured to use 'Simple Recovery Mode' in the ",(0,i.jsx)(n.a,{href:"/docs/threatprevention/threatprevention/requirements/sqlserver",children:"SQL Server Requirements"}),". This configuration has a direct impact on the size of the transaction log during database maintenance delete tasks. If Simple Recovery Mode is not configured on the databases, the transaction log may get quite large during delete tasks."]}),"\n",(0,i.jsx)(n.h2,{id:"event-type-tab",children:"Event Type Tab"}),"\n",(0,i.jsx)(n.p,{children:"The Event Type tab is displayed by default when the Database Maintenance window opens."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Database Maintenance window - Event Type tab",src:t(554517).A+"",width:"856",height:"498"})}),"\n",(0,i.jsxs)(n.p,{children:["Check the ",(0,i.jsx)(n.strong,{children:"Enabled"})," box at the top to set database maintenance by event type. The table contains the following information:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Enable \u2013 Checked box indicates database maintenance is enabled for the event type"}),"\n",(0,i.jsxs)(n.li,{children:["Event Type \u2013 Data is grouped by the following event types:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Active Directory \u2013 Configure maintenance for all event data collected by the Active Directory Changes, Active Directory Lockdown, Active Directory Read Monitoring, AD Replication Monitoring, AD Replication Lockdown, Effective Group Membership, FSMO Role Monitoring, GPO Setting Lockdown, GPO Setting Changes, LSASS Guardian \u2013 Monitor, LSASS Guardian \u2013 Protect, and Password Enforcement Event Types"}),"\n",(0,i.jsx)(n.li,{children:"Authentications \u2013 Configure maintenance for all event data collected by the Authentication Monitoring and Authentication Lockdown Event Types. This does not apply to Analytics policy data"}),"\n",(0,i.jsx)(n.li,{children:"Exchange \u2013 Configure maintenance for all event data collected by the Exchange Changes and Exchange Lockdown Event Types"}),"\n",(0,i.jsx)(n.li,{children:"File System \u2013 Configure maintenance for all event data collected by the File System Changes, File System Lockdown, and File System Enterprise Auditor Event Types"}),"\n",(0,i.jsx)(n.li,{children:"LDAP \u2013 Configure maintenance for all event data collected by the LDAP Monitoring, LDAP Lockdown, and LDAP Bind Monitoring Event Types"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Operation \u2013 The operation set for the event type: Move (for archiving) or Delete"}),"\n",(0,i.jsx)(n.li,{children:"Retention Period \u2013 The age of data to be retained when the database maintenance job is executed for the event type"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"analytics-tab",children:"Analytics Tab"}),"\n",(0,i.jsxs)(n.p,{children:["Click the ",(0,i.jsx)(n.strong,{children:"Analytics"})," tab on the Database Maintenance window."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Database Maintenance window - Analytics tab",src:t(667373).A+"",width:"850",height:"492"})}),"\n",(0,i.jsxs)(n.p,{children:["Check the ",(0,i.jsx)(n.strong,{children:"Enabled"})," box at the top to set database maintenance by analytic. The table contains the following information:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Enable \u2013 Checked box indicates database maintenance is enabled for the analytic"}),"\n",(0,i.jsx)(n.li,{children:"Analytic Name \u2013 Name of each analytic"}),"\n",(0,i.jsx)(n.li,{children:"Operation \u2013 The operation set for the analytic: Move (for archiving) or Delete"}),"\n",(0,i.jsx)(n.li,{children:"Retention Period \u2013 The age of data to be retained when the database maintenance job is executed for the analytic"}),"\n",(0,i.jsx)(n.li,{children:"Incident Count \u2013 The number of incidents recorded in the database for each analytic"}),"\n",(0,i.jsx)(n.li,{children:"Event Count \u2013 The number of events for the recorded incidents in the database for each analytic"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The rows in the table can be sorted alphanumerically by the Analytic Name, Incident Count, or Event Count column."}),"\n",(0,i.jsx)(n.p,{children:"Above the table is a cumulative count of:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Total Incidents \u2013 The number of incidents recorded in the database for all analytics"}),"\n",(0,i.jsx)(n.li,{children:"Total Events \u2013 The number of events for the recorded incidents in the database for all analytics"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"policy-tab",children:"Policy Tab"}),"\n",(0,i.jsxs)(n.p,{children:["Click the ",(0,i.jsx)(n.strong,{children:"Policy"})," tab on the Database Maintenance window."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Database Maintenance window - Policy tab",src:t(900777).A+"",width:"858",height:"502"})}),"\n",(0,i.jsxs)(n.p,{children:["Check the ",(0,i.jsx)(n.strong,{children:"Enabled"})," box at the top to set database maintenance by policy. The table contains the following information:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Enable \u2013 Checked box indicates database maintenance is enabled for the policy"}),"\n",(0,i.jsx)(n.li,{children:"Policy \u2013 Name of each policy you have created. Policies are listed in alphanumeric order, first live policies (whether or not they are enabled) and then the deleted policies are listed"}),"\n",(0,i.jsx)(n.li,{children:"Operation \u2013 The operation set for the policy: Move (for archiving) or Delete"}),"\n",(0,i.jsx)(n.li,{children:"Retention Period \u2013 The age of data to be retained when the database maintenance job is executed for the policy"}),"\n",(0,i.jsx)(n.li,{children:"Event Count \u2013 The number of events for the recorded incidents in the database for each policy"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Above the table is a cumulative count of:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Total Events \u2013 The number of events for the recorded incidents in the database for all policies"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The rows in the table can be sorted alphanumerically by the Policy or Event Count column. Deleted policies are always listed after all other policies."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},113921:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/warning-4af13e2818eb135aa855efece3657de1.webp"},554517:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/eventtype-d07f28054ac605d72def95fe7416375e.webp"},568909:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/databasemaintenance-2eeecbc4797c0b690a6c5931fbe13057.webp"},667373:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/analytics-41c10b709d33f4948621b68510c7c098.webp"},900777:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/policy-122be908faf0fbb9e6902c1485957df1.webp"}}]);