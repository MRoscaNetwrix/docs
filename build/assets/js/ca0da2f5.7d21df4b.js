"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[163633],{28453:(e,t,i)=>{i.d(t,{R:()=>s,x:()=>d});var o=i(296540);const r={},n=o.createContext(r);function s(e){const t=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(n.Provider,{value:t},e.children)}},651254:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"auditor/addon/siem/overview","title":"SIEM","description":"Netwrix Auditor Add-on for SIEM helps you to get most from your SIEM investment. This topic focuses on the AlienVault USM SIEM\xa0solution.","source":"@site/docs/auditor/auditor/addon/siem/overview.md","sourceDirName":"auditor/addon/siem","slug":"/auditor/addon/siem/overview","permalink":"/docs/auditor/auditor/addon/siem/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/addon/siem/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Integration Event Log Fields","permalink":"/docs/auditor/auditor/addon/siem/integrationeventlog"},"next":{"title":"Automate Add-On Execution","permalink":"/docs/auditor/auditor/addon/siemcefexport/automate"}}');var r=i(474848),n=i(28453);const s={},d="SIEM",a={},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Netwrix Auditor Activity Records to Event Log Add-on",id:"netwrix-auditor-activity-records-to-event-log-add-on",level:3},{value:"Netwrix Auditor Alerts to Event Log Add-on",id:"netwrix-auditor-alerts-to-event-log-add-on",level:3},{value:"Compatibility Notice",id:"compatibility-notice",level:2},{value:"Activity Records to Event Log Add-on",id:"activity-records-to-event-log-add-on",level:2},{value:"Netwrix Auditor Alerts to Event Log Add-on",id:"netwrix-auditor-alerts-to-event-log-add-on-1",level:2}];function c(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"siem",children:"SIEM"})}),"\n",(0,r.jsx)(t.p,{children:"Netwrix Auditor Add-on for SIEM helps you to get most from your SIEM investment. This topic focuses on the AlienVault USM SIEM\xa0solution."}),"\n",(0,r.jsx)(t.p,{children:"The add-on works in collaboration with Netwrix Auditor, supplying additional data that augments the data collected by the SIEM solution."}),"\n",(0,r.jsx)(t.p,{children:"The add-on enriches your SIEM data with actionable context in human-readable format, including the before and after values for every change and data access attempt, both failed and successful. Aggregating data into a single audit trail simplifies analysis, makes your SIEM more cost effective, and helps you keep tabs on your IT infrastructure."}),"\n",(0,r.jsx)(t.p,{children:"Implemented as a PowerShell script, this add-on facilitates the audit data transition from Netwrix Auditor to the SIEM solution. All you have to do is provide connection details and schedule the script for execution."}),"\n",(0,r.jsx)(t.p,{children:"On a high level, the add-on works as follows:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"The add-on connects to the Netwrix Auditor server and retrieves audit data using the Netwrix Auditor Integration API."}),"\n",(0,r.jsx)(t.li,{children:"The add-on processes Netwrix Auditor-compatible data (Activity Records) into log events that work as input for the SIEM solution. Each event contains the user account, action, time, and other details."}),"\n",(0,r.jsxs)(t.li,{children:["The add-on creates a special Windows event log named ",(0,r.jsx)(t.strong,{children:"Netwrix_Auditor_Integration"})," and stores events there. These events are structured and ready for integration with the SIEM solution."]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["See the ",(0,r.jsx)(t.a,{href:"/docs/auditor/auditor/api/overview",children:"Integration API"})," topic for additional information on the structure of the Activity Record and the capabilities of the Netwrix Auditor Integration API."]}),"\n",(0,r.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(t.p,{children:"Before running the add-on, ensure that all the necessary components and policies are configured as follows:"}),"\n",(0,r.jsx)(t.h3,{id:"netwrix-auditor-activity-records-to-event-log-add-on",children:"Netwrix Auditor Activity Records to Event Log Add-on"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"On..."}),(0,r.jsx)(t.th,{children:"Ensure that..."})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"The Auditor side"}),(0,r.jsxs)(t.td,{children:["- Auditor version is ",(0,r.jsx)(t.strong,{children:"9.8"})," or later.  - The Audit Database settings are configured in Auditor Server. - The TCP 9699 port (default Integration API port) is open for inbound connections.   The user retrieving data from the Audit Database is granted the Global reviewer role in Auditor or is a member of the Netwrix Auditor Client Users group.  Alternatively, you can grant the Global administrator role or add the user to the Netwrix Auditor Administrators group. In this case, this user will have the most extended permissions in the product."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"The computer where the script will be executed"}),(0,r.jsxs)(t.td,{children:["- PowerShell ",(0,r.jsx)(t.strong,{children:"3.0"})," or later must be installed. - .NET ",(0,r.jsx)(t.strong,{children:"4.5"})," or later must be installed.  - Execution policy for powershell scripts is set to ",(0,r.jsx)(t.em,{children:'"Unrestricted"'}),". Run Windows PowerShell as administrator and execute the following command:  Set-ExecutionPolicy Unrestricted - The user running the script is granted the write permission on the script folder\u2014the add-on creates a special .bin file with the last exported event.  - The user running the script must be a member of the Domain Users group. - At least the first script run should be performed under the account with elevated privileges, as it will be necessary to create event log file and perform other required operations."]})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"netwrix-auditor-alerts-to-event-log-add-on",children:"Netwrix Auditor Alerts to Event Log Add-on"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"On..."}),(0,r.jsx)(t.th,{children:"Ensure that..."})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"The Auditor Server side"}),(0,r.jsxs)(t.td,{children:["- Auditor version is ",(0,r.jsx)(t.strong,{children:"9.96"})," or 10. - The alert response action settings in Auditor Server are configured as follows:   - ",(0,r.jsx)(t.strong,{children:"Take action when alert occurs"})," is switched ",(0,r.jsx)(t.strong,{children:"ON"}),"   - ",(0,r.jsx)(t.strong,{children:"Run"})," field contains the path to Windows PowserShell: ",(0,r.jsx)(t.code,{children:"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"}),"   - ",(0,r.jsx)(t.strong,{children:"With parameters"})," field contains the required parameters, including the path to ",(0,r.jsx)(t.strong,{children:"Netwrix_Auditor_Alerts_to_Event_Log_Add-on.ps1"})," file. Example:        ",(0,r.jsx)(t.code,{children:"-File C:\\Netwrix_Auditor_Add-on_for_SIEM\\Netwrix_Auditor_Alerts_to_Event_Log_Add-on.ps1 -NetwrixPathToCsvData"})," For details on script parameters, see the section below.    - ",(0,r.jsx)(t.strong,{children:"Write data to CSV file"})," option is selected   - ",(0,r.jsx)(t.strong,{children:"Command line preview"})," looks like this:       ",(0,r.jsx)(t.code,{children:"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -File C:\\Netwrix_Auditor_Add-on_for_SIEM\\Netwrix_Auditor_Alerts_to_Event_Log_Add-on.ps1 -NetwrixPathToCsvData {CsvFile}"})," - By default, the executable file will be launched under the ",(0,r.jsx)(t.em,{children:"LocalSystem"})," account. If you want to use another account, make sure it has ",(0,r.jsx)(t.strong,{children:"Log on as batch job"})," privilege on Netwrix Auditor server.   You may want to perform the test run after configuring the script as the alert response action. If so, consider that current user account (logged on to Auditor client) must have local ",(0,r.jsx)(t.strong,{children:"Administrator"})," privileges on AuditorServer where the executable file is located."]})]})})]}),"\n",(0,r.jsx)(t.h2,{id:"compatibility-notice",children:"Compatibility Notice"}),"\n",(0,r.jsx)(t.p,{children:"Make sure to check your product version, and then review and update your add-ons and scripts leveraging Netwrix Auditor Integration API. Download the latest add-on version in the Add-on Store."}),"\n",(0,r.jsx)(t.h2,{id:"activity-records-to-event-log-add-on",children:"Activity Records to Event Log Add-on"}),"\n",(0,r.jsx)(t.p,{children:"On a high level, this add-on works as follows:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"The add-on connects to the Auditor server and retrieves audit data using the Integration API."}),"\n",(0,r.jsx)(t.li,{children:"The add-on processes Netwrix Auditor -compatible data (Activity Records) into log events that work as input for Windows event log. Each event contains the user account, action, time, and other details."}),"\n",(0,r.jsx)(t.li,{children:"The add-on creates a special Windows event log named Netwrix_Auditor_Integration and stores events there. These events are structured and ready for integration with Windows event log."}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["For more information on the structure of the Activity Record and the capabilities of the Netwrix Auditor Integration API, refer to ",(0,r.jsx)(t.a,{href:"/docs/auditor/auditor/api/overview",children:"Integration API"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"netwrix-auditor-alerts-to-event-log-add-on-1",children:"Netwrix Auditor Alerts to Event Log Add-on"}),"\n",(0,r.jsx)(t.p,{children:"This add-on works as response action to the alert, as follows:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["The administrator enables and configured response action for selected alert, as described in the following topic: ",(0,r.jsx)(t.a,{href:"/docs/auditor/auditor/admin/alertsettings/responseaction",children:"Configure a Response Action for Alert"}),". Make sure to provide correct path to the script file and to select the Write data to CSV file option."]}),"\n",(0,r.jsx)(t.li,{children:"When the alert is triggered, the script starts - it retrieves audit data (activity record fields) from the CSV file and processes it into log events. Each event contains the user account, action, time, and other details."}),"\n",(0,r.jsx)(t.li,{children:"The add-on creates a special Windows event log named Netwrix_Auditor_Integration and stores events there. These events are structured and ready for integration with SIEM system."}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["See the ",(0,r.jsx)(t.a,{href:"/docs/auditor/auditor/admin/alertsettings/responseaction",children:"Configure a Response Action for Alert"})," topic\xa0for additional information on the alert response actions and CSV file."]})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);