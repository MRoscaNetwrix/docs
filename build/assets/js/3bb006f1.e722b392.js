"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[242859],{28453:(e,t,o)=>{o.d(t,{R:()=>s,x:()=>r});var i=o(296540);const a={},n=i.createContext(a);function s(e){const t=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(n.Provider,{value:t},e.children)}},688619:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>s,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"policypak/video/applicationsettings/variables","title":"Using Environment Variables in Paks","description":"You might want to deliver settings based upon Windows\' environment variables. There are several types of Env variables, and in this demo, we show you how to find them and some use cases.","source":"@site/docs/policypak/policypak/video/applicationsettings/variables.md","sourceDirName":"policypak/video/applicationsettings","slug":"/policypak/video/applicationsettings/variables","permalink":"/docs/policypak/policypak/video/applicationsettings/variables","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/video/applicationsettings/variables.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Keeping Application Settings Manager and Paks up to date","permalink":"/docs/policypak/policypak/video/applicationsettings/uptodate"},"next":{"title":"Endpoint Policy Manager and VMware Horizon View \u2013 Dedicated VDI","permalink":"/docs/policypak/policypak/video/applicationsettings/vdi/dedicated"}}');var a=o(474848),n=o(28453);const s={},r="Using Environment Variables in Paks",l={},d=[{value:"PolicyPak: Using Environment Variables in Paks Video Transcript",id:"policypak-using-environment-variables-in-paks-video-transcript",level:3}];function h(e){const t={a:"a",code:"code",h1:"h1",h3:"h3",header:"header",p:"p",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"using-environment-variables-in-paks",children:"Using Environment Variables in Paks"})}),"\n",(0,a.jsx)(t.p,{children:"You might want to deliver settings based upon Windows' environment variables. There are several types of Env variables, and in this demo, we show you how to find them and some use cases."}),"\n",(0,a.jsx)(t.h3,{id:"policypak-using-environment-variables-in-paks-video-transcript",children:"PolicyPak: Using Environment Variables in Paks Video Transcript"}),"\n",(0,a.jsx)(t.p,{children:"Hi. This is Jeremy Moskowitz, former Group Policy MVP and Founder of PolicyPak Software. In this video, I'm going to show you how you can use environment variables when using PolicyPak."}),"\n",(0,a.jsx)(t.p,{children:'The way to get started is let\'s take a look for an application that has the ability to be configured, such as WinZip here. Now, you can see that WinZip has a bunch of different "Folders." You might want to declare what the "CheckOut base folder" is. You can see here that it\'s by default not configured. You might want to choose maybe the Desktop of %temp or something like that, and it\'s easy enough to perform.'}),"\n",(0,a.jsx)(t.p,{children:'The way to do this is inside "PolicyPak" you\'re just going to create a GPO and link it over to where you want to. I\'ve already done that, so I\'ll go to "New/Application" and pick "PolicyPak for WinZip International LLC WinZip 14 to 17" here.'}),"\n",(0,a.jsxs)(t.p,{children:["Now inside here, all you're going to do is \u2013 in the Pak definition itself, we've already put something we think you might want, which is \"",(0,a.jsx)(t.code,{children:"%localappdata%temp"}),'." If you were simply to use this by right clicking and selecting "Always reapply this setting," it will take "',(0,a.jsx)(t.code,{children:"%localappdata%temp"}),'" and evaluate that on the client.']}),"\n",(0,a.jsxs)(t.p,{children:['Let\'s go ahead and see that in action. If we were to go here and run "gpupdate," and let\'s go ahead and run "WinZip" now after getting the update here. If we go over to "Folders," you can see that it has updated the "CheckOut base folder" to "',(0,a.jsx)(t.code,{children:"C:Userseastsalesuser2AppDataLocaltemp"}),'."']}),"\n",(0,a.jsxs)(t.p,{children:["Now again, you can if you want to change this to something else. Like let me go back over here. I'll go over here and change it to maybe \"",(0,a.jsx)(t.code,{children:"%desktop%"}),'." In changing it to "',(0,a.jsx)(t.code,{children:"%desktop%"}),'" and going over to the target machine and running "',(0,a.jsx)(t.code,{children:"gpupdate"}),'" and rerunning "',(0,a.jsx)(t.code,{children:"WinZip"}),'" here, if we go to "Options/Configuration\u2026," go back to "Folders," you can see it has declared that the "CheckOut base folder" for this user is "',(0,a.jsx)(t.code,{children:"C:Userseastsalesuser2Desktop"}),'."']}),"\n",(0,a.jsxs)(t.p,{children:["There are a lot of other options here, but let me give you a quick technique to go to the advanced level here. On every target machine, all these environment variables are declared inside a special location in the registry. I'm going to show you that location. Actually, I'm going to \"",(0,a.jsx)(t.a,{href:"https://www.policypak.com/products/policypak-least-privilege-manager.html",children:"https://www.policypak.com/products/policypak-least-privilege-manager.html"}),".\" This is an advanced technique, so I'm going to run this as administrator here."]}),"\n",(0,a.jsxs)(t.p,{children:['I\'ll type "regedit." I\'m looking under "',(0,a.jsx)(t.code,{children:"HKEY_CURRENT_USER/Software/Microsoft/Windows/Current Version/Explorer/Shell Folders"}),'." These guys, everything on the left here, is an environment variable that you can use on this machine.']}),"\n",(0,a.jsxs)(t.p,{children:['There may be others that are available, for instance, all the things that are available when you type "set" at a Command prompt. These are all available. Everything that\'s set inside of Windows is available. So like "',(0,a.jsx)(t.code,{children:"%PUBLIC%"}),'" as you can see will go to "',(0,a.jsx)(t.code,{children:"C:UsersPublic"}),'." That\'s available. "',(0,a.jsx)(t.code,{children:"%HOMEPATH%"}),'" \u2013 so all of these evaluate, plus all of these guys in "Shell Folders." For instance, if you wanted to go to "History" \u2013 "History" is this folder that goes all the way down there \u2013 you would just do "',(0,a.jsx)(t.code,{children:"%history%"}),'" and that would evaluate there.']}),"\n",(0,a.jsxs)(t.p,{children:['Now, there are a couple of weird ones in this list, so I want to point them out. Take a look at this guy right here. This guy evaluates to "',(0,a.jsx)(t.code,{children:"C:UsersaDownloads"}),'." So the name for this guy is, well, let\'s take a look. We would have to do "',(0,a.jsx)(t.code,{children:"%{374DE290-123F-4565-9164-39C4925E467B}%"}),'." That\'s "Downloads."']}),"\n",(0,a.jsxs)(t.p,{children:['The reason why is that these handful of guys simply are somewhat different than some of the other guys. Just to prove a point here to make this "Downloads," I\'ll copy this guy into my PolicyPak here. Instead of "',(0,a.jsx)(t.code,{children:"%desktop%"}),'," I\'m going to do "',(0,a.jsx)(t.code,{children:"%{374DE290-123F-4565-9164-39C4925E467B}%"}),'" and that is "Downloads." I know it\'s a little weird, but that\'s how it works.']}),"\n",(0,a.jsxs)(t.p,{children:["I'll close this out. I'll rerun \"",(0,a.jsx)(t.code,{children:"gpupdate"}),'," and we\'ll see that it works. OK, we\'ll run "WinZip" here. We\'ll go to "Options/Configuration\u2026," go to "Folders" and there\'s the "',(0,a.jsx)(t.code,{children:"C:Userseastsalesuser2Downloads"}),'" folder. That would work. You could also use if you wanted to \u2013 I\'ll do it for this one just to prove a point \u2013 you could also use "',(0,a.jsx)(t.code,{children:"%userprofile%downloads"}),'." That should work also: "',(0,a.jsx)(t.code,{children:"%userprofile%downloads"}),'."']}),"\n",(0,a.jsxs)(t.p,{children:["Let's see that that works. It starts off, it's not at \"Downloads.\" Now let's go ahead and run \"",(0,a.jsx)(t.code,{children:"gpupdate"}),'" here, and we\'ll see if it works. If I run "',(0,a.jsx)(t.code,{children:"WinZip"}),'" here \u2013 remember, I\'m manipulating a different folder \u2013 there it is. Those are two ways that you could use "Downloads."']}),"\n",(0,a.jsx)(t.p,{children:"There's one other way you might want to use environment variables, and that comes down to using item-level targeting (\"Enable item-level targeting\"). We have other videos on item-level targeting. But if you'll remember, item-level targeting lets you specify certain conditions for when this Pak entry will hit a target machine."}),"\n",(0,a.jsxs)(t.p,{children:['You may want to use it, for instance, on "File Match." You might want to say when the "File exists" and put in something like "',(0,a.jsx)(t.code,{children:"%desktop%file123.doc"}),'." In other words, this whole Pak entry won\'t kick off unless it see the file called "',(0,a.jsx)(t.code,{children:"file123.doc"}),"\" on the Desktop. That's perfectly legal, so that's how you would use environment variables inside the item-level targeting."]}),"\n",(0,a.jsx)(t.p,{children:"That's it for environment variables. If you have questions on that, we're here for you. Go ahead and post your questions in the forum, and we'll see you there."}),"\n",(0,a.jsx)(t.p,{children:"Thanks so much."})]})}function c(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}}}]);