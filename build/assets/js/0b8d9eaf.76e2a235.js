"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[256622],{28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var i=t(296540);const r={},s=i.createContext(r);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:n},e.children)}},148881:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"auditor/accountlockoutexaminer/configure","title":"Planning and Preparation","description":"Before you start using Netwrix Account Lockout Examiner, check the prerequisites and set up your environment, as described in this section.","source":"@site/docs/auditor/auditor/accountlockoutexaminer/configure.md","sourceDirName":"auditor/accountlockoutexaminer","slug":"/auditor/accountlockoutexaminer/configure","permalink":"/docs/auditor/auditor/accountlockoutexaminer/configure","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/accountlockoutexaminer/configure.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Select Data Sources","permalink":"/docs/auditor/auditor/accessreviewsconfiguration"},"next":{"title":"Account Lockout Examiner","permalink":"/docs/auditor/auditor/accountlockoutexaminer/overview"}}');var r=t(474848),s=t(28453);const o={},c="Planning and Preparation",d={},l=[{value:"System requirements",id:"system-requirements",level:2},{value:"Accounts and rights",id:"accounts-and-rights",level:2},{value:"Licensing",id:"licensing",level:2},{value:"Target infrastructure",id:"target-infrastructure",level:2},{value:"Target systems and platforms",id:"target-systems-and-platforms",level:3},{value:"Inbound firewall rules",id:"inbound-firewall-rules",level:3},{value:"Ports",id:"ports",level:3},{value:"Recommended network security settings",id:"recommended-network-security-settings",level:3},{value:"Required audit settings",id:"required-audit-settings",level:3}];function a(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"planning-and-preparation",children:"Planning and Preparation"})}),"\n",(0,r.jsx)(n.p,{children:"Before you start using Netwrix Account Lockout Examiner, check the prerequisites and set up your environment, as described in this section."}),"\n",(0,r.jsx)(n.h2,{id:"system-requirements",children:"System requirements"}),"\n",(0,r.jsx)(n.p,{children:"Make sure that the machine where you plan install the solution meets the system requirements listed below."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Hardware:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Specification"}),(0,r.jsx)(n.th,{children:"Requirement"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CPU"}),(0,r.jsx)(n.td,{children:"min 1.5 GHz"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Memory"}),(0,r.jsx)(n.td,{children:"1 GB RAM"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Disk space"}),(0,r.jsx)(n.td,{children:"20 MB"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Software:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Specification"}),(0,r.jsx)(n.th,{children:"Requirement"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"OS"}),(0,r.jsx)(n.td,{children:"Both 32-bit and 64-bit of the following operating systems are supported:   - Windows Server 2019 - Windows Server 2016 - Windows Server 2012 R2 - Windows Server 2012 - Windows 10 - Windows 8.1"})]})})]}),"\n",(0,r.jsx)(n.h2,{id:"accounts-and-rights",children:"Accounts and rights"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["The computer where ",(0,r.jsx)(n.strong,{children:"Account Lockout Examiner"})," will run must be a member of the domain where lockouts happen."]}),"\n",(0,r.jsxs)(n.li,{children:["The account used to run the application must be a member of the following groups:","\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Domain Admins"})," group (to retrieve the necessary data from domain controllers.)"]}),"\n",(0,r.jsxs)(n.li,{children:["Local ",(0,r.jsx)(n.strong,{children:"Administrators"})," group on the workstation where lockouts happen (to access the Security event log.)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["In the environments with root/child domains, the account used to run Account Lockout Examiner should be a member of the local ",(0,r.jsx)(n.strong,{children:"Administrators"})," group on the workstations in both root and child domains."]}),"\n",(0,r.jsx)(n.h2,{id:"licensing",children:"Licensing"}),"\n",(0,r.jsx)(n.p,{children:"Account Lockout Examiner is shipped with a free pre-configured license that will be valid until a newer version becomes available. You will be notified on the new version release by the corresponding message displayed in the product. Then you will need to download that new version."}),"\n",(0,r.jsx)(n.h2,{id:"target-infrastructure",children:"Target infrastructure"}),"\n",(0,r.jsx)(n.p,{children:"For the solution to connect to and retrieve the necessary information from the Windows machines that may become the potential lockout reasons, your infrastructure should meet the requirements listed below."}),"\n",(0,r.jsx)(n.h3,{id:"target-systems-and-platforms",children:"Target systems and platforms"}),"\n",(0,r.jsx)(n.p,{children:"The following Windows machines are supported as examination targets:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Windows Server 2019"}),"\n",(0,r.jsx)(n.li,{children:"Windows Server 2016"}),"\n",(0,r.jsx)(n.li,{children:"Windows Server 2012 R2"}),"\n",(0,r.jsx)(n.li,{children:"Windows Server 2012"}),"\n",(0,r.jsx)(n.li,{children:"Windows 10"}),"\n",(0,r.jsx)(n.li,{children:"Windows 8.1"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The solution can work with the following Exchange Server versions to retrieve information needed for lockout reason detection:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Exchange Server 2019"}),"\n",(0,r.jsx)(n.li,{children:"Exchange Server 2016"}),"\n",(0,r.jsx)(n.li,{children:"Exchange Server 2013"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"inbound-firewall-rules",children:"Inbound firewall rules"}),"\n",(0,r.jsxs)(n.p,{children:["Make sure the following ",(0,r.jsx)(n.strong,{children:"Inbound"})," firewall rules are enabled on the Domain Controllers and domain computers:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"File and Printer Sharing (Echo Request - ICMPv4-In)"}),"\n",(0,r.jsx)(n.li,{children:"Remote Event Log Management (RPC)"}),"\n",(0,r.jsx)(n.li,{children:"Remote Service Management (NP-In)"}),"\n",(0,r.jsx)(n.li,{children:"Remote Scheduled Tasks Management (RPC)"}),"\n",(0,r.jsx)(n.li,{children:"Remote Volume Management (RPC -EPMAP)"}),"\n",(0,r.jsx)(n.li,{children:"Windows Management Instrumentation (WMI-In)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"ports",children:"Ports"}),"\n",(0,r.jsxs)(n.p,{children:["The following ",(0,r.jsx)(n.strong,{children:"TCP"})," ports should be open on the Domain Controllers and domain computers:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Port ",(0,r.jsx)(n.strong,{children:"135"})," \u2014 for communication using RPC"]}),"\n",(0,r.jsxs)(n.li,{children:["Dynamic ports ",(0,r.jsx)(n.strong,{children:"1024-65535"})," \u2014 for internal communication"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"recommended-network-security-settings",children:"Recommended network security settings"}),"\n",(0,r.jsx)(n.p,{children:"Security researches revealed that NTLM and NTLMv2 authentication is vulnerable to a variety of malicious attacks, including SMB replay, man-in-the-middle attacks, and brute force attacks."}),"\n",(0,r.jsxs)(n.p,{children:["To make Windows operating system use more secure protocols (e.g. Kerberos version 5), the outgoing NTLM authentication traffic should be disabled for the machine where Netwrix Account Lockout Examiner will run. (See also ",(0,r.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/win32/secauthn/microsoft-negotiate",children:"this Microsoft article"}),".)"]}),"\n",(0,r.jsxs)(n.p,{children:["For that, you need to set the ",(0,r.jsx)(n.strong,{children:"Network Security: Restrict NTLM: Outgoing NTLM traffic to remote servers"})," policy setting to ",(0,r.jsx)(n.strong,{children:"Deny All"}),". This can be done locally on the machine hosting Netwrix Account Lockout Examiner, or via Group Policy."]}),"\n",(0,r.jsx)(n.p,{children:"To disable outgoing NTLM authentication traffic locally:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Run ",(0,r.jsx)(n.em,{children:"secpol.msc"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Browse to ",(0,r.jsx)(n.strong,{children:"Security Settings\\Local Policies\\Security Options"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Set the ",(0,r.jsx)(n.strong,{children:"Network Security: Restrict NTLM: Outgoing NTLM traffic to remote servers"})," setting to ",(0,r.jsx)(n.strong,{children:"Deny All"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"To disable outgoing NTLM authentication traffic via Group Policy:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Open ",(0,r.jsx)(n.em,{children:"gpmc.msc"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Find the Group Policy Object (GPO) that is applied to the machine where Netwrix Account Lockout Examiner runs."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Edit this GPO. Browse to ",(0,r.jsx)(n.strong,{children:"Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Set the ",(0,r.jsx)(n.strong,{children:"Network Security: Restrict NTLM: Outgoing NTLM traffic to remote servers"})," setting to ",(0,r.jsx)(n.strong,{children:"Deny All"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"On the machine hosting Netwrix Account Lockout Examiner run the following command via the command prompt:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"gpupdate /force"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"required-audit-settings",children:"Required audit settings"}),"\n",(0,r.jsxs)(n.p,{children:["You can configure either ",(0,r.jsx)(n.strong,{children:"Advanced audit policies"})," or ",(0,r.jsx)(n.strong,{children:"Basic audit policies"})," for the target machines. See Scenario A or Scenario B, respectively."]}),"\n",(0,r.jsx)(n.p,{children:"Scenario A: Advanced audit policies"}),"\n",(0,r.jsxs)(n.p,{children:["Enable the following ",(0,r.jsx)(n.strong,{children:"Advanced audit policies"})," for the target machines:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Audit entry"}),(0,r.jsx)(n.th,{children:"Event ID"}),(0,r.jsx)(n.th,{children:"Success/Failure"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Account Logon"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Audit Credential Validation"}),(0,r.jsx)(n.td,{children:"4776"}),(0,r.jsx)(n.td,{children:"Failure"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Audit Kerberos Authentication Service"}),(0,r.jsx)(n.td,{children:"4771"}),(0,r.jsx)(n.td,{children:"Failure"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Audit Other Account Logon Events"}),(0,r.jsx)(n.td,{children:"4776"}),(0,r.jsx)(n.td,{children:"Failure"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Account Management"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Audit User Account Management"}),(0,r.jsx)(n.td,{children:"4740"}),(0,r.jsx)(n.td,{children:"Success"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Logon/Logoff"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Audit Logon"}),(0,r.jsx)(n.td,{children:"4625"}),(0,r.jsx)(n.td,{children:"Failure"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Audit Account Lockout"}),(0,r.jsx)(n.td,{children:"4625"}),(0,r.jsx)(n.td,{children:"Failure"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Scenario B: Basic audit policies"}),"\n",(0,r.jsxs)(n.p,{children:["Enable the following ",(0,r.jsx)(n.strong,{children:"basic audit policies"})," for the target machines:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Audit entry"}),(0,r.jsx)(n.th,{children:"Event ID"}),(0,r.jsx)(n.th,{children:"Success/Failure"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Audit logon events"}),(0,r.jsx)(n.td,{children:"4625"}),(0,r.jsx)(n.td,{children:"Failure"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Audit account logon events"}),(0,r.jsx)(n.td,{children:"4776, 4771"}),(0,r.jsx)(n.td,{children:"Failure"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Audit account management"}),(0,r.jsx)(n.td,{children:"4740"}),(0,r.jsx)(n.td,{children:"Success"})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);