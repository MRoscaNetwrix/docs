"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[806330],{28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>c});var t=i(296540);const o={},r=t.createContext(o);function s(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(r.Provider,{value:n},e.children)}},266424:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/manualconfig_objectlevel_winserver2016-5a817dca94ad4a9b818da461643cb02a.webp"},329844:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/manualconfig_aduc_advsecwinserver2016-da16907c5787986f7889d0fd291dc9b8.webp"},336550:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/manualconfig_adsi_connectionwinserver2016-41a2e4cc2fd45497e31cda18e4cbaaec.webp"},701689:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/manualconfig_aduc_advauditing_winserver2016-16c514d49d8d218aadb72f69fcb43cc6.webp"},782532:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"auditor/configuration/activedirectory/objectlevel","title":"Configure Object-Level Auditing","description":"Object-level auditing must be configured for the Domain partition if you want to collect information on user activity in the domain. If you also want to audit changes to AD configuration and schema, you must enable object-level auditing for Configuration and Schema partitions.","source":"@site/docs/auditor/auditor/configuration/activedirectory/objectlevel.md","sourceDirName":"auditor/configuration/activedirectory","slug":"/auditor/configuration/activedirectory/objectlevel","permalink":"/docs/auditor/auditor/configuration/activedirectory/objectlevel","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/auditor/auditor/configuration/activedirectory/objectlevel.md","tags":[],"version":"current","frontMatter":{},"sidebar":"auditorSidebar","previous":{"title":"Active Directory: Manual Configuration","permalink":"/docs/auditor/auditor/configuration/activedirectory/manual"},"next":{"title":"Active Directory","permalink":"/docs/auditor/auditor/configuration/activedirectory/overview"}}');var o=i(474848),r=i(28453);const s={},c="Configure Object-Level Auditing",a={},d=[{value:"Configuring object-level auditing for the Domain partition",id:"configuring-object-level-auditing-for-the-domain-partition",level:2},{value:"Enabling object-level auditing for the Configuration and Schema partitions",id:"enabling-object-level-auditing-for-the-configuration-and-schema-partitions",level:2}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"configure-object-level-auditing",children:"Configure Object-Level Auditing"})}),"\n",(0,o.jsxs)(n.p,{children:["Object-level auditing must be configured for the ",(0,o.jsx)(n.strong,{children:"Domain"})," partition if you want to collect information on user activity in the domain. If you also want to audit changes to AD configuration and schema, you must enable object-level auditing for ",(0,o.jsx)(n.strong,{children:"Configuration"})," and ",(0,o.jsx)(n.strong,{children:"Schema"})," partitions."]}),"\n",(0,o.jsxs)(n.p,{children:["Auditing of the Configuration partition is enabled by default. See the ",(0,o.jsx)(n.a,{href:"/docs/auditor/auditor/admin/monitoringplans/activedirectory/overview",children:"Active Directory"})," topic for detailed instructions on how to enable monitoring of changes to the Schema partition in the target AD domain."]}),"\n",(0,o.jsx)(n.p,{children:"Perform the following procedures to configure object-level auditing for the Domain, Configuration and Schema partitions:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"#Configuring-object-level-auditing-for-the-Domain-partition",children:"Configuring object-level auditing for the Domain partition"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"#Enabling-object-level-auditing-for-the-Configuration-and-Schema-partitions",children:"Enabling object-level auditing for the Configuration and Schema partitions"})}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"configuring-object-level-auditing-for-the-domain-partition",children:"Configuring object-level auditing for the Domain partition"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Step 1 \u2013"})," Open the ",(0,o.jsx)(n.strong,{children:"Active Directory Users and Computers"})," console on any domain controller in the target domain: navigate to Start > Windows Administrative Tools \u2192 ",(0,o.jsx)(n.strong,{children:"Active Directory Users and Computers"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Step 2 \u2013"})," In the ",(0,o.jsx)(n.strong,{children:"Active Directory Users and Computers"})," dialog, click ",(0,o.jsx)(n.strong,{children:"View"})," in the main menu and ensure that the ",(0,o.jsx)(n.strong,{children:"Advanced Features"})," are enabled."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"manualconfig_aduc_advsecwinserver2016",src:i(329844).A+"",width:"750",height:"367"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Step 3 \u2013"})," Right-click the ",(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"<domain_name>"})})," node and select ",(0,o.jsx)(n.strong,{children:"Properties."})," Select the ",(0,o.jsx)(n.strong,{children:"Security"})," tab and click ",(0,o.jsx)(n.strong,{children:"Advanced"}),". In the ",(0,o.jsxs)(n.strong,{children:["Advanced Security Settings for ",(0,o.jsx)(n.code,{children:"<domain_name>"})]})," dialog, select the ",(0,o.jsx)(n.strong,{children:"Auditing"})," tab."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"manualconfig_aduc_advauditing_winserver2016",src:i(701689).A+"",width:"766",height:"518"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Step 4 \u2013"})," Perform the following actions on the Windows Server 2012 and above:"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Click ",(0,o.jsx)(n.strong,{children:"Add"}),". In the ",(0,o.jsx)(n.strong,{children:"Auditing Entry"})," dialog, click the ",(0,o.jsx)(n.strong,{children:"Select a principal"})," link."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["In the ",(0,o.jsx)(n.strong,{children:"Select user, Computer, Service account, or Group"})," dialog, type ",(0,o.jsx)(n.em,{children:'"Everyone"'})," in the ",(0,o.jsx)(n.strong,{children:"Enter the object name to select"})," field."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Set ",(0,o.jsx)(n.strong,{children:"Type"})," to ",(0,o.jsx)(n.em,{children:'"Success"'})," and ",(0,o.jsx)(n.strong,{children:"Applies to"})," to ",(0,o.jsx)(n.em,{children:'"This object and all descendant objects"'}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Under ",(0,o.jsx)(n.strong,{children:"Permissions"}),", select all checkboxes except the following: ",(0,o.jsx)(n.em,{children:"Full Control"}),", ",(0,o.jsx)(n.em,{children:"List Contents"}),", ",(0,o.jsx)(n.em,{children:"Read All Properties"})," and ",(0,o.jsx)(n.em,{children:"Read Permissions"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Scroll to the bottom of the list and make sure that the ",(0,o.jsx)(n.strong,{children:"Only apply these auditing settings to objects and/or containers within this container"})," checkbox is cleared."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"manualconfig_objectlevel_winserver2016",src:i(266424).A+"",width:"914",height:"590"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"enabling-object-level-auditing-for-the-configuration-and-schema-partitions",children:"Enabling object-level auditing for the Configuration and Schema partitions"}),"\n",(0,o.jsxs)(n.p,{children:["To perform this procedure, you will need the ",(0,o.jsx)(n.a,{href:"http://technet.microsoft.com/en-us/library/cc773354(v=ws.10).aspx",children:"ADSI Edit"})," utility. Follow\xa0the steps to enable object-level auditing for the Configuration and Schema partitions."]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Step 1 \u2013"})," On any domain controller in the target domain, navigate to Start > Windows Administrative Tools ",(0,o.jsx)(n.strong,{children:"> ADSI Edit"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Step 2 \u2013"})," Right-click the ",(0,o.jsx)(n.strong,{children:"ADSI Edit"})," node and select ",(0,o.jsx)(n.strong,{children:"Connect To"}),". In the ",(0,o.jsx)(n.strong,{children:"Connection Settings"})," dialog, enable ",(0,o.jsx)(n.strong,{children:"Select a well-known Naming Context"})," and select ",(0,o.jsx)(n.strong,{children:"Configuration"})," from the drop-down list."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"manualconfig_adsi_connectionwinserver2016",src:i(336550).A+"",width:"374",height:"379"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Step 3 \u2013"})," Expand the ",(0,o.jsxs)(n.strong,{children:["Configuration ",(0,o.jsx)(n.code,{children:"<Your_Root_Domain_Name>"})]})," node. Right-click the ",(0,o.jsxs)(n.strong,{children:["CN=Configuration, DC=",(0,o.jsx)(n.code,{children:"<name>"}),",DC=",(0,o.jsx)(n.code,{children:"<name>"}),"\u2026"]})," node and select ",(0,o.jsx)(n.strong,{children:"Properties."})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Step 4 \u2013"})," In the ",(0,o.jsxs)(n.strong,{children:["CN=Configuration, DC=",(0,o.jsx)(n.code,{children:"<name>"}),", DC=",(0,o.jsx)(n.code,{children:"<name>"})," Properties"]})," dialog select the ",(0,o.jsx)(n.strong,{children:"Security"})," tab and click ",(0,o.jsx)(n.strong,{children:"Advanced"}),". In the ",(0,o.jsx)(n.strong,{children:"Advanced Security Settings for Configuration"})," dialog, open the ",(0,o.jsx)(n.strong,{children:"Auditing"})," tab."]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Step 5 \u2013"})," Perform the following actions on the Windows Server 2012 and above:"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Click ",(0,o.jsx)(n.strong,{children:"Add"}),". In the ",(0,o.jsx)(n.strong,{children:"Auditing Entry"})," dialog, click the ",(0,o.jsx)(n.strong,{children:"Select a principal"})," link."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["In the ",(0,o.jsx)(n.strong,{children:"Select user, Computer, Service account, or Group"})," dialog, type ",(0,o.jsx)(n.em,{children:'"Everyone"'})," in the ",(0,o.jsx)(n.strong,{children:"Enter the object name to select"})," field."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Set ",(0,o.jsx)(n.strong,{children:"Type"})," to ",(0,o.jsx)(n.em,{children:'"Success"'})," and ",(0,o.jsx)(n.strong,{children:"Applies to"})," to ",(0,o.jsx)(n.em,{children:'"This object and all descendant objects"'}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Under ",(0,o.jsx)(n.strong,{children:"Permissions"}),", select all checkboxes except the following: ",(0,o.jsx)(n.em,{children:"Full Control"}),", ",(0,o.jsx)(n.em,{children:"List Contents"}),", ",(0,o.jsx)(n.em,{children:"Read All Properties"})," and ",(0,o.jsx)(n.em,{children:"Read Permissions"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Scroll to the bottom of the list and make sure that the ",(0,o.jsx)(n.strong,{children:"Only apply these auditing settings to objects and/or containers within this container"})," checkbox is cleared."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"manualconfig_objectlevel_winserver2016",src:i(266424).A+"",width:"914",height:"590"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Repeat these steps for the Schema container if necessary."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}}}]);