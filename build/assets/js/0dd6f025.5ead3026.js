"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[619456],{28453:(e,i,n)=>{n.d(i,{R:()=>l,x:()=>o});var t=n(296540);const s={},r=t.createContext(s);function l(e){const i=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:i},e.children)}},386314:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"config/sharepointonline/access","title":"SharePoint Online Access & Sensitive Data Auditing Configuration","description":"Netwrix Access Analyzer (formerly Enterprise Auditor) uses Modern Authentication to execute Access Auditing (SPAA) and/or Sensitive Data Discovery Auditing scans for the target SharePoint Online & OneDrive for Business environments. This involves creating and defining a Microsoft Entra ID\xa0application for app\u2013only access to SharePoint Online.","source":"@site/docs/accessanalyzer/config/sharepointonline/access.md","sourceDirName":"config/sharepointonline","slug":"/config/sharepointonline/access","permalink":"/docs/accessanalyzer/config/sharepointonline/access","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/config/sharepointonline/access.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"SharePoint Target Requirements","permalink":"/docs/accessanalyzer/config/sharepoint/overview"},"next":{"title":"SharePoint Online Activity Auditing Configuration","permalink":"/docs/accessanalyzer/config/sharepointonline/activity"}}');var s=n(474848),r=n(28453);const l={},o="SharePoint Online Access & Sensitive Data Auditing Configuration",a={},c=[{value:"Permissions",id:"permissions",level:2},{value:"Create Self\u2013Signed Certificate",id:"create-selfsigned-certificate",level:2},{value:"Register a Microsoft Entra ID Application",id:"register-a-microsoft-entra-id-application",level:2},{value:"Upload Self-Signed Certificate",id:"upload-self-signed-certificate",level:2},{value:"Grant Permissions to the Registered Application",id:"grant-permissions-to-the-registered-application",level:2},{value:"Identify the Client ID",id:"identify-the-client-id",level:2}];function d(e){const i={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"sharepoint-online-access--sensitive-data-auditing-configuration",children:"SharePoint Online Access & Sensitive Data Auditing Configuration"})}),"\n",(0,s.jsx)(i.p,{children:"Netwrix Access Analyzer (formerly Enterprise Auditor) uses Modern Authentication to execute Access Auditing (SPAA) and/or Sensitive Data Discovery Auditing scans for the target SharePoint Online & OneDrive for Business environments. This involves creating and defining a Microsoft Entra ID\xa0application for app\u2013only access to SharePoint Online."}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"NOTE:"})," A user account with the Global Administrator role is required to register an app with Microsoft Entra ID."]}),"\n",(0,s.jsx)(i.p,{children:"Configuration Settings from the Registered Application"}),"\n",(0,s.jsx)(i.p,{children:"The following settings are needed from your tenant once you have registered the application:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Client ID \u2013 This is the Application (client) ID for the registered application"}),"\n",(0,s.jsxs)(i.li,{children:["Key \u2013 The comma delimited string containing the path to the certificate PFX file, certificate password, and the Microsoft Entra ID environment identifier ( ",(0,s.jsx)(i.code,{children:"CertPath,CertPassword,AzureEnvironment"}),")"]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Configure Modern Authentication for SharePoint Online using SP_RegisterAzureAppAuth Instant Job"}),"\n",(0,s.jsx)(i.p,{children:"Registering a Microsoft Entra ID application and provisioning it to grant permissions to SharePoint Online can be automated using the SP_RegisterAzureAppAuth job from the Access Analyzer Instant Job Library. The SP_RegisterAzureAppAuth job uses the PowerShell Data Collector to automatically configure modern authentication for SharePoint Online. It requires:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["A Connection Profile containing the following two user credentials, both with an Account Type of ",(0,s.jsx)(i.strong,{children:"Task (Local)"}),":"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Microsoft Entra ID Global Admin credential"}),"\n",(0,s.jsxs)(i.li,{children:["A credential with the username ",(0,s.jsx)(i.code,{children:"newapp"})," that contains the password for the new application"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"Microsoft Graph API PowerShell module to be installed on targeted hosts"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["See the ",(0,s.jsx)(i.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/jobs/instantjobs/sp_registerazureappauth",children:"SP_RegisterAzureAppAuth Job"})," topic for additional information."]}),"\n",(0,s.jsx)(i.h2,{id:"permissions",children:"Permissions"}),"\n",(0,s.jsx)(i.p,{children:"The following permissions are required:"}),"\n",(0,s.jsx)(i.p,{children:"Permissions for Microsoft Graph API"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"Application Permissions:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Application.Read.All \u2013 Read all applications"}),"\n",(0,s.jsx)(i.li,{children:"AuditLog.Read.All \u2013 Read all audit log data"}),"\n",(0,s.jsx)(i.li,{children:"Directory.Read.All \u2013 Read directory data"}),"\n",(0,s.jsx)(i.li,{children:"Domain.Read.All \u2013 Read domains"}),"\n",(0,s.jsx)(i.li,{children:"Files.Read.All \u2013 Read files in all site collections"}),"\n",(0,s.jsx)(i.li,{children:"GroupMember.Read.All \u2013 Read all group memberships"}),"\n",(0,s.jsx)(i.li,{children:"InformationProtectionPolicy.Read.All \u2013 Read all published labels and label policies for an organization"}),"\n",(0,s.jsx)(i.li,{children:"Member.Read.Hidden \u2013 Read all hidden memberships"}),"\n",(0,s.jsx)(i.li,{children:"Organization.Read.All \u2013 Read organization information"}),"\n",(0,s.jsx)(i.li,{children:"OrgContact.Read.All \u2013 Read organization contact"}),"\n",(0,s.jsx)(i.li,{children:"Policy.Read.All \u2013 Read your organization's policies"}),"\n",(0,s.jsx)(i.li,{children:"Policy.Read.ConditionalAccess \u2013 Read you organization's conditional access policies"}),"\n",(0,s.jsx)(i.li,{children:"Policy.Read.PermissionGrant \u2013 Read consent and permission grant policies"}),"\n",(0,s.jsx)(i.li,{children:"ServiceHealth.Read.All \u2013 Read service health"}),"\n",(0,s.jsx)(i.li,{children:"ServiceMessage.Read.All \u2013 Read service messages"}),"\n",(0,s.jsx)(i.li,{children:"Sites.Read.All \u2013 Read items in all site collections"}),"\n",(0,s.jsx)(i.li,{children:"Team.ReadBasic.All \u2013 Get a list of all teamss"}),"\n",(0,s.jsx)(i.li,{children:"TeamMember.Read.All \u2013 Read the members of all teams"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"Delegated Permissions:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Group.Read.All \u2013 Read all groups"}),"\n",(0,s.jsx)(i.li,{children:"User.Read.All \u2013 Read all users' full profiles"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Permissions for Office 365 Management APIs"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"Application Permissions:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"ActivityFeed.Read \u2013 Read activity data for your organization"}),"\n",(0,s.jsx)(i.li,{children:"ActivityFeed.ReadDlp \u2013 Read DLP policy events including detected sensitive data"}),"\n",(0,s.jsx)(i.li,{children:"ServiceHealth.Read \u2013 Read service health information for your organization"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Permissions for SharePoint"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"Application Permissions:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Sites.FullControl.All \u2013 Have full control of all site collections"}),"\n",(0,s.jsx)(i.li,{children:"Sites.Read.All \u2013 Read items in all site collections"}),"\n",(0,s.jsx)(i.li,{children:"TermStore.Read.All \u2013 Read managed metadata"}),"\n",(0,s.jsx)(i.li,{children:"User.Read.All \u2013 Read user profiles"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"create-selfsigned-certificate",children:"Create Self\u2013Signed Certificate"}),"\n",(0,s.jsxs)(i.p,{children:["To configure the Entra ID Application for invoking SharePoint Online with an App Only access token, create and configure a self\u2013signed X.509 certificate. This certificate authenticates the application against Entra ID while requesting the App Only access token. See the Microsoft ",(0,s.jsx)(i.a,{href:"https://learn.microsoft.com/en-us/sharepoint/dev/solution-guidance/security-apponly-azuread",children:"Granting access via Azure AD App-Only"})," article for additional information."]}),"\n",(0,s.jsx)(i.p,{children:"Follow the steps create the self-signed X.509 certificate."}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 1 \u2013"})," To generate a certificate, use the sample PowerShell command below:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["Change the following parameters in the sample PowerShell command. See the Microsoft ",(0,s.jsx)(i.a,{href:"https://docs.microsoft.com/en-us/powershell/module/pki/new-selfsignedcertificate",children:"New-SelfSignedCertificate"})," article for additional information."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"DNS\xa0Name \u2013 Specifies a DNS name to put into the subject alternative name extension of the certificate"}),"\n",(0,s.jsx)(i.li,{children:"Subject \u2013 A unique name for the new App (always starts with CN=, to denote a canonical name)"}),"\n",(0,s.jsx)(i.li,{children:"FriendlyName \u2013 Same as Subject name minus the canonical name prefix"}),"\n",(0,s.jsx)(i.li,{children:"NotAfter \u2013 A datetime string denoting the certificate's expiration date - in the above sample, Get-Date.AddYears(11) specifies that the certificate will expire 11 years from the current datetime"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Example PowerShell:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:'$cert=New-SelfSignedCertificate -CertStoreLocation Cert:\\CurrentUser\\My -DnsName stealthbits.com -Subject "CN=StealthAUDIT SharePoint Auditor" -FriendlyName "StealthAUDIT SharePoint Auditor" -KeyAlgorithm RSA -KeyLength 2048 -KeyExportPolicy Exportable -Provider "Microsoft Enhanced RSA and AES Cryptographic Provider" -NotAfter (Get-Date).AddYears(11)\n'})}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 2 \u2013"})," Export the certificate public key as a .cer file to the PrivateAssemblies folder in Access Analyzer with the Export\u2013Certificate cmdlet using the certificate path stored in the $certPath variable (see Step 1)."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"NOTE:"})," The environment variable ",(0,s.jsx)(i.code,{children:"SAINSTALLDIR"})," always points to the base Access Analyzer install directory; simply append the PrivateAssemblies to point to that folder with the following cmdlet:"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:'Export-Certificate -Cert $cert -FilePath "$($env:SAINSTALLDIR)PrivateAssemblies\\spaa_cert.cer" -Type CERT\n'})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["See the Microsoft ",(0,s.jsx)(i.a,{href:"https://docs.microsoft.com/en-us/powershell/module/pki/export-certificate",children:"Export-Certificate"})," article for additional information."]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 3 \u2013"})," Export the certificate private key as a .pfx file to the same folder by running the following cmdlet:"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:'Export-PfxCertificate -Cert $cert -FilePath "$($env:SAINSTALLDIR)PrivateAssemblies\\spaa_cert.pfx" -Password (ConvertTo-SecureString -String "PasswordGoesHere" -Force -AsPlainText)\n'})}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.em,{children:(0,s.jsx)(i.strong,{children:"RECOMMENDED:"})}),' Change the string in the Password parameter from "PasswordGoesHere" to something more secure before running this cmdlet.']}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["See the Microsoft ",(0,s.jsx)(i.a,{href:"https://docs.microsoft.com/en-us/powershell/module/pki/export-pfxcertificate",children:"Export-PfxCertificate"})," article for additional information."]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"register-a-microsoft-entra-id-application",children:"Register a Microsoft Entra ID Application"}),"\n",(0,s.jsx)(i.p,{children:"Follow the steps to register Access Analyzer with Microsoft Entra ID."}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"NOTE:"})," The steps below are for registering an app through the Microsoft Entra admin center. These steps may vary slightly if you use a different Microsoft portal. See the relevant Microsoft documentation for additional information."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 1 \u2013"})," Sign in to the ",(0,s.jsx)(i.a,{href:"https://entra.microsoft.com/",children:"Microsoft Entra admin center"}),"."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 2 \u2013"})," On the left navigation menu, navigate to ",(0,s.jsx)(i.strong,{children:"Identity"})," > ",(0,s.jsx)(i.strong,{children:"Applications"})," and click App registrations."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 3 \u2013"})," In the top toolbar, click ",(0,s.jsx)(i.strong,{children:"New registration"}),"."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 4 \u2013"})," Enter the following information in the Register an application page:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Name \u2013 Enter a user-facing display name for the application, for example Netwrix Access Analyzer (formerly Enterprise Auditor) Entra ID for SharePoint"}),"\n",(0,s.jsxs)(i.li,{children:["Supported account types \u2013 Select ",(0,s.jsx)(i.strong,{children:"Accounts in this organizational directory only"})]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 5 \u2013"})," Click ",(0,s.jsx)(i.strong,{children:"Register"}),"."]}),"\n",(0,s.jsx)(i.p,{children:"The Overview page for the newly registered app opens. Review the newly created registered application. Now that the application has been registered, permissions need to be granted to it."}),"\n",(0,s.jsx)(i.h2,{id:"upload-self-signed-certificate",children:"Upload Self-Signed Certificate"}),"\n",(0,s.jsx)(i.p,{children:"Follow the steps to provision the upload your self-signed certificate."}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"NOTE:"})," The steps below are for registering an app through the Microsoft Entra admin center. These steps may vary slightly if you use a different Microsoft portal. See the relevant Microsoft documentation for additional information."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 1 \u2013"})," Select the newly-created, registered application. If you left the Overview page, it will be listed in the ",(0,s.jsx)(i.strong,{children:"Identity"})," > ",(0,s.jsx)(i.strong,{children:"Applications"})," > ",(0,s.jsx)(i.strong,{children:"App registrations"})," > ",(0,s.jsx)(i.strong,{children:"All applications"})," list."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 2 \u2013"})," On the registered app blade, click ",(0,s.jsx)(i.strong,{children:"Certificates & secrets"})," in the Manage section."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 3 \u2013"})," Select the Certificates tab."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 4 \u2013"})," In the tool bar, click ",(0,s.jsx)(i.strong,{children:"Upload Certificate"}),"."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 5 \u2013"})," Navigate to the to PrivateAssemblies folder and select the ",(0,s.jsx)(i.code,{children:"spaa_cert.cer"})," file. Optionally add a Description."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 6 \u2013"})," Click ",(0,s.jsx)(i.strong,{children:"Add"}),"."]}),"\n",(0,s.jsx)(i.p,{children:"The upload certificate public key .cer file is an application key credential."}),"\n",(0,s.jsx)(i.h2,{id:"grant-permissions-to-the-registered-application",children:"Grant Permissions to the Registered Application"}),"\n",(0,s.jsx)(i.p,{children:"Follow the steps to grant permissions to the registered application."}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"NOTE:"})," The steps below are for registering an app through the Microsoft Entra admin center. These steps may vary slightly if you use a different Microsoft portal. See the relevant Microsoft documentation for additional information."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 1 \u2013"})," Select the newly-created, registered application. If you left the Overview page, it will be listed in the ",(0,s.jsx)(i.strong,{children:"Identity"})," > ",(0,s.jsx)(i.strong,{children:"Applications"})," > ",(0,s.jsx)(i.strong,{children:"App registrations"})," > ",(0,s.jsx)(i.strong,{children:"All applications"})," list."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 2 \u2013"})," On the registered app blade, click ",(0,s.jsx)(i.strong,{children:"API permissions"})," in the Manage section."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 3 \u2013"})," In the top toolbar, click ",(0,s.jsx)(i.strong,{children:"Add a permission"}),"."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 4 \u2013"})," On the Request API permissions blade, select ",(0,s.jsx)(i.strong,{children:"Microsoft Graph"})," on the Microsoft APIs tab. Select the following permissions:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"Application Permissions:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Application.Read.All \u2013 Read all applications"}),"\n",(0,s.jsx)(i.li,{children:"AuditLog.Read.All \u2013 Read all audit log data"}),"\n",(0,s.jsx)(i.li,{children:"Directory.Read.All \u2013 Read directory data"}),"\n",(0,s.jsx)(i.li,{children:"Domain.Read.All \u2013 Read domains"}),"\n",(0,s.jsx)(i.li,{children:"Files.Read.All \u2013 Read files in all site collections"}),"\n",(0,s.jsx)(i.li,{children:"GroupMember.Read.All \u2013 Read all group memberships"}),"\n",(0,s.jsx)(i.li,{children:"InformationProtectionPolicy.Read.All \u2013 Read all published labels and label policies for an organization"}),"\n",(0,s.jsx)(i.li,{children:"Member.Read.Hidden \u2013 Read all hidden memberships"}),"\n",(0,s.jsx)(i.li,{children:"Organization.Read.All \u2013 Read organization information"}),"\n",(0,s.jsx)(i.li,{children:"OrgContact.Read.All \u2013 Read organization contact"}),"\n",(0,s.jsx)(i.li,{children:"Policy.Read.All \u2013 Read your organization's policies"}),"\n",(0,s.jsx)(i.li,{children:"Policy.Read.ConditionalAccess \u2013 Read you organization's conditional access policies"}),"\n",(0,s.jsx)(i.li,{children:"Policy.Read.PermissionGrant \u2013 Read consent and permission grant policies"}),"\n",(0,s.jsx)(i.li,{children:"ServiceHealth.Read.All \u2013 Read service health"}),"\n",(0,s.jsx)(i.li,{children:"ServiceMessage.Read.All \u2013 Read service messages"}),"\n",(0,s.jsx)(i.li,{children:"Sites.Read.All \u2013 Read items in all site collections"}),"\n",(0,s.jsx)(i.li,{children:"Team.ReadBasic.All \u2013 Get a list of all teamss"}),"\n",(0,s.jsx)(i.li,{children:"TeamMember.Read.All \u2013 Read the members of all teams"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"Delegated Permissions:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Group.Read.All \u2013 Read all groups"}),"\n",(0,s.jsx)(i.li,{children:"User.Read.All \u2013 Read all users' full profiles"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 5 \u2013"})," At the bottom of the page, click ",(0,s.jsx)(i.strong,{children:"Add Permissions"}),"."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 6 \u2013"})," In the top toolbar, click ",(0,s.jsx)(i.strong,{children:"Add a permission"}),"."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 7 \u2013"})," On the Request API permissions blade, select ",(0,s.jsx)(i.strong,{children:"Office 365 Management APIs"})," on the Microsoft APIs tab. Select the following permissions:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"Application Permissions:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"ActivityFeed.Read \u2013 Read activity data for your organization"}),"\n",(0,s.jsx)(i.li,{children:"ActivityFeed.ReadDlp \u2013 Read DLP policy events including detected sensitive data"}),"\n",(0,s.jsx)(i.li,{children:"ServiceHealth.Read \u2013 Read service health information for your organization"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 8 \u2013"})," At the bottom of the page, click ",(0,s.jsx)(i.strong,{children:"Add Permissions"}),"."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 9 \u2013"})," In the top toolbar, click ",(0,s.jsx)(i.strong,{children:"Add a permission"}),"."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 10 \u2013"})," On the Request API permissions blade, select ",(0,s.jsx)(i.strong,{children:"SharePoint"})," on the Microsoft APIs tab. Select the following permissions:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"Application Permissions:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Sites.FullControl.All \u2013 Have full control of all site collections"}),"\n",(0,s.jsx)(i.li,{children:"Sites.Read.All \u2013 Read items in all site collections"}),"\n",(0,s.jsx)(i.li,{children:"TermStore.Read.All \u2013 Read managed metadata"}),"\n",(0,s.jsx)(i.li,{children:"User.Read.All \u2013 Read user profiles"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 11 \u2013"})," At the bottom of the page, click ",(0,s.jsx)(i.strong,{children:"Add Permissions"}),"."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 12 \u2013"})," Click ",(0,s.jsx)(i.strong,{children:"Grant Admin Consent for [tenant]"}),". Then click ",(0,s.jsx)(i.strong,{children:"Yes"})," in the confirmation window."]}),"\n",(0,s.jsx)(i.p,{children:"Now that the permissions have been granted to it, the Connection Profile and host settings for Access Analyzer need to be collected."}),"\n",(0,s.jsx)(i.h2,{id:"identify-the-client-id",children:"Identify the Client ID"}),"\n",(0,s.jsx)(i.p,{children:"Follow the steps to find the registered application's Client ID."}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"NOTE:"})," The steps below are for registering an app through the Microsoft Entra admin center. These steps may vary slightly if you use a different Microsoft portal. See the relevant Microsoft documentation for additional information."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 1 \u2013"})," Select the newly-created, registered application. If you left the Overview page, it will be listed in the ",(0,s.jsx)(i.strong,{children:"Identity"})," > ",(0,s.jsx)(i.strong,{children:"Applications"})," > ",(0,s.jsx)(i.strong,{children:"App registrations"})," > ",(0,s.jsx)(i.strong,{children:"All applications"})," list."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 2 \u2013"})," Copy the ",(0,s.jsx)(i.strong,{children:"Application (client) ID"})," value."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Step 3 \u2013"})," Save this value in a text file."]}),"\n",(0,s.jsxs)(i.p,{children:["This is needed for the Access Analyzer Connection Profile. See the ",(0,s.jsx)(i.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/settings/connection/profile/entraid",children:"Azure Active Directory for User Credentials"})," topic for additional information."]})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);