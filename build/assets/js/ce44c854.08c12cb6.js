"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[948413],{28453:(e,t,r)=>{r.d(t,{R:()=>o,x:()=>c});var s=r(296540);const n={},i=s.createContext(n);function o(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(i.Provider,{value:t},e.children)}},346803:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/579_2_image-20190918135807-2-29ad0c6f8a1d66fc8f47caae2d19abef.webp"},539369:(e,t,r)=>{r.d(t,{A:()=>s});const s=r.p+"assets/images/579_1_image-20190918135807-1-49f455314db4f1d864b9ac212012d272.webp"},921775:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"policypak/scriptstriggers/shortcutpublicdesktop","title":"How to create a shortcut under the Public Desktop using Endpoint Policy Scripts Manager","description":"The steps below are performed using WinZip as an example.","source":"@site/docs/policypak/policypak/scriptstriggers/shortcutpublicdesktop.md","sourceDirName":"policypak/scriptstriggers","slug":"/policypak/scriptstriggers/shortcutpublicdesktop","permalink":"/docs/policypak/policypak/scriptstriggers/shortcutpublicdesktop","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/scriptstriggers/shortcutpublicdesktop.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Where do scripts run? How are they protected from unauthorized access? How can I change the location of where scripts are stored?","permalink":"/docs/policypak/policypak/scriptstriggers/scriptlocation"},"next":{"title":"How to silently install Firefox ESR, Chrome and WinZip 14.5 using Endpoint Policy Scripts Manager","permalink":"/docs/policypak/policypak/scriptstriggers/silentbrowserinstall"}}');var n=r(474848),i=r(28453);const o={},c="How to create a shortcut under the Public Desktop using Endpoint Policy Scripts Manager",p={},a=[];function l(e){const t={code:"code",h1:"h1",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"how-to-create-a-shortcut-under-the-public-desktop-using-endpoint-policy-scripts-manager",children:"How to create a shortcut under the Public Desktop using Endpoint Policy Scripts Manager"})}),"\n",(0,n.jsx)(t.p,{children:"The steps below are performed using WinZip as an example."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 1 \u2013"})," Create a new GPO and link it to the OU where the computers live that will need to have the shortcut added."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 2 \u2013"})," Edit the GPO."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 3 \u2013"}),' \xa0Select "Computer Configuration > Netwrix Endpoint Policy Manager (formerly PolicyPak) > Scripts Manager".']}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 4 \u2013"}),' Click the "ADD NEW POLICY" button, then click "Next".']}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 5 \u2013"}),' At the "Specify policy target" screen be sure to select the 2nd radio button that states "Apply this policy to all users who log on to the computer (switched mode) then click "Next".']}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"579_1_image-20190918135807-1",src:r(539369).A+"",width:"727",height:"509"})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 6 \u2013"}),' At the "On apply action" screen select "PowerShell script" from the dropdown.']}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 7 \u2013"}),' In the main text window, paste in the script below and then click "Next".']}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:'#Script starts here  \n#create WinZip shortcut on Public Desktop  \n$TargetFile="C:\\Program Files (x86)\\WinZip\\WINZIP32.EXE"  \n$ShortcutFile="$env:Public\\Desktop\\WinZip.lnk"  \n$WScriptShell=New-Object-ComObjectWScript.Shell  \n$Shortcut=$WScriptShell.CreateShortcut($ShortcutFile)  \n$Shortcut.TargetPath =$TargetFile  \n$Shortcut.Save()  \n\xa0#Script ends here\n'})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 8 \u2013"}),' Before clicking "Next" make sure that the "Run script as user" option is unchecked.']}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"579_2_image-20190918135807-2",src:r(346803).A+"",width:"724",height:"502"})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 9 \u2013"}),' Then click "Next" again on the "On revert action" screen.']}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 10 \u2013"}),' Select the "Once or when forced" option at the "Specify process mode" screen, then click "Next" again.']}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 11 \u2013"}),' Give the policy a descriptive name (i.e. Create WinZip Shortcut on Public Desktop), then click "Finish.']}),"\n",(0,n.jsxs)(t.p,{children:["Lastly, log into a computer that lives in the OU where this GPO is applied and within seconds of logging in you should see the WinZip shortcut get created on the desktop. If needed you can run ",(0,n.jsx)(t.code,{children:"GPUPDATE /FORCE"})," from a CMD prompt to speed up the process, or for testing."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"NOTE:"}),' When installing WinZip from MSI, WinZip will remove any desktop icons by default, for this shortcut policy to work properly you should have it apply after WinZip is already installed, or upgraded. Alternatively, you can change the "Policy process mode configuration" to run "Always" instead of "Once or when forced" to always create the shortcut at login or when ',(0,n.jsx)(t.code,{children:"GPUPDATE"})," runs."]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}}}]);