"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[487854],{28453:(e,o,t)=>{t.d(o,{R:()=>a,x:()=>r});var n=t(296540);const i={},s=n.createContext(i);function a(e){const o=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function r(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(s.Provider,{value:o},e.children)}},539381:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>a,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"policypak/video/leastprivilege/preventusercommands","title":"Prevent Users Running some commands with command lines","description":"Customer requested demo to show how to block users from running Chrome or Firefox with specific command line options.","source":"@site/docs/policypak/policypak/video/leastprivilege/preventusercommands.md","sourceDirName":"policypak/video/leastprivilege","slug":"/policypak/video/leastprivilege/preventusercommands","permalink":"/docs/policypak/policypak/video/leastprivilege/preventusercommands","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/video/leastprivilege/preventusercommands.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Automatically Prevent 6210 and 6215 Events from Known Good Identities","permalink":"/docs/policypak/policypak/video/leastprivilege/preventevents"},"next":{"title":"Overcome Print Nightmare Standard User UAC Prompts","permalink":"/docs/policypak/policypak/video/leastprivilege/printeruacprompts"}}');var i=t(474848),s=t(28453);const a={},r="Prevent Users Running some commands with command lines",l={},h=[{value:"Endpoint Policy Manager: Prevent Users Running some commands with command lines",id:"endpoint-policy-manager-prevent-users-running-some-commands-with-command-lines",level:3}];function d(e){const o={a:"a",br:"br",h1:"h1",h3:"h3",header:"header",p:"p",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.header,{children:(0,i.jsx)(o.h1,{id:"prevent-users-running-some-commands-with-command-lines",children:"Prevent Users Running some commands with command lines"})}),"\n",(0,i.jsx)(o.p,{children:"Customer requested demo to show how to block users from running Chrome or Firefox with specific command line options."}),"\n",(0,i.jsx)(o.h3,{id:"endpoint-policy-manager-prevent-users-running-some-commands-with-command-lines",children:"Endpoint Policy Manager: Prevent Users Running some commands with command lines"}),"\n",(0,i.jsxs)(o.p,{children:["Hi. This is Jeremy Moskowitz. In this video, I'm going to show you how you can use Netwrix Endpoint Policy Manager (formerly PolicyPak) ",(0,i.jsx)(o.a,{href:"https://www.policypak.com/products/policypak-least-privilege-manager.html",children:"https://www.policypak.com/products/policypak-least-privilege-manager.html"})," to prevent users from doing naughty things like running Firefox or Chrome with specific flags that might work around your security."]}),"\n",(0,i.jsx)(o.p,{children:'We have a customer who had this challenge. Their challenge was their end users knew that if they just went to Windows+R and just ran "chrome \u2013disable-extensions" like this, then Chrome would not have the extensions enabled. Same thing if they were to go to a Command prompt here ("cmd") and also try to run it this way: "Program Files (x86)GoogleChromeApplicationchrome.exe" \u2013disable-extensions."'}),"\n",(0,i.jsx)(o.p,{children:"This is an end user doing this. They don't want this to happen. They only want \"Google Chrome\" to work when that end user double clicks it the way it's supposed to and the extensions will be fully running. How do we do this with Endpoint Policy Manager Least Privilege Manager? It's actually pretty easy to do."}),"\n",(0,i.jsx)(o.p,{children:'For all of our "East Sales Users" here we\'re going to "Create a GPO in this domain, and link it here." We\'ll call this "PP LPM Command line demo." We\'ll right click and click "Edit" on this guy. We\'re doing this on the user side. You could do it for all the computers too. I just happen to be doing it on the user side.'}),"\n",(0,i.jsx)(o.p,{children:'We\'re going to go to "Least Privilege Manager." This is a little bit tricky. You\'re going to do what\'s called a "New Executable Policy" here, and you\'re going to "Use combo rule." A combo rule is going to have a "Path," which is going to have the executable name in it, and the "Command-line arguments" flags here.'}),"\n",(0,i.jsx)(o.p,{children:'The command you\'re going to "Add" is a file ("Add file"). You\'re going to just do "*chrome.exe." We don\'t care where it is. As long as it\'s Chrome, you\'re good to go. Then the "Command-line Arguments" is going to be "Any argument from the list." I just want to make sure I spell it exactly right because it has to be spelled perfectly. Here we go: "\u2013disable-extensions." You put that in there.'}),"\n",(0,i.jsx)(o.p,{children:'Now we\'re saying "Any argument from the list," "\u2013disable-extensions" is the only argument anyway. We\'ll go ahead and click "Next," and we want to "Deny execution." If they try to run it in this naughty fashion, we\'re going to deny it, so we\'ll call it "Put smackdown on chrome when run in naughty fashion."'}),"\n",(0,i.jsx)(o.p,{children:"By the way, you can specify \"Item Level Targeting\" to say certain people have to adhere to these rules and other people don't have to adhere to these rules if that's what you wanted to do. I'm just going to say all of my East Sales people are going to do this."}),"\n",(0,i.jsx)(o.p,{children:"At that point now just to prove a point, here's \"Google Chrome.\" It's running. You already saw me with the Command prompt. It will still run with the extensions disabled. Let me go ahead and run GP Update (\"gpupdate\") here. Let's get the signal from Group Policy. We'll give this a minute to finish up. Okay, and that's it."}),"\n",(0,i.jsx)(o.p,{children:'At this point now let\'s go ahead and just prove a point. "Google Chrome" will still run. That\'s cool. But if we try to go to Windows+R and try to run Chrome ("chrome \u2013disable-extensions"), "This app has been blocked by your system administrator" which is awesome. If we were to go to a Command prompt ("cmd") or something and copy this line ("Program Files (x86)GoogleChromeApplicationchrome.exe" \u2013disable-extensions") and try to run Chrome directly, "This program is blocked by Group Policy."'}),"\n",(0,i.jsx)(o.p,{children:"So just like that, using Endpoint Policy Manager Least Privilege Manager it's as simple as pie to ensure that applications will run the way you intend them to and not some unusual way that you do not intend them to."}),"\n",(0,i.jsxs)(o.p,{children:["I hope this video helps you out. If you're looking to get started, the best first step is to join us for the webinar and after that we'll hand over the bits and you can try it yourself.",(0,i.jsx)(o.br,{}),"\n","Thanks so much."]})]})}function c(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);