"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[419467],{5121:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"policypak/leastprivilege/bestpractices/rules/commandline","title":"Creating and Using Command Line Rules","description":"From time to time, you may encounter a situation in which an application only runs from the command line, or there is an application that you want to run with specific command-line arguments. This could occur in day-to-day use or with items that must run from a logon script and perform the task with elevated rights.","source":"@site/docs/policypak/policypak/leastprivilege/bestpractices/rules/commandline.md","sourceDirName":"policypak/leastprivilege/bestpractices/rules","slug":"/policypak/leastprivilege/bestpractices/rules/commandline","permalink":"/docs/policypak/policypak/leastprivilege/bestpractices/rules/commandline","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/leastprivilege/bestpractices/rules/commandline.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Best Practices and Miscellaneous Topics","permalink":"/docs/policypak/policypak/leastprivilege/bestpractices/overviewmisc"},"next":{"title":"Creating and Using Executable Combo Rules","permalink":"/docs/policypak/policypak/leastprivilege/bestpractices/rules/executablecombo"}}');var i=t(474848),r=t(28453);const a={},o="Creating and Using Command Line Rules",c={},l=[];function d(e){const n={a:"a",code:"code",h1:"h1",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"creating-and-using-command-line-rules",children:"Creating and Using Command Line Rules"})}),"\n",(0,i.jsx)(n.p,{children:"From time to time, you may encounter a situation in which an application only runs from the command line, or there is an application that you want to run with specific command-line arguments. This could occur in day-to-day use or with items that must run from a logon script and perform the task with elevated rights."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"NOTE:"})," See the ",(0,i.jsx)(n.a,{href:"/docs/policypak/policypak/video/leastprivilege/preventusercommands",children:"Prevent Users Running some commands with command lines"})," video for an overview of using Endpoint Policy Manager (formerly PolicyPak) Least Privilege Manager and command-line arguments."]}),"\n",(0,i.jsx)(n.p,{children:"A good example would be enabling standard users to start and stop services with a command line, or to run the Performance Monitor\u2019s Resource Monitor. Both must be executed from the command line."}),"\n",(0,i.jsx)(n.p,{children:"A Combo rule addresses this issue, by using Path and Command-line argument rules."}),"\n",(0,i.jsx)(n.p,{children:"![A screenshot of a computer"}),"\n",(0,i.jsx)(n.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/bestpractices/rules/creating_and_using_command.webp)"}),"\n",(0,i.jsxs)(n.p,{children:["The first step, as shown here, is to specify the Path Condition, such as ",(0,i.jsx)(n.code,{children:"%SYSTEMROOT%\\System32\\sc.exe"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"![A screenshot of a computer"}),"\n",(0,i.jsx)(n.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/bestpractices/rules/creating_and_using_command_1.webp)"}),"\n",(0,i.jsxs)(n.p,{children:["For the command-line arguments in this example, the argument ",(0,i.jsx)(n.strong,{children:"stop wsearch"}),", which stops the Windows Search Service, is specified."]}),"\n",(0,i.jsx)(n.p,{children:"![A screenshot of a computer"}),"\n",(0,i.jsx)(n.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/bestpractices/rules/creating_and_using_command_2.webp)"}),"\n",(0,i.jsxs)(n.p,{children:["For ",(0,i.jsx)(n.strong,{children:"Check Mode"}),", there are four choices:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Strict empty - Command must have no arguments."}),"\n",(0,i.jsx)(n.li,{children:"Strict equality - This means the Command and Rule will be elevated (or otherwise run) when the arguments are exactly as you specify in the same order, with no variance."}),"\n",(0,i.jsx)(n.li,{children:"Ignore arguments order - This means the Command and Rule will be elevated (or otherwise run) when all the arguments are in place, regardless of the order."}),"\n",(0,i.jsx)(n.li,{children:"Any argument from the list - This means that any argument in the Arguments box (separated by spaces) is allowed in the command."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"NOTE:"})," Ignore arguments order and ",(0,i.jsx)(n.strong,{children:"Any argument from the list"})," only work when the command has slash-based switches. If the command line doesn\u2019t have slashes, then use the ",(0,i.jsx)(n.strong,{children:"Strict equality"})," method."]}),"\n",(0,i.jsxs)(n.p,{children:["On the next screen, for ",(0,i.jsx)(n.strong,{children:"Action"}),", select ",(0,i.jsx)(n.strong,{children:"Run with elevated privileges"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["The net result is that ",(0,i.jsx)(n.strong,{children:"standard users"})," can now stop the ",(0,i.jsx)(n.code,{children:"wsearch"})," service without needing elevated rights."]}),"\n",(0,i.jsx)(n.p,{children:"![A computer screen with a black and white text"}),"\n",(0,i.jsx)(n.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/bestpractices/rules/creating_and_using_command_3.webp)"}),"\n",(0,i.jsxs)(n.p,{children:["Another example would be to enable Standard Users to perform their own Registry merge. To do this, make a Combo rule, which starts with the Path Condition running ",(0,i.jsx)(n.code,{children:"%SYSTEMROOT%\\System32\\reg.exe"})," (not shown)."]}),"\n",(0,i.jsxs)(n.p,{children:["For the Command-line Arguments, select ",(0,i.jsx)(n.strong,{children:"Strict equality"}),", and then specify the location of the .REG file, perhaps on a secure file server, as demonstrated here."]}),"\n",(0,i.jsx)(n.p,{children:"![A screenshot of a computer"}),"\n",(0,i.jsx)(n.p,{children:"Description automatically generated](/img/product_docs/policypak/policypak/leastprivilege/bestpractices/rules/creating_and_using_command_4.webp)"}),"\n",(0,i.jsx)(n.p,{children:"Since the arguments are being specified, a user cannot add their own .REG files; they can only add those specified by the admin (e.g., on a server where they could only read and not modify it)."})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var s=t(296540);const i={},r=s.createContext(i);function a(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);