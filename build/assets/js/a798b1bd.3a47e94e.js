"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[893753],{28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>t});var s=i(296540);const r={},l=s.createContext(r);function a(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(l.Provider,{value:n},e.children)}},685775:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"enterpriseauditor/requirements/target/exchangeonline","title":"Target Exchange Online Requirements, Permissions, and Ports","description":"The Access Analyzer for Exchange Solution provides the ability to audit Exchange Online. It scans:","source":"@site/docs/accessanalyzer/enterpriseauditor/requirements/target/exchangeonline.md","sourceDirName":"enterpriseauditor/requirements/target","slug":"/enterpriseauditor/requirements/target/exchangeonline","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/target/exchangeonline","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/enterpriseauditor/requirements/target/exchangeonline.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"Target Exchange Servers Requirements, Permissions, and Ports","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/target/exchange"},"next":{"title":"File System Supported Platforms","permalink":"/docs/accessanalyzer/enterpriseauditor/requirements/target/filesystems"}}');var r=i(474848),l=i(28453);const a={},t="Target Exchange Online Requirements, Permissions, and Ports",c={},o=[{value:"Permissions",id:"permissions",level:2},{value:"Ports",id:"ports",level:2}];function d(e){const n={a:"a",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"target-exchange-online-requirements-permissions-and-ports",children:"Target Exchange Online Requirements, Permissions, and Ports"})}),"\n",(0,r.jsx)(n.p,{children:"The Access Analyzer for Exchange Solution provides the ability to audit Exchange Online. It scans:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Exchange Online (Limited)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/support",children:"Exchange Support and Permissions Explained"})," topic for details on the type of auditing supported by data collector and by job group."]}),"\n",(0,r.jsx)(n.p,{children:"Data Collectors"}),"\n",(0,r.jsx)(n.p,{children:"This solution employs the following data collectors to scan the target environment:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/azureadinventory/overview",children:"AzureADInventory Data Collector"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/ewsmailbox/overview",children:"EWSMailbox Data Collector"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/ewspublicfolder/overview",children:"EWSPublicFolder Data Collector"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/admin/datacollector/exchangeps/overview",children:"ExchangePS Data Collector"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"permissions",children:"Permissions"}),"\n",(0,r.jsx)(n.p,{children:"For .Entra ID Inventory Prerequisite with the AzureADInventory Data Collector"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Microsoft Graph API"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Application Permissions:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"AuditLog.Read.All \u2013 Read all audit log data"}),"\n",(0,r.jsx)(n.li,{children:"Directory.Read.All \u2013 Read directory data"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Delegated Permissions:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Group.Read.All \u2013 Read all groups"}),"\n",(0,r.jsx)(n.li,{children:"User.Read.All \u2013 Read all users' full profiles"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Access URLs"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://login.windows.net",children:"https://login.windows.net"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://graph.windows.net",children:"https://graph.windows.net"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://login.microsoftonline.com",children:"https://login.microsoftonline.com"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://graph.microsoft.com",children:"https://graph.microsoft.com"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All sub-directories of the access URLs listed"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"/docs/accessanalyzer/config/entraid/access",children:"Microsoft Entra ID Auditing Configuration"})," topic for additional information."]}),"\n",(0,r.jsx)(n.p,{children:"Permissions for the Registered Microsoft Entra ID Application:\xa0Office 365 Exchange Online"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Application Permissions:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Exchange.ManageAsApp \u2013 Manage Exchange As Application"}),"\n",(0,r.jsx)(n.li,{children:"full_access_as_app \u2013 Use Exchange Web Services with full access to all mailboxes"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Exchange Administrator role assigned to the registered application's service principal"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"/docs/accessanalyzer/config/exchangeonline/access",children:"Exchange Online Auditing Configuration"})," topic for additional information."]}),"\n",(0,r.jsx)(n.p,{children:"For Exchange Web Services API Permissions with the EWSMailbox Data Collector"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Exchange Admin Role"}),"\n",(0,r.jsx)(n.li,{children:"Discovery Management Role"}),"\n",(0,r.jsx)(n.li,{children:"Exchange Online License"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/webservicesapi",children:"Exchange Web Services API Permissions"})," topic for additional information."]}),"\n",(0,r.jsx)(n.p,{children:"For Exchange Web Services API Permissions with the EWSPublicFolder Data Collector"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Exchange Admin Role"}),"\n",(0,r.jsx)(n.li,{children:"Discovery Management Role"}),"\n",(0,r.jsx)(n.li,{children:"Exchange Online License with a mailbox"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/webservicesapi",children:"Exchange Web Services API Permissions"})," topic for additional information."]}),"\n",(0,r.jsx)(n.p,{children:"For Exchange PowerShell with ExchangePS Data Collector"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Discovery Management Role"}),"\n",(0,r.jsx)(n.li,{children:"Organization Management Role"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/powershell",children:"Exchange PowerShell Permissions"})," topic for additional information."]}),"\n",(0,r.jsx)(n.h2,{id:"ports",children:"Ports"}),"\n",(0,r.jsx)(n.p,{children:"The following firewall ports are needed:"}),"\n",(0,r.jsx)(n.p,{children:"For AzureADInventory Data Collector"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"TCP 80 and 443"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"For EWSMailbox Data Collector"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"TCP 389"}),"\n",(0,r.jsx)(n.li,{children:"TCP 443"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"For EWSPublicFolder Data Collector"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"TCP 389"}),"\n",(0,r.jsx)(n.li,{children:"TCP 443"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"For ExchangePS Data Collector"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"TCP 135"}),"\n",(0,r.jsx)(n.li,{children:"Randomly allocated high TCP ports"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);