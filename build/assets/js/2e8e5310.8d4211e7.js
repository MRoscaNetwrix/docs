"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[191322],{28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>c});var s=i(296540);const o={},n=s.createContext(o);function r(e){const t=s.useContext(n);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(n.Provider,{value:t},e.children)}},324184:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/cacollectionqueries-d6318b70191ec1dbf183af5ac9b66cdf.webp"},779375:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"enterpriseauditor/solutions/activedirectory/certificateauthority/ad_cacollection","title":"Collection > AD\\\\_CACollection Job","description":"The AD\\\\_CACollection job collects Certificate Authority details and settings for analysis against potential vulnerabilities that exist in Active Directory Certificate Services configurations. This job is located in the Collection job group.","source":"@site/docs/accessanalyzer/enterpriseauditor/solutions/activedirectory/certificateauthority/ad_cacollection.md","sourceDirName":"enterpriseauditor/solutions/activedirectory/certificateauthority","slug":"/enterpriseauditor/solutions/activedirectory/certificateauthority/ad_cacollection","permalink":"/docs/accessanalyzer/enterpriseauditor/solutions/activedirectory/certificateauthority/ad_cacollection","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/enterpriseauditor/solutions/activedirectory/certificateauthority/ad_cacollection.md","tags":[],"version":"current","frontMatter":{},"sidebar":"accessAnalyzerSidebar","previous":{"title":"AD Security Assessment Job","permalink":"/docs/accessanalyzer/enterpriseauditor/solutions/activedirectory/ad_securityassessment"},"next":{"title":"AD\\\\_CertificateAudit Job","permalink":"/docs/accessanalyzer/enterpriseauditor/solutions/activedirectory/certificateauthority/ad_certificateaudit"}}');var o=i(474848),n=i(28453);const r={},c="Collection > AD_CACollection Job",a={},l=[{value:"Queries for the AD_CACollection Job",id:"queries-for-the-ad_cacollection-job",level:2},{value:"Analysis Tasks for the AD_CACollection Job",id:"analysis-tasks-for-the-ad_cacollection-job",level:2}];function d(e){const t={h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"collection--ad_cacollection-job",children:"Collection > AD_CACollection Job"})}),"\n",(0,o.jsx)(t.p,{children:"The AD_CACollection job collects Certificate Authority details and settings for analysis against potential vulnerabilities that exist in Active Directory Certificate Services configurations. This job is located in the Collection job group."}),"\n",(0,o.jsx)(t.p,{children:"Target Host"}),"\n",(0,o.jsxs)(t.p,{children:["It is recommended to target the ",(0,o.jsx)(t.strong,{children:"ONE DOMAIN CONTROLLER PER DOMAIN"})," or ",(0,o.jsx)(t.strong,{children:"Default domain controller"})," host list."]}),"\n",(0,o.jsx)(t.h2,{id:"queries-for-the-ad_cacollection-job",children:"Queries for the AD_CACollection Job"}),"\n",(0,o.jsx)(t.p,{children:"The AD_CACollection job uses the PowerShell data collector to collect details about Certificate Authorities, templates, and requests."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Queries for the AD_CACollection Job",src:i(324184).A+"",width:"1050",height:"348"})}),"\n",(0,o.jsx)(t.p,{children:"The queries for the job are:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"CA Connection String \u2013 Gets the Certificate Authority (CA)\xa0string to use for connections"}),"\n",(0,o.jsx)(t.li,{children:"Permissions \u2013 Returns Certificate Authority Access Control Lists (ACLs)"}),"\n",(0,o.jsx)(t.li,{children:"Registry Settings \u2013 Returns setup of Certificate Authorities"}),"\n",(0,o.jsx)(t.li,{children:"Enrollment Agents \u2013 Returns Enrollment Agent rights, availability, and details"}),"\n",(0,o.jsx)(t.li,{children:"NTLM Endpoints \u2013 Discovers NTLM enabled endpoints for Certificate Authorities"}),"\n",(0,o.jsx)(t.li,{children:"AllCertificates \u2013 Collects all certificate requests from the ADCS Database"}),"\n",(0,o.jsx)(t.li,{children:"CertificateTemplates \u2013 Gets certificate templates"}),"\n",(0,o.jsx)(t.li,{children:"CertificateTemplatesPublished \u2013 Collects information from the PkiEnrollmentServices"}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"analysis-tasks-for-the-ad_cacollection-job",children:"Analysis Tasks for the AD_CACollection Job"}),"\n",(0,o.jsxs)(t.p,{children:["Navigate to the ",(0,o.jsx)(t.strong,{children:"Active Directory"})," > ",(0,o.jsx)(t.strong,{children:"7.Certificate Authority"})," > ",(0,o.jsx)(t.strong,{children:"Collection"})," > ",(0,o.jsx)(t.strong,{children:"AD_CACollection"})," > ",(0,o.jsx)(t.strong,{children:"Configure"})," node and select ",(0,o.jsx)(t.strong,{children:"Analysis"})," to view the analysis tasks."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"CAUTION:"})," Do not modify or deselect the selected analysis tasks. The analysis tasks are preconfigured for this job."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Analysis Tasks for the AD_CACollection Job",src:i(785246).A+"",width:"629",height:"251"})}),"\n",(0,o.jsx)(t.p,{children:"The default analysis tasks are:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Split String \u2013 Splits strings on a given delimiter. This is used to break apart Certificate Values."}),"\n",(0,o.jsx)(t.li,{children:"Subject Alternative Names \u2013 Breakdown of all Subject Alternative Names in key value pairs. Creates the SA_AD_CertificateConfiguration_ALLSANs view accessible under the job\u2019s Results node."}),"\n",(0,o.jsx)(t.li,{children:"Certificate OIDs \u2013 Certificate templates split out with OIDs"}),"\n",(0,o.jsx)(t.li,{children:"Template Flags \u2013 Enumerates flags on certificate templates. Creates the SA_AD_CertificateConfiguration_Flags view accessible under the job\u2019s Results node."}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},785246:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/cacollectionanalysis-1468ec51782e90b52268629ab5bd3129.webp"}}]);