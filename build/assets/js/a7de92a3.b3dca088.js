"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[449031],{28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>a});var n=i(296540);const s={},o=n.createContext(s);function r(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(o.Provider,{value:t},e.children)}},39089:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/processes-dae193e63acf36ce18d480bc723927ba.webp"},124275:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/userstab-88b0911ddab65c3147b7b6fa747b6119.webp"},210630:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/operations-55f366404b17e72379fcd195b5de71f0.webp"},872308:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/servers-f41261310d34398fe36d9a6140913b8f.webp"},950718:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"activitymonitor/admin/monitoreddomains/admonitoringconfiguration/lsassguardian","title":"LSASS Guardian Tab","description":"The LSASS Guardian tab allows users to modify settings that were populated with the information entered when the host was added to prevent, monitor, or block LSASS code injections.","source":"@site/docs/activitymonitor/activitymonitor/admin/monitoreddomains/admonitoringconfiguration/lsassguardian.md","sourceDirName":"activitymonitor/admin/monitoreddomains/admonitoringconfiguration","slug":"/activitymonitor/admin/monitoreddomains/admonitoringconfiguration/lsassguardian","permalink":"/docs/activitymonitor/activitymonitor/admin/monitoreddomains/admonitoringconfiguration/lsassguardian","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/activitymonitor/activitymonitor/admin/monitoreddomains/admonitoringconfiguration/lsassguardian.md","tags":[],"version":"current","frontMatter":{},"sidebar":"activityMonitorSidebar","previous":{"title":"LDAP Monitor Tab","permalink":"/docs/activitymonitor/activitymonitor/admin/monitoreddomains/admonitoringconfiguration/ldapmonitor"},"next":{"title":"AD Monitoring Configuration Window","permalink":"/docs/activitymonitor/activitymonitor/admin/monitoreddomains/admonitoringconfiguration/overview"}}');var s=i(474848),o=i(28453);const r={},a="LSASS Guardian Tab",c={},d=[{value:"Operations",id:"operations",level:2},{value:"Processes",id:"processes",level:2},{value:"Servers",id:"servers",level:2},{value:"Users",id:"users",level:2}];function l(e){const t={em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"lsass-guardian-tab",children:"LSASS Guardian Tab"})}),"\n",(0,s.jsx)(t.p,{children:"The LSASS Guardian tab allows users to modify settings that were populated with the information entered when the host was added to prevent, monitor, or block LSASS code injections."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Operations Tab in the LSASS Guardian Tab",src:i(210630).A+"",width:"743",height:"852"})}),"\n",(0,s.jsx)(t.p,{children:"After checking the Enable LSASS Guardian box, the following event filters can be modified on the sub-tabs:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Operations"}),"\n",(0,s.jsx)(t.li,{children:"Processes"}),"\n",(0,s.jsx)(t.li,{children:"Servers"}),"\n",(0,s.jsx)(t.li,{children:"Users"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:'Each filter tab acts like an "AND" statement for the filter. Any filter tab left blank is treated like an "ALL" for that filter set.'}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.em,{children:(0,s.jsx)(t.strong,{children:"RECOMMENDED:"})})," Add exclusion process filters for legitimate processes that make changes to LSASS, e.g. third-party malware applications."]}),"\n",(0,s.jsx)(t.h2,{id:"operations",children:"Operations"}),"\n",(0,s.jsx)(t.p,{children:"The Operations option filters for successful events, failed events, or both."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Operations Tab in the LSASS Guardian Tab",src:i(210630).A+"",width:"743",height:"852"})}),"\n",(0,s.jsx)(t.p,{children:"The Open Process Flags section is where monitoring can be scoped for requested handles that would maliciously impact LSASS processes."}),"\n",(0,s.jsx)(t.p,{children:"Check the box to select the process flag(s) to be monitored:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"PROCESS_VM_WRITE \u2013 Writes to memory in a process"}),"\n",(0,s.jsx)(t.li,{children:"PROCESS_CREATE_THREAD \u2013 Creates a thread"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"processes",children:"Processes"}),"\n",(0,s.jsx)(t.p,{children:"The Processes option is where legitimate processes, which make changes to LSASS, e.g. third-party malware applications, can be included/excluded from being monitored by the policy."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Processes Tab in the LSASS Guardian Tab",src:i(39089).A+"",width:"743",height:"852"})}),"\n",(0,s.jsx)(t.p,{children:"Double-click the text box beneath Name to enter the desired processes to include or exclude. Press the Enter or Tab key to add another text box."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"NOTE:"})," While a processes inclusion is a filter option, it is not recommended for monitoring LSASS. Adding a process inclusion filter will limit the scope to only monitor that process. Unknown malicious processes would not be monitored in this case."]}),"\n",(0,s.jsx)(t.h2,{id:"servers",children:"Servers"}),"\n",(0,s.jsx)(t.p,{children:"The Servers option targets servers to be included or excluded when filtering for LSASS changes."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Servers Tab in the LSASS Guardian Tab",src:i(872308).A+"",width:"743",height:"852"})}),"\n",(0,s.jsx)(t.p,{children:"In both sections, servers must be specified in the form 'DOMAIN\\SERVER', where DOMAIN is NetBIOS Domain name and SERVER is NetBIOS server name."}),"\n",(0,s.jsx)(t.p,{children:"Double-click the textbox beneath Name to enter the desired servers to include or exclude. Press the Enter or Tab key to add another textbox."}),"\n",(0,s.jsx)(t.h2,{id:"users",children:"Users"}),"\n",(0,s.jsx)(t.p,{children:"The Users option is where the policy can be scoped to only monitor specific security principals committing changes within Active Directory or to exclude specific users committing changes from being monitored."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Users Tab in the LSASS Guardian Tab",src:i(124275).A+"",width:"743",height:"852"})}),"\n",(0,s.jsx)(t.p,{children:"The following details appear beneath both sections:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Subtree \u2013 If checked, the filter is applied to the parent and all child contexts. If unchecked, the filter is only applied to the listed context."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Type \u2013 Field must describe the type of the select Active Directory object and can have the following values:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"user \u2013 Indicates that selected object is user"}),"\n",(0,s.jsx)(t.li,{children:"group \u2013 Indicates that selected object is group"}),"\n",(0,s.jsx)(t.li,{children:"context \u2013 Indicates that selected object is container"}),"\n",(0,s.jsx)(t.li,{children:"sidType \u2013 Indicates that selected object is well-known SID type"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Distinguished Name \u2013 Field must be specified in the form of 'distinguishedName' attribute syntax, e.g. 'CN=Users,DC=Domain,DC=com'. However, for objects with 'sidType' type, it must be in the form of WellKnownSidType Enum, e.g. 'AnonymousSid' or 'LocalSid'."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Double-click the text box beneath Distinguished Name to enter the desired group types to include or exclude. Double-click the text box beneath Type to enter the desired AD object to include or exclude. Press the Enter or Tab key to add another text box. Check the box under Subtree to include or exclude child contexts."})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);