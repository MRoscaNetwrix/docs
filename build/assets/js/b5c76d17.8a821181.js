"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[110628],{28453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>i});var r=s(296540);const n={},o=r.createContext(n);function a(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),r.createElement(o.Provider,{value:t},e.children)}},187588:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"passwordreset/administration/moving_to_sql_server","title":"Moving to SQL Server","description":"Moving to SQL Server","source":"@site/docs/passwordreset/passwordreset/administration/moving_to_sql_server.md","sourceDirName":"passwordreset/administration","slug":"/passwordreset/administration/moving_to_sql_server","permalink":"/docs/passwordreset/passwordreset/administration/moving_to_sql_server","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/passwordreset/passwordreset/administration/moving_to_sql_server.md","tags":[],"version":"current","frontMatter":{},"sidebar":"passwordResetSidebar","previous":{"title":"Installation","permalink":"/docs/passwordreset/passwordreset/administration/installation"},"next":{"title":"Password Reset Client","permalink":"/docs/passwordreset/passwordreset/administration/password_reset_client"}}');var n=s(474848),o=s(28453);const a={},i="Moving to SQL Server",d={},c=[{value:"Create the Database",id:"create-the-database",level:3},{value:"Create the Tables and Copy the Data",id:"create-the-tables-and-copy-the-data",level:3},{value:"Configure Netwrix Password Reset to Connect to SQL Server",id:"configure-netwrix-password-reset-to-connect-to-sql-server",level:3},{value:"Other Tasks",id:"other-tasks",level:3}];function l(e){const t={code:"code",h1:"h1",h3:"h3",header:"header",img:"img",p:"p",strong:"strong",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"moving-to-sql-server",children:"Moving to SQL Server"})}),"\n",(0,n.jsx)(t.p,{children:"Moving to SQL Server"}),"\n",(0,n.jsx)(t.h1,{id:"moving-to-sql-server-1",children:"Moving to SQL Server"}),"\n",(0,n.jsx)(t.p,{children:"Some planning is needed before moving the database to SQL Server. A trial run on a lab network is recommended. You can run the Data Copy wizard more than once if you cannot complete the move on the first attempt. A move back to SQL Server Compact is also possible."}),"\n",(0,n.jsx)(t.h3,{id:"create-the-database",children:"Create the Database"}),"\n",(0,n.jsx)(t.p,{children:"Your database administrator needs to set up the SQL Server database. The instructions below are an overview of the procedure, they are not step-by-step instructions. NPR V3.30 has been tested with SQL Server 2012 to 2019."}),"\n",(0,n.jsx)(t.p,{children:"Follow the instructions below for an overview of the procedure."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 1 \u2013"})," Create an SQL Server database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 2 \u2013"})," Create an SQL Server login for the Password Reset service account, and configure it for Windows authentication. To identify the service account, open services.msc, double-click the Password Reset service, and then click the Log On tab. Password Reset logs on to SQL Server with this account."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"working_with_the_database",src:s(477901).A+"",width:"607",height:"409"})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 3 \u2013"})," Create an SQL Server user, and map it to the service account login."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 4 \u2013"})," Add the SQL Server user to the db_datareader, db_datawriter, and db_ddladmin server roles for the database."]}),"\n",(0,n.jsx)(t.p,{children:"Your database administrator also needs to grant access to the users that will use the Data Console. These users only need to be added to the db_datareader server role, and they can be denied access to the VerificationCode and EnrollRecord columns in the User table. The user running the Data Copy wizard also needs to be added to the db_datawriter and db_ddladmin server roles."}),"\n",(0,n.jsx)(t.p,{children:"Additional permissions can be set for users of the Data Console after the tables are created. Grant the DELETE privilege on the User table to users who are allowed to delete user records. Deny all privileges on the VerificationCode and EnrollRecord columns in the User table as they are not used by the Data Console."}),"\n",(0,n.jsx)(t.h3,{id:"create-the-tables-and-copy-the-data",children:"Create the Tables and Copy the Data"}),"\n",(0,n.jsx)(t.p,{children:"The Data Copy wizard creates the database tables and copies the data to SQL Server. You must run the wizard even if the SQL Server Compact database is empty. Data in the destination database is deleted before it is copied from the source database."}),"\n",(0,n.jsx)(t.p,{children:"Follow the steps below to create the tables and copy the data."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 1 \u2013"})," Open the Configuration Console."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 2 \u2013"})," Click the ",(0,n.jsx)(t.strong,{children:"General"})," tab."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 3 \u2013"})," Click ",(0,n.jsx)(t.strong,{children:"Copy Data..."})," to open the Data Copy wizard."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 4 \u2013"})," Click ",(0,n.jsx)(t.strong,{children:"Copy from SQL Compact to SQL Server"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 5 \u2013"})," Check the path to the SQL Server Compact database files. If the default path is incorrect, then click ",(0,n.jsx)(t.strong,{children:"Browse..."}),", choose a path, and then click ",(0,n.jsx)(t.strong,{children:"OK"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 6 \u2013"})," Click ",(0,n.jsx)(t.strong,{children:"Next"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 7 \u2013"})," Set the SQL Server connection settings for the Data Copy wizard. You can set different connection settings for the service account later. The ",(0,n.jsx)(t.strong,{children:"Username"})," and ",(0,n.jsx)(t.strong,{children:"Password"})," are only needed if ",(0,n.jsx)(t.strong,{children:"SQL Server Authentication"})," is selected. The user must be in the db_datareader, db_datawriter, and db_ddladmin SQL Server roles. ",(0,n.jsx)(t.strong,{children:"Encrypt connection"})," should be selected to protect user information, and ",(0,n.jsx)(t.strong,{children:"Trust server certificate"})," must be selected if SQL Server is using a self-signed certificate. SQL Server uses a self-signed certificate if a trusted certificate is not installed. The SQL Server Native Client must be installed if ",(0,n.jsx)(t.strong,{children:"Trust server certificate"})," is selected."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"working_with_the_database_1",src:s(965573).A+"",width:"483",height:"345"})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 8 \u2013"})," Click ",(0,n.jsx)(t.strong,{children:"Next"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 9 \u2013"})," Check the summary information, and then click ",(0,n.jsx)(t.strong,{children:"Start"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 10 \u2013"})," Wait for the wizard to finish, and then click ",(0,n.jsx)(t.strong,{children:"Close"}),"."]}),"\n",(0,n.jsx)(t.h3,{id:"configure-netwrix-password-reset-to-connect-to-sql-server",children:"Configure Netwrix Password Reset to Connect to SQL Server"}),"\n",(0,n.jsx)(t.p,{children:"Configure Password Reset to connect to SQL Server immediately after copying the data. If the cutover is delayed, then run the Data Copy wizard again to update the SQL Server database with the latest data. To configure Password Reset to connect to SQL Server:"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 1 \u2013"})," Open the Configuration Console."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 2 \u2013"})," Click the ",(0,n.jsx)(t.strong,{children:"General"})," tab."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 3 \u2013"})," Click ",(0,n.jsx)(t.strong,{children:"Change..."})]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 4 \u2013"})," Select the ",(0,n.jsx)(t.strong,{children:"SQL Server"})," option."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 5 \u2013"})," Type the server name in the ",(0,n.jsx)(t.strong,{children:"Server"})," text box. Use ",(0,n.jsx)(t.code,{children:"[server]\\[instance]"})," to connect to a named instance."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 6 \u2013"})," Type the database name in the ",(0,n.jsx)(t.strong,{children:"Database"})," text box."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 7 \u2013"})," Select the ",(0,n.jsx)(t.strong,{children:"Encrypt connection"})," option to encrypt the connection to SQL Server. This option should be selected to protect user information."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 8 \u2013"})," Select the ",(0,n.jsx)(t.strong,{children:"Trust server certificate"})," option if SQL Server is using a self-signed certificate. SQL Server uses a self-signed certificate if a trusted certificate is not installed. Password Reset cannot connect to SQL Server with a self-signed certificate if this option is not selected. The SQL Server Native Client must be installed if ",(0,n.jsx)(t.strong,{children:"Trust server certificate"})," is selected."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 9 \u2013"})," Click ",(0,n.jsx)(t.strong,{children:"OK"}),", and then click ",(0,n.jsx)(t.strong,{children:"Apply"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Step 10 \u2013"})," Restart the Password Reset service. If the service does not start, then check the database connection options and the SQL Server login, user, and server roles configured earlier. You can change the database back to SQL Server Compact while you troubleshoot the issue."]}),"\n",(0,n.jsx)(t.h3,{id:"other-tasks",children:"Other Tasks"}),"\n",(0,n.jsxs)(t.p,{children:["Open the Data Console and set your SQL Server connection options. You will need to enter a password every time you open the Data Console if ",(0,n.jsx)(t.strong,{children:"SQL Server Authentication"})," is selected. The Data Console executable and help file (APRDC.exe and CHM_NPR.chm) can be copied to the computers of other users who will use the Data Console."]}),"\n",(0,n.jsx)(t.p,{children:"Delete the two SQL Server Compact database files (apr.sdf and aprlog.sdf) after cutting over to SQL Server. These files will soon contain outdated information, and leaving them on the server is an unnecessary security risk. Also ensure that the SQL Server database is backed up regularly."})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},477901:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/working_with_the_database-e9b646621d93302e5c140dd592f4d0f2.webp"},965573:(e,t,s)=>{s.d(t,{A:()=>r});const r=s.p+"assets/images/working_with_the_database_1-c1cb6d50ffd3326a6c5931acb33e0e07.webp"}}]);