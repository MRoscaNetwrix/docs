"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[197018],{28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>o});var s=n(296540);const i={},r=s.createContext(i);function a(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:t},e.children)}},437240:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/endusersession-496b1c0d3043cae3c3121ff60ab6cbbe.webp"},510664:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/powershellscriptactionstep-95c2a43cd7ead69ae0e6918ad9846d68.webp"},550423:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/stopprocess-c5c41a16a1c66ab4f2c2047656b32b7f.webp"},647585:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"threatmanager/administration/playbooks/action/localhost","title":"Local Host Target Actions","description":"The following actions target the Threat Manager server.","source":"@site/docs/threatmanager/threatmanager/administration/playbooks/action/localhost.md","sourceDirName":"threatmanager/administration/playbooks/action","slug":"/threatmanager/administration/playbooks/action/localhost","permalink":"/docs/threatmanager/threatmanager/administration/playbooks/action/localhost","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/threatmanager/threatmanager/administration/playbooks/action/localhost.md","tags":[],"version":"current","frontMatter":{},"sidebar":"threatManagerSidebar","previous":{"title":"Entra ID Target Actions","permalink":"/docs/threatmanager/threatmanager/administration/playbooks/action/entraid"},"next":{"title":"Action Configuration for Playbook Steps","permalink":"/docs/threatmanager/threatmanager/administration/playbooks/action/overview"}}');var i=n(474848),r=n(28453);const a={},o="Local Host Target Actions",l={},c=[{value:"PowerShell Script",id:"powershell-script",level:2},{value:"Send Email",id:"send-email",level:2},{value:"Stop Process",id:"stop-process",level:2},{value:"End User Session",id:"end-user-session",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"local-host-target-actions",children:"Local Host Target Actions"})}),"\n",(0,i.jsx)(t.p,{children:"The following actions target the Threat Manager server."}),"\n",(0,i.jsx)(t.h2,{id:"powershell-script",children:"PowerShell Script"}),"\n",(0,i.jsx)(t.p,{children:"The PowerShell Script action executes a specified PowerShell script. This action can be used to build a custom threat response, using PowerShell, to handle scenarios not covered by other preconfigured action steps."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"powershellscriptactionstep",src:n(510664).A+"",width:"865",height:"1340"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"PowerShell Script \u2013 Select the PowerShell script to execute. By default, the PowerShell script includes a comment section which includes Threat Manager threat variables that can be used in PowerShell script action steps."}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Credential \u2013 Select a credential profile using the drop-down list. This will provide the PowerShell action step with a PowerShell credential object, based upon the Threat Manager credential specified for use in the script. For example:"}),"\n",(0,i.jsx)(t.p,{children:'$Session = New-PSSession -ComputerName "Computer01" -Credential $Credential'}),"\n",(0,i.jsxs)(t.p,{children:["Invoke-Command -Session $Session -ScriptBlock ",(0,i.jsx)(t.code,{children:'{Write-Host "Hello World"}'})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"send-email",children:"Send Email"}),"\n",(0,i.jsx)(t.p,{children:"The Send Email action sends an email."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"sendemail",src:n(844208).A+"",width:"79",height:"23"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Subject \u2013 The subject of the email"}),"\n",(0,i.jsx)(t.li,{children:"To \u2013 Specify the email addresses receiving the email"}),"\n",(0,i.jsx)(t.li,{children:"Body \u2013 The body of the email. HTML is supported."}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"stop-process",children:"Stop Process"}),"\n",(0,i.jsx)(t.p,{children:"The Stop Process action stops a process running locally on the host associated with the threat."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"stopprocess",src:n(550423).A+"",width:"844",height:"380"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Credential \u2013 Select a credential profile that contains valid Active Directory credentials. Credential profiles are configured on the ",(0,i.jsx)(t.a,{href:"/docs/threatmanager/threatmanager/administration/configuration/integrations/credentialprofile",children:"Credential Profile Page"}),". If not specified, the action will be run as the credentials of the Action Service."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"end-user-session",children:"End User Session"}),"\n",(0,i.jsx)(t.p,{children:"The End User Session action attempts to log the specified user out of any active RDP sessions on the target client."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"endusersession",src:n(437240).A+"",width:"839",height:"593"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Users \u2013 The users to log out of RDP sessions. If not specified, only the perpetrator will be used. Select the users from the drop-down list:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Perpetrator \u2013 The account that initiated the threat"}),"\n",(0,i.jsx)(t.li,{children:"Both Users and Perpetrators Affected \u2013 The account that initiated the threat and also the users affected by the threat"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Computers \u2013 The computers to log a user out of a RDP session. If not specified, only the perpetrator client will be used. Select computers from the drop down list:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Perpetrator Client \u2013 The computer that initiated the threat"}),"\n",(0,i.jsx)(t.li,{children:"Host \u2013 The host client that initiated the threat"}),"\n",(0,i.jsx)(t.li,{children:"Both Perpetrator Client and Host \u2013 The computer and the host client affected by the threat"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["Credential \u2013 The domain credential used to run the action. Domain credentials are populated by credential profiles that are created on the Integrations page. If not specified, the action will be run under the credentials of the action. Select the credentials from the drop-down list. See the ",(0,i.jsx)(t.a,{href:"/docs/threatmanager/threatmanager/administration/configuration/integrations/credentialprofile",children:"Credential Profile Page"})," topic for additional information."]}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},844208:(e,t,n)=>{n.d(t,{A:()=>s});const s="data:image/webp;base64,UklGRigCAABXRUJQVlA4IBwCAADwDACdASpPABcAPm0uk0akIiGhKbqraIANiWIAz0GgME5yUD9ZusllsmO1/hcxXjgO4B90v8t6PP9B5RPnT/c+4P+qH+u4Bb9dGI69QsxWumAZonn/5SYfzN46UjKLuZHiUsg4RRBrUTUMmEl7o/WAAP7/mB2xvaFv9h6pJpg1Sgoid/ESA7DPiYkvghjXPsYj3XsmR8B/tOxCDX1o1+QqU94zi1AFkYu70hFGGW0rSUWTSi7e5pN9Pk7g5IEaf90Urv/01SJ9uAjC1/e0Sf/4mM2hz8myjJV6f9bJd8C/Tl4l+/FF1z5DMW/RJwIf1UhoslLckh4Essk8t0lDCbcV30oS2VZQaxYpmX1X+ZV7KuokZl135DdPbTwWaLOu3Hy1R2B+4F/bEYA9+/xm02QuiVBHTYs3Sr9e092TABlsl+RwaK2dzXjPV79dF2I5eeFIsx0AWKg+jfTh7LIsnPCcn/zyFPb7lxMb2Bi/ZahsVHvR9x75v8iJ/w8p/6bR//5R8V22hlFkf8dvw2cRtP/lS7xM8jZdYs0H0DObbVLzbnkoe6HxAb2hLXCDook+lGXbFj4ze47T/9jn0zV3063cNeJMmInNN5d2442gp/xnGffFfT2FkUAG8OMlTsc5tNHFpfNOlGqWr0NHPWSNfXFP9aUB/ZQGkOPNc9rUBnnd6pflEzuz4Ar9xS/4yY69cxbOSknlOedBorM8AAA="}}]);