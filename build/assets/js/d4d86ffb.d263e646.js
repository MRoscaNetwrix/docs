"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[230455],{28453:(e,s,c)=>{c.d(s,{R:()=>o,x:()=>n});var i=c(296540);const t={},r=i.createContext(t);function o(e){const s=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function n(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:s},e.children)}},651895:(e,s,c)=>{c.d(s,{A:()=>i});const i=c.p+"assets/images/scenario_4_elevating_a_service-3f2eb75e58c37083c7fc308df56e9f45.webp"},815504:(e,s,c)=>{c.r(s),c.d(s,{assets:()=>a,contentTitle:()=>n,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"policypak/leastprivilege/scopefilters/elevateserviceaccount","title":"Scenario 4: Elevating a Service Account","description":"NOTE: For an overview of this scenario see the Reduce or specify Service Account Rights video.","source":"@site/docs/policypak/policypak/leastprivilege/scopefilters/elevateserviceaccount.md","sourceDirName":"policypak/leastprivilege/scopefilters","slug":"/policypak/leastprivilege/scopefilters/elevateserviceaccount","permalink":"/docs/policypak/policypak/leastprivilege/scopefilters/elevateserviceaccount","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/leastprivilege/scopefilters/elevateserviceaccount.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Scenario 2B: Block Powershell.exe Completely, but Allow Local System to Run a Specific .PS1 Script","permalink":"/docs/policypak/policypak/leastprivilege/scopefilters/blockpowershell"},"next":{"title":"Scenario 1: Enhanced SecureRun / Prevent Untrusted Executables and Scripts from Running Even by LOCAL SYSTEM","permalink":"/docs/policypak/policypak/leastprivilege/scopefilters/enhancedsecurerun"}}');var t=c(474848),r=c(28453);const o={},n="Scenario 4: Elevating a Service Account",a={},l=[];function p(e){const s={a:"a",code:"code",h1:"h1",header:"header",img:"img",p:"p",strong:"strong",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"scenario-4-elevating-a-service-account",children:"Scenario 4: Elevating a Service Account"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"NOTE:"})," For an overview of this scenario see the ",(0,t.jsx)(s.a,{href:"/docs/policypak/policypak/video/leastprivilege/bestpractices/serviceaccountrights",children:"Reduce or specify Service Account Rights"})," video."]}),"\n",(0,t.jsx)(s.p,{children:"You might have a service which requires specific privileges. Maybe your service, by default, uses Local System, and you want to give it lessrights."}),"\n",(0,t.jsxs)(s.p,{children:["With Endpoint Policy Manager ",(0,t.jsx)(s.a,{href:"/docs/policypak/policypak/video/leastprivilege/bestpractices/serviceaccountrights",children:"Reduce or specify Service Account Rights"}),", you can remove the powerful privileges of the service account and strip out LOCAL SYSTEM and grant a specific user the permissions required."]}),"\n",(0,t.jsx)(s.p,{children:"If you want a process to be run via special user account, you need to do the following:"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Step 1 \u2013"})," Make a rule for an .exe from which the service runs."]}),"\n",(0,t.jsxs)(s.p,{children:["We recommend to make a File Info + Signature rule, but PATH rules would work as well, e.g. ",(0,t.jsx)(s.code,{children:"C:\\Program Files\\AppABC \\AppService.exe"})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Step 2 \u2013"})," On the Actions page select ",(0,t.jsx)(s.strong,{children:"Run with custom token"})," and configure the TOKEN and/or exact PRIVILEGES the process needs, like Load Driver Privilege (SeLoadDriverPrivilege), orBypass Traverse Checking (SeChangeNotify)."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Step 3 \u2013"})," On the final page select ",(0,t.jsx)(s.strong,{children:"Scope"})," > ",(0,t.jsx)(s.strong,{children:"User and System Processes"}),". ",(0,t.jsx)(s.strong,{children:"Scope Filter"})," should be trimmed to the specific account you specified to run the service runs as."]}),"\n",(0,t.jsx)(s.p,{children:"Tip: It's also possible to use Scope Filter = SERVICES to make the rule apply to all services that run from the specified .exe, regardless of the user."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"A screenshot of a computer Description automatically generated",src:c(651895).A+"",width:"1416",height:"696"})})]})}function u(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}}}]);