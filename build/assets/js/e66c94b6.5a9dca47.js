"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[188264],{28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>l});var s=n(296540);const o={},i=s.createContext(o);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(i.Provider,{value:t},e.children)}},227740:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/116_2_msiuu2-image-006-5ecdad36b714a940abe43729686177d5.jpg"},803029:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/116_1_msiuu2-image-005-cfb4d83e02572d4a2a0af1790892b028.jpg"},953756:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"policypak/troubleshooting/install/uninstall","title":"The CSE won\'t uninstall or allow in-place upgrade. What should I do?","description":"The issue of the CSE not allowing an uninstall or an updrage isn\'t a problem with the Netwrix Endpoint Policy Manager (formerly PolicyPak) CSE. This is a problem with the MSI database that contains the contents of what is registered or not.","source":"@site/docs/policypak/policypak/troubleshooting/install/uninstall.md","sourceDirName":"policypak/troubleshooting/install","slug":"/policypak/troubleshooting/install/uninstall","permalink":"/docs/policypak/policypak/troubleshooting/install/uninstall","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/troubleshooting/install/uninstall.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"What can I do if I installed a new CSE version and it\'s causing problems (slowdowns or other issues?)","permalink":"/docs/policypak/policypak/troubleshooting/install/newversionissues"},"next":{"title":"Intel Driver and Support Assistant","permalink":"/docs/policypak/policypak/troubleshooting/intelgraphicdriver"}}');var o=n(474848),i=n(28453);const r={},l="The CSE won't uninstall or allow in-place upgrade. What should I do?",a={},h=[{value:"Resolution",id:"resolution",level:2}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",strong:"strong",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"the-cse-wont-uninstall-or-allow-in-place-upgrade-what-should-i-do",children:"The CSE won't uninstall or allow in-place upgrade. What should I do?"})}),"\n",(0,o.jsx)(t.p,{children:"The issue of the CSE not allowing an uninstall or an updrage isn't a problem with the Netwrix Endpoint Policy Manager (formerly PolicyPak) CSE. This is a problem with the MSI database that contains the contents of what is registered or not."}),"\n",(0,o.jsxs)(t.p,{children:["One quick fix we have seen is to rename the newest CSE you get from us to something unique. For instance, ",(0,o.jsx)(t.code,{children:"PolicyPak-CSE-SETUPx64-BUILD12345.MSI"}),", then retry your upgrade. Users have reported that this can fix the problem by fooling the MSI\xa0database."]}),"\n",(0,o.jsx)(t.p,{children:"If that does not work, you might see a dialog similar to this when trying to install/uninstall. Even if you revert to a previous version, it is still likely that the CSE won't uninstall."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"116_1_msiuu2-image-005",src:n(803029).A+"",width:"548",height:"332"})}),"\n",(0,o.jsx)(t.h2,{id:"resolution",children:"Resolution"}),"\n",(0,o.jsxs)(t.p,{children:["Microsoft has a one-off fix to deal with broken MSIs that get stuck.\xa0Start with this solution from Microsoft to test on one machine. See Microsoft's article ",(0,o.jsx)(t.a,{href:"https://support.microsoft.com/en-us/topic/fix-problems-that-block-programs-from-being-installed-or-removed-cca7d1b6-65a9-3d98-426b-e9f927e1eb4d",children:"Fix problems that block programs from being installed or removed"})," for the procedure on this solution."]}),"\n",(0,o.jsx)(t.p,{children:"If the procedure from Microsoft's article is unsuccessful, try the following steps on one machine."}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 1 \u2013"})," Remove existing CSE version to allow\xa0a re-installation of the newest CSE, download MSICUU from this link: ",(0,o.jsx)(t.a,{href:"https://www.policypak.com/pp-files/msicuu2.zip",children:"https://www.policypak.com/pp-files/msicuu2.zip"})]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 2 \u2013"})," Then launch it and select the CSE version and click ",(0,o.jsx)(t.strong,{children:"Remove"}),"."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"116_2_msiuu2-image-006",src:n(227740).A+"",width:"545",height:"550"})}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 3 \u2013"})," Manually install the latest Endpoint Policy Manager CSE, and verify it worked as expected."]}),"\n",(0,o.jsx)(t.p,{children:"If that succeeds, follow these steps."}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 1 \u2013"})," Test a scriptversion of that on some machines."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 2 \u2013"})," Try to deploy the new CSE to some machines."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 3 \u2013"})," Run the script on the remainder of your machines."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 4 \u2013"})," Deploy the new CSE to the remainder of your machines."]}),"\n",(0,o.jsxs)(t.p,{children:["If you don't already have a tool you use to deploy the Endpoint Policy Manager CSE, we recommend you use PDQ Deploy ",(0,o.jsx)(t.a,{href:"https://www.pdq.com/",children:"(www.PDQ.com"}),"). There is a free and a paid version of the tool, either version will work."]}),"\n",(0,o.jsx)(t.p,{children:"Once the new CSE is deployed to the remainder of your machines, follow these steps."}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 1 \u2013"})," Download our ",(0,o.jsxs)(t.a,{href:"https://www.policypak.com/pp-files/ppMSIzapscript-4191.zip",children:[(0,o.jsx)(t.code,{children:"MSIZAP"})," and batch file"]}),"."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"NOTE:"})," ",(0,o.jsx)(t.code,{children:"MSIZAP"})," is a command line version of ",(0,o.jsx)(t.code,{children:"MSICUU"})," that was used in the previous steps.."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 2 \u2013"})," Locate the batch file included in the download."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 3 \u2013"})," Run the batch file which will perform the uninstall using ",(0,o.jsx)(t.code,{children:"MSIZAP"}),". It only works if you put the old versions in another location. You'll see if you open up the batch file, which is much clearer."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"NOTE:"})," If the batch file needs updating and doesn't contain the MSI codes for the version you are trying to uninstall, please work with your Netwrix support rep who can get that updated for you."]}),"\n",(0,o.jsx)(t.p,{children:"After the batch file has been run, follow these steps."}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 1 \u2013"})," Manually test the batch file on a handful of machines."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 2 \u2013"})," Verify that it worked."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 3 \u2013"})," Don't try to run the script on all your machines yet."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 4 \u2013"})," Try PDQ Deploy to get the latest CSE on those endpoints."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 5 \u2013"})," Run the script on the remainder of your machines."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 6 \u2013"})," Continue to use PDQ deploy to get the rest of the machines CSEs installed."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Step 7 \u2013"})," Rename the latest CSE to be a unique name while attempting your upgrade. This might yield more success, according to at least one customer report."]}),"\n",(0,o.jsx)(t.p,{children:"The machines are now updated with a new CSE. If this solution was unsuccessful, contact your Netwrix support representative for additional assistance."})]})}function d(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);