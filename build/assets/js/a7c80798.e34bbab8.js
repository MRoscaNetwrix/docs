"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[670926],{28453:(e,i,n)=>{n.d(i,{R:()=>a,x:()=>l});var s=n(296540);const o={},t=s.createContext(o);function a(e){const i=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),s.createElement(t.Provider,{value:i},e.children)}},117930:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>r,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"policypak/troubleshooting/remoteworkdelivery/tips/specialvariables","title":"About Special Variables","description":"For running processes after the file is copied (called post copy) or when the policy no longer applies (called revert action) we have the variables `%DestinationFile%` and `%DestinationDir%`. The ideal format is to use these variables inside straight quotes, for example \\"%DestinationFile%\\" and \\"%DestinationDir%\\", so filenames and directory names with spaces will correctly unfurl and evaluate correctly. For running PowerShell commands in these post copy or revert action scenarios, we have the variables `$EnvDestinationFile`. For these variables, you do not need to use quotes. We\'ll see how to use these variables in following sections.","source":"@site/docs/policypak/policypak/troubleshooting/remoteworkdelivery/tips/specialvariables.md","sourceDirName":"policypak/troubleshooting/remoteworkdelivery/tips","slug":"/policypak/troubleshooting/remoteworkdelivery/tips/specialvariables","permalink":"/docs/policypak/policypak/troubleshooting/remoteworkdelivery/tips/specialvariables","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/troubleshooting/remoteworkdelivery/tips/specialvariables.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"Tips: Wildcards and Variables","permalink":"/docs/policypak/policypak/troubleshooting/remoteworkdelivery/tips/overview"},"next":{"title":"About Wildcards","permalink":"/docs/policypak/policypak/troubleshooting/remoteworkdelivery/tips/wildcards"}}');var o=n(474848),t=n(28453);const a={},l="About Special Variables",r={},c=[{value:"Using Special Variables by Running a Process",id:"using-special-variables-by-running-a-process",level:2},{value:"Using Special Variables by Running a PowerShell Command",id:"using-special-variables-by-running-a-powershell-command",level:2}];function d(e){const i={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.header,{children:(0,o.jsx)(i.h1,{id:"about-special-variables",children:"About Special Variables"})}),"\n",(0,o.jsxs)(i.p,{children:["For running processes after the file is copied (called post copy) or when the policy no longer applies (called revert action) we have the variables ",(0,o.jsx)(i.code,{children:"%DestinationFile%"})," and ",(0,o.jsx)(i.code,{children:"%DestinationDir%"}),'. The ideal format is to use these variables inside straight quotes, for example "%DestinationFile%" and "%DestinationDir%", so filenames and directory names with spaces will correctly unfurl and evaluate correctly. For running PowerShell commands in these post copy or revert action scenarios, we have the variables ',(0,o.jsx)(i.code,{children:"$Env:DestinationDir"})," and ",(0,o.jsx)(i.code,{children:"$Env:DestinationFile"}),". For these variables, you do not need to use quotes. We'll see how to use these variables in following sections."]}),"\n",(0,o.jsx)(i.h2,{id:"using-special-variables-by-running-a-process",children:"Using Special Variables by Running a Process"}),"\n",(0,o.jsx)(i.p,{children:"You can use special variables in a variety of situations. Here are some examples for standard policies only:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:"Run a process to install software after the software is delivered:"}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.code,{children:'msiexec.exe /i "%DestinationFile%"/qn'})}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:"Run a process to install specific software in a specific directory:"}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.code,{children:"msiexec.exe /i %DestinationDir%\\7zip.msi /qn"})}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:'Run a process to count the lines in a file (The examples counts the lines in the file that don\'t have the unlikely string "ZZZZZYYYXX"):'}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.code,{children:'%DestinationFile% | file /v /c "ZZZZZYYYXX"> %DestinationDir%\\numlines.txt'})}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:"Run a process to count the number of files in the destination folder:"}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.code,{children:'attrib.exe "%DestinationDir%"/s ./*.xml | find /v "File not found - " | find /c /v "" > numfiles.txt'})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(i.h2,{id:"using-special-variables-by-running-a-powershell-command",children:"Using Special Variables by Running a PowerShell Command"}),"\n",(0,o.jsx)(i.p,{children:"If you want to use PowerShell commands to install files (which is required for the Endpoint Policy Manager Remote Work Delivery Manager Lite Endpoint Policy Manager Cloud policies and optional in web or standard policies), here are some examples that can be used with standard policies and Endpoint Policy Manager Cloud:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:["Create a new file in the destination directory: ",(0,o.jsx)(i.code,{children:'New-Item $Env:DestinationDir\\new_file.txt -type file -force -value "Hello world"'})]}),"\n",(0,o.jsxs)(i.li,{children:["Install an MSI file immediately and quietly after downloading it ",(0,o.jsx)(i.code,{children:": msiexec.exe /i\xa0$Env:DestinationFile /qn"})]}),"\n",(0,o.jsxs)(i.li,{children:["Install a non-MSI application, like Notepad++ setup installer immediately after downloading it (with its own switches, such as capital /S for silent, in the case of Notepad++ setup routine): ",(0,o.jsx)(i.code,{children:"npp.7.5.6.Installer.exe $Env:DestinationFile /S"})]}),"\n"]})]})}function p(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);