"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[196713],{28453:(e,o,t)=>{t.d(o,{R:()=>a,x:()=>r});var n=t(296540);const i={},s=n.createContext(i);function a(e){const o=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function r(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(s.Provider,{value:o},e.children)}},904867:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>a,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"policypak/scriptstriggers/windows7tls","title":"How do I update Windows 7 machines to TLS 1.2 such that they work with Endpoint Policy Manager Cloud?","description":"First know that Windows 7 is not officially supported by Netwrix Endpoint Policy Manager (formerly PolicyPak) and may or may not work for all functions.","source":"@site/docs/policypak/policypak/scriptstriggers/windows7tls.md","sourceDirName":"policypak/scriptstriggers","slug":"/policypak/scriptstriggers/windows7tls","permalink":"/docs/policypak/policypak/scriptstriggers/windows7tls","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/scriptstriggers/windows7tls.md","tags":[],"version":"current","frontMatter":{},"sidebar":"policyPakSidebar","previous":{"title":"What is the expected behavior on Windows 10 when you MODIFY an existing Endpoint Policy Manager Scripts script?","permalink":"/docs/policypak/policypak/scriptstriggers/windows10modifyscript"},"next":{"title":"How to import a WLAN / 802.11 / Wireless profile from Dropbox using Endpoint Policy Scripts Manager","permalink":"/docs/policypak/policypak/scriptstriggers/wlandropbox"}}');var i=t(474848),s=t(28453);const a={},r="How do I update Windows 7 machines to TLS 1.2 such that they work with Endpoint Policy Manager Cloud?",c={},l=[];function d(e){const o={a:"a",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.header,{children:(0,i.jsx)(o.h1,{id:"how-do-i-update-windows-7-machines-to-tls-12-such-that-they-work-with-endpoint-policy-manager-cloud",children:"How do I update Windows 7 machines to TLS 1.2 such that they work with Endpoint Policy Manager Cloud?"})}),"\n",(0,i.jsx)(o.p,{children:"First know that Windows 7 is not officially supported by Netwrix Endpoint Policy Manager (formerly PolicyPak) and may or may not work for all functions."}),"\n",(0,i.jsx)(o.p,{children:"Pre-read the following to know what is known to NOT work in Windows 7 before continuing:"}),"\n",(0,i.jsx)(o.p,{children:(0,i.jsx)(o.a,{href:"/docs/policypak/policypak/requirements/support/windows11",children:"How does Endpoint Policy Manager support (and not support) Windows 11?"})}),"\n",(0,i.jsx)(o.p,{children:"Then after that, if you still wish to use Endpoint Policy Manager with Windows 7 and Endpoint Policy Manager Cloud, you must update Windows 7 to\nbe TLS 1.2 complaint."}),"\n",(0,i.jsxs)(o.p,{children:["Then to adjust on these computers, all pre-Windows 10 machines must be upgraded to use TLS 1.2 on the client. The\nhow-to from Microsoft is here:",(0,i.jsx)(o.a,{href:"https://docs.microsoft.com/en-us/mem/configmgr/core/plan-design/security/enable-tls-1-2-client",children:"https://docs.microsoft.com/en-us/mem/configmgr/core/plan-design/security/enable-tls-1-2-client"}),"The\nquick version goes like this:"]}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsx)(o.li,{children:"Have Service Pack 1 installed (on Windows 7)."}),"\n",(0,i.jsxs)(o.li,{children:["Have the Windows Update KB3140245 installed. (Download from ",(0,i.jsx)(o.a,{href:"https://www.catalog.update.microsoft.com/search.aspx?q=kb3140245",children:"https://www.catalog.update.microsoft.com/search.aspx?q=kb3140245"}),".)"]}),"\n",(0,i.jsxs)(o.li,{children:["Update the registry. (Download the Microsoft ",(0,i.jsx)(o.a,{href:"https://support.microsoft.com/en-us/topic/update-to-enable-tls-1-1-and-tls-1-2-as-default-secure-protocols-in-winhttp-in-windows-c4bd73d2-31d7-761e-0178-11268bb10392#httpssupportmicrosoftcomen-ustopicupdate-to-enable-tls-1-1-and-tls-1-2-as-default-secure-protocols-in-winhttp-in-windows-c4bd73d2-31d7-761e-0178-11268bb10392bkmk_easy",children:"https://support.microsoft.com/en-us/topic/update-to-enable-tls-1-1-and-tls-1-2-as-default-secure-protocols-in-winhttp-in-windows-c4bd73d2-31d7-761e-0178-11268bb10392#bkmk_easy"})," which is downloadable as a .MSI for easy deliver.)"]}),"\n"]}),"\n",(0,i.jsx)(o.p,{children:"Note that Endpoint Policy Manager Support cannot be engaged for you to update these machines on your behalf. And we cannot\nautomatically validate or report that you have performed the steps correctly."}),"\n",(0,i.jsx)(o.p,{children:'If you wish to script the installation of the KB3140245 hotfix and the Registry with the "Easy fix" you\ncan do so with two scripts. These scripts will work with Endpoint Policy Manager Cloud and Endpoint Policy Manager Scripts Manager (GPO, MDM or\nCloud.)'}),"\n",(0,i.jsxs)(o.p,{children:["The video explaining how to do this by hand, or by script, or using Endpoint Policy Manager Scripts can be found at : ",(0,i.jsx)(o.a,{href:"#How-do-I-update-Windows-7-machines-to-TLS-12-such-that-they-work-with-Endpoint-Policy-Manager-Cloud",children:"How do I update Windows 7 machines to TLS 1.2 such that they work with Endpoint Policy Manager Cloud?"})]}),"\n",(0,i.jsx)(o.p,{children:"Note for the MSU file, you will need to stage it on Amazon S3 or another publicly readable service like Azure Blob\nstorage. The file cannot automatically be downloaded by Windows 7 in its original home location because that download\nrequires TLS 1.2; and the machine you're trying to update doesn't support that yet. \xa0Note also that\nthe script references the 64-bit MSU file. You will need a separate script to deliver the MSU to 32-bit Windows 7\nmachines. Or if you have Windows 8 machines or Server 2008 R2 machines, use the corresponding MSU from the Microsoft\nCatalog referenced above."}),"\n",(0,i.jsx)(o.p,{children:"Script 1: Win 7 MSU Update"}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{children:'# Microsoft MSU will be coming from = https://z_deleteme.s3.amazonaws.com/windows6.1-kb3140245-x64_5b067ffb69a94a6e5f9da89ce88c658e52a0dec0.msu  \n#Script starts here  \nSet-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass -Force  \n# Set Download variables  \n$DownloadFolder = "c:\\temp\\apps"  \n$DownloadURL = "https://z_deleteme.s3.amazonaws.com/windows6.1-kb3140245-x64_5b067ffb69a94a6e5f9da89ce88c658e52a0dec0.msu"  \n$LocalDownloadFile = "c:\\temp\\apps\\kb3140245-x64.msu"  \n#Create temp folder if not present  \n$tempfolder = "C:\\temp"  \nif (-not (Test-Path $tempfolder -PathType Container))  \n{  \nNew-Item -ItemType directory -Path $tempfolder  \n}  \n# Create apps folder and enable logging  \nNew-Item -ItemType directory -Path $DownloadFolder  \nstart-transcript -path "c:\\temp\\apps\\kb3140245-x64_PS.log" -append  \n# Download and install kb3140245-x64.msu  \nIf ((Test-Path $LocalDownloadFile -PathType Leaf) -eq $False)  \n{  \nInvoke-WebRequest -Uri $DownloadURL -OutFile $LocalDownloadFile  \n#install kb3140245-x64.msu silently and enable verbose logging  \nwusa.exe c:\\temp\\apps\\kb3140245-x64.msu /quiet /norestart /log:c:\\temp\\apps\\kb3140245-x64_MSU.log  \n}  \n#Script ends here\n'})}),"\n",(0,i.jsx)(o.p,{children:"Script 2: Win 7 Easy Fix"}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{children:'# Microsoft EasyFix will be coming from here: https://download.microsoft.com/download/0/6/5/0658B1A7-6D2E-474F-BC2C-D69E5B9E9A68/MicrosoftEasyFix51044.msi  \n#Script starts here  \nSet-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass -Force  \n# Set Download variables  \n$DownloadFolder = "c:\\temp\\apps"  \n$DownloadURL = "https://download.microsoft.com/download/0/6/5/0658B1A7-6D2E-474F-BC2C-D69E5B9E9A68/MicrosoftEasyFix51044.msi"  \n$LocalDownloadFile = "c:\\temp\\apps\\MicrosoftEasyFix51044.msi"  \n#Create temp folder if not present  \n$tempfolder = "C:\\temp"  \nif (-not (Test-Path $tempfolder -PathType Container))  \n{  \nNew-Item -ItemType directory -Path $tempfolder  \n}  \n# Create apps folder and enable logging  \nNew-Item -ItemType directory -Path $DownloadFolder  \nstart-transcript -path "c:\\temp\\apps\\MicrosoftEasyFix51044.msi_PS.log" -append  \n# Download and install MSEasyFix  \nIf ((Test-Path $LocalDownloadFile -PathType Leaf) -eq $False)  \n{  \nInvoke-WebRequest -Uri $DownloadURL -OutFile $LocalDownloadFile  \n#install MSEasyFix silently and enable verbose logging  \nmsiexec.exe /i c:\\temp\\Apps\\MicrosoftEasyFix51044.msi /qn /L*V C:\\temp\\apps\\MSEasyFix_install.log  \n}  \n#Script ends here\n'})})]})}function p(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);