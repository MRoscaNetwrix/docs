"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[327141],{28453:(e,t,s)=>{s.d(t,{R:()=>d,x:()=>c});var i=s(296540);const r={},n=i.createContext(r);function d(e){const t=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(n.Provider,{value:t},e.children)}},781914:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"activitymonitor/admin/outputs/logfile/activedirectoryjson","title":"Active Directory JSON Log File","description":"The following information lists all of the attributes generated by Active Directory Activity Monitor into a JSON log file:","source":"@site/docs/activitymonitor/activitymonitor/admin/outputs/logfile/activedirectoryjson.md","sourceDirName":"activitymonitor/admin/outputs/logfile","slug":"/activitymonitor/admin/outputs/logfile/activedirectoryjson","permalink":"/docs/activitymonitor/activitymonitor/admin/outputs/logfile/activedirectoryjson","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/activitymonitor/activitymonitor/admin/outputs/logfile/activedirectoryjson.md","tags":[],"version":"current","frontMatter":{},"sidebar":"activityMonitorSidebar","previous":{"title":"GID Exclusions Tab","permalink":"/docs/activitymonitor/activitymonitor/admin/outputs/gidexclusions"},"next":{"title":"File TSV Log File","permalink":"/docs/activitymonitor/activitymonitor/admin/outputs/logfile/filetsv"}}');var r=s(474848),n=s(28453);const d={},c="Active Directory JSON Log File",o={},l=[];function a(e){const t={a:"a",h1:"h1",header:"header",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"active-directory-json-log-file",children:"Active Directory JSON Log File"})}),"\n",(0,r.jsx)(t.p,{children:"The following information lists all of the attributes generated by Active Directory Activity Monitor into a JSON log file:"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Attributes"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"AffectedObject"}),(0,r.jsx)(t.td,{children:"If resolved, contains DN of the object affected by operation; otherwise, some textual representation of the object"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"AffectedObjectAccountName"}),(0,r.jsx)(t.td,{children:"If resolved, contains account name of the object affected by operation"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"AffectedObjectSid"}),(0,r.jsx)(t.td,{children:"If resolved, contains Sid of the object affected by operation"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"AgentDomain"}),(0,r.jsx)(t.td,{children:"Domain where SI agent is installed"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"AgentHost"}),(0,r.jsx)(t.td,{children:"Host name where SI agent is installed"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"AgentIP"}),(0,r.jsx)(t.td,{children:"IP address where SI agent is installed. If multiple IP addresses, one of them is reported."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"AuthenticationType"}),(0,r.jsx)(t.td,{children:"Indicates type of the authentication event. Possible values: Kerberos, NTLM."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"AuthProtocol"}),(0,r.jsx)(t.td,{children:"Indicates authentication protocol. Possible values: Unknown, Kerberos, KerberosTgs, KerberosAS, NTLM, NTLMv1, NTLMMixed, NTLMv2."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Blocked"}),(0,r.jsx)(t.td,{children:"Indicates if operation was blocked by SI agent. Blocking policies are required."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"ClassName"}),(0,r.jsx)(t.td,{children:"Affected object class"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"DesiredAccess"}),(0,r.jsxs)(t.td,{children:["Security and access rights requested during OpenProcess invoke. List of possible values can be found at:\xa0 ",(0,r.jsx)(t.a,{href:"https://docs.microsoft.com/en-us/windows/desktop/ProcThread/process-security-and-access-rights",children:"https://docs.microsoft.com/en-us/windows/desktop/ProcThread/process-security-and-access-rights"}),"."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"EncryptionType"}),(0,r.jsx)(t.td,{children:"Indicates encryption type used in request part of the Kerberos ticket. Possible values: des_cbc_crc, des_cbc_md4, des_cbc_md5, reserved_0x4, des3_cbc_md5, reserved_0x6, des3_cbc_sha1, dsaWithSHA1, md5WithRSAEncryption, rc2CBC, rsaEncryption, rsaES, des_ede3_cbc, des3_cbc_sha1_kd, aes128, aes256, rc4_hmac, rc4_hmac_exp, subkey_keymaterial."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"EventResult"}),(0,r.jsx)(t.td,{children:"Result of the operation triggered current event"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"EventType"}),(0,r.jsx)(t.td,{children:"Identifies event"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"EventsCount"}),(0,r.jsx)(t.td,{children:"Number of similar events captured during consolidation period which is 1 minute by default"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"From"}),(0,r.jsx)(t.td,{children:"Contains raw representation of the machine from which event was triggered"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"FromHost"}),(0,r.jsx)(t.td,{children:"If resolved, contains host name of the machine from which event was triggered"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"FromIp"}),(0,r.jsx)(t.td,{children:"If resolved, contains the IP address of the machine from which event was triggered"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"FromMac"}),(0,r.jsx)(t.td,{children:"If resolved, contains mac address of the machine from which event was triggered"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"IsN2Password"}),(0,r.jsx)(t.td,{children:"Indicates if password that was used for authentication is a previous or one before previous"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"IsUserExist"}),(0,r.jsx)(t.td,{children:"Indicates if user exists"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"KerbAuthTime"}),(0,r.jsx)(t.td,{children:"Time at which KDC issued the initial ticket that corresponds to this ticket"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"KerbEndTime"}),(0,r.jsx)(t.td,{children:"Ticket expiration time"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"KerbRenewTill"}),(0,r.jsx)(t.td,{children:"Latest time at which renewal of ticket can be valid"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"KerbSPN"}),(0,r.jsx)(t.td,{children:"Service principal name for which ticket was requested"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"KerbStartTime"}),(0,r.jsx)(t.td,{children:"Ticket start time"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"LogonType"}),(0,r.jsxs)(t.td,{children:["Contains SECURITY_LOGON_TYPE. More details at ",(0,r.jsx)(t.a,{href:"https://docs.microsoft.com/en-us/windows/win32/api/ntsecapi/ne-ntsecapi-security_logon_type",children:"https://docs.microsoft.com/en-us/windows/win32/api/ntsecapi/ne-ntsecapi-security_logon_type"}),"."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"NewAttributes"}),(0,r.jsx)(t.td,{children:"Map of new attributes where key is name and value attribute value"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"NewName"}),(0,r.jsx)(t.td,{children:"New name of the AD object"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"NlpLogonType"}),(0,r.jsx)(t.td,{children:"NTLM logon type. Possible values: Unknown, Interactive, Network, Service, Generic, TransitiveInteractive, TransitiveNetwork, TransitiveService"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"OldAttributes"}),(0,r.jsx)(t.td,{children:"Map of old attributes where key is attribute name and value attribute value"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"PAC"}),(0,r.jsx)(t.td,{children:"List of RIDs extracted from ticket authorization data"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"ProcessID"}),(0,r.jsx)(t.td,{children:"Contains process ID that attempted to open LSASS process"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"ProcessName"}),(0,r.jsx)(t.td,{children:"Contains process name that attempted to open LSASS process"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Protocol"}),(0,r.jsx)(t.td,{children:"Operation specific details"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"QueryFilter"}),(0,r.jsx)(t.td,{children:"LDAP filter used in the operation"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"QueryIsSSL"}),(0,r.jsx)(t.td,{children:"Indicates if LDAP connection is secure or not"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"QueryObjectsReturned"}),(0,r.jsx)(t.td,{children:"Number of returned objects produced by the LDAP request"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Source"}),(0,r.jsx)(t.td,{children:"Indicates source of the operation. Currently can be: \u2018Authentication\u2019, \u2018Active Directory\u2019, \u2018LSASS Guardian \u2013 Monitor\u2019, \u2018LDAP Monitor\u2019, \u2018AD Replication Monitoring\u2019."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Success"}),(0,r.jsx)(t.td,{children:"Indicates if original operation completed successfully or not"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"TargetHost"}),(0,r.jsx)(t.td,{children:"Contains host name to which authentication attempt took place. In case of failed Kerberos AS, this field contains name of the domain controller."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"TargetHostIP"}),(0,r.jsx)(t.td,{children:"If resolved, contains IP address of the target host"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"TargetProcess"}),(0,r.jsx)(t.td,{children:"Contains process name that is monitored. Currently this is only lsass.exe."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"TgsReplyEncryptionType"}),(0,r.jsx)(t.td,{children:"Indicates encryption type used in reply part of the TGS Kerberos ticket. Possible values the same as for EncryptionType."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"TimeLogged"}),(0,r.jsx)(t.td,{children:"UTC timestamp of the event"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"UserDN"}),(0,r.jsx)(t.td,{children:"If resolved, contains DN of the object triggered operation"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"UserName"}),(0,r.jsx)(t.td,{children:"If resolved, contains account name of the object triggered operation"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"UserSid"}),(0,r.jsx)(t.td,{children:"If resolved, contains SID of the object triggered operation"})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);