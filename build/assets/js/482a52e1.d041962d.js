"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[238951],{28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var r=t(296540);const s={},i=r.createContext(s);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:n},e.children)}},215199:(e,n,t)=>{t.d(n,{A:()=>r});const r="data:image/webp;base64,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"},588195:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>a,frontMatter:()=>o,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"usercube/integration-guide/connectors/references-connectors/powershellsync/index","title":"PowerShellSync","description":"This connector exports data from an external system via a PowerShell script.","source":"@site/docs/usercube/usercube/integration-guide/connectors/references-connectors/powershellsync/index.md","sourceDirName":"usercube/integration-guide/connectors/references-connectors/powershellsync","slug":"/usercube/integration-guide/connectors/references-connectors/powershellsync/","permalink":"/docs/usercube/usercube/integration-guide/connectors/references-connectors/powershellsync/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/usercube/usercube/integration-guide/connectors/references-connectors/powershellsync/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"userCubeSidebar","previous":{"title":"PowerShellProv","permalink":"/docs/usercube/usercube/integration-guide/connectors/references-connectors/powershellprov/"},"next":{"title":"RACF","permalink":"/docs/usercube/usercube/integration-guide/connectors/references-connectors/racf/"}}');var s=t(474848),i=t(28453);const o={},c="PowerShellSync",l={},h=[{value:"Overview",id:"overview",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Export",id:"export",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Setting attributes",id:"setting-attributes",level:5},{value:"Write a script",id:"write-a-script",level:3},{value:"Fulfill",id:"fulfill",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h5:"h5",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"powershellsync",children:"PowerShellSync"})}),"\n",(0,s.jsxs)(n.p,{children:["This connector exports data from an external system via a ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/powershell/scripting/overview",children:"PowerShell"})," script."]}),"\n",(0,s.jsxs)(n.p,{children:["This page is about ",(0,s.jsx)(n.a,{href:"/docs/usercube/usercube/integration-guide/connectors/references-packages/powershellsync/",children:"\nPowerShellSync\n"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Package: Custom/PowerShellSync",src:t(215199).A+"",width:"233",height:"60"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"PowerShell is a cross-platform task automation and configuration management framework, consisting of a command-line shell and scripting language. Unlike most shells which accept and return text, PowerShell is built on top of the .NET Common Language Runtime (CLR), and accepts and returns .NET objects. This fundamental change brings entirely new tools and methods for automation."}),"\n",(0,s.jsx)(n.p,{children:"Data can be synchronized from any managed system by writing a PowerShell script that generates the relevant CSV files for Identity Manager. The PowerShellSync connector provides all the necessary tools for an easy integration of the script with Identity Manager's synchronization mechanisms."}),"\n",(0,s.jsx)(n.p,{children:"When Identity Manager\xa0provides a native connector for a given system, for example the Active Directory connector, Netwrix Identity Manager (formerly Usercube)highly recommends using the native connector rather than this PowerShell connector."}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(n.p,{children:"Implementing this connector requires:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["making sure that the command ",(0,s.jsx)(n.code,{children:"powershell.exe"}),", inside the command prompt (",(0,s.jsx)(n.code,{children:"cmd.exe"}),"), does execute a PowerShell terminal;"]}),"\n",(0,s.jsxs)(n.li,{children:["knowledge of scripting in PowerShell 5.1 or later, ",(0,s.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/powershell/scripting/windows-powershell/install/windows-powershell-system-requirements",children:"see here PowerShell's requirements"}),";"]}),"\n",(0,s.jsx)(n.li,{children:"making sure that the device hosting the agent has its execution policy properly configured to execute the given PowerShell script;"}),"\n",(0,s.jsx)(n.li,{children:"checking the targeted system's requirements (environment, libraries, etc.), as this connector is meant to connect Identity Manager\xa0to a PowerShell-compatible system;"}),"\n",(0,s.jsxs)(n.li,{children:["writing and testing a PowerShell script (",(0,s.jsx)(n.code,{children:".ps1"}),") according to Netwrix Identity Manager (formerly Usercube)' guidelines below."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"export",children:"Export"}),"\n",(0,s.jsx)(n.p,{children:"This connector executes a PowerShell script that generates one or several CSV files. These files are to be used during the synchronization of the data from the managed system targeted by the PowerShellSync connector."}),"\n",(0,s.jsxs)(n.p,{children:["The CSV files must be written to the ",(0,s.jsx)(n.code,{children:"$OutputPath"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["The export is executed by a job from the UI, or via ",(0,s.jsx)(n.code,{children:"Usercube-Export-Powershell.exe"})," in the command prompt."]}),"\n",(0,s.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["This process is configured through a ",(0,s.jsx)(n.a,{href:"/docs/usercube/usercube/integration-guide/toolkit/xml-configuration/connectors/connection/",children:"\nConnection\n"})," in the UI and/or the XML configuration, and in the ",(0,s.jsx)(n.code,{children:"appsettings.agent.json > Connections"})," section:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'appsettings.agent.json\n{\n  ...\n  "Connections": {\n    ...\n    "<ConnectionIdentifier>": {\n      ...\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"The identifier of the connection and thus the name of the subsection must:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"be unique."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"not begin with a digit."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["not contain ",(0,s.jsx)(n.code,{children:"<"}),", ",(0,s.jsx)(n.code,{children:">"}),", ",(0,s.jsx)(n.code,{children:":"}),", ",(0,s.jsx)(n.code,{children:'"'}),", ",(0,s.jsx)(n.code,{children:"/"}),", ",(0,s.jsx)(n.code,{children:"\\"}),", ",(0,s.jsx)(n.code,{children:"|"}),", ",(0,s.jsx)(n.code,{children:"?"}),", ",(0,s.jsx)(n.code,{children:"*"})," and ",(0,s.jsx)(n.code,{children:"_"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"For example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'appsettings.agent.json\n{\n  ...\n  "Connections": {\n    ...\n    "PowerShellExport": {\n      "PowerShellScriptPath": "C:/UsercubeDemo/Scripts/Export-CSV.ps1",\n    }\n  }\n}\n'})}),"\n"]}),"\n",(0,s.jsx)(n.h5,{id:"setting-attributes",children:"Setting attributes"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Name"}),(0,s.jsx)(n.th,{children:"Details"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"PowerShellScriptPath   required"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.strong,{children:"Type"}),"    String   ",(0,s.jsx)(n.strong,{children:"Description"})," Path of the PowerShell script (.ps1) to be executed."]})]})})]}),"\n",(0,s.jsx)(n.h3,{id:"write-a-script",children:"Write a script"}),"\n",(0,s.jsx)(n.p,{children:"Identity Manager\xa0provides a few variables to be used in the PowerShell script."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Name"}),(0,s.jsx)(n.th,{children:"Details"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"OutputPath"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.strong,{children:"Type"}),"    String   ",(0,s.jsx)(n.strong,{children:"Description"})," Prefix of the path of the generated CSV file.   ",(0,s.jsx)(n.strong,{children:"Info:"})," the synchronization process requires the generated CSV file to be located in a very specific location, with a specific name prefix. Hence the need for this predefined variable. ",(0,s.jsx)(n.strong,{children:"Value"})," ",(0,s.jsx)(n.a,{href:"/docs/usercube/usercube/integration-guide/network-configuration/agent-configuration/appsettings/#tempfolderpath",children:(0,s.jsx)(n.code,{children:"<TempFolderPath>"})}),(0,s.jsx)(n.code,{children:"/ExportOutput/<connectionIdentifier>_"})," ",(0,s.jsx)(n.strong,{children:"Example"})," In this example, if the temp folder is named ",(0,s.jsx)(n.code,{children:"Temp"})," and the connection ",(0,s.jsx)(n.code,{children:"PowerShellExport"}),", then the generated file is: ",(0,s.jsx)(n.code,{children:"Temp/ExportOutput/PowerShellExport_users.csv"}),".  ```generateCSV"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"IsIncremental"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.strong,{children:"Type"}),"    Boolean   ",(0,s.jsx)(n.strong,{children:"Description"})," Variable to be used to provide a different behavior for complete and incremental synchronization."]})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"fulfill",children:"Fulfill"}),"\n",(0,s.jsx)(n.p,{children:"There are no fulfill capabilities for this connector."})]})}function a(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);