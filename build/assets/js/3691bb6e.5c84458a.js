"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[246181],{28453:(e,r,o)=>{o.d(r,{R:()=>i,x:()=>a});var t=o(296540);const n={},s=t.createContext(n);function i(e){const r=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),t.createElement(s.Provider,{value:r},e.children)}},253011:(e,r,o)=>{o.d(r,{A:()=>t});const t=o.p+"assets/images/forestrecovered-cc5cca0698090ccc15b69265a8328bf8.webp"},255173:(e,r,o)=>{o.d(r,{A:()=>t});const t=o.p+"assets/images/domaincontroller-8ee2053106d7730b2c0577c497e00307.webp"},276063:(e,r,o)=>{o.d(r,{A:()=>t});const t=o.p+"assets/images/options-383c5abc80612a7132de89dc53e5b78b.webp"},381770:(e,r,o)=>{o.r(r),o.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"recoveryforactivedirectory/admin/forest/recover","title":"Recover a Forest","description":"You can recover a forest using the domain controller backups generated by Recovery for Active Directory. A restore playbook, also called a recovery playbook, is used to restore a forest. Once the desired domain controllers have been added to the restore playbook, the forest recovery process can be initiated and the forest will be restored using the automated process provided by Recovery for Active Directory.","source":"@site/docs/recoveryforactivedirectory/recoveryforactivedirectory/admin/forest/recover.md","sourceDirName":"recoveryforactivedirectory/admin/forest","slug":"/recoveryforactivedirectory/admin/forest/recover","permalink":"/docs/recoveryforactivedirectory/recoveryforactivedirectory/admin/forest/recover","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/recoveryforactivedirectory/recoveryforactivedirectory/admin/forest/recover.md","tags":[],"version":"current","frontMatter":{},"sidebar":"recoveryForActiveDirectorySidebar","previous":{"title":"Forest Page","permalink":"/docs/recoveryforactivedirectory/recoveryforactivedirectory/admin/forest/"},"next":{"title":"Navigate the Console","permalink":"/docs/recoveryforactivedirectory/recoveryforactivedirectory/admin/navigation"}}');var n=o(474848),s=o(28453);const i={},a="Recover a Forest",c={},l=[{value:"Use Cases for Restoring Domain Controller Backups",id:"use-cases-for-restoring-domain-controller-backups",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Recover a Forest",id:"recover-a-forest-1",level:2},{value:"Create a Recovery Playbook",id:"create-a-recovery-playbook",level:2},{value:"Run the Recovery Playbook",id:"run-the-recovery-playbook",level:3}];function d(e){const r={a:"a",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"recover-a-forest",children:"Recover a Forest"})}),"\n",(0,n.jsx)(r.p,{children:"You can recover a forest using the domain controller backups generated by Recovery for Active Directory. A restore playbook, also called a recovery playbook, is used to restore a forest. Once the desired domain controllers have been added to the restore playbook, the forest recovery process can be initiated and the forest will be restored using the automated process provided by Recovery for Active Directory."}),"\n",(0,n.jsx)(r.h2,{id:"use-cases-for-restoring-domain-controller-backups",children:"Use Cases for Restoring Domain Controller Backups"}),"\n",(0,n.jsx)(r.p,{children:"Administrators may need to bring a forest backup created by Recovery for Active Directory online in the following scenarios:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Stand up a duplicate of a domain controller, for example, stand up a duplicate in a lab environment for testing purposes"}),"\n",(0,n.jsx)(r.li,{children:"Restore a server or domain controller to a specific state-in-time image"}),"\n",(0,n.jsx)(r.li,{children:"Restore lost or deleted data"}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,n.jsx)(r.p,{children:"To perform a forest recovery, the following prerequisites must be in place:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Configure backups for one or more domain controllers in each domain in a forest."}),"\n",(0,n.jsx)(r.li,{children:"Next, ensure that backups run as scheduled. You can also force-run a backup."}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["See the ",(0,n.jsx)(r.a,{href:"/docs/recoveryforactivedirectory/recoveryforactivedirectory/admin/forest/",children:"Forest Page"})," topic for additional information."]}),"\n",(0,n.jsx)(r.h2,{id:"recover-a-forest-1",children:"Recover a Forest"}),"\n",(0,n.jsx)(r.p,{children:"Follow the steps to recover a forest."}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 1 \u2013"})," Prepare an isolated environment to restore the forest to."]}),"\n",(0,n.jsxs)(r.p,{children:["See the ",(0,n.jsx)(r.a,{href:"/docs/recoveryforactivedirectory/recoveryforactivedirectory/requirements/targetserver",children:"Target Server Considerations"})," topic to understand the requirements for a target environment and target servers for restoring domain controllers."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 2 \u2013"})," Add the desired domain controllers to create a recovery playbook, also called a restore playbook."]}),"\n",(0,n.jsx)(r.p,{children:"For example, if you have a forest with one root domain and four child domains, you can add one domain controller from the root domain and one from each of the child domains to the recovery playbook, and restore your forest."}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 3 \u2013"}),' When your playbook is complete, use the "Start" command to start the forest recovery process.']}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"The following restore capabilities are supported:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"VM DC backup to VM"}),"\n",(0,n.jsx)(r.li,{children:"VM DC backup to Physical"}),"\n",(0,n.jsx)(r.li,{children:"Physical DC backup to VM"}),"\n",(0,n.jsx)(r.li,{children:"Physical DC backup to Physical DC"}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"create-a-recovery-playbook",children:"Create a Recovery Playbook"}),"\n",(0,n.jsx)(r.p,{children:"A recovery playbook is a list of domains and domain controllers for those domains that you want to restore to an isolated environment. Ideally it should be a physical environment but a virtual environment can work too. For example, you can choose a Hyper-V or a VMware environment hosted in Azure or AWS, and isolated from the rest of the domain."}),"\n",(0,n.jsx)(r.p,{children:"Once the desired domain controllers have at least one backup to choose from, you can start the forest recovery playbook by adding the domain controllers to it."}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"NOTE:"}),' You only need one backup of a domain controller for each domain in the forest. Any other domains can then be added via the playbook or you should handle them manually using the "add DC to the domain, let replication happen" model.']}),"\n",(0,n.jsx)(r.p,{children:"Follow the steps to create a recovery playbook."}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 1 \u2013"})," Click ",(0,n.jsx)(r.strong,{children:"Forest"})," in the left pane to open the Forest page."]}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 2 \u2013"})," On the Forest page, select a forest to view the domain controllers in it. To locate a domain controller in a specific domain, expand the forest in the left pane and select a domain. The adjacent pane displays the domain controllers in that domain."]}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 3 \u2013"})," Click the ",(0,n.jsx)(r.strong,{children:"Add Domain Controller to Restore Playbook"})," icon (",(0,n.jsx)(r.strong,{children:"+"}),") for a domain controller to add it to the recovery playbook. The Add to Recovery Playbook wizard opens, where you can specify the restore settings for the domain controller."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"Add to Recovery Playbook wizard - Domain Controller page",src:o(255173).A+"",width:"905",height:"1047"})}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 4 \u2013"})," On the Domain Controller page, the Source Domain Controller section displays information for the domain controller that is being added to the playbook. It displays the domain it is deployed to, its name, operating system, and the date and time of the most recent backup."]}),"\n",(0,n.jsx)(r.p,{children:"In the Target Server section:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["In the ",(0,n.jsx)(r.strong,{children:"Server"})," field, enter the IP address of the target server where you want to restore the domain controller from the backup."]}),"\n",(0,n.jsx)(r.li,{children:"Provide the credentials of an account in the Account and Password fields. This must be an administrator account for the target server."}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["See the ",(0,n.jsx)(r.a,{href:"/docs/recoveryforactivedirectory/recoveryforactivedirectory/requirements/targetserver#target-server-and-operating-system-requirements",children:"Target Server and Operating System Requirements"})," topic for additional information."]}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 5 \u2013"})," Click ",(0,n.jsx)(r.strong,{children:"Next"}),"."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"Add to Recovery Playbook wizard - Options page",src:o(276063).A+"",width:"749",height:"526"})}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 6 \u2013"})," From the ",(0,n.jsx)(r.strong,{children:"Backup"})," drop-down menu, select the backup to use for restoring the domain controller. The drop-down menu lists the backups available for the domain controller."]}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"NOTE:"}),"  If you do not choose a backup for a domain controller, an attempt will be made to join the domain controller to the existing domain that was restored previously in the playbook using a backup of another domain controller."]}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 7 \u2013"})," If the backup is encrypted, provide the password used for encryption in the Encryption Password field. This would allow the recovery process to decrypt the backup."]}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 8 \u2013"})," From the ",(0,n.jsx)(r.strong,{children:"Roles"})," drop-down menu, select the FSMO role(s) the domain controller will acquire when it is restored. You can:"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Select the Acquire All Roles option to assign all FSMO roles to the domain controller."}),"\n",(0,n.jsx)(r.li,{children:"Select one or more FSMO roles to assign to the domain controller. All five FSMO roles are listed."}),"\n",(0,n.jsx)(r.li,{children:"Select Restore original roles to retain the previously assigned roles that are defined in the backup."}),"\n",(0,n.jsx)(r.li,{children:"Select Do not assign any roles if you do not want to assign any role to the domain controller. This option is selected by default, because the first domain controller in your domain automatically acquires all the FSMO roles."}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 9 \u2013"})," In the DSRM Password field, set the Directory Services Restore Mode (DSRM) password for the to-be-restored domain controller."]}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 10 \u2013"})," Click ",(0,n.jsx)(r.strong,{children:"Next"}),"."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"Add to Recovery Playbook wizard - Confirm page",src:o(596713).A+"",width:"801",height:"546"})}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Step 11 \u2013"})," The Confirm page displays a summary of the settings you provided on the pages of the wizard. Use the Back button to return to a previous page and change any setting. Click ",(0,n.jsx)(r.strong,{children:"Complete"})," to finish the wizard."]}),"\n",(0,n.jsx)(r.p,{children:"The playbook has been created with the domain controller added to it."}),"\n",(0,n.jsx)(r.p,{children:"Repeat this process for all the domain controllers you wish to restore in the target environment. When you add another domain controller, it appears as a new tab added to the playbook. Click the tab representing a domain controller to view its details."}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"Recovery Playbook created on the Forest Page",src:o(563023).A+"",width:"1389",height:"864"})}),"\n",(0,n.jsx)(r.p,{children:"The following information is displayed for a domain controller in the playbook:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Original Server \u2013 The name of the server that you added to the playbook for restore"}),"\n",(0,n.jsx)(r.li,{children:"Target Server \u2013 The server where the domain should be restored"}),"\n",(0,n.jsx)(r.li,{children:"Domain \u2013 The domain the domain controller belongs to"}),"\n",(0,n.jsx)(r.li,{children:"Operating System \u2013 The operating system of the original server (the domain controller to be restored)"}),"\n",(0,n.jsx)(r.li,{children:"Version \u2013 The operating system of the original server (the domain controller to be restored)"}),"\n",(0,n.jsx)(r.li,{children:"Roles \u2013 The FSMO role(s) the domain controller will acquire when restored"}),"\n",(0,n.jsx)(r.li,{children:"Backup Time \u2013 the date and time of the backup that will be restored for the domain controller"}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"run-the-recovery-playbook",children:"Run the Recovery Playbook"}),"\n",(0,n.jsxs)(r.p,{children:["When your playbook is ready, click ",(0,n.jsx)(r.strong,{children:"Start"})," to initiate the forest recovery process. The machine will reboot once the recovery process is complete"]}),"\n",(0,n.jsx)(r.p,{children:"Your new forest is ready for you to log in using any Administrator credentials from the forest."}),"\n",(0,n.jsx)(r.p,{children:"Notice that the Forest page displays the operations performed during the restore process."}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"Forest page showing a restored forest",src:o(253011).A+"",width:"1920",height:"963"})}),"\n",(0,n.jsx)(r.p,{children:"From here, you can proceed to restore additional domain controllers or promote new ones to the forest."})]})}function h(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},563023:(e,r,o)=>{o.d(r,{A:()=>t});const t=o.p+"assets/images/recoveryplaybook-6682e3f702714860f555154c68035ffc.webp"},596713:(e,r,o)=>{o.d(r,{A:()=>t});const t=o.p+"assets/images/confirm-28172147b18d0b95b766a44cebde96df.webp"}}]);