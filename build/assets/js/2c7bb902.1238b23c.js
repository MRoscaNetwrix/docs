"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[344116],{22059:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/howtos_azuread_exportsecret-e9757f899528f499b3a3e8c095a037f3.webp"},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var i=t(296540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}},243257:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/howtos_azuread_exportdirectorypermission-c3fbd57ceecf29a0bddf207a45931270.webp"},621244:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"usercube/integration-guide/connectors/how-tos/azuread-register/index","title":"Register for Microsoft Entra ID","description":"This guide shows how to register Identity Manager\xa0as an application, i.e. grant Identity Manager\xa0a service account, with Microsoft Identity Platform to authenticate to a Microsoft Entra ID (formerly Azure Active Directory), and how to grant Identity Manager\xa0the directory permissions for reading the data to be exported via the Microsoft Graph API.","source":"@site/docs/usercube_saas/usercube/integration-guide/connectors/how-tos/azuread-register/index.md","sourceDirName":"usercube/integration-guide/connectors/how-tos/azuread-register","slug":"/usercube/integration-guide/connectors/how-tos/azuread-register/","permalink":"/docs/usercube_saas/usercube/integration-guide/connectors/how-tos/azuread-register/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/usercube_saas/usercube/integration-guide/connectors/how-tos/azuread-register/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"userCubeSaasSidebar","previous":{"title":"References: Format for the EntityPropertyMapping","permalink":"/docs/usercube_saas/usercube/integration-guide/connectors/entitypropertymapping-format/"},"next":{"title":"Configure Secured Options","permalink":"/docs/usercube_saas/usercube/integration-guide/connectors/how-tos/configure-secured-options/"}}');var s=t(474848),r=t(28453);const o={},a="Register for Microsoft Entra ID",c={},d=[{value:"Create a New Registration",id:"create-a-new-registration",level:2},{value:"Get the application&#39;s identifier",id:"get-the-applications-identifier",level:3},{value:"Get the application&#39;s secret key",id:"get-the-applications-secret-key",level:3},{value:"Grant Directory Permissions",id:"grant-directory-permissions",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"register-for-microsoft-entra-id",children:"Register for Microsoft Entra ID"})}),"\n",(0,s.jsxs)(n.p,{children:["This guide shows how to ",(0,s.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app",children:"register"})," Identity Manager\xa0as an application, i.e. grant Identity Manager\xa0a service account, with Microsoft Identity Platform to authenticate to a Microsoft Entra ID (formerly Azure Active Directory), and how to grant Identity Manager\xa0the ",(0,s.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/permissions-reference",children:"directory permissions"})," for reading the data to be exported via the ",(0,s.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-graph-api",children:"Microsoft Graph API"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"create-a-new-registration",children:"Create a New Registration"}),"\n",(0,s.jsx)(n.p,{children:"Create a new registration for Identity Manager\xa0with Microsoft Identity Platform by proceeding as follows:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to ",(0,s.jsx)(n.a,{href:"https://portal.azure.com/",children:"the Microsoft portal"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Log in using the organization's credentials."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Find the ",(0,s.jsx)(n.strong,{children:"Microsoft Entra ID"})," menu on the left panel."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to ",(0,s.jsx)(n.strong,{children:"App Registrations"})," in the left panel."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Click the ",(0,s.jsx)(n.strong,{children:"+ New Registration"})," button in the top menu."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Azure AD Export - Add New Registration",src:t(674970).A+"",width:"1039",height:"180"})}),"\n",(0,s.jsx)(n.p,{children:"A new registration form is displayed:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Name: display name of your application for the currently created registration. It is used to identify this registration within Microsoft Entra ID. In the case at hand, it won't be displayed to the end-user since Identity Manager\xa0doesn't access the Microsoft Entra ID using end-user identity but ",(0,s.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/auth-v2-service",children:"its own"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Netwrix Identity Manager (formerly Usercube)\xa0recommends using a mnemonic name resembling Identity Manager Organization in order to remember it as the registration of Identity Manager\xa0within the target Microsoft Entra ID, for example Identity Manager Contoso."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-supported-account-types",children:"Supported account types"}),": select ",(0,s.jsx)(n.strong,{children:"Accounts in this organizational directory only (... - Single tenant)"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Identity Manager\xa0uses its own identity to access the API. It doesn't access the data on behalf of a user. To authenticate, it uses credentials of a service account granted by this registration, in the form of an ",(0,s.jsx)(n.strong,{children:"ApplicationId"})," and a secret Client Secret."]}),"\n",(0,s.jsxs)(n.p,{children:["See how to get ",(0,s.jsx)(n.strong,{children:"ApplicationId"})," and ",(0,s.jsx)(n.strong,{children:"ApplicationKey"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["This service account is stored in the organizational directory, and hence using the ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Principle_of_least_privilege",children:"Principle of Least Privilege"}),", only ",(0,s.jsx)(n.strong,{children:"Accounts in this organizational directory"})," are supported for authentication within this registration scope."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Redirect URI:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The left combo box represents the type of application. It influences the authorization protocol exchanges. Identity Manager\xa0is of type Web."}),"\n",(0,s.jsx)(n.li,{children:"The right line edit isn't applicable to our case and should be left blank. It is used for end-user authentication, but doesn't apply to Identity Manager."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Confirm the registration with the ",(0,s.jsx)(n.strong,{children:"Register"})," button at the bottom of the page."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"get-the-applications-identifier",children:"Get the application's identifier"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"ApplicationId"})," is available in the registration overview. Get it by proceeding as follows:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to ",(0,s.jsx)(n.strong,{children:"App Registrations"})," in the left panel."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Select ",(0,s.jsx)(n.strong,{children:"Owned applications"})," > ",(0,s.jsx)(n.strong,{children:"Identity Manager"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to ",(0,s.jsx)(n.strong,{children:"Overview"})," in the left panel."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"Essentials"})," top panel displays the ",(0,s.jsx)(n.strong,{children:"Application (client) ID"})," required by the Identity Manager\xa0Agent. The same page also displays the ",(0,s.jsx)(n.strong,{children:"Directory (tenant) ID"})," that will also be needed by the Identity Manager\xa0Agent."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Azure AD Export - New ApplicationId",src:t(902586).A+"",width:"1474",height:"367"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"get-the-applications-secret-key",children:"Get the application's secret key"}),"\n",(0,s.jsxs)(n.p,{children:["A ",(0,s.jsx)(n.strong,{children:"Client Secret"})," key needs to be generated. Get it by proceeding as follows:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to ",(0,s.jsx)(n.strong,{children:"App Registrations"})," in the left panel."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Select ",(0,s.jsx)(n.strong,{children:"Owned applications"})," > ",(0,s.jsx)(n.strong,{children:"Identity Manager"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to ",(0,s.jsx)(n.strong,{children:"Certificate & Secrets"})," in the left panel."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Click the ",(0,s.jsx)(n.strong,{children:"+ New client secret"})," button in the bottom panel ",(0,s.jsx)(n.strong,{children:"Client Secrets"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Input a mnemonic name such as Identity Manager Organization Secret."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["It is recommended to use a short ",(0,s.jsx)(n.strong,{children:"expiration period"})," such as 1 year."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Confirm the creation with the ",(0,s.jsx)(n.strong,{children:"Add"})," button."]}),"\n",(0,s.jsxs)(n.p,{children:["The Client Secret is now listed in the bottom panel ",(0,s.jsx)(n.strong,{children:"Client Secrets"}),". The Client Secret value is needed by the Identity Manager\xa0Agent settings file."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Azure AD Export - New Client Secret",src:t(22059).A+"",width:"1259",height:"671"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"Client Secret"})," value is only displayed in the UI in plain text at first. After a while, it is only displayed as ",(0,s.jsx)(n.code,{children:"**************"}),". It should hence be stored in the appsettings.agent.json file or an environment variable as soon as it is created, to be used subsequently by Identity Manager. If the key is lost, a new key can be created to replace the lost one."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"grant-directory-permissions",children:"Grant Directory Permissions"}),"\n",(0,s.jsx)(n.p,{children:"Grant Identity Manager\xa0directory permissions by proceeding as follows:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to ",(0,s.jsx)(n.strong,{children:"App Registrations"})," in the left panel."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Select ",(0,s.jsx)(n.strong,{children:"Owned applications"})," > ",(0,s.jsx)(n.strong,{children:"Identity Manager"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to ",(0,s.jsx)(n.strong,{children:"API Permissions"})," in the left panel."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Click on the ",(0,s.jsx)(n.strong,{children:"+ Add a permission"})," button."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Azure AD Export - Add Permission",src:t(913993).A+"",width:"1065",height:"309"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to ",(0,s.jsx)(n.strong,{children:"Microsoft graph"})," > ",(0,s.jsx)(n.strong,{children:"Application permissions"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Search and open the ",(0,s.jsx)(n.strong,{children:"Directory"})," category."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Check the ",(0,s.jsx)(n.strong,{children:"Directory.Read.All"})," permission."]}),"\n",(0,s.jsxs)(n.p,{children:["If you plan on configuring fulfillment too, you must only check the ",(0,s.jsx)(n.strong,{children:"Directory.ReadWrite.All"})," permission."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Azure AD Export - Directory Permission",src:t(243257).A+"",width:"831",height:"889"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Confirm with the ",(0,s.jsx)(n.strong,{children:"Add permissions"})," button at the bottom of the page."]}),"\n",(0,s.jsxs)(n.p,{children:["You now see the Directory.Read.All or Directory.ReadWrite.All permission in the ",(0,s.jsx)(n.strong,{children:"Configured permissions"})," list with a  ",(0,s.jsx)(n.strong,{children:"\u26a0 Not granted for ..."})," status."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Grant admin consent by clicking on ",(0,s.jsx)(n.strong,{children:"\u221a Grant admin consent for"})," name of the organization."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Azure AD Export - Grant Admin Consent",src:t(961516).A+"",width:"1038",height:"261"})}),"\n",(0,s.jsxs)(n.p,{children:["You should now see the status displayed as ",(0,s.jsx)(n.strong,{children:"\u221a Granted for"})," name of the organization."]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},674970:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/howtos_azuread_exportregistration-982365170f610b17794b70da2d4e4b10.webp"},902586:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/howtos_azuread_exportapplicationid-87d7ed6549a0b170d90409aa12f4a3f0.webp"},913993:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/howtos_azuread_exportpermissions-a278ac5e076ab14785d0f318deab6494.webp"},961516:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/howtos_azuread_exportadminconsent-75b3aa7b50708217ca599e4bb1fc0159.webp"}}]);