"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[195743],{28453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>o});var i=n(296540);const r={},s=i.createContext(r);function l(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(s.Provider,{value:t},e.children)}},408305:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"threatprevention/install/agent/silent","title":"Agent Silent Install Option","description":"You can use command line options to install the Agent silently. These options can be leveraged to deploy the Agent via custom batch files, login scripts, or for integrating with third-party software distribution solutions that an organization may already have in their environment.","source":"@site/docs/threatprevention/threatprevention/install/agent/silent.md","sourceDirName":"threatprevention/install/agent","slug":"/threatprevention/install/agent/silent","permalink":"/docs/threatprevention/threatprevention/install/agent/silent","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/threatprevention/threatprevention/install/agent/silent.md","tags":[],"version":"current","frontMatter":{},"sidebar":"threatPreventionSidebar","previous":{"title":"Agent Information","permalink":"/docs/threatprevention/threatprevention/install/agent/overview"},"next":{"title":"Application Server Install","permalink":"/docs/threatprevention/threatprevention/install/application"}}');var r=n(474848),s=n(28453);const l={},o="Agent Silent Install Option",a={},d=[];function c(e){const t={a:"a",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"agent-silent-install-option",children:"Agent Silent Install Option"})}),"\n",(0,r.jsx)(t.p,{children:"You can use command line options to install the Agent silently. These options can be leveraged to deploy the Agent via custom batch files, login scripts, or for integrating with third-party software distribution solutions that an organization may already have in their environment."}),"\n",(0,r.jsx)(t.p,{children:"MSI Compliant Command-Line Options"}),"\n",(0,r.jsx)(t.p,{children:"The WiX installer application for Agent runs under control of Windows installer component (MSI). Therefore, standard MSI command-line options can be used with the \u201cthreatprevention-agent-7.4.0.xxx.exe\u201d install."}),"\n",(0,r.jsxs)(t.p,{children:["Available command-line options can be found in the ",(0,r.jsx)(t.a,{href:"https://msdn.microsoft.com/en-us/library/windows/desktop/aa372024(v=vs.85).aspx",children:"Microsoft Standard Installer Command-Line Options"})," article."]}),"\n",(0,r.jsx)(t.p,{children:"Two of the more useful options are:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Silent installation option \u2013 ",(0,r.jsx)(t.code,{children:"/q"})]}),"\n",(0,r.jsxs)(t.li,{children:["Logging option \u2013 ",(0,r.jsx)(t.code,{children:'/log "file_for_logging.log"'})]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"All Properties for the Agent Installer"}),"\n",(0,r.jsx)(t.p,{children:"The following table details all properties that can be specified to the Agent installer via the command line."}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Property Name"}),(0,r.jsx)(t.th,{children:"Description"}),(0,r.jsx)(t.th,{children:"Default Value"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"CUSTOM_CA"}),(0,r.jsx)(t.td,{children:"If this property is set to True, then the custom-managed certificate mode is enabled. This mode uses certificates that are signed by the customer's external certificate authority. In this mode, the installer will not generate certificates and will not start the Agent Service at the end of the installation."}),(0,r.jsx)(t.td,{children:"FALSE"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"EMCERTIFICATE"}),(0,r.jsx)(t.td,{children:"Enterprise Manager Certificate Thumbprint"}),(0,r.jsxs)(t.td,{children:["This value can be found in the ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/agents/overview",children:"Agents Interface"})," by clicking the Agent Enrollment Secret icon to open the ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/agents/window/enrollmentsecretconfiguration",children:"Enrollment Secret Configuration Window"}),". This value is not used for high security mode."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:["ENROLLMENTSECRET  ",(0,r.jsx)(t.strong,{children:"Required for enrolling new Agent"})]}),(0,r.jsx)(t.td,{children:"Agent Enrollment Secret"}),(0,r.jsxs)(t.td,{children:["This value can be found in the ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/agents/overview",children:"Agents Interface"})," by clicking the Agent Enrollment Secret icon to open the ",(0,r.jsx)(t.a,{href:"/docs/threatprevention/threatprevention/admin/agents/window/enrollmentsecretconfiguration",children:"Enrollment Secret Configuration Window"}),". This is a required field if using auto security mode. It is not used for high security mode."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"SAFEMODE"}),(0,r.jsx)(t.td,{children:"Start Agent Service in safe mode"}),(0,r.jsx)(t.td,{children:"FALSE"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"STARTAGENTSERVICE"}),(0,r.jsx)(t.td,{children:"Start Agent Service on successful installation"}),(0,r.jsx)(t.td,{children:"FALSE"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"ADDFWRULES"}),(0,r.jsx)(t.td,{children:"Create firewall rules for the Agent Service"}),(0,r.jsx)(t.td,{children:"TRUE"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"INSTALLFOLDER"}),(0,r.jsx)(t.td,{children:"Agent installation path"}),(0,r.jsx)(t.td,{children:"\u2026\\Program Files \\Netwrix\\Netwrix Threat Prevention\\SIWindowsAgent"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"PORTNUMBER"}),(0,r.jsx)(t.td,{children:"Enterprise Manager port value"}),(0,r.jsx)(t.td,{children:"3741"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"ENTMGR_IPADDRESS  Required"}),(0,r.jsx)(t.td,{children:"Enterprise Manager IP address"}),(0,r.jsx)(t.td,{children:"127.0.0.1"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"FILE_MONITOR_INSTALL"}),(0,r.jsx)(t.td,{children:"Windows File System feature"}),(0,r.jsx)(t.td,{children:"FALSE"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"AD_MONITOR_INSTALL"}),(0,r.jsx)(t.td,{children:"Windows Active Directory Events feature"}),(0,r.jsx)(t.td,{children:"FALSE"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"EXCHANGE_MONITOR_INSTALL"}),(0,r.jsx)(t.td,{children:"Exchange Server Monitoring feature"}),(0,r.jsx)(t.td,{children:"FALSE"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"DNSLOOKUPS"}),(0,r.jsx)(t.td,{children:"\u2018dnsLookups\u2019 in the SIWindowsAgent.exe file"}),(0,r.jsx)(t.td,{children:"TRUE"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"CONFIGPARAMS"}),(0,r.jsx)(t.td,{children:"Key value pairs used in SIWindowsAgent.exe.config  Example Value:  Key=value&SDEventFormat=PROTOBUF"}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"LOCALPWNEDDB"}),(0,r.jsx)(t.td,{children:"HaveIBeenPwned (HIBP) hash Database mode for Agent or Enterprise Manager"}),(0,r.jsx)(t.td,{children:"FALSE"})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"Command Line Configuration Examples"}),"\n",(0,r.jsx)(t.p,{children:"The following examples show some standard scenarios for Agent installations."}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"NOTE:"}),"  Parameters with TRUE or FALSE are case sensitive. In the examples, EMCERTIFICATE and ENROLLMENTSECRET have been generated and are unique to each install. These need to be retrieved from the Administration Console."]}),"\n",(0,r.jsx)(t.p,{children:"Installing a new Agent to monitor Active Directory and File Events Example"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"\u201cSI Agent.exe\u201d /q ENTMGR_IPADDRESS=10.0.21.1 FILE_MONITOR_INSTALL=TRUE AD_MONITOR_INSTALL=TRUE EMCERTIFICATE=261730F6D0E6400ECB3E4A09DD38B10C8BCA494F ENROLLMENTSECRET=E2401994866965EB\n"})}),"\n",(0,r.jsx)(t.p,{children:"Upgrading an Agent Installation Example"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"\u201cSI Agent.exe\u201d /q ENTMGR_IPADDRESS=10.0.21.1 FILE_MONITOR_INSTALL=TRUE AD_MONITOR_INSTALL=TRUE\n"})})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);