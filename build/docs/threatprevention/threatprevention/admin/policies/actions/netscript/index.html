<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-threatprevention docs-version-current docs-doc-page docs-doc-id-threatprevention/admin/policies/actions/netscript" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">.NET Script Actions | Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.yourcompany.com/img/Logo_RGB.svg"><meta data-rh="true" name="twitter:image" content="https://docs.yourcompany.com/img/Logo_RGB.svg"><meta data-rh="true" property="og:url" content="https://docs.yourcompany.com/docs/threatprevention/threatprevention/admin/policies/actions/netscript"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-threatprevention-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-threatprevention-current"><meta data-rh="true" property="og:title" content=".NET Script Actions | Documentation"><meta data-rh="true" name="description" content="A Visual Basic or C# script can be written and assigned to a policy by users or a Netwrix Engineer via engaging Netwrix Professional Services. The script will be invoked by the Enterprise Manager for an enabled policy."><meta data-rh="true" property="og:description" content="A Visual Basic or C# script can be written and assigned to a policy by users or a Netwrix Engineer via engaging Netwrix Professional Services. The script will be invoked by the Enterprise Manager for an enabled policy."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.yourcompany.com/docs/threatprevention/threatprevention/admin/policies/actions/netscript"><link data-rh="true" rel="alternate" href="https://docs.yourcompany.com/docs/threatprevention/threatprevention/admin/policies/actions/netscript" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.yourcompany.com/docs/threatprevention/threatprevention/admin/policies/actions/netscript" hreflang="x-default"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"><link rel="stylesheet" href="/assets/css/styles.4cbdd69d.css">
<script src="/assets/js/runtime~main.a42836f1.js" defer="defer"></script>
<script src="/assets/js/main.3131faef.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/branding/logo.svg" alt="Netwrix Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/branding/logo.svg" alt="Netwrix Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Products</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/1secure">1Secure</a></li><li><a class="dropdown__link" href="/docs/accessanalyzer">Access Analyzer</a></li><li><a class="dropdown__link" href="/docs/accessinformationcenter">Access Information Center</a></li><li><a class="dropdown__link" href="/docs/activitymonitor">Activity Monitor</a></li><li><a class="dropdown__link" href="/docs/auditor">Auditor</a></li><li><a class="dropdown__link" href="/docs/changetracker">Change Tracker</a></li><li><a class="dropdown__link" href="/docs/dataclassification">Data Classification</a></li><li><a class="dropdown__link" href="/docs/groupid">Group ID</a></li><li><a class="dropdown__link" href="/docs/passwordpolicyenforcer">Password Policy Enforcer</a></li><li><a class="dropdown__link" href="/docs/passwordreset">Password Reset</a></li><li><a class="dropdown__link" href="/docs/passwordsecure">Password Secure</a></li><li><a class="dropdown__link" href="/docs/policypak">PolicyPak</a></li><li><a class="dropdown__link" href="/docs/privilegesecure">Privilege Secure</a></li><li><a class="dropdown__link" href="/docs/recoveryforactivedirectory">Recovery for Active Directory</a></li><li><a class="dropdown__link" href="/docs/strongpointfornetsuite">StrongPoint for NetSuite</a></li><li><a class="dropdown__link" href="/docs/strongpointforsalesforce">StrongPoint for Salesforce</a></li><li><a class="dropdown__link" href="/docs/strongpointnetsuiteflashlight">StrongPoint NetSuite Flashlight</a></li><li><a class="dropdown__link" href="/docs/strongpointsalesforceflashlight">StrongPoint Salesforce Flashlight</a></li><li><a class="dropdown__link" href="/docs/threatmanager">Threat Manager</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/threatprevention">Threat Prevention</a></li><li><a class="dropdown__link" href="/docs/usercube">UserCube</a></li><li><a class="dropdown__link" href="/docs/usercube_saas">UserCube SaaS</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="http://github.com/netwrix" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/threatprevention/config/activedirectory/threatprevention">config</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/threatprevention/">Threat Prevention</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/threatprevention/threatprevention/admin/agents/deploy/installing">threatprevention</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/threatprevention/threatprevention/admin/agents/deploy/installing">admin</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/admin/agents/deploy/installing">agents</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/admin/alerts/overview">alerts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/admin/analytics/baduseridsourcehost">analytics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/admin/configuration/collectionmanager/dynamic">configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/admin/investigate/datagrid">investigate</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/admin/navigation/datagrid">navigation</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/threatprevention/threatprevention/admin/overview">Administration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/actions/file">policies</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/actions/file">actions</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/actions/file">File Actions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/actions/netscript">.NET Script Actions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/actions/overview">Actions Tab</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/actions/powershell">PowerShell 4.0 Actions</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/configuration">Policy Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/dataprotection">Data Protection</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/eventtype/activedirectorychanges">eventtype</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/exportpoliciestemplates">Export Policies and Templates Window</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/general">General Tab</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/overview">Policies Interface</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/admin/policies/recentevents/eventtracker">recentevents</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/admin/tags/overview">tags</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/admin/templates/actions">templates</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/admin/tools/exportpoliciestemplates">tools</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/api/collections">api</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/eperestsite/accountmanagement">eperestsite</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/threatprevention/threatprevention/gettingstarted">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/install/adminconsole">install</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/threatprevention/threatprevention/overview">Netwrix Threat Prevention v7.5 Documentation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/reportingmodule/configuration/integrations/activedirectorysync">reportingmodule</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/requirements/adminconsole">requirements</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/siemdashboard/overview">siemdashboard</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/solutions/activedirectory">solutions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/threatprevention/threatprevention/troubleshooting/agentcommunication">troubleshooting</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/threatprevention/threatprevention/whatsnew">What&#x27;s New</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">threatprevention</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">admin</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">policies</span><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">actions</span><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">.NET Script Actions</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>.NET Script Actions</h1></header>
<p>A Visual Basic or C# script can be written and assigned to a policy by users or a Netwrix Engineer via engaging Netwrix Professional Services. The script will be invoked by the Enterprise Manager for an enabled policy.</p>
<p>Follow the steps to add a .NET Script action to a policy/template.</p>
<p><img decoding="async" loading="lazy" alt="Actions tab - Actions Configurations area" src="data:image/webp;base64,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" width="911" height="273" class="img_ev3q"></p>
<p><strong>Step 1 –</strong> On a policy or template <strong>Actions</strong> tab, click <strong>Add</strong> (+) to open the Add Action window.</p>
<p><strong>Step 2 –</strong> In the left pane, select the radio button for <strong>.NET Script</strong>.</p>
<p><img decoding="async" loading="lazy" alt="Policy &amp;gt; Actions tab &amp;gt; Add Actions window for .Net Script" src="/assets/images/addactionwindowfornetscript-cf211f1d729026f080af6ecb6ae53b0e.webp" width="600" height="654" class="img_ev3q"></p>
<p><strong>Step 3 –</strong> Configure the .NET Script action:</p>
<ul>
<li>Name – Provide a unique, descriptive name for this .NET Script action</li>
<li>Check the box for <strong>Enabled</strong> to allow the policy to launch the script</li>
<li>Description – Provide a clear and detailed description for this .NET Script action. This is optional but recommended.</li>
<li>Select the radio button for the script language being used:<!-- -->
<ul>
<li>Visual Basic</li>
<li>C#</li>
</ul>
</li>
<li>Click <strong>Edit…</strong> to open the Threat Prevention Script Editor window and provide the script</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Script Editor for .Net Scripts" src="/assets/images/scripteditorfornet-05d6f24a3f9a246bce23719c5eb40ecc.webp" width="1184" height="816" class="img_ev3q"></p>
<p><strong>Step 4 –</strong> Create or copy/paste a custom script in the Threat Prevention Script Editor. See the <a href="#Threat-Prevention-Script-Editor-Tools">Threat Prevention Script Editor Tools</a> topic for additional information, i.e. Run for testing and Encrypt functionality. See the <a href="#Default-Visual-Basic-Script">Default Visual Basic Script</a> and <a href="#Default-C-Script">Default C# Script</a> topics for default custom scripts. Save and close.</p>
<p><strong>Step 5 –</strong> On the Add Action window, the new script is displayed in the <strong>Script Preview</strong> section. Check the <strong>Enable compiler error logging</strong> checkbox to enable Threat Prevention to log information about the compiling of scripts.</p>
<p><strong>Step 6 –</strong> Click Save to close the Add Action window and apply changes.</p>
<p><img decoding="async" loading="lazy" alt="Actions tab - .Net Script Action Created" src="/assets/images/netscriptaction-aec6d707dd3a11ac4900b80ecf15cefa.webp" width="1309" height="921" class="img_ev3q"></p>
<p>The Actions tab now displays the configured settings for the specified .NET Script action. The action configuration can be directly edited through this display as well.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="threat-prevention-script-editor-tools">Threat Prevention Script Editor Tools<a href="#threat-prevention-script-editor-tools" class="hash-link" aria-label="Direct link to Threat Prevention Script Editor Tools" title="Direct link to Threat Prevention Script Editor Tools">​</a></h2>
<p>On the Add Action window, the <strong>Edit...</strong> button opens the Threat Prevention Script Editor. The top bar includes the Tools dropdown menu that provides several useful tools.</p>
<p><img decoding="async" loading="lazy" alt="Tools Menu in the Script Editor" src="/assets/images/toolsmenu-bc23ac32b6d2272a6c4bd6ff3313a2a5.webp" width="406" height="238" class="img_ev3q"></p>
<p>The Tools menu contains the following options:</p>
<ul>
<li>Assembly Manager – Applies to Visual Basic and C# scripts only. It displays a list of assemblies that support exposing Threat Prevention data in the VB or C# runtime environments.</li>
<li>Compile (Ctrl+F6) – Applies to Visual Basic and C# scripts only. It compiles the script to find and fix syntax errors.</li>
<li>Run (F5) – Executes the script on the machine where the Administration Console is installed. It launches the script from the Administration Console, allowing the user to test the script. When running a .NET Script action, there are no prerequisites.</li>
<li>Reset to Default Script – Replaces the existing script with the default script that is shipped with Threat Prevention.</li>
<li>Encrypt – Encrypts selected portions of the script to an encrypted string with a decrypt command for run time. See note below explaining why only a plain text string, information in thae script between quote marks (“), should be encrypted.</li>
</ul>
<p><em>Remember,</em> when testing a script in the Script Editor, the <strong>Run</strong> option executes the script in the context of the user logged into the Administration Console. In production, when this script is run as part of a policy, it will run in the context of the account configured for the Enterprise Manager. If the script depends on specific user/account rights, then that should be taken into account when using the <strong>Run</strong> option to test the script.</p>
<p><strong>CAUTION:</strong> The Tools &gt; Encrypt option is used to obfuscate plain text strings, e.g. credentials, within the script. Encrypting functions or other commands result in the script not working. Only a literal string should be encrypted, between the quote marks (“). The quote marks themselves should not be included in the encryption.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="default-visual-basic-script">Default Visual Basic Script<a href="#default-visual-basic-script" class="hash-link" aria-label="Direct link to Default Visual Basic Script" title="Direct link to Default Visual Basic Script">​</a></h2>
<p>The following Visual Basic script is configured as a default action. It will either create the c:\nveventdata.txt file or append the event data to it.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Imports Microsoft.VisualBasic  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Imports System  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Imports System.Collections  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Imports System.IO  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Imports System.Text  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Imports SI.Common.Messages  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Imports SI.SIMonitor.ConsoleMessages.Helpers   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Namespace ScriptNamespace   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Public Class ScriptClass   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private helper As EventConsumerHelper = Nothing   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;&#x27;&#x27;Required class constructor  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Public Sub New(ByVal ecHelper As EventConsumerHelper)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MyBase.New  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Me.helper = ecHelper  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;Public Read-Only Properties of EventConsumerHelper are as follows:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public DateTime TimeLogged  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public DateTime TimeLoggedUtc  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string EventSourceType  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string EventSourceName  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string SettingName  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string EventName  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string DN  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string ClassName  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string Perpetrator  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string OriginatingServer  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string OriginatingClient  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string Success  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string Status  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public Hashtable NewAttributes  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public Hashtable OldAttributes  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public Hashtable Operations  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string BlockedEvent  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string EventsCount  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string OriginatingClientProtocol  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string FromHost  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string FromHostIp  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string ToHost  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string ToHostIp  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string LoginType  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string AffectedObjectSid  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string OriginatingServerIp  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string PerpetratorName  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string PerpetratorSid  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;  public string EventNameTranslated  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;Enter code in method ScriptMain below:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27; new attributes  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27; old attributes  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27; operations  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Public Overridable Sub ScriptMain()   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim sw As System.IO.StreamWriter = Nothing  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Try   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw = New System.IO.StreamWriter(&quot;c:\si_eventdata.txt&quot;, true)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;===========================================&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;TimeLogged:  &quot; + helper.TimeLogged.ToString))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;TimeLoggedUtc:  &quot; + helper.TimeLoggedUtc.ToString))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;EventSourceType: &quot; + helper.EventSourceType))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;EventSourceName: &quot; + helper.EventSourceName))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;SettingName: &quot; + helper.SettingName))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;EventName: &quot; + helper.EventName))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;DN:  &quot; + helper.DN.ToString))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;ClassName: &quot; + helper.ClassName))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;Perpetrator: &quot; + helper.Perpetrator))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;OriginatingServer: &quot; + helper.OriginatingServer))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;OriginatingClient: &quot; + helper.OriginatingClient))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;Success: &quot; + helper.Success.ToString))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;Status: &quot; + helper.Status))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;BlockedEvent: &quot; + helper.BlockedEvent.ToString))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;EventsCount: &quot; + helper.EventsCount.ToString))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;OriginatingClientProtocol: &quot; + helper.OriginatingClientProtocol))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;FromHost: &quot; + helper.FromHost))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;FromHostIp: &quot; + helper.FromHostIp))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;ToHost: &quot; + helper.ToHost))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;ToHostIp: &quot; + helper.ToHostIp))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;LoginType: &quot; + helper.LoginType.ToString))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;AffectedObjectSid: &quot; + helper.AffectedObjectSid))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;OriginatingServerIp: &quot; + helper.OriginatingServerIp))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;PerpetratorName: &quot; + helper.PerpetratorName))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;PerpetratorSid: &quot; + helper.PerpetratorSid))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;EventNameTranslated: &quot; + helper.EventNameTranslated))   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;New Attributes:&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;--------------&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(Me.GetAttributes(helper.NewAttributes))   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;Old Attributes:&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;--------------&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(Me.GetAttributes(helper.OldAttributes))   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;Operations:&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;--------------&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(Me.GetAttributes(helper.Operations))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;===========================================&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.Flush  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Catch e As System.Exception  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Finally  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.Close  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Try  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Function GetAttributes(ByVal attributes As System.Collections.Hashtable) As String  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim sb As System.Text.StringBuilder = New System.Text.StringBuilder()  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim enumerator As System.Collections.IEnumerator = attributes.GetEnumerator   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Do While enumerator.MoveNext  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim attrName As String = Nothing  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim de As System.Collections.DictionaryEntry = CType(enumerator.Current,System.Collections.DictionaryEntry)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If (de.Key &lt;&gt; Nothing) Then  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">attrName = de.Key.ToString  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Else  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">attrName = &quot;&quot;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End If  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(attrName)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(&quot;: &quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If Not (de.Value Is Nothing) Then  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If (de.Value.GetType Is GetType(SI.Common.Messages.NvMessageArray)) Then  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim values As SI.Common.Messages.NvMessageArray = CType(de.Value,SI.Common.Messages.NvMessageArray)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If (values.Count &gt; 0) Then  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim valueCount As Integer = values.Count  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim valueEnumerator As System.Collections.IEnumerator = values.GetEnumerator  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Do While valueEnumerator.MoveNext  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim o As Object = valueEnumerator.Current  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If (o &lt;&gt; Nothing) Then  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(o.ToString)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">valueCount = (valueCount - 1)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If (valueCount &gt; 0) Then  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(&quot;, &quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Else  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(&quot;&quot;&amp;Global.Microsoft.VisualBasic.ChrW(13)&amp;Global.Microsoft.VisualBasic.ChrW(10))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End If  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End If   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loop  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End If  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Else  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(de.Value.ToString)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(&quot;&quot;&amp;Global.Microsoft.VisualBasic.ChrW(13)&amp;Global.Microsoft.VisualBasic.ChrW(10))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End If  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End If   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loop  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Return sb.ToString  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Class  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Namespace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="default-c-script">Default C# Script<a href="#default-c-script" class="hash-link" aria-label="Direct link to Default C# Script" title="Direct link to Default C# Script">​</a></h2>
<p>The following C# script is configured as a default action. It will either create the c:\nveventdata.txt file or append the event data to it.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">namespace ScriptNamespace  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Collections;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.IO;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Text;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using SI.Common.Messages;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using SI.SIMonitor.ConsoleMessages.Helpers;   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ScriptClass  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private EventConsumerHelper helper = null;   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// Required class constructor  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public ScriptClass(EventConsumerHelper ecHelper)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">this.helper = ecHelper;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Public Read-Only Properties of EventConsumerHelper are as follows:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public DateTime TimeLogged  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public DateTime TimeLoggedUtc  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string EventSourceType  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string EventSourceName  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string SettingName  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string EventName  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string DN  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string ClassName  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string Perpetrator  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string OriginatingServer  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string OriginatingClient  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string Success  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string Status  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public Hashtable NewAttributes  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public Hashtable OldAttributes  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public Hashtable Operations  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string BlockedEvent  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string EventsCount  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string OriginatingClientProtocol  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string FromHost  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string FromHostIp  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string ToHost  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string ToHostIp  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string LoginType  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string AffectedObjectSid  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string OriginatingServerIp  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string PerpetratorName  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string PerpetratorSid  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   public string EventNameTranslated  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Enter code in method ScriptMain below:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//  new attributes  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//  old attributes  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//  operations  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public virtual void ScriptMain()  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.IO.StreamWriter sw = null;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw = new System.IO.StreamWriter(&quot;c:\\si_eventdata.txt&quot;, true);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;===========================================&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;TimeLogged:  &quot; + helper.TimeLogged.ToString()));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;TimeLoggedUtc:  &quot; + helper.TimeLoggedUtc.ToString()));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;EventSourceType: &quot; + helper.EventSourceType));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;EventSourceName: &quot; + helper.EventSourceName));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;SettingName: &quot; + helper.SettingName));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;EventName: &quot; + helper.EventName));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;DN:  &quot; + helper.DN.ToString()));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;ClassName: &quot; + helper.ClassName));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;Perpetrator: &quot; + helper.Perpetrator));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;OriginatingServer: &quot; + helper.OriginatingServer));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;OriginatingClient: &quot; + helper.OriginatingClient));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;Success: &quot; + helper.Success.ToString()));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;Status: &quot; + helper.Status));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;BlockedEvent: &quot; + helper.BlockedEvent.ToString()));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;EventsCount: &quot; + helper.EventsCount.ToString()));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;OriginatingClientProtocol: &quot; + helper.OriginatingClientProtocol));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;FromHost: &quot; + helper.FromHost));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;FromHostIp: &quot; + helper.FromHostIp));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;ToHost: &quot; + helper.ToHost));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;ToHostIp: &quot; + helper.ToHostIp));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;LoginType: &quot; + helper.LoginType.ToString()));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;AffectedObjectSid: &quot; + helper.AffectedObjectSid));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;OriginatingServerIp: &quot; + helper.OriginatingServerIp));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;PerpetratorName: &quot; + helper.PerpetratorName));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;PerpetratorSid: &quot; + helper.PerpetratorSid));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine((&quot;EventNameTranslated: &quot; + helper.EventNameTranslated));   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;New Attributes:&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;--------------&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(this.GetAttributes(helper.NewAttributes));   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;Old Attributes:&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;--------------&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(this.GetAttributes(helper.OldAttributes));   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;Operations:&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;--------------&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(this.GetAttributes(helper.Operations));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;===========================================&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.WriteLine(&quot;&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.Flush();  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">catch (System.Exception e)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">finally  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sw.Close();  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private string GetAttributes(System.Collections.Hashtable attributes)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.Text.StringBuilder sb = new System.Text.StringBuilder();  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.Collections.IEnumerator enumerator = attributes.GetEnumerator();  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for (  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; enumerator.MoveNext();   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string attrName = null;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.Collections.DictionaryEntry de = ((System.Collections.DictionaryEntry)(enumerator.Current));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ((de.Key != null))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">attrName = de.Key.ToString();  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">else  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">attrName = &quot;&quot;;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(attrName);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(&quot;: &quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ((de.Value != null))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ((de.Value.GetType() == typeof(SI.Common.Messages.NvMessageArray)))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SI.Common.Messages.NvMessageArray values = ((SI.Common.Messages.NvMessageArray)(de.Value));  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ((values.Count &gt; 0))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int valueCount = values.Count;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.Collections.IEnumerator valueEnumerator = values.GetEnumerator();  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for (  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; valueEnumerator.MoveNext();   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object o = valueEnumerator.Current;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ((o != null))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(o.ToString());  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">valueCount = (valueCount - 1);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ((valueCount &gt; 0))  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(&quot;, &quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">else  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(&quot;\r\n&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">else  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(de.Value.ToString());  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sb.Append(&quot;\r\n&quot;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">return sb.ToString();  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/threatprevention/threatprevention/admin/policies/actions/netscript.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/threatprevention/threatprevention/admin/policies/actions/file"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">File Actions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/threatprevention/threatprevention/admin/policies/actions/overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Actions Tab</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#threat-prevention-script-editor-tools" class="table-of-contents__link toc-highlight">Threat Prevention Script Editor Tools</a></li><li><a href="#default-visual-basic-script" class="table-of-contents__link toc-highlight">Default Visual Basic Script</a></li><li><a href="#default-c-script" class="table-of-contents__link toc-highlight">Default C# Script</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>