<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-activitymonitor docs-version-current docs-doc-page docs-doc-id-config/netappcmode/activity" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">NetApp Data ONTAP Cluster-Mode Activity Auditing Configuration | Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.yourcompany.com/img/Logo_RGB.svg"><meta data-rh="true" name="twitter:image" content="https://docs.yourcompany.com/img/Logo_RGB.svg"><meta data-rh="true" property="og:url" content="https://docs.yourcompany.com/docs/activitymonitor/config/netappcmode/activity"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-activitymonitor-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-activitymonitor-current"><meta data-rh="true" property="og:title" content="NetApp Data ONTAP Cluster-Mode Activity Auditing Configuration | Documentation"><meta data-rh="true" name="description" content="The Activity Monitor agent employed to monitor NetApp leverages NetApp ONTAP API, and the NetApp FPolicy framework to monitor file system events. This includes both NetApp 7-Mode and Cluster-Mode configurations. For more information about FPolicy read the What are the two parts of the FPolicy solution  article."><meta data-rh="true" property="og:description" content="The Activity Monitor agent employed to monitor NetApp leverages NetApp ONTAP API, and the NetApp FPolicy framework to monitor file system events. This includes both NetApp 7-Mode and Cluster-Mode configurations. For more information about FPolicy read the What are the two parts of the FPolicy solution  article."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.yourcompany.com/docs/activitymonitor/config/netappcmode/activity"><link data-rh="true" rel="alternate" href="https://docs.yourcompany.com/docs/activitymonitor/config/netappcmode/activity" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.yourcompany.com/docs/activitymonitor/config/netappcmode/activity" hreflang="x-default"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"><link rel="stylesheet" href="/assets/css/styles.4cbdd69d.css">
<script src="/assets/js/runtime~main.a42836f1.js" defer="defer"></script>
<script src="/assets/js/main.3131faef.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/branding/logo.svg" alt="Netwrix Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/branding/logo.svg" alt="Netwrix Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Products</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/1secure">1Secure</a></li><li><a class="dropdown__link" href="/docs/accessanalyzer">Access Analyzer</a></li><li><a class="dropdown__link" href="/docs/accessinformationcenter">Access Information Center</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/activitymonitor">Activity Monitor</a></li><li><a class="dropdown__link" href="/docs/auditor">Auditor</a></li><li><a class="dropdown__link" href="/docs/changetracker">Change Tracker</a></li><li><a class="dropdown__link" href="/docs/dataclassification">Data Classification</a></li><li><a class="dropdown__link" href="/docs/groupid">Group ID</a></li><li><a class="dropdown__link" href="/docs/passwordpolicyenforcer">Password Policy Enforcer</a></li><li><a class="dropdown__link" href="/docs/passwordreset">Password Reset</a></li><li><a class="dropdown__link" href="/docs/passwordsecure">Password Secure</a></li><li><a class="dropdown__link" href="/docs/policypak">PolicyPak</a></li><li><a class="dropdown__link" href="/docs/privilegesecure">Privilege Secure</a></li><li><a class="dropdown__link" href="/docs/recoveryforactivedirectory">Recovery for Active Directory</a></li><li><a class="dropdown__link" href="/docs/strongpointfornetsuite">StrongPoint for NetSuite</a></li><li><a class="dropdown__link" href="/docs/strongpointforsalesforce">StrongPoint for Salesforce</a></li><li><a class="dropdown__link" href="/docs/strongpointnetsuiteflashlight">StrongPoint NetSuite Flashlight</a></li><li><a class="dropdown__link" href="/docs/strongpointsalesforceflashlight">StrongPoint Salesforce Flashlight</a></li><li><a class="dropdown__link" href="/docs/threatmanager">Threat Manager</a></li><li><a class="dropdown__link" href="/docs/threatprevention">Threat Prevention</a></li><li><a class="dropdown__link" href="/docs/usercube">UserCube</a></li><li><a class="dropdown__link" href="/docs/usercube_saas">UserCube SaaS</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="http://github.com/netwrix" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/activitymonitor/activitymonitor/admin/agents/add/activedirectory">activitymonitor</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/activitymonitor/config/activedirectory/activity">config</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/activedirectory/activity">activedirectory</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/ctera/Activity">ctera</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/dellcelerravnx/Activity">dellcelerravnx</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/dellpowerscale/InstallCEE">dellpowerscale</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/dellpowerstore/activity">dellpowerstore</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/dellunity/InstallCEE">dellunity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/entraid/activity">entraid</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/exchangeonline/activity">exchangeonline</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/hitachi/activity">hitachi</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/nasuni/activity">nasuni</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/netapp7mode/activity">netapp7mode</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/activitymonitor/config/netappcmode/activity">netappcmode</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/activitymonitor/config/netappcmode/activity">NetApp Data ONTAP Cluster-Mode Activity Auditing Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/activitymonitor/config/netappcmode/configurefirewall">Configure Network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/activitymonitor/config/netappcmode/configurefpolicy">Configure FPolicy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/activitymonitor/config/netappcmode/provisionactivity">Provision ONTAP Account</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/nutanix/activity">nutanix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/panzura/activity">panzura</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/qumulo/activity">qumulo</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/sharepoint/activity">sharepoint</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/sharepointonline/activity">sharepointonline</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/sqlserver/activity">sqlserver</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/activitymonitor/config/windowsfile/activity">windowsfile</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/activitymonitor/">Activity Monitor</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">config</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">netappcmode</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">NetApp Data ONTAP Cluster-Mode Activity Auditing Configuration</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>NetApp Data ONTAP Cluster-Mode Activity Auditing Configuration</h1></header>
<p>The Activity Monitor agent employed to monitor NetApp leverages NetApp ONTAP API, and the NetApp FPolicy framework to monitor file system events. This includes both NetApp 7-Mode and Cluster-Mode configurations. For more information about FPolicy read the <a href="https://library.netapp.com/ecmdocs/ECMP1401220/html/GUID-54FE1A84-6CF0-447E-9AAE-F43B61CA2138.html" target="_blank" rel="noopener noreferrer">What are the two parts of the FPolicy solution </a> article.</p>
<p>Activity Monitor requires two communication channels for ONTAP monitoring:</p>
<ol>
<li>Activity Monitor Agent connects to ONTAP on port 80 or 443 for access to ONTAP API (ONTAPI/ZAPI or REST API).</li>
<li>Data LIFs of the SVM connect to Activity Monitor Agent on port 9999 for FPolicy notifications.</li>
</ol>
<p>The ONTAP API access is mandatory; without the API access the agent will not be able to receive and translate events from FPolicy. Both classic ONTAPI/ZAPI and the new REST API are supported. The agent uses the API to retrieve information about the storage virtual machines (SVM): CIFS settings, list of volumes, list of LIFs. Depending on the configuration, the agent can also retrieve the state of FPolicy to ensure it is enabled; configure FPolicy and register or unregister itself.</p>
<p>The FPolicy framework enables the collection of audit events on the ONTAP side and their transfer to the agent(s) via the designated Data LIFs. Each LIF establishes its own connection with one or several agents and sends notifications as soon as the file transaction occurs. The FPolicy connection is asynchronous and buffered; both ONTAP and Activity Monitor have techniques in place to make sure that connections are alive and working. The connection can be secured using TLS with server or mutual authentication.</p>
<p>FPolicy may have a significant impact on file system throughput, and it is always a best practice to monitor performance when enabling FPolicy.</p>
<p><em><strong>RECOMMENDED:</strong></em> Create a tailored FPolicy which only collects the desired activity from the environment to limit the scope and impact.</p>
<p>For scale-out and fault tolerance purposes, the product supports a range of deployment options. A single agent can receive events from multiple SVMs. Or events from a single SVM can be distributed among multiple agents. Or a set of SVMs can distribute events among a set of agents. The choice depends on the fault tolerance requirements and the expected event flow. As a rule of thumb, the <em>average</em> load on a single agent should not exceed 5000 events per second.</p>
<p>Starting with ONTAP 9.15.1, the FPolicy Persistent Store provides resilience and predictable latency during scenarios such as network delays or bursts of activity. The feature uses a dedicated volume for each SVM as a staging buffer before events are sent to the agent. FPolicy will automatically create a volume if one does not already exist.</p>
<p><em><strong>RECOMMENDED:</strong></em> Enable the Persistent Store feature and allow it to create a volume automatically.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-checklist">Configuration Checklist<a href="#configuration-checklist" class="hash-link" aria-label="Direct link to Configuration Checklist" title="Direct link to Configuration Checklist">​</a></h2>
<p>Complete the following checklist prior to configuring the activity monitoring of NetApp Data ONTAP Cluster-Mode devices. Instructions for each item of the checklist are detailed within the following sections.</p>
<p>Checklist Item 1: Plan Deployment</p>
<ul>
<li>
<p>Gather the following information:</p>
<ul>
<li>
<p>Names of the SVM(s) to be monitored</p>
<ul>
<li>FPolicy is configured for each SVM separately</li>
<li>This should be the SVM(s) hosting the CIFS or NFS shares(s) to be monitored</li>
</ul>
</li>
<li>
<p>Credentials to access ONTAP to provision a role and account.</p>
</li>
<li>
<p>Desired functionality level:</p>
<ul>
<li><em>Manual</em>. A user configures FPolicy manually and ensures it stays enabled.</li>
<li><em>Enable and Connect FPolicy</em>. The product ensures that FPolicy stays enabled and connected all the time. RECOMMENDED.</li>
<li><em>Configure FPolicy</em>. The product configures FPolicy automatically and ensures it stays enabled and connected all the time. RECOMMENDED.</li>
</ul>
</li>
<li>
<p>Volumes or shares on each SVM to be monitored</p>
<ul>
<li>Limiting the FPolicy to select volumes or shares is an effective way to limit the performance impact of FPolicy</li>
</ul>
</li>
<li>
<p>Successful/failed file operations to be monitored</p>
<ul>
<li>Limiting the FPolicy to specific file operations is an effective way to limit the performance impact of FPolicy</li>
</ul>
</li>
<li>
<p>IP Address of the server(s) where the Activity Monitor Agent is deployed</p>
</li>
<li>
<p>API enabled in ONTAP: the classic ONTAPI/ZAPI or the new REST API</p>
<ul>
<li>The product supports the REST API for ONTAP 9.13.1 and above.</li>
<li>Volume names and sizes to be used as a Persistent Store for each SVM. This is recommended.</li>
<li>The product supports the Persistent Store feature for ONTAP 9.15.1 and later.</li>
<li>At least one local tier (aggregate) is assigned to the SVM.</li>
</ul>
</li>
<li>
<p>Encryption and Authentication protocol for FPolicy connection</p>
<ul>
<li>No Authentication (default)</li>
<li>TLS, server authentication (the SVM authenticates the agent)</li>
<li>TLS, mutual authentication (both the SVM and the agent authenticate each other)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Persistent Store provides resilience and predictable latency in scenarios such as network delays or bursts of activity events.</p>
<p>It uses a dedicated volume for each SVM as a staging buffer before the events are sent to Activity Monitor Agent.</p>
<p>Checklist Item 2: <a href="/docs/activitymonitor/config/netappcmode/provisionactivity">Provision ONTAP Account</a></p>
<ul>
<li>
<p>Permission names depend on the API used, ONTAPI/ZAPI or REST API.</p>
</li>
<li>
<p>The case of domain and username created during the account provisioning process must match exactly to the credentials provided to the activity agent for authentication to work.</p>
</li>
<li>
<p>The credential associated with the FPolicy used to monitor activity must be provisioned with access to (at minimum) the following CLI or API commands, according to the level of collection desired:</p>
<ul>
<li>
<p>Manual, Collect Activity Events Only (Least Privilege)</p>
<ul>
<li>
<p>ONTAPI/ZAPI</p>
<ul>
<li><code>version</code> – Readonly access</li>
<li><code>volume</code> – Readonly access</li>
<li><code>vserver</code> – Readonly access</li>
</ul>
</li>
<li>
<p>REST API</p>
<ul>
<li><code>/api/cluster</code> – Readonly access</li>
<li><code>/api/protocols/cifs/services</code> – Readonly access</li>
<li><code>/api/storage/volumes</code> – Readonly access</li>
<li><code>/api/svm/svms</code> – Readonly access</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Employ the “Enable and connect FPolicy” Option (Less Privilege) – RECOMMENDED</p>
<ul>
<li>
<p>ONTAPI/ZAPI</p>
<ul>
<li><code>version</code> – Readonly access</li>
<li><code>volume</code> – Readonly access</li>
<li><code>vserver</code> – Readonly access</li>
<li><code>network interface</code> – Readonly access</li>
<li><code>vserver fpolicy disable</code> – All access</li>
<li><code>vserver fpolicy enable</code> – All access</li>
<li><code>vserver fpolicy engine-connect</code> – All access</li>
</ul>
</li>
<li>
<p>REST API</p>
<ul>
<li><code>/api/cluster</code> – Readonly access</li>
<li><code>/api/protocols/cifs/services</code> – Readonly access</li>
<li><code>/api/storage/volumes</code> – Readonly access</li>
<li><code>/api/svm/svms</code> – Readonly access</li>
<li><code>/api/network/ip/interfaces</code> – Readonly access</li>
<li><code>/api/protocols/fpolicy</code> – All access</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Employ the “Configure FPolicy” Option (Automatic Configuration of FPolicy) – RECOMMENDED</p>
<ul>
<li>
<p>ONTAPI/ZAPI</p>
<ul>
<li><code>version</code> – Readonly access</li>
<li><code>volume</code> – Readonly access</li>
<li><code>vserver</code> – Readonly access</li>
<li><code>network interface</code> – Readonly access</li>
<li><code>vserver fpolicy</code> – All access</li>
<li><code>security certificate install</code> – All access (only if FPolicy uses a TLS connection)</li>
</ul>
</li>
<li>
<p>REST API</p>
<ul>
<li><code>/api/cluster</code> – Readonly access</li>
<li><code>/api/protocols/cifs/services</code> – Readonly access</li>
<li><code>/api/storage/volumes</code> – Readonly access</li>
<li><code>/api/svm/svms</code> – Readonly access</li>
<li><code>/api/network/ip/interfaces</code> – Readonly access</li>
<li><code>/api/protocols/fpolicy</code> – All access</li>
<li><code>/api/security/certificates</code> – All access (only if FPolicy uses a TLS connection)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Access Analyzer Integration requires the addition of the following CLI command:</p>
<ul>
<li><code>security login role show-ontapi</code> – Readonly access</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Checklist Item 3: <a href="/docs/activitymonitor/config/netappcmode/configurefirewall">Configure Network</a></p>
<ul>
<li>
<p>Agent must be able to connect to ONTAP API via a management LIF on ports HTTP (80) or HTTPS (443)</p>
<ul>
<li>NetApp firewall policy may need to be modified.</li>
<li>LIF&#x27;s service policy may need to be modified to include <code>management-https</code> or <code>management-http</code> services.</li>
<li>Either of these ports is required. Activity Monitor requires ONTAP API access.</li>
</ul>
</li>
<li>
<p>ONTAP cluster nodes, which serve the SVM, must be able to connect to the agent on port 9999.</p>
<ul>
<li>LIFs&#x27; service policy may need to be modified to include <code>data-fpolicy-client</code> service.</li>
<li>Each data serving node should have its own LIF with the <code>data-fpolicy-client</code> service.</li>
<li>The default port 9999 can be changed in the agent&#x27;s settings.</li>
</ul>
</li>
</ul>
<p>Checklist Item 4: <a href="/docs/activitymonitor/config/netappcmode/configurefpolicy">Configure FPolicy</a></p>
<ul>
<li>
<p>Remember: all FPolicy objects and SVM names are case sensitive.</p>
</li>
<li>
<p>FPolicy must be configured for each SVM to be monitored.</p>
</li>
<li>
<p>If using TLS, … authentication options, generate needed certificates and PEM files</p>
</li>
<li>
<p>Select method:</p>
<ul>
<li>
<p>Configure FPolicy Manually – If you want to exclude certain volumes or shares; a tailored FPolicy decreases the impact on NetApp.</p>
<ul>
<li>Required when the FPolicy account is provisioned for either Least Privileged or Less Privilege permission model</li>
<li>If using TLS, … authentication options, set authentication</li>
</ul>
</li>
<li>
<p>Allow the Activity Monitor to create an FPolicy automatically</p>
<ul>
<li>If using TLS, … authentication options, set authentication</li>
<li>This option is enabled using the <strong>Configure FPolicy. Create or modify FPolicy objects if needed</strong> checkbox for each monitored SVM.</li>
<li>It monitors file system activity on all volumes and shares of the SVM.</li>
<li>FPolicy configuration is automatically updated to reflect the Activity Monitor configuration.</li>
<li>Requires a Privileged Access credential be provided.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Enable the Persistent Store to increase the resilience and control the latency in case of network outages or bursts of activity</p>
</li>
</ul>
<p>Checklist Item 5: Activity Monitor Configuration</p>
<ul>
<li>Deploy the Activity Monitor Agent to a Windows server.</li>
<li>Configure the Agent to monitor the SVM.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/activitymonitor/config/netappcmode/activity.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/activitymonitor/config/netapp7mode/provisionactivity"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Provision FPolicy Account</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/activitymonitor/config/netappcmode/configurefirewall"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configure Network</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configuration-checklist" class="table-of-contents__link toc-highlight">Configuration Checklist</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>