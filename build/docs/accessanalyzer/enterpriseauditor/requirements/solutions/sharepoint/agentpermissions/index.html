<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-accessanalyzer docs-version-current docs-doc-page docs-doc-id-enterpriseauditor/requirements/solutions/sharepoint/agentpermissions" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">SharePoint Agent Permissions | Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.yourcompany.com/img/Logo_RGB.svg"><meta data-rh="true" name="twitter:image" content="https://docs.yourcompany.com/img/Logo_RGB.svg"><meta data-rh="true" property="og:url" content="https://docs.yourcompany.com/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/agentpermissions"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-accessanalyzer-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-accessanalyzer-current"><meta data-rh="true" property="og:title" content="SharePoint Agent Permissions | Documentation"><meta data-rh="true" name="description" content="When Access Analyzer SharePoint scans are run in agent-based mode, the Access Analyzer SharePoint Agent must be installed on the SharePoint Application server which hosts the Central Administration component prior to executing the scans. This is typically the first server stood up during the SharePoint farm installation process in this mode. The data collection processing is conducted by the SharePoint Agent for the target environment. The final step in data collection is to transfer the data collected in the SQLite databases, or Tier 2 databases, on the Access Analyzer SharePoint Agent server back to the Access Analyzer Console server."><meta data-rh="true" property="og:description" content="When Access Analyzer SharePoint scans are run in agent-based mode, the Access Analyzer SharePoint Agent must be installed on the SharePoint Application server which hosts the Central Administration component prior to executing the scans. This is typically the first server stood up during the SharePoint farm installation process in this mode. The data collection processing is conducted by the SharePoint Agent for the target environment. The final step in data collection is to transfer the data collected in the SQLite databases, or Tier 2 databases, on the Access Analyzer SharePoint Agent server back to the Access Analyzer Console server."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.yourcompany.com/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/agentpermissions"><link data-rh="true" rel="alternate" href="https://docs.yourcompany.com/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/agentpermissions" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.yourcompany.com/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/agentpermissions" hreflang="x-default"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"><link rel="stylesheet" href="/assets/css/styles.4cbdd69d.css">
<script src="/assets/js/runtime~main.a42836f1.js" defer="defer"></script>
<script src="/assets/js/main.3131faef.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/branding/logo.svg" alt="Netwrix Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/branding/logo.svg" alt="Netwrix Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Products</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/1secure">1Secure</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/accessanalyzer">Access Analyzer</a></li><li><a class="dropdown__link" href="/docs/accessinformationcenter">Access Information Center</a></li><li><a class="dropdown__link" href="/docs/activitymonitor">Activity Monitor</a></li><li><a class="dropdown__link" href="/docs/auditor">Auditor</a></li><li><a class="dropdown__link" href="/docs/changetracker">Change Tracker</a></li><li><a class="dropdown__link" href="/docs/dataclassification">Data Classification</a></li><li><a class="dropdown__link" href="/docs/groupid">Group ID</a></li><li><a class="dropdown__link" href="/docs/passwordpolicyenforcer">Password Policy Enforcer</a></li><li><a class="dropdown__link" href="/docs/passwordreset">Password Reset</a></li><li><a class="dropdown__link" href="/docs/passwordsecure">Password Secure</a></li><li><a class="dropdown__link" href="/docs/policypak">PolicyPak</a></li><li><a class="dropdown__link" href="/docs/privilegesecure">Privilege Secure</a></li><li><a class="dropdown__link" href="/docs/recoveryforactivedirectory">Recovery for Active Directory</a></li><li><a class="dropdown__link" href="/docs/strongpointfornetsuite">StrongPoint for NetSuite</a></li><li><a class="dropdown__link" href="/docs/strongpointforsalesforce">StrongPoint for Salesforce</a></li><li><a class="dropdown__link" href="/docs/strongpointnetsuiteflashlight">StrongPoint NetSuite Flashlight</a></li><li><a class="dropdown__link" href="/docs/strongpointsalesforceflashlight">StrongPoint Salesforce Flashlight</a></li><li><a class="dropdown__link" href="/docs/threatmanager">Threat Manager</a></li><li><a class="dropdown__link" href="/docs/threatprevention">Threat Prevention</a></li><li><a class="dropdown__link" href="/docs/usercube">UserCube</a></li><li><a class="dropdown__link" href="/docs/usercube_saas">UserCube SaaS</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="http://github.com/netwrix" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/accessanalyzer/config/activedirectory/access">config</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/accessanalyzer/enterpriseauditor/admin/action/activedirectory/operations/computerdetails">enterpriseauditor</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/admin/action/activedirectory/operations/computerdetails">admin</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/cdsa/job">cdsa</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/gettingstarted">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/install/application/database">install</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/overview">Netwrix Access Analyzer (formerly Enterprise Auditor) v12.0 Documentation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/overview">requirements</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/overview">Requirements</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/activedirectory">solutions</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/activedirectory">Active Directory Solution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/activedirectorypermissionsanalyzer">Active Directory Permissions Analyzer Solution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/aws">Amazon Web Services (AWS) Solution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/box">Box Solution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/databases">Databases Solution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/dropbox">Dropbox Solution</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/entraid/entraroles">entraid</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/entraid">Entra ID Solution</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange/mailflow">exchange</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/exchange">Exchange Solution</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/filesystem/appletmodepermissions">filesystem</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/filesystem">File System Solution</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/agentlesspermissions">sharepoint</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/agentlesspermissions">SharePoint Agent-Less Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/agentlessports">SharePoint Agent-Less Ports</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/agentpermissions">SharePoint Agent Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/agentports">SharePoint Agent Ports</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/onlinepermissions">SharePoint Online Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/onlineports">SharePoint Online Ports</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/scanoptions">SharePoint Scan Options</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint">SharePoint Solution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/unix">Unix Solution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/windows">Windows Solution</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/requirements/target/activedirectorypermissionsanalyzer">target</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/sensitivedatadiscovery/criteriaeditor/configuration">sensitivedatadiscovery</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/solutions/activedirectory/activity/ad_activitycollection">solutions</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/accessanalyzer/enterpriseauditor/whatsnew">What&#x27;s New</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/accessanalyzer/">Access Analyzer</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/accessanalyzer/stealthaudit/install_guides/mapi_cdo_install/appendix">stealthaudit</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">enterpriseauditor</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">requirements</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">solutions</span><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">sharepoint</span><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">SharePoint Agent Permissions</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>SharePoint Agent Permissions</h1></header>
<p>When Access Analyzer SharePoint scans are run in agent-based mode, the Access Analyzer SharePoint Agent must be installed on the SharePoint Application server which hosts the Central Administration component prior to executing the scans. This is typically the first server stood up during the SharePoint farm installation process in this mode. The data collection processing is conducted by the SharePoint Agent for the target environment. The final step in data collection is to transfer the data collected in the SQLite databases, or Tier 2 databases, on the Access Analyzer SharePoint Agent server back to the Access Analyzer Console server.</p>
<p>The Access Analyzer SharePoint Agent needs to be installed on the:</p>
<ul>
<li>
<p>SharePoint Application server hosting the Central Administration component</p>
<ul>
<li>SharePoint® 2013 through SharePoint® 2019</li>
<li>Windows® Server 2016 through Windows® Server 2022</li>
</ul>
</li>
</ul>
<p>Additional Server Requirements</p>
<p>The following are additional requirements for the Access Analyzer SharePoint Agent server:</p>
<ul>
<li>.NET Framework 4.8 installed</li>
<li>Port Sharing network feature</li>
</ul>
<p>Sensitive Data Discovery Auditing Requirement</p>
<p><strong>NOTE:</strong> The appropriate JDK (Java) version for Sensitive Data Discovery is installed on the server. The JDK deployed is prepackaged and does not require any configuration; it has been preconfigured to work with Access Analyzer and should never be customized through Java. It will not conflict with other JDKs or Java Runtimes in the same environment.</p>
<p>If running Sensitive Data Discovery (SDD) scans, it will be necessary to increase the minimum amount of RAM. Each thread requires a minimum of 2 additional GB of RAM per host. For example, if the job is configured to scan 8 hosts at a time , then an extra 16 GB of RAM are required (8x2=16).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="permissions-explained">Permissions Explained<a href="#permissions-explained" class="hash-link" aria-label="Direct link to Permissions Explained" title="Direct link to Permissions Explained">​</a></h2>
<p>If limited provisioning of the service account is not required by the organization, then the following permissions are sufficient for successful agent-based scans:</p>
<ul>
<li>
<p>Membership in the local Administrator group on the on server where the Access Analyzer SharePoint Agent is installed</p>
<ul>
<li>Only needed for agent installation</li>
</ul>
</li>
<li>
<p>SharePoint Application Server permissions:</p>
<ul>
<li>
<p>Membership in the local Backup Operators group</p>
<ul>
<li>This is required so Access Analyzer can read remote registry to identify if the server is part of the farm, what the server’s role is, and to identify the location of the SharePoint configuration database</li>
</ul>
</li>
<li>
<p>Membership in the local WSS_WPG group</p>
<ul>
<li>This is required to gain read access to system resources used by Microsoft SharePoint Foundation</li>
</ul>
</li>
<li>
<p>Log on as a Service in the Local Security Policy</p>
</li>
<li>
<p>Full Control on the agent install directory, default path is:</p>
<p><code>C:\Program Files\STEALTHbits\StealthAUDIT\SPAA</code></p>
</li>
</ul>
</li>
<li>
<p>SharePoint Farm permissions:</p>
<ul>
<li>
<p>Membership in the Farm Read group at the farm level</p>
<ul>
<li>This is required so the Access Analyzer auditing account can make calls against the SharePoint web services to remotely gather information around permissions, site hierarchy, content and more</li>
<li>If the group does not exist already, then you need to create a new group at that level and grant it Read access. Specifically, it is a group that exists within Central Administration at the farm administrator level. This group only requires Read access and is not giving farm admin access. Once the group is created, add the service account that Access Analyzer will be leveraging to scan SharePoint.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Web Application permissions:</p>
<ul>
<li>
<p>Custom Role with Site Collection Auditor at the web application level with the Open Items permission</p>
<ul>
<li>This is needed for Access Analyzer to execute web service calls against Central Administration</li>
</ul>
</li>
</ul>
</li>
<li>
<p>SharePoint Database Server permissions:</p>
<ul>
<li>
<p>SPDataAccess on the SharePoint Content database and all Configuration databases</p>
<ul>
<li>This permission should be applied on the desired Configuration database and all Content databases for the SharePoint version</li>
<li>This version-specific permission is required for Access Analyzer to execute read operations directly against the SharePoint databases, gather information from the configuration database regarding the names and locations of the web applications and content databases, and give read access around sites, roles, and users</li>
</ul>
</li>
</ul>
</li>
<li>
<p>DB_Owner on Access Analyzer database if using Windows Authentication for the Storage Profile</p>
</li>
<li>
<p>MySites permissions are based on the SharePointAccess Data Collector configuration option:</p>
<ul>
<li>Forcing the service account to become a temporary admin of the personal sites either as the service account or as a member of the Company Administrators group requires SharePoint Farm Administrator role or Site Collection Auditor at the web application housing MySites</li>
<li>The skipping inaccessible personal sites option only scans sites where the service account has administrative access</li>
<li>This grants Access Analyzer rights to scan MySites</li>
</ul>
</li>
</ul>
<p>Additional permission models are explained for a less and least permission model.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sharepoint-agent-based-less-privilege-permission-model">SharePoint Agent-Based Less Privilege Permission Model<a href="#sharepoint-agent-based-less-privilege-permission-model" class="hash-link" aria-label="Direct link to SharePoint Agent-Based Less Privilege Permission Model" title="Direct link to SharePoint Agent-Based Less Privilege Permission Model">​</a></h2>
<p>If restricted permissions are desired by the organization, then the following permissions are needed for the service account to successfully run SharePoint Agent-based scans.</p>
<p>Prior to installation of the SharePoint Agent, the service account to be supplied during installation and later used to run the Access Auditing (SPAA) and Sensitive Data Discovery Auditing scans against the targeted SharePoint environment needs the following permissions:</p>
<ul>
<li>Log on as a Service in the Local Security Policy</li>
<li>Membership in the local IIS_IUSRS group</li>
<li>Performance Log Users (for Sensitive Data Discovery only)</li>
</ul>
<p>After the SharePoint Agent installation, this service account needs the following additional permissions to run the Access Auditing (SPAA) and Sensitive Data Discovery Auditing scans:</p>
<ul>
<li>Site Collection Administrator on all Site Collections to be scanned</li>
<li>Membership in the local Users group on the server where the SharePoint Agent is installed</li>
<li>DB_Owner on Access Analyzer database if using Windows Authentication for the Storage Profile</li>
</ul>
<p>If the scans include Web Application scoping, then the following permissions are needed (can be skipped if running full farm scans):</p>
<ul>
<li>Membership in the local Backup Operators group</li>
<li>Membership in the local WSS_WPG group</li>
<li>WSS_CONTENT_APPLICATION_POOLS on the SharePoint Configuration database</li>
</ul>
<p>After the Access Analyzer SharePoint Agent is installed, ensure that the service account has the following permissions:</p>
<ul>
<li>
<p>Full Control on the agent install directory, default path is:</p>
<p><code>C:\Program Files\STEALTHbits\StealthAUDIT\SPAA</code></p>
</li>
</ul>
<p>The Access Analyzer SharePoint Agent utilizes Microsoft APIs. The Microsoft APIs require an account with the following permissions in order to collect all of the data:</p>
<ul>
<li>WSS_CONTENT_APPLICATION_POOLS on the SharePoint Content databases</li>
<li>WSS_CONTENT_APPLICATION_POOLS on the SharePoint Configuration database</li>
</ul>
<p><strong>NOTE:</strong> If scans include Web Application scoping, this last permission requirement is already met.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sharepoint-agent-based-least-privilege-permission-model">SharePoint Agent-Based Least Privilege Permission Model<a href="#sharepoint-agent-based-least-privilege-permission-model" class="hash-link" aria-label="Direct link to SharePoint Agent-Based Least Privilege Permission Model" title="Direct link to SharePoint Agent-Based Least Privilege Permission Model">​</a></h2>
<p>If a least privilege model is required by the organization, then the following permissions are needed for the service account to successfully run SharePoint Agent-based scans.</p>
<p>Prior to installation of the SharePoint Agent, the service account to be supplied during installation and later used to run the Access Auditing (SPAA) and Sensitive Data Discovery Auditing scans the targeted SharePoint environment needs the following permissions:</p>
<ul>
<li>Log on as a Service in the Local Security Policy</li>
<li>Service Account SID added to the <code>SMSvcHost.exe.config</code> file</li>
<li>Performance Log Users (for Sensitive Data Discovery only)</li>
</ul>
<p>After the SharePoint Agent installation, this service account needs the following additional permissions to run the Access Auditing (SPAA) scans:</p>
<ul>
<li>Site Collection Administrator on all Site Collections to be scanned</li>
<li>Membership in the local Users group on the server where the SharePoint Agent is installed</li>
<li>DB_Owner on Access Analyzer database if using Windows Authentication for the Storage Profile</li>
</ul>
<p>If the scans include Web Application scoping, then the following permissions are needed (can be skipped if running full farm scans):</p>
<ul>
<li>
<p>READ Access on the following registry keys:</p>
<ul>
<li>
<p><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg</code></p>
</li>
<li>
<p><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg\AllowPaths</code></p>
</li>
<li>
<p><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg\AllowExactPaths</code></p>
</li>
<li>
<p>For SharePoint 2013:</p>
<ul>
<li><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\Web Server Extensions\15.0\Secure</code></li>
<li><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\Web Server Extensions\15.0\Secure\ConfigDB</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>DB_DataReader on the SharePoint Configuration database</p>
</li>
<li>
<p><code>&#x27;GRANT EXECUTE&#x27;</code> permissions on the following stored procedures in the SharePoint Configuration database:</p>
<ul>
<li><code>proc_getObject</code></li>
<li><code>proc_getObjectsByClass</code></li>
<li><code>proc_getObjectsByBaseClass</code></li>
<li><code>proc_getDependentObjectsByBaseClass</code></li>
<li><code>proc_ReturnWebFeatures</code></li>
</ul>
</li>
</ul>
<p>After the Access Analyzer SharePoint Agent is installed, ensure that the service account has the following permissions:</p>
<ul>
<li>
<p>Full Control on the agent install directory, default path is:</p>
<p><code>C:\Program Files\STEALTHbits\StealthAUDIT\SPAA</code></p>
</li>
</ul>
<p>The Access Analyzer SharePoint Agent utilizes Microsoft APIs. The Microsoft APIs require an account with the following permissions in order to collect all of the data:</p>
<ul>
<li>
<p><code>&#x27;GRANT EXECUTE&#x27;</code> permissions on the following stored procedures in the SharePoint Configuration database:</p>
<ul>
<li>
<p><code>proc_getObject</code></p>
</li>
<li>
<p><code>proc_getObjectsByClass</code></p>
</li>
<li>
<p><code>proc_getObjectsByBaseClass</code></p>
</li>
<li>
<p><code>proc_getDependentObjectsByBaseClass</code></p>
</li>
<li>
<p><code>proc_ReturnWebFeatures</code></p>
<p><strong>NOTE:</strong> The above four stored procedures would already have the correct permissions if Web Application scoping is desired.</p>
</li>
<li>
<p><code>[dbo].proc_getSiteName</code></p>
</li>
<li>
<p><code>[dbo].proc_getSiteMap</code></p>
</li>
<li>
<p><code>[dbo].proc_getSiteMapById</code></p>
</li>
</ul>
</li>
<li>
<p>DB_DataReader on the SharePoint Content databases and SharePoint AdminContent database, if applicable</p>
</li>
<li>
<p><code>&#x27;GRANT EXECUTE&#x27;</code> permissions on the following stored procedures in the SharePoint Content databases and SharePoint AdminContent database (if applicable):</p>
<ul>
<li><code>[dbo].proc_EnumLists</code></li>
<li><code>[dbo].proc_GetTpWebMetaDataAndListMetaData</code></li>
<li><code>[dbo].proc_GetListMetaDataAndEventReceivers</code></li>
<li><code>[dbo].proc_GetSiteProps</code></li>
<li><code>[dbo].proc_GetListWebParts</code></li>
<li><code>[dbo].proc_GetWebFeatureList</code></li>
<li><code>[dbo].proc_GetListFields</code></li>
<li><code>[dbo].proc_GetDocsMetaInfo</code></li>
<li><code>[dbo].proc_GetDocIdUrl</code></li>
<li><code>[dbo].proc_ListChildWebs</code></li>
<li><code>[dbo].proc_ListChildWebs</code></li>
<li><code>[dbo].proc_ListUrls</code></li>
<li><code>[dbo].proc_ListChildWebs</code></li>
<li><code>[dbo].proc_SecListAllSiteMembers</code></li>
<li><code>[dbo].proc_SecRefreshToken</code></li>
<li><code>[dbo].proc_SecListSiteGroups</code></li>
<li><code>[dbo].proc_SecListSiteGroupMembership</code></li>
<li><code>[dbo].proc_SecGetRoleDefs</code></li>
<li><code>[dbo].proc_SecListSiteGroups</code></li>
<li><code>[dbo].proc_SecListScopeUsers</code></li>
<li><code>[dbo].proc_SecListScopeGroups</code></li>
<li><code>[dbo].proc_SecAddWebMembership</code></li>
<li><code>[dbo].proc_SecGetSecurityInfo</code></li>
<li><code>[dbo].proc_SecGetPrincipalByLogin</code></li>
<li><code>[dbo].proc_SecGetPrincipalDisplayInformation20</code></li>
<li><code>[dbo].proc_SecGetRoleBindingsForAllPrincipals</code></li>
</ul>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/agentpermissions.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/agentlessports"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SharePoint Agent-Less Ports</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/accessanalyzer/enterpriseauditor/requirements/solutions/sharepoint/agentports"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SharePoint Agent Ports</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#permissions-explained" class="table-of-contents__link toc-highlight">Permissions Explained</a></li><li><a href="#sharepoint-agent-based-less-privilege-permission-model" class="table-of-contents__link toc-highlight">SharePoint Agent-Based Less Privilege Permission Model</a></li><li><a href="#sharepoint-agent-based-least-privilege-permission-model" class="table-of-contents__link toc-highlight">SharePoint Agent-Based Least Privilege Permission Model</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>