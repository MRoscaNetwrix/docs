<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-policypak docs-version-current docs-doc-page docs-doc-id-policypak/video/mdm/itemleveltargeting/entraid" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Determine the Azure AAD Group Membership for User or Computers | Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.yourcompany.com/img/Logo_RGB.svg"><meta data-rh="true" name="twitter:image" content="https://docs.yourcompany.com/img/Logo_RGB.svg"><meta data-rh="true" property="og:url" content="https://docs.yourcompany.com/docs/policypak/policypak/video/mdm/itemleveltargeting/entraid"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-policypak-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-policypak-current"><meta data-rh="true" property="og:title" content="Determine the Azure AAD Group Membership for User or Computers | Documentation"><meta data-rh="true" name="description" content="If you want to know which GROUPS your Users or Computers are in within Azure AD, then use Netwrix Endpoint Policy Manager (formerly PolicyPak) and these scripts. Then after that, you can use Item Level Targeting to check group membership and trigger actions and policies."><meta data-rh="true" property="og:description" content="If you want to know which GROUPS your Users or Computers are in within Azure AD, then use Netwrix Endpoint Policy Manager (formerly PolicyPak) and these scripts. Then after that, you can use Item Level Targeting to check group membership and trigger actions and policies."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.yourcompany.com/docs/policypak/policypak/video/mdm/itemleveltargeting/entraid"><link data-rh="true" rel="alternate" href="https://docs.yourcompany.com/docs/policypak/policypak/video/mdm/itemleveltargeting/entraid" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.yourcompany.com/docs/policypak/policypak/video/mdm/itemleveltargeting/entraid" hreflang="x-default"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"><link rel="stylesheet" href="/assets/css/styles.4cbdd69d.css">
<script src="/assets/js/runtime~main.a42836f1.js" defer="defer"></script>
<script src="/assets/js/main.3131faef.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/branding/logo.svg" alt="Netwrix Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/branding/logo.svg" alt="Netwrix Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Products</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/1secure">1Secure</a></li><li><a class="dropdown__link" href="/docs/accessanalyzer">Access Analyzer</a></li><li><a class="dropdown__link" href="/docs/accessinformationcenter">Access Information Center</a></li><li><a class="dropdown__link" href="/docs/activitymonitor">Activity Monitor</a></li><li><a class="dropdown__link" href="/docs/auditor">Auditor</a></li><li><a class="dropdown__link" href="/docs/changetracker">Change Tracker</a></li><li><a class="dropdown__link" href="/docs/dataclassification">Data Classification</a></li><li><a class="dropdown__link" href="/docs/groupid">Group ID</a></li><li><a class="dropdown__link" href="/docs/passwordpolicyenforcer">Password Policy Enforcer</a></li><li><a class="dropdown__link" href="/docs/passwordreset">Password Reset</a></li><li><a class="dropdown__link" href="/docs/passwordsecure">Password Secure</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/policypak">PolicyPak</a></li><li><a class="dropdown__link" href="/docs/privilegesecure">Privilege Secure</a></li><li><a class="dropdown__link" href="/docs/recoveryforactivedirectory">Recovery for Active Directory</a></li><li><a class="dropdown__link" href="/docs/strongpointfornetsuite">StrongPoint for NetSuite</a></li><li><a class="dropdown__link" href="/docs/strongpointforsalesforce">StrongPoint for Salesforce</a></li><li><a class="dropdown__link" href="/docs/strongpointnetsuiteflashlight">StrongPoint NetSuite Flashlight</a></li><li><a class="dropdown__link" href="/docs/strongpointsalesforceflashlight">StrongPoint Salesforce Flashlight</a></li><li><a class="dropdown__link" href="/docs/threatmanager">Threat Manager</a></li><li><a class="dropdown__link" href="/docs/threatprevention">Threat Prevention</a></li><li><a class="dropdown__link" href="/docs/usercube">UserCube</a></li><li><a class="dropdown__link" href="/docs/usercube_saas">UserCube SaaS</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="http://github.com/netwrix" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/policypak/">Policypak</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/policypak/policypak/adminstrativetemplates/comments">policypak</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/adminstrativetemplates/comments">adminstrativetemplates</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/applicationsettings/appsetfiles/findfixgpos">applicationsettings</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/archive/acrobatxpro">archive</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/basicconcepts">Introduction and Basic Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/browserrouter/advancedblockingmessage">browserrouter</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/cloud/add/administrator">cloud</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/device/devicemanager/devicemanagerpolicies">device</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/editions/overview">editions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/feature/addremove/collections">feature</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/fileassociations/applymode">fileassociations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/gettingstarted/fastest">gettingstarted</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/gettingstarted">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/gpoexport/delivercertificates">gpoexport</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/grouppolicy/insertuserinfo">grouppolicy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/grouppolicycompliancereporter/concepts">grouppolicycompliancereporter</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/install/adminconsole">install</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/integration/applocker">integration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/itemleveltargeting/applypreferences">itemleveltargeting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/javaenterpriserules/evaluateurls">javaenterpriserules</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/knowledgebase">Netwrix Endpoint Policy Manager (formerly PolicyPak) Knowledge Base Articles</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/leastprivilege/accountelevatedprocess">leastprivilege</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/license/activedirectory/disabledcomputer">license</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/licensing">Licensing</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/mac/applicationlaunch">mac</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/manuals">Netwrix Endpoint Policy Manager (formerly PolicyPak) User Manuals</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/mdm/gettingstarted">mdm</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/overview">Netwrix Endpoint Policy Manager (formerly PolicyPak) Documentation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/preferences/componentlicense">preferences</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/remotedesktopprotocol/importrdpfile">remotedesktopprotocol</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/remoteworkdelivery/advanced/standard/multiplefiles">remoteworkdelivery</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/requirements/cloud">requirements</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/scriptstriggers/advantages">scriptstriggers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/securitysettings/exportwizard">securitysettings</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/softwarepackage/appx/addremovepackages">softwarepackage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/startscreentaskbar/addlink">startscreentaskbar</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/tips/emailoptout">tips</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/troubleshooting/administrativetemplates/missingcollections">troubleshooting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/policypak/policypak/video/administrativetemplates/collections">video</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/administrativetemplates/collections">administrativetemplates</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/applicationsettings/acllockdown">applicationsettings</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/browserrouter/blockwebsites">browserrouter</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/cameyo/applicationsettings">cameyo</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/changemanagementutilities/advancedgrouppolicymanagement">changemanagementutilities</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/cloud/add/administrator">cloud</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/device/bitlockerdrives">device</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/feature/cloud">feature</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/fileassociations/acroreader">fileassociations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/fslogix/appmasking">fslogix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/gettingstarted/admx">gettingstarted</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/gpocompilancereporter/existinggpos">gpocompilancereporter</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/gpoexport/cloudimport">gpoexport</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/grouppolicy/explained">grouppolicy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/install/autoupdate">install</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/integration/auditordemo">integration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/javaenterpriserules/block">javaenterpriserules</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/leastprivilege/acltraverse/deleteicons">leastprivilege</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/license/cleanup">license</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/policypak/policypak/video/mdm/admintemplates">mdm</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/video/mdm/admintemplates">Deliver Group Policy Admin Templates Using Your MDM Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/video/mdm/citrixendpointmanager">Endpoint Policy Managerand Citrix Endpoint Manager: Deploy real Group Policy and Endpoint Policy Manager settings via CEM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/video/mdm/exporterutility">Deploying Endpoint Policy Managerdirectives without Group Policy (Endpoint Policy Manager Exporter Utility)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/video/mdm/exportgpos">Reduce GPOs (and/or export them for use with Endpoint Policy Manager Cloud or with MDM)</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/policypak/policypak/video/mdm/itemleveltargeting/entraid">itemleveltargeting</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/policypak/policypak/video/mdm/itemleveltargeting/entraid">Determine the Azure AAD Group Membership for User or Computers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/video/mdm/itemleveltargeting/entraidgroupdetermine">Use PP MDM to determine the Azure AAD Group Membership for User or Computers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/video/mdm/itemleveltargeting/entraidgroupmembership">Use Endpoint Policy Manager cloud + Azure AAD Group Membership for User or Computers</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/video/mdm/microsoftintune">Endpoint Policy Manager and Microsoft Intune</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/video/mdm/mobileiron">Endpoint Policy Manager and MobileIron MDM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/video/mdm/realgrouppolicy">Deploying Real Group Policy (and Extra Endpoint Policy Manager Settings) Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/video/mdm/testsample">Endpoint Policy Manager and MDM walk before you run</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/policypak/policypak/video/mdm/workspaceone">Endpoint Policy Managerand Workspace One (Airwatch) MDM: Deploy Group Policy and Endpoint Policy Manager superpowers today</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/methods/exporterutility">methods</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/networksecurity/applicationsports">networksecurity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/preferences/cloudlocaluser">preferences</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/remotedesktopprotocol/cloud">remotedesktopprotocol</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/remoteworkdelivery/azureblobstorage">remoteworkdelivery</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/scriptstriggers/bitlocker">scriptstriggers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/softwarepackage/appxmanager">softwarepackage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/startscreentaskbar/customicons">startscreentaskbar</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/troubleshooting/admxfiles">troubleshooting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/policypak/policypak/video/windowsvirtualdesktops/admintemplatemanager">windowsvirtualdesktops</a></div></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">policypak</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">video</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">mdm</span><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">itemleveltargeting</span><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Determine the Azure AAD Group Membership for User or Computers</span><meta itemprop="position" content="5"></li></ul></nav><div class="theme-doc-markdown markdown"><header><h1>Determine the Azure AAD Group Membership for User or Computers</h1></header>
<p>If you want to know which GROUPS your Users or Computers are in within Azure AD, then use Netwrix Endpoint Policy Manager (formerly PolicyPak) and these scripts. Then after that, you can use Item Level Targeting to check group membership and trigger actions and policies.</p>
<p>Hi. This is Jeremy Moskowitz. In this video, I&#x27;m going to show you how to use a couple of scripts in order to figure out which Azure AD groups the user or computer is a member of.<br>
<!-- -->Now I&#x27;m going to stress a couple of things right at the front of this video. These scripts are completely unsupported. If you have trouble with them, I&#x27;m sorry. If they work, that&#x27;s great. That&#x27;s the first thing. The second thing is there are a bunch of little moving parts here, and I&#x27;ll go over those.</p>
<p>There&#x27;s also a second video for using this in Endpoint Policy Manager Cloud, but don&#x27;t do that one unless you&#x27;ve actually watched this video first because a lot of the pregame setup is in here.<br>
<!-- -->This is what you&#x27;ll see in the download. You&#x27;ll see that there are four things. One is a thing that will encrypt a password (&quot;EncryptPassword2&quot;). Second is a think that will get the user side (&quot;AzureADInformationUser&quot;). Third is a thing that will get the computer side (&quot;AzureADInformationComputer&quot;). And fourth is a thing that is sort of a prerequired item (&quot;InstallAzureADModule&quot;).<br>
<!-- -->Before all this happens, the very first thing you need to do is to go to Azure AD and to create what is really called a read-only user. You just go ahead and click on &quot;New user&quot; in Azure. Then you give them a &quot;Name,&quot; give them a password. Now you have to log on as that guy one time to then change the password to something complicated. You can&#x27;t just set it up and use the default password that Azure gives you. You actually have to log on one time first.</p>
<p>Now I&#x27;ve already done all this. I called my guy &quot;Lookup.&quot; So my guy is called &quot;<a href="mailto:lookup@fabrikam1000.com" target="_blank" rel="noopener noreferrer">lookup@fabrikam1000.com</a>.&quot; He doesn&#x27;t have Office. He doesn&#x27;t have anything else. He&#x27;s just a guy called &quot;Lookup,&quot; and this is required.</p>
<p>Now if you take a look at the &quot;AAD Scripts,&quot; you&#x27;ll see that inside the scripts we give you if we take a look at the user side there is the &quot;usernameinformation&quot; and what&#x27;s called the &quot;encryptedcredentials.&quot; The user information, you&#x27;re going to have to jam that in and make it &quot;<a href="mailto:lookup@fabrikam1000.com" target="_blank" rel="noopener noreferrer">lookup@fabrikam1000.com</a>&quot; or whatever yours is.</p>
<p>Then how do you get the encrypted password? That is what &quot;EncryptPassword2&quot; is all about. Let me go ahead and show you what this looks like in PowerShell land. Let me go over here then &quot;powershell.&quot; Okay, so the idea is that once this guy has a password, you&#x27;re going to know what that password is. Let&#x27;s take a look at our scripts.</p>
<p>The one we want is the &quot;EncryptPassword2.&quot; Let me just do a quick &quot;get-help&quot; on this guy to remember how it works. So all you need to do is to do the &quot;EncryptedPassword2&quot; script, and then give it &quot;-passwordinformation&quot; and then the password whatever that is (&quot;p@ssw0rd&quot;).</p>
<p>When you do this, an encrypted string pops out. If you want to write it to a file, you can just pipe it to &quot;out-file passwordenc1.txt&quot; or something like that. Okay, so now it&#x27;s hanging out in a file-based form. Here we go. Here&#x27;s the password encrypted. We&#x27;ll take this guy, and we&#x27;re going to shove it right between the little dashes here and you&#x27;ll save it out. You&#x27;ll do exactly the same thing on the computer side. I&#x27;ve already done this to make this go a little faster.</p>
<p>Now remember, these scripts are unsupported and they are technically not secure. Why are they not secure? Well, let&#x27;s take a look at the first one. Because you can see, here&#x27;s the login information for this guy, here&#x27;s the password, and then here&#x27;s the key to decrypt it. If you knew what you were doing, if you were a smart and savvy person as a user, you could in fact find the script hanging out in Endpoint Policy Manager and Group Policy land, read the key, do some magic, and pull back out the Lookup password.<br>
<!-- -->Again, not a lot that can go wrong here, but I don&#x27;t want you to think that this has actually got a firewall level of security on it. Again, this script is use at your own risk, and you should know by using it that it is not technically secure.</p>
<p>Okay, so you&#x27;ve jammed in your user &quot;UPN&quot; name, <a href="mailto:lookup@yourwhatever.com" target="_blank" rel="noopener noreferrer">lookup@yourwhatever.com</a>, and you&#x27;re encrypted password in both of those guys. The next thing you&#x27;re going to do is you&#x27;re going to use PP SCRIPTS. Now I&#x27;ve already got this set up to make this go a little faster. I have a GPO called &quot;AAD Group Enumerate Script via PP.&quot;</p>
<p>Now, again, if you only care about Endpoint Policy Manager Cloud, you can maybe pause the video at this point and jump to the next video, but you probably want to watch it all the way through.<br>
<!-- -->In this first example I&#x27;m going to use a machine that is both domain joined and Azure joined which is called &quot;DJ++.&quot; So he has a foot in both camps. Let&#x27;s take a look at what I&#x27;m doing on the computer side first. If I go to computer side, &quot;Endpoint Policy Manager,&quot; &quot;Scripts Manager,&quot; what you do here is &quot;Add&quot; a &quot;New Policy&quot; here. Even though it&#x27;s already done, I&#x27;m just going to walk through.<br>
<!-- -->You&#x27;re going to &quot;Appy this policy to computer.&quot; Then you&#x27;re going to  paste in &quot;PowerShell script.&quot; The one that you want to paste in first in order is the &quot;InstallAzureADModule&quot; script. You&#x27;re going to take this guy, jam it in here and paste it in, Next/Next/Next, and you&#x27;re done.</p>
<p>I&#x27;ve already done that. It&#x27;s hanging out right here: &quot;Install AAD module.&quot; I&#x27;ve already done that stuff. It&#x27;s hanging out right here. You&#x27;re going to do that exact same thing right here with the computer script, so you&#x27;re going to get the computer side as well. You&#x27;re going to do the exact same thing. You&#x27;re just going to jam that right in there. You&#x27;re going to make that an &quot;Apply action.&quot; You can see there are my credentials and so on. There&#x27;s no &quot;Revert action&quot; required. Again, you&#x27;re just going to &quot;Apply this policy to computer.&quot;</p>
<p>In this same GPO, provided this Group Policy Object will hit both the computer and the user—this is linked to my Sales team so it has that ability—but if you need to do another Group Policy Object, that&#x27;s fine. What we&#x27;re going to do is on the user side in &quot;Endpoint Policy Manager&quot; &quot;Scripts Manager&quot; this is where you&#x27;re going to jam in the user side script.<br>
<!-- -->Remember, I&#x27;ve already done this and it&#x27;s ready to rock. I&#x27;ve already got this ready to go here. You&#x27;re going to make &quot;Run script as user&quot; goes here, not &quot;Run interactively.&quot; You&#x27;re just going to copy and paste the whole script in just like that.</p>
<p>When this is all over, here is what happens. If I go over to this machine here, I&#x27;ve already done it. I&#x27;ve already logged on. Let me show you the result of what has happened here. Now first things first is that it may not happen the very first time you reboot the computer or the first time the guy logs on. Sometimes this takes two shots to work.<br>
<!-- -->When this is over, if you type &quot;set&quot; at a &quot;Command Prompt,&quot; what you&#x27;re looking at is the environment variables. You can see here &quot;AzureADComputerGroups&quot; are this group and that group. And &quot;AzureADUserGroups&quot; are this group, that group, and this other group. So you can see here that you can query the environment variable to figure out if somebody is a member of a group or not now. You couldn&#x27;t do that before, and now you can.</p>
<p>The last part of this is, how do you use this in item-level targeting? How do you take a Group Policy Preferences or an Admin Templates item or a Endpoint Policy Manager item, how do you take these things and make sure it only hits when somebody is in a particular group? I&#x27;m going to show you that right now.</p>
<p>Actually, let me go back to the material that you&#x27;ll be downloading. Maybe what I&#x27;ll also do here is I will create a new file. So by the time you see this video, there will be a file here called &quot;WMI FILTER EXAMPLE.&quot; I&#x27;ll go ahead and paste this in. The idea here is that you&#x27;re going to use this in a minute inside of Group Policy Preferences land. I&#x27;ll actually create this one and create that one: &quot;AzureADUserGroups&quot; and &quot;AzureADComputerGroups.&quot; I&#x27;ll explain how this works in two seconds.</p>
<p>So the idea here is that you&#x27;re going to then be reading that string and you&#x27;re going to say if the guy as a &quot;User&quot; is in a group called &quot;Support,&quot; that means we have a hit. And if the &quot;Computer&quot; is in a group called &quot;Laptops,&quot; then you&#x27;ve got a hit. So this is on the &quot;Computer side&quot; and this is on the &quot;User side.&quot;</p>
<p>Now let me show you how you would use this thing. I&#x27;m going to go ahead and &quot;Copy&quot; this string. I already have a Group Policy Preferences item that ready to go here. I want to create a Group Policy Preferences shortcut item when I know the guy is on the Sales team. Let&#x27;s figure out how to do that.</p>
<p>If I go to &quot;Preferences&quot; here and I go to &quot;Windows Settings&quot; &quot;Shortcuts&quot; here, I always like to use shortcuts because it&#x27;s very easy to do. If I go to &quot;Shortcuts&quot; here, all I&#x27;m doing is creating a URL called &quot;<a href="http://www.helloworld.com" target="_blank" rel="noopener noreferrer">www.helloworld.com</a>&quot;<!-- --> on the &quot;Desktop&quot; when I know the guy is on the Sales team.</p>
<p>I&#x27;ve got &quot;Item-level targeting,&quot; and you can click on &quot;Targeting&quot; here. There&#x27;s a special query. I&#x27;ll go ahead and delete that just to get started. There&#x27;s a special query. There&#x27;s no way to look at the environment variable. You can see there is a thing called &quot;Environment Variable&quot; here, but there&#x27;s no way to pull out information from that environment variable. It&#x27;s sort of a bummer. I&#x27;d love to use that, but I can&#x27;t.</p>
<p>So instead, you&#x27;re going to use this other guy called &quot;WMI Query.&quot; The thing is you&#x27;re going to actually nuke this &quot;Namespace item.&quot; I don&#x27;t know why. You just do. Nuke that first. Then take what I have in the text file and jam that into  &quot;Query.&quot; Let&#x27;s look at it again: &quot;select * from win32_environment where Name=&#x27;AzureADUserGroups&#x27;&quot;—that&#x27;s the name of the environment variable that&#x27;s now on the machine—has the thing I&#x27;m looking for.</p>
<p>Let&#x27;s go back to the machine. Let&#x27;s see. How about &quot;EastSalesUsers&quot;? Let&#x27;s see if he&#x27;s a member of &quot;EastSalesUsers.&quot; Okay, great. So we&#x27;ll go back over here and type that in. So not &quot;LIKE %Support%&quot; but let&#x27;s look for &quot;EastSalesUsers.&quot; Okay, so this shortcut for a user is now only going to fire off when the guy is a member of the &quot;EastSalesUsers&quot; user group in Azure AD.</p>
<p>Now that we&#x27;ve done that, let&#x27;s go ahead and run GP Update (&quot;gpupdate&quot;). Remember, this computer is domain joined and Azure AD joined. Because of that, it&#x27;s getting the Group Policy Object but reading the evaluation that has occurred from Azure AD. If all goes well, this shortcut wouldn&#x27;t normally be there but because we&#x27;re querying for that value, there&#x27;s our &quot;<a href="http://www.helloworld.com" target="_blank" rel="noopener noreferrer">www.helloworld.com</a>&quot;<!-- --> shortcut just like what we expect.</p>
<p>You can also see this happen in reverse as well, which is to say if you change this over and the condition no longer applies, like maybe that user isn&#x27;t in Azure AD anymore. For instance, if I take a look at &quot;Azure Active Directory&quot; and take a look at &quot;Groups&quot; to take a look at my group membership, I can look at &quot;EastSalesUsers&quot; real quick.</p>
<p>I can see that there are &quot;9 Users&quot; in there. I can take a look at the &quot;Members&quot; and there&#x27;s &quot;EastSalesUser1.&quot; That guy is a member. So the point of the story is maybe this guy is not a member anymore. This will evaluate to false, and then that shortcut can go away if that&#x27;s something you wanted to do.</p>
<p>Now just to put a fine point on it, this whole idea of the &quot;Item-level targeting&quot; can be used not just in &quot;Preferences,&quot; of course, but anywhere in Endpoint Policy Manager land. So if you wanted to say kill the Control Panel when the guy has whatever, you can just use &quot;Administrative Templates Manager&quot; or you could do something nifty with &quot;Browser Router&quot; or &quot;Least Privilege Manager.&quot; It&#x27;s all the same thing.</p>
<p>You just &quot;Add&quot; a &quot;New Policy&quot; here, all the same stuff. Maybe I want to do something like &quot;Prohibit access to Control Panel and PC settings.&quot; That&#x27;s the guy right there. Then I want to only do this when an Azure AD group thing is true. How would I do that? &quot;New Item,&quot; &quot;WMI Query,&quot; nuke the &quot;Namespace,&quot; paste the example I gave you into &quot;Query.&quot;</p>
<p>And if you want to say he&#x27;s in &quot;EastSalesUsers.&quot; Again, you&#x27;re going to check that first and make sure he&#x27;s really a member of that thing here in &quot;AzureADUserGroups.&quot; &quot;EastSalesUsers,&quot; yes, sure enough. So if you wanted to do this thing, &quot;Prohibit access to Control Panel and PC Settings&quot; only when that Azure AD group has got the thing, you can see we light up as orange and you&#x27;re ready to go. That&#x27;s all there is to it.</p>
<p>Okay, so that ends this first video. If you want to do this in Endpoint Policy Manager Cloud, you can move on to the next video and you&#x27;re off to the races. Again, this is all unsupported, and we know that it inherently is not a secure mechanism. But it does get you to the goal to enumerate what groups a user or a computer has in Azure Active Directory and then take an action upon them if that&#x27;s what you want to do.</p>
<p>Hope this helps you out. Thank you very much and talk to you soon.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/policypak/policypak/video/mdm/itemleveltargeting/entraid.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/policypak/policypak/video/mdm/exportgpos"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Reduce GPOs (and/or export them for use with Endpoint Policy Manager Cloud or with MDM)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/policypak/policypak/video/mdm/itemleveltargeting/entraidgroupdetermine"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Use PP MDM to determine the Azure AAD Group Membership for User or Computers</div></a></nav></div></div></div></div></main></div></div></div></div>
</body>
</html>