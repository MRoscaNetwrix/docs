# Stored Procedures

The table contains a list of the stored procedures Threat Prevention uses on its SQL Server databases. See the [Database Maintenance Window](/versioned_docs/threatprevention_7.4/threatprevention/admin/configuration/databasemaintenance/overview.md) topic for additional information.

| Name | When Threat Prevention Uses the Procedure | What the Stored Procedure Does |
| --- | --- | --- |
| DeleteAuthAnalytics | Called from the SQLAgent job if the “Delete” operation is selected for database maintenance for Authentication Analytics. | This stored procedure deletes “old” data from the database in the following tables:   - A\_Login - A\_Login2Policy - AR\_BruteForceAttacks - AR\_UserAccountHackingAttacks - AR\_HorizontalMovementAttacks - AR\_BadUserIdByUser - AR\_BadUserIdByHost - AR\_BreachedPassword - AR\_ConcurrentLogins - AR\_DiamondPAC - AR\_EventTracker - AR\_ImpersonationLogins - AR\_GoldenTickets - AR\_KerberosWeakEncryption |
| DeleteByPolicy | Called from the SQLAgent job if the “Delete” operation is selected for database maintenance for selected policies. | This stored procedure deletes “old” data from the database in the following tables:   - NvEvent - NvEvent\_EventTracker - AttributeValue - OldAttributeValue - EventPolicy - E\_LDAP - E\_LDAP\_EventTracker - E\_LDAP2Policy |
| DeleteFSAnalytics | Called from the SQLAgent job if the “Delete” operation is selected for database maintenance File System Analytics. | This stored procedure deletes “old” data from the database in the following tables:   - A\_FS - A\_FS2Policy - AR\_FilesPerUser - AR\_EventTracker |
| Delete LDAP | Called from the SQL Agent job if the “Delete” operation is selected for database maintenance for the LDAP Event Type. | This stored procedure deletes “old” data from the database in the following tables:   - E\_LDAP - E\_LDAP\_EventTracker - E\_LDAP2Policy |
| DeleteNvEventByEventType | Called from the SQL Agent job if the “Delete” operation is selected for database maintenance for all Event Types except LDAP. | This stored procedure deletes “old” data from the database in the following tables:   - NvEvent - NvEvent\_EventTracker - AttributeValue - OldAttributeValue - EventPolicy |
| MoveAuthAnalytics | Called from the SQLAgent job if the “Move” operation is selected for database maintenance for Authentication Analytics. | This stored procedure moves “old” data from one database to another in the following tables:   - A\_Login - A\_Login2Policy - AR\_BruteForceAttacks - AR\_UserAccountHackingAttacks - AR\_HorizontalMovementAttacks - AR\_BadUserIdByUser - AR\_BadUserIdByHost - AR\_BreachedPassword - AR\_ConcurrentLogins - AR\_DiamondPAC - AR\_EventTracker - AR\_ImpersonationLogins - AR\_GoldenTickets - AR\_KerberosWeakEncryption |
| MoveByPolicy | Called from the SQLAgent job if the “Move” operation is selected for database maintenance for selected policies. | This stored procedure moves “old” database from one database to another in the following tables:   - NvEvent - NvEvent\_EventTracker - AttributeValue - OldAttributeValue - EventPolicy - E\_LDAP - E\_LDAP\_EventTracker - E\_LDAP2Policy |
| MoveFSAnalytics | Called from the SQLAgent job if the “Move” operation is selected for database maintenance for File System Analytics. | This stored procedure moves “old” data from one database into another in the following tables:   - A\_FS - A\_FS2Policy - AR\_FilesPerUser - AR\_EventTracker |
| Move LDAP | Called from the SQLAgent job if the “Move” operation is selected for database maintenance for LDAP Event Type. | This stored procedure moves “old” data from one database into another in the following tables:   - E\_LDAP - E\_LDAP\_EventTracker - E\_LDAP2Policy |
| MoveNvEventsByEventType | Called from the SQLAgent job if the “Move” operation is selected for database maintenance for all Event Types except LDAP. | This stored procedure moves “old” data from one database to another in the following tables:   - NvEvent - NvEvent\_EventTracker - AttributeValue - OldAttributeValue - EventPolicy |
| RdbPolicyCopy | Called from the SQLAgent job if the “Move” operation is selected for database maintenance. | This stored procedure creates a copy of the RdbPolicy table in the target database. |
