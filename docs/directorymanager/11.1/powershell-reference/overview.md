# Contact Commands

Directory Manager provides the following cmdlets to perform contact-related tasks, such as:

- [Get-Contact](/docs/directorymanager/11.1/powershell-reference/getcontact.md) – Retrieves a contact that matches the given criteria.
- [New-Contact](/docs/directorymanager/11.1/powershell-reference/newcontact.md) – Creates a new contact.
- [Remove-Contact](/docs/directorymanager/11.1/powershell-reference/removecontact.md) – Removes a contact from the directory.
- [Set-Contact](/docs/directorymanager/11.1/powershell-reference/setcontact.md) – Modifies a contact in the directory.

# Dynasty Commands

This section covers the following cmdlets for managing Dynasties.

- [New-Dynasty](/docs/directorymanager/11.1/powershell-reference/newdynasty.md) – Creates a new Dynasty.
- [Set-Dynasty](/docs/directorymanager/11.1/powershell-reference/setdynasty.md) – Modifies a Dynasty or its children.

# General Commands

You can use the following Management Shell cmdlets to perform tasks such as:

- [Get-Computer](/docs/directorymanager/11.1/powershell-reference/getcomputer.md) – Provides information about a computer object.
- [Get-ConnectedStoreInformation](/docs/directorymanager/11.1/powershell-reference/getconnectedstoreinformation.md) – Provides information about the
  connected identity store.
- [Get-ConnectedUser](/docs/directorymanager/11.1/powershell-reference/getconnecteduser.md) – Provides information about the connected user.
- [Get-GroupIdInformation](/docs/directorymanager/11.1/powershell-reference/getdirectorymanagerinformation.md) – Provides information about GroupID.
- [Get-ImanamiCommand](/docs/directorymanager/11.1/powershell-reference/getimanamicommand.md) – Provides basic information about GroupID Management
  Shell cmdlets.
- [Get-ReplicationStatus](/docs/directorymanager/11.1/powershell-reference/getreplicationstatus.md) – Provides the replication status of objects in
  an identity store.
- [Get-TombStoneObject](/docs/directorymanager/11.1/powershell-reference/gettombstoneobject.md) – Displays information about tombstone objects.
- [Invoke-Replication](/docs/directorymanager/11.1/powershell-reference/invokereplication.md) – Starts the replication process for all the identity
  stores or for a specific identity store.
- [New-Container](/docs/directorymanager/11.1/powershell-reference/newcontainer.md) – Creates a new organizational unit.
- [Remove-Container](/docs/directorymanager/11.1/powershell-reference/removecontainer.md) – Removes an empty organizational unit.
- [Restore-TombStoneObject](/docs/directorymanager/11.1/powershell-reference/restoretombstoneobject.md) – Restores tombstone objects from the
  directory.
- [Send-Notification](/docs/directorymanager/11.1/powershell-reference/sendnotification.md) – Sends notifications to a group or a user.

# Identity Store Commands

This section covers cmdlets for performing identity store-related tasks such as:

- [Clear-MessagingServer](/docs/directorymanager/11.1/powershell-reference/clearmessagingserver.md) – Removes a configured messaging server.
- [Clear-Notifications](/docs/directorymanager/11.1/powershell-reference/clearnotifications.md) – Removes notification settings of an identity store.
- [Clear-SmtpServer](/docs/directorymanager/11.1/powershell-reference/clearsmtpserver.md) – Removes a configured SMTP server of an identity store.
- [Get-AvailableMessagingServers](/docs/directorymanager/11.1/powershell-reference/getavailablemessagingservers.md) – Retrieves messaging servers for
  the configured messaging provider.
- [Get-Client](/docs/directorymanager/11.1/powershell-reference/getclient.md) – Lists information about the Directory Manager clients.
- [Get-IdentityStore](/docs/directorymanager/11.1/powershell-reference/getidentitystore.md) – Retrieves information about an identity store.
- [Get-IdentityStoreRoles](/docs/directorymanager/11.1/powershell-reference/getidentitystoreroles.md) – Retrieves information about the security
  roles in an identity store
- [Get-LogSettings](/docs/directorymanager/11.1/powershell-reference/getlogsettings.md) – Provides information about the global log settings of an
  identity store.
- [Get-RolePermissionNames](/docs/directorymanager/11.1/powershell-reference/getrolepermissionnames.md) – Lists the permissions assigned to the
  logged-in user.
- [Get-SchemaAttributes](/docs/directorymanager/11.1/powershell-reference/getschemaattributes.md) – Lists schema attributes available for an identity
  store.
- [Get-SmsGateways](/docs/directorymanager/11.1/powershell-reference/getsmsgateways.md) – Provides information of the configured SMS gateways.
- [Get-UserRole](/docs/directorymanager/11.1/powershell-reference/getuserrole.md) – Displays role information of a user in an identity store.
- [New-IdentityStore](/docs/directorymanager/11.1/powershell-reference/newidentitystore.md) – Creates a new identity store.
- [Remove-IdentityStore](/docs/directorymanager/11.1/powershell-reference/removeidentitystore.md) – Removes an identity store from Directory Manager.
- [Send-TestNotification](/docs/directorymanager/11.1/powershell-reference/sendtestnotification.md) – Sends a test notification.
- [Set-IdentityStore](/docs/directorymanager/11.1/powershell-reference/setidentitystore.md) – Modifies an identity store configuration.
- [Set-IdentityStoreRole](/docs/directorymanager/11.1/powershell-reference/setidentitystorerole.md) – Modifies properties of a security role in an
  identity store.
- [Set-MessagingServer](/docs/directorymanager/11.1/powershell-reference/setmessagingserver.md) – Configures a messaging server in an identity store.
- [Set-Notifications](/docs/directorymanager/11.1/powershell-reference/setnotifications.md) – Modifies notification settings of an identity store.
- [Set-SmtpServer](/docs/directorymanager/11.1/powershell-reference/setsmtpserver.md) – Configures an SMTP server of an identity store.

See Also

- [Directory Manager Management Shell](/docs/directorymanager/11.1/powershell-reference/overview.md)
- [All Commands](/docs/directorymanager/11.1/powershell-reference/commands.md)
- [Parameters](/docs/directorymanager/11.1/powershell-reference/parameters.md)

# Identity Store Connection Commands

This section covers cmdlets for establishing a connection with an identity store.

- [Connect-IdentityStore](/docs/directorymanager/11.1/powershell-reference/connectidentitystore.md) – Connects to an identity store using the
  authentication mode mentioned.
- [Get-Token](/docs/directorymanager/11.1/powershell-reference/gettoken.md) – Gets a token from the Directory Manager Security service.

# Mailbox Commands

This section covers cmdlets for performing mailbox-specific tasks such as:

- [Get-Mailbox](/docs/directorymanager/11.1/powershell-reference/getmailbox.md) – Retrieves a mailbox.
- [New-Mailbox](/docs/directorymanager/11.1/powershell-reference/newmailbox.md) – Creates a new mailbox.
- [Remove-Mailbox](/docs/directorymanager/11.1/powershell-reference/removemailbox.md) – Deletes a mailbox.
- [Set-Mailbox](/docs/directorymanager/11.1/powershell-reference/setmailbox.md) – Modifies a mailbox.

# Mail-Enable/Disable Groups Commands

This section covers cmdlets for enabling and disabling groups for email.

- [Disable-DistributionGroup](/docs/directorymanager/11.1/powershell-reference/disabledistributiongroup.md) – disables a group's email capability.
- [Enable-DistributionGroup](/docs/directorymanager/11.1/powershell-reference/enabledistributiongroup.md) – enable a group's email capability.

# Membership Commands

This section covers cmdlets for managing the memberships of both managed and unmanaged groups.

- [Add-GroupMember](/docs/directorymanager/11.1/powershell-reference/addgroupmember.md) – adds objects to the membership of a group.
- [Get-GroupMember](/docs/directorymanager/11.1/powershell-reference/getgroupmember.md) – retrieves members of a group.
- [Get-Object](/docs/directorymanager/11.1/powershell-reference/getobject.md) – retrieves objects.
- [Remove-GroupMember](/docs/directorymanager/11.1/powershell-reference/removegroupmember.md) – removes recipients from a group's membership.
- [Set-Object](/docs/directorymanager/11.1/powershell-reference/setobject.md) – modifies an object.

# Directory Manager Management Shell

Directory Manager Management Shell is a command-line interface for managing objects like users,
contacts, mailboxes, groups, smart groups, dynasties and for performing other administrative tasks
in an Active Directory and Microsoft Entra ID based identity stores.

Built with PowerShell Core technology, Directory Manager Management Shell provides a platform to
perform many of the tasks you can perform with Directory Manager as well as tasks that the console
does not support.

This documentation is a reference for the Directory Manager PowerShell commands. It provides detail
on their function, syntax, parameters, and gives ready-to-use examples that you can modify and test
in your own environment.

The documentation is intended for advanced users familiar with the use of the Windows Command prompt
and PowerShell Core.

## Identity Store-based Model

Directory Manager 11.1 has extensible identity store based model. It supports the following data
stores for creating an identity store:

- Active Directory
- Microsoft Entra ID
- Generic LDAP
- Google Workspace

NOTE: The commandlets covered in this section are for Active Directory and Microsoft Entra ID based
identity stores.

## Access Directory Manager Management Shell

Before using Directory Manager Management Shell, you must connect it to an identity store.

Follow the steps to access Management Shell.

Step 1 – On the Windows Start menu, search for **Directory ManagerManagement Shell 11.1**. Click it
to launch Directory Manager Management Shell 11.1.

Step 2 – On the Netwrix Netwrix Directory Manager Authenticate page, select an identity store to
connect to.

![Login page](/img/product_docs/directorymanager/directorymanager/managementshell/login.webp)

NOTE: If your required identity store is not listed, contact the Directory Manager administrator.

Step 3 – In the **Username** and **Password** boxes, provide the user name and password of your
identity store account and click **Sign In**.

![Login page](/img/product_docs/directorymanager/directorymanager/managementshell/login-2.webp)

NOTE: Click the **Edit** icon if you want to select another identity store to connect to.

The Management Shell window appears as follows:

![GroupID Management Shell 11.0](/img/product_docs/directorymanager/directorymanager/managementshell/shell.webp)

It displays information about the connected identity store.

You can now run Directory Manager Management Shell commandlets.

## Connect Directory Manager Management Shell Remotely

To enable remoting on a Directory Manager machine, the remote machine must have one of the following
Operating Systems:

- Windows Server 2016 or 2019 or 2022
- Windows Server Nano (1809 or higher)
- Windows 11
- Windows 10 1607+

Windows network location of that machine must be Domain or Private ("Home" or "Work"). If the
network location is Public, Directory Manager Management Shell cannot create the required firewall
exception for WS-Management Communication.

The Windows Management Shell remoting features are supported by the WS-Management protocol and the
Windows Remote Management (WinRM) service that implements WS-Management in Windows.

Also make sure the following is available at the remote machine:

- Windows Powershell 7.4.6
- Windows Remote Management 2.0

Follow the steps to enable remoting on a Directory Manager machine.

Step 1 – Click **Start > Windows Powershell**. Right-click Windows PowerShell and select **Run as
administrator**.

Step 2 – At the command prompt, type:

```
enable-psremoting
```

![powershellwindow](/img/product_docs/directorymanager/directorymanager/managementshell/powershellwindow.webp)

NOTE: By default, on Windows Server 2016, Windows PowerShell remoting is enabled. Use this command
to re-enable remoting on Windows Server 2016 if it becomes disabled.

You have to run this command only one time on each computer that will receive commands. You do not
have to run it on computers that only send commands. Because the configuration starts listeners, it
is prudent to run it only where it is needed.

To verify that remoting is configured correctly, run a test command:

```
new-PSSession –ComputerName <computer name>
```

This command creates a remote session on the local computer and returns an object that represents
the session. The output should look as shown in the following snapshot:

![Management Shell Remote session](/img/product_docs/directorymanager/directorymanager/managementshell/pssessioncommand.webp)

### Access Directory Manager Management Shell Remotely

Log on to the machine through which you want to remotely access the Directory Manager Management
Shell and perform the following steps:

Step 1 – Right-click **Start > PowerShell 7.4.6** using the **Run as Administrator** command to open
it with Administrator privileges.

Step 2 – At the prompt, type the following script. It will display the new session created for the
remote machine.

```
$username = "domain\username"
$pass = ConvertTo-SecureString "user password" -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential ($username, $pass)
$s = New-PSSession -ComputerName "machine name" -Credential $Cred -ConfigurationName PowerShell.7
Invoke-Command -Session $s -ScriptBlock {$srcu = [reflection.assembly]::LoadFrom('C:\Program Files\PowerShell\7\System.Windows.Forms.dll'); $OnAssemblyResolve = [System.ResolveEventHandler] { param($sender, $e) if ($e.Name -like "System.Windows.Forms, Version=*") { return $srcu }return $null;};[System.AppDomain]::CurrentDomain.add_AssemblyResolve($OnAssemblyResolve);$reg=Get-ItemProperty -Path HKLM:SOFTWARE\Microsoft\PowerShell\1\PowerShellSnapIns\Imanami.Groups.Management.PowerShell.Admin11; $appbase=$reg.ApplicationBase;Import-Module -Name $appbase\directorymanagerManagementShell\bin\Imanami.directorymanager.Management.dll;Set-ModulePath -ModulePath $appbase\GroupIDManagementShell\bin}
Import-PSSession -Session $s -Type cmdlet -AllowClobber
Connect-IdentityStore -mode "2" -IdentityStoreID "identity store id" -Credential $Cred
```

Following line of the above script connects the current user to the identity store (_having ID 1_).

```
Connect-IdentityStore -mode "2" -IdentityStoreID "1" -Credential $Cred
```

Follow the steps to get the identity store ID from Directory Manager SQL database in which the
desired identity store exists:

1. Login to SQL server (having Directory Manager database) with account having read permissions.
2. View the table “Svc.Identitystore” top 100 rows. See the following snapshot for details:

   ![groupiddatabase](/img/product_docs/directorymanager/directorymanager/managementshell/directorymanagerdatabase.webp)

Once the script has run, a remote session will be created. You can now run all Directory Manager
cmdlets through PowerShell 7.4.6 without the need of signing into the Directory Manager server.

# Scheduling Commands

This section covers the cmdlets that perform scheduling-related operations.

- [Get-Schedule](/docs/directorymanager/11.1/powershell-reference/getschedule.md) – retrieves scheduled jobs.
- [Get-TargetSchedules](/docs/directorymanager/11.1/powershell-reference/gettargetschedule.md) – retrieves the scheduled jobs operating on a group or
  OU.
- [ Invoke-Schedule](/docs/directorymanager/11.1/powershell-reference/invokeschedule.md) – executes a scheduled job.
- [New-Schedule](/docs/directorymanager/11.1/powershell-reference/newschedule.md) – creates a new schedule.
- [Remove-Schedule](/docs/directorymanager/11.1/powershell-reference/removeschedule.md) – removes a schedule from an identity store.
- [Set-Schedule](/docs/directorymanager/11.1/powershell-reference/setschedule.md) – modifies a schedule.
- [Stop-Schedule](/docs/directorymanager/11.1/powershell-reference/stopschedule.md) – stops a running schedule.

# Smart Group Commands

This section covers cmdlets for managing Smart Groups.

- [ConvertTo-StaticGroup](/docs/directorymanager/11.1/powershell-reference/converttostaticgroup.md) – Converts a Smart Group or a Dynasty to a static
  group.
- [Get-SmartGroup](/docs/directorymanager/11.1/powershell-reference/getsmartgroup.md) – Retrieves Smart Groups and Dynasties that match the given
  criteria.
- [New-SmartGroup](/docs/directorymanager/11.1/powershell-reference/newsmartgroup.md) – Creates a new Smart Group (managed group) in the directory.
- [Set-SmartGroup](/docs/directorymanager/11.1/powershell-reference/setsmartgroup.md) – Modifies a Smart Group in the directory.
- [Update-Group](/docs/directorymanager/11.1/powershell-reference/updategroup.md) – Modifies the membership of a Smart Group or Dynasty according to
  the results returned by the LDAP query.
- [Upgrade-Group](/docs/directorymanager/11.1/powershell-reference/upgradegroup.md) – Upgrades managed (Smart Groups and Dynasties) and non-managed
  groups from GroupID 9 and 10 to GroupID 11.

# User Lifecycle Commands

This section covers the cmdlets for performing user lifecycle tasks such as:

- [Extend-User](/docs/directorymanager/11.1/powershell-reference/extenduser.md) – Activates a user account for a specific number of days
- [Get-Status](/docs/directorymanager/11.1/powershell-reference/getstatus.md) – Provides the status of a user as per the profile validation criteria.
- [Reinstate-User](/docs/directorymanager/11.1/powershell-reference/reinstateuser.md) – Activates or disables a user.
- [Terminate-DirectReports](/docs/directorymanager/11.1/powershell-reference/terminatedirectreports.md) – Terminates direct reports of a user.
- [Transfer-DirectReports ](/docs/directorymanager/11.1/powershell-reference/transferdirectreports.md) – Transfers direct reports of a user.
