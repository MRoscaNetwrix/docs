---
title: exchange recommended reports
sidebar_label: recommended reports
description: Solution guide for exchange recommended reports including implementation steps, configuration, and best practices.
---

# Recommended Configurations for the 3. Databases Job Group

Dependencies

This job group requires the following items to be installed and configured on the Enterprise Auditor
Console:

- Microsoft MAPI CDO installed
- Enterprise Auditor MAPI CDO installed
- **Settings** > **Exchange** node configured

Targeted Hosts

The **0. Collection** > **1. Local** job group has been set to run against:

- Local host

The **0. Collection** > **2. PF** job group has been set to run against the following default
dynamic host list:

- Exchange MB Servers

**NOTE:** Default dynamic host lists are populated from hosts in the Host Master Table which meet
the host inventory criteria for the list. Ensure the appropriate host lists have been populated
through host inventory results.

Connection Profile

A Connection Profile must be set directly on the EX_DBInfo Job and the EX_PFInfo Job. See the
[Exchange PowerShell Permissions](/docs/accessanalyzer/11.6/getting-started/requirements/solutions-requirements.md)
topic for the Ex_DBInfo Job required permissions. See the
[MAPI-Based Data Collector Permissions](/docs/accessanalyzer/11.6/getting-started/requirements/solutions-requirements.md)
topic for the EX_PFInfo Job requirements.

See the
[Connection](/docs/accessanalyzer/11.6/administration/settings/connections.md)
topic for additional information.

Schedule Frequency

This job group has been designed to run daily to collect information about the size of databases in
the environment.

**_RECOMMENDED:_** Run this Job Group at 3:00 AM.

History Retention

History retention should not be enabled on this job group. History is kept through analysis tasks.
Modify the following analysis tasks to customize the amount of history which is kept:

| Job Name    | Analysis Task Name    | Default History |
| ----------- | --------------------- | --------------- |
| EX_DBSizing | SET HISTORY RETENTION | 6 Months        |

Query Configuration

The 3. Databases Job Group is designed to be run with the default query configurations. However, the
following query can be modified:

- **0.Collection** > **1. Local** > **EX_DBInfo** Job – **Exchange 2010 Store Size** Query

No other queries should be modified.

Analysis Configuration

The 3. Databases Job Group should be run with the default analysis configurations.

**CAUTION:** Most of the analysis tasks are preconfigured and should never be modified or
deselected. There are some that are deselected by default, as they are for troubleshooting purposes.

The following analysis task should not be deselected, but the parameters can be modified:

- **EX_DBSizing** Job – **SET HISTORY RETENTION** Analysis Task

Workflow

**Step 1 –** Set a Connection Profile on the jobs that run data collection.

**Step 2 –** Schedule the 3. Databases Job Group to run daily.

**Step 3 –** Review the reports generated by the jobs.

# Recommended Configurations for the 8. Exchange Online Job Group

Dependencies

The following Enterprise Auditor job groups need to be successfully run:

- .Active Directory Inventory
- .Entra ID Inventory

Targeted Hosts

The Mailflow job group uses Remote PowerShell through the ExchangePS Data Collector and the
PowerShell Data Collector. The host list needs to be set to one of the following:

- Local Host
- Custom Host List for Exchange Online

  - The host list should include the tenant name of the Microsoft Entra tenant used to connect to
    Exchange Online. See the
    [Exchange Online Host List](/docs/accessanalyzer/11.6/data-collection/exchange/configuration.md#exchange-online-host-list)
    topic for additional information.

Connection Profile

See the
[Exchange PowerShell Permissions](/docs/accessanalyzer/11.6/getting-started/requirements/solutions-requirements.md)
topic for the EX_Mailflow job requirements.

Additionally, the Exchange Online job group needs access to the following Exchange Online URLs to
perform collection:

- Exchange PowerShell – https://ps.outlook.com/PowerShell
- Autodiscover – https://autodiscover-s.outlook.com/autodiscover/autodiscover.svc
- EWS – https://outlook.office365.com/EWS/Exchange.asmx

See the
[Exchange Custom Connection Profile & Host List](/docs/accessanalyzer/11.6/data-collection/exchange/configuration.md)
topic for additional information.

Schedule Frequency

This job group has been designed to run daily.

**_RECOMMENDED:_** Run this job group at 1:00 AM.

Query Configuration

The 8. Exchange Online job group is designed to be run with the default query configurations.
However, the following queries can be modified:

- **Mailflow** > **0. Collection** > **EX_Mailflow** Job – **MailFlow** Query
- **EX_ASPolicies** Job – **Exchange Settings** Query

No other queries should be modified.

Analysis Configuration

The 8. Exchange Online job group should be run with the default analysis configurations. Most of
these analysis tasks are preconfigured and should never be modified or deselected. There are some
that are deselected by default, as they are for troubleshooting purposes.

The following analysis tasks should not be deselected, but their parameters can be modified:

- **Mailflow** > **0. Collection** > **EX_Mailflow** Job – **03. SET HISTORY RETENTION** Analysis
  Task
- **Mailflow** > **EX_Mailflow_Domain** Job – **Mailflow Domain** Analysis Task
- **Mailflow** > **EX_Mailflow_Mailbox** Job – **User Mailboxes By Message Count** Analysis Task
- **Mailflow** > **EX_Mailflow_Mailbox** Job – **User Mailboxes by Message Size** Analysis Task
- **Mailflow** > **EX_Mailflow_OrgOverview** Job – **Organization Overview** Analysis Task

Workflow

**Step 1 –** Set the host on the EX_Mailflow job.

- The **Mailflow** > **0. Collection** > **EX_Mailflow** job needs to be set to run against one of
  the following:

  - Local Host
  - Custom Host List

**Step 2 –** Set a Connection Profile on the jobs which run data collection.

**Step 3 –** Schedule the 8. Exchange Online job group to run as desired.

# Recommended Configurations for the Exchange Solution

Each job group within the Exchange Solution has its own Recommended Configurations topic. See the
relevant topic for specific information on job group settings and recommended schedule frequency.

- [Recommended Configurations for the 1. HUB Metrics Job Group](/docs/accessanalyzer/11.6/solutions/exchange/metrics-analysis.md)
- [Recommended Configurations for the 2. CAS Metrics Job Group](/docs/accessanalyzer/11.6/solutions/exchange/metrics-analysis.md)
- [Recommended Configurations for the 3. Databases Job Group](/docs/accessanalyzer/11.6/solutions/exchange/recommended-reports.md)
- [Recommended Configurations for the 4. Mailboxes Job Group](/docs/accessanalyzer/11.6/solutions/exchange/mailbox-analysis.md)
- [Recommended Configurations for the 5. Public Folders Job Group](/docs/accessanalyzer/11.6/solutions/exchange/public-folder-analysis.md)
- [Recommended Configurations for the 6. Distribution Lists Job Group](/docs/accessanalyzer/11.6/solutions/exchange/distribution-lists.md)
- [Recommended Configurations for the 7. Sensitive Data Job Group](/docs/accessanalyzer/11.6/solutions/exchange/sensitive-data.md)
- [Recommended Configurations for the 8. Exchange Online Job Group](/docs/accessanalyzer/11.6/solutions/exchange/recommended-reports.md)

## ExchangePS Data Collector & Client Access Server

A Client Access Server (CAS) name is required for the ExchangePS Data Collector. When targeting
Exchange 2013 or 2016, it is possible for the **Settings** > **Exchange** node to have been
configured with a web address instead of a CAS.

- Exchange 2010 Servers – Uses the CAS server set in the global configuration (**Settings** >
  **Exchange** node)
- Exchange 2013 & 2016 – May require a CAS name set in the ExchangePS Data Collector configuration:

  - If the **Settings** > **Exchange** node was configured for **MAPI over HTTP**, then a CAS
    server name was supplied and that is used by the ExchangePS Data Collector
  - If the **Settings** > **Exchange** node was configured for **MAPI over HTTPS**, then the
    global configuration has a web address instead of an actual server. Therefore, each query
    requires the CAS server to be set as the specific server on the Category page.

Follow the steps to supply a CAS name for data collection.

**Step 1 –** Navigate to the job’s **Configure** node and select **Queries**.

**Step 2 –** In the Query Selection view, click **Query Properties**. The Query Properties window
opens.

**Step 3 –** Select the **Data Source** tab, and click **Configure**. The ExchangePS Data Collector
Wizard opens.

**CAUTION:** Unless otherwise indicated within the job group section, do not make changes to other
wizard pages as they have been pre-configured for the purpose of the job.

![CAS name on ExchangePS Data Collector Wizard Category page](/img/versioned_docs/accessanalyzer_11.6/accessanalyzer/solutions/exchange/exchangepscas.webp)

**Step 4 –** On the Category page, select the **Use specific server** option and enter the CAS name
in the text box. See the
[ExchangePS: Category](/docs/accessanalyzer/11.6/data-collection/exchange/configuration.md) topic
for additional information.

**Step 5 –** Navigate to the Summary page. Click **Finish**.

The job now successfully targets Exchange 2013 and 2016 environments.
